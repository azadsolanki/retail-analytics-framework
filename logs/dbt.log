

============================== 2025-09-03 05:41:22.943864 | 248d0a01-534c-475f-92a5-47fb92959598 ==============================
05:41:22.943864 [info ] [MainThread]: Running with dbt=1.0.1
05:41:22.944098 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/azadsolanki/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
05:41:22.944195 [debug] [MainThread]: Tracking: tracking
05:41:22.952844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b24820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b584f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b58c10>]}
05:41:22.966008 [debug] [MainThread]: Executing "git --help"
05:41:22.979376 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
05:41:22.979717 [debug] [MainThread]: STDERR: "b''"
05:41:22.980024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b357f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbe640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbe6a0>]}


============================== 2025-09-03 05:50:22.258536 | 9486c78d-70e7-46c9-8036-8201b6c0bac2 ==============================
05:50:22.258536 [info ] [MainThread]: Running with dbt=1.0.1
05:50:22.258854 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/azadsolanki/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
05:50:22.258951 [debug] [MainThread]: Tracking: tracking
05:50:22.269577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e04670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e041f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e04730>]}
05:50:22.276309 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
05:50:22.284495 [debug] [MainThread]: Executing "git --help"
05:50:22.298247 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
05:50:22.298566 [debug] [MainThread]: STDERR: "b''"
05:50:22.298851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e56f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e0a640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e0a8e0>]}


============================== 2025-09-03 05:53:31.070721 | 749fb91d-8c62-48db-8e72-d83b085c8187 ==============================
05:53:31.070721 [info ] [MainThread]: Running with dbt=1.0.1
05:53:31.071029 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/azadsolanki/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
05:53:31.071126 [debug] [MainThread]: Tracking: tracking
05:53:31.082918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104648940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104648520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104648610>]}
05:53:31.089331 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
05:53:31.099457 [debug] [MainThread]: Executing "git --help"
05:53:31.112393 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
05:53:31.112698 [debug] [MainThread]: STDERR: "b''"
05:53:31.112989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046254f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10469a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10469a3d0>]}


============================== 2025-09-03 05:56:11.245575 | af357f46-90f6-4dd6-b1d7-34e388f02016 ==============================
05:56:11.245575 [info ] [MainThread]: Running with dbt=1.0.1
05:56:11.245964 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/azadsolanki/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
05:56:11.246059 [debug] [MainThread]: Tracking: tracking
05:56:11.259058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081506a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108150610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108150760>]}
05:56:11.274151 [debug] [MainThread]: Executing "git --help"
05:56:11.287610 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
05:56:11.287953 [debug] [MainThread]: STDERR: "b''"
05:56:11.288221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c0be0>]}


============================== 2025-09-03 05:56:38.902824 | 0ce49de3-75ee-4f79-a3a6-945d0ee36b0a ==============================
05:56:38.902824 [info ] [MainThread]: Running with dbt=1.0.1
05:56:38.903151 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/azadsolanki/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
05:56:38.903248 [debug] [MainThread]: Tracking: tracking
05:56:38.911391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082202b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082207c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108220580>]}
05:56:38.918143 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
05:56:38.927689 [debug] [MainThread]: Executing "git --help"
05:56:38.935587 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
05:56:38.935899 [debug] [MainThread]: STDERR: "b''"
05:56:38.936247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108220220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10828fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10828fc70>]}
[0m22:58:20.474914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074bafa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108986250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108986520>]}


============================== 22:58:20.477753 | 265a38ef-fa42-4ede-9e57-9078d690dc81 ==============================
[0m22:58:20.477753 [info ] [MainThread]: Running with dbt=1.10.10
[0m22:58:20.478151 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'use_colors': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'debug': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'partial_parse': 'True', 'quiet': 'False', 'empty': 'None', 'no_print': 'None', 'static_parser': 'True'}
[0m22:58:20.488461 [info ] [MainThread]: dbt version: 1.10.10
[0m22:58:20.488802 [info ] [MainThread]: python version: 3.9.6
[0m22:58:20.489039 [info ] [MainThread]: python path: /Users/azadsolanki/dev/data-engineering/airflow-env/bin/python3
[0m22:58:20.489262 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m22:58:35.064018 [info ] [MainThread]: Using profiles dir at /Users/azadsolanki/.dbt
[0m22:58:35.064536 [info ] [MainThread]: Using profiles.yml file at /Users/azadsolanki/.dbt/profiles.yml
[0m22:58:35.064805 [info ] [MainThread]: Using dbt_project.yml file at /Users/azadsolanki/dev/data-engineering/analytics-engineering/dbt_project.yml
[0m22:58:35.065045 [info ] [MainThread]: adapter type: bigquery
[0m22:58:35.065260 [info ] [MainThread]: adapter version: 1.10.1
[0m22:58:35.129957 [info ] [MainThread]: Configuration:
[0m22:58:35.130339 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:58:35.130576 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:58:35.130791 [info ] [MainThread]: Required dependencies:
[0m22:58:35.131063 [debug] [MainThread]: Executing "git --help"
[0m22:58:35.154402 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:58:35.155057 [debug] [MainThread]: STDERR: "b''"
[0m22:58:35.155355 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:58:35.155615 [info ] [MainThread]: Connection:
[0m22:58:35.155937 [info ] [MainThread]:   method: service-account
[0m22:58:35.156155 [info ] [MainThread]:   database: data-products-441119
[0m22:58:35.156366 [info ] [MainThread]:   execution_project: data-products-441119
[0m22:58:35.156582 [info ] [MainThread]:   schema: educative
[0m22:58:35.156789 [info ] [MainThread]:   location: US
[0m22:58:35.157000 [info ] [MainThread]:   priority: interactive
[0m22:58:35.157209 [info ] [MainThread]:   maximum_bytes_billed: None
[0m22:58:35.157416 [info ] [MainThread]:   impersonate_service_account: None
[0m22:58:35.157630 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m22:58:35.157839 [info ] [MainThread]:   job_retries: 1
[0m22:58:35.158042 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m22:58:35.158246 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m22:58:35.158450 [info ] [MainThread]:   timeout_seconds: 300
[0m22:58:35.158653 [info ] [MainThread]:   client_id: None
[0m22:58:35.158854 [info ] [MainThread]:   token_uri: None
[0m22:58:35.159056 [info ] [MainThread]:   compute_region: None
[0m22:58:35.159258 [info ] [MainThread]:   dataproc_cluster_name: None
[0m22:58:35.159460 [info ] [MainThread]:   gcs_bucket: None
[0m22:58:35.159662 [info ] [MainThread]:   dataproc_batch: None
[0m22:58:35.160117 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:58:35.329840 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m22:58:35.330264 [debug] [MainThread]: On debug: select 1 as id
[0m22:58:35.330525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:58:36.364510 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:bce3d3aa-f97e-43ec-a9ea-811f64bea042&page=queryresults
[0m22:58:36.872455 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:58:36.873533 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:58:36.889627 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 16.460697, "process_in_blocks": "0", "process_kernel_time": 0.55864, "process_mem_max_rss": "359530496", "process_out_blocks": "0", "process_user_time": 2.766272}
[0m22:58:36.891121 [debug] [MainThread]: Command `dbt debug` succeeded at 22:58:36.890882 after 16.46 seconds
[0m22:58:36.891805 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:58:36.892476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074bafa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128740700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107392580>]}
[0m22:58:36.893223 [debug] [MainThread]: Flushing usage events
[0m22:58:37.244540 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:05:38.388781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10398bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e55280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e55550>]}


============================== 23:05:38.391686 | 809328c3-fa06-4510-88f6-e299a1c14b59 ==============================
[0m23:05:38.391686 [info ] [MainThread]: Running with dbt=1.10.10
[0m23:05:38.392085 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'debug': 'False', 'introspect': 'True', 'static_parser': 'True', 'warn_error': 'None', 'empty': 'False', 'no_print': 'None', 'profiles_dir': '/Users/azadsolanki/.dbt', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'log_format': 'default', 'target_path': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'version_check': 'True'}
[0m23:05:40.250532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '809328c3-fa06-4510-88f6-e299a1c14b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029fd7c0>]}
[0m23:05:40.286516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '809328c3-fa06-4510-88f6-e299a1c14b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d2e8e0>]}
[0m23:05:40.286946 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m23:05:40.465787 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m23:05:40.466394 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:05:40.466679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '809328c3-fa06-4510-88f6-e299a1c14b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f944220>]}
[0m23:05:41.378434 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics-engineering.example
[0m23:05:41.382324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '809328c3-fa06-4510-88f6-e299a1c14b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1391c7130>]}
[0m23:05:41.442876 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m23:05:41.444118 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m23:05:41.458699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '809328c3-fa06-4510-88f6-e299a1c14b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1391e7a90>]}
[0m23:05:41.459098 [info ] [MainThread]: Found 2 models, 4 data tests, 496 macros
[0m23:05:41.459351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '809328c3-fa06-4510-88f6-e299a1c14b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1391c7640>]}
[0m23:05:41.460460 [info ] [MainThread]: 
[0m23:05:41.460845 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:05:41.461086 [info ] [MainThread]: 
[0m23:05:41.461459 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:05:41.464372 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m23:05:41.464679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:42.041115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now create_data-products-441119_educative)
[0m23:05:42.042362 [debug] [ThreadPool]: Creating schema "database: "data-products-441119"
schema: "educative"
"
[0m23:05:42.058651 [debug] [ThreadPool]: On create_data-products-441119_educative: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "analytics-engineering", "target_name": "dev", "connection_name": "create_data-products-441119_educative"} */
create schema if not exists `data-products-441119`.`educative`
  
[0m23:05:42.059353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:05:42.996452 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:69df8146-c57b-4025-8c6e-fa8afa47b0f7&page=queryresults
[0m23:05:43.935945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data-products-441119_educative, now list_data-products-441119_educative)
[0m23:05:43.936399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:05:44.477085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '809328c3-fa06-4510-88f6-e299a1c14b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ffb5760>]}
[0m23:05:44.478080 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:05:44.574605 [debug] [Thread-1  ]: Began running node model.analytics_engineering.my_first_dbt_model
[0m23:05:44.575044 [info ] [Thread-1  ]: 1 of 2 START sql table model educative.my_first_dbt_model ...................... [RUN]
[0m23:05:44.575379 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_educative, now model.analytics_engineering.my_first_dbt_model)
[0m23:05:44.575840 [debug] [Thread-1  ]: Began compiling node model.analytics_engineering.my_first_dbt_model
[0m23:05:44.581362 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_engineering.my_first_dbt_model"
[0m23:05:44.582188 [debug] [Thread-1  ]: Began executing node model.analytics_engineering.my_first_dbt_model
[0m23:05:44.607414 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_engineering.my_first_dbt_model"
[0m23:05:44.608509 [debug] [Thread-1  ]: On model.analytics_engineering.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "analytics-engineering", "target_name": "dev", "node_id": "model.analytics_engineering.my_first_dbt_model"} */

  
    

    create or replace table `data-products-441119`.`educative`.`my_first_dbt_model`
      
    
    

    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m23:05:44.608835 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:05:45.451327 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:1f949651-01fd-49aa-883d-4b090f796abb&page=queryresults
[0m23:05:47.513882 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '809328c3-fa06-4510-88f6-e299a1c14b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a866be0>]}
[0m23:05:47.515049 [info ] [Thread-1  ]: 1 of 2 OK created sql table model educative.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.94s]
[0m23:05:47.515906 [debug] [Thread-1  ]: Finished running node model.analytics_engineering.my_first_dbt_model
[0m23:05:47.516891 [debug] [Thread-1  ]: Began running node model.analytics_engineering.my_second_dbt_model
[0m23:05:47.517683 [info ] [Thread-1  ]: 2 of 2 START sql view model educative.my_second_dbt_model ...................... [RUN]
[0m23:05:47.518335 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.analytics_engineering.my_first_dbt_model, now model.analytics_engineering.my_second_dbt_model)
[0m23:05:47.518879 [debug] [Thread-1  ]: Began compiling node model.analytics_engineering.my_second_dbt_model
[0m23:05:47.523749 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_engineering.my_second_dbt_model"
[0m23:05:47.524750 [debug] [Thread-1  ]: Began executing node model.analytics_engineering.my_second_dbt_model
[0m23:05:47.547309 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_engineering.my_second_dbt_model"
[0m23:05:47.548138 [debug] [Thread-1  ]: On model.analytics_engineering.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "analytics-engineering", "target_name": "dev", "node_id": "model.analytics_engineering.my_second_dbt_model"} */


  create or replace view `data-products-441119`.`educative`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `data-products-441119`.`educative`.`my_first_dbt_model`
where id = 1;


[0m23:05:47.548525 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:05:48.310211 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:aa5fcec4-0f49-4285-a7d3-e2903db30622&page=queryresults
[0m23:05:48.693441 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '809328c3-fa06-4510-88f6-e299a1c14b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103884c40>]}
[0m23:05:48.694966 [info ] [Thread-1  ]: 2 of 2 OK created sql view model educative.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m23:05:48.696033 [debug] [Thread-1  ]: Finished running node model.analytics_engineering.my_second_dbt_model
[0m23:05:48.697428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:05:48.790978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:48.791309 [debug] [MainThread]: Connection 'model.analytics_engineering.my_second_dbt_model' was properly closed.
[0m23:05:48.791557 [info ] [MainThread]: 
[0m23:05:48.791803 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 7.33 seconds (7.33s).
[0m23:05:48.792344 [debug] [MainThread]: Command end result
[0m23:05:48.809015 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m23:05:48.810309 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m23:05:48.814306 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m23:05:48.814547 [info ] [MainThread]: 
[0m23:05:48.814833 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:05:48.815062 [info ] [MainThread]: 
[0m23:05:48.815305 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:05:48.817806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.476805, "process_in_blocks": "0", "process_kernel_time": 0.457352, "process_mem_max_rss": "371998720", "process_out_blocks": "0", "process_user_time": 4.11353}
[0m23:05:48.818197 [debug] [MainThread]: Command `dbt run` succeeded at 23:05:48.818148 after 10.48 seconds
[0m23:05:48.818468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10398bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d2e8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c3c7f0>]}
[0m23:05:48.818733 [debug] [MainThread]: Flushing usage events
[0m23:05:49.154748 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:49.335017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728ef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111276190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111276460>]}


============================== 15:57:49.337805 | 33bfae82-40c4-4ee2-b04f-30ea63653f6e ==============================
[0m15:57:49.337805 [info ] [MainThread]: Running with dbt=1.10.10
[0m15:57:49.338208 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_format': 'default', 'static_parser': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'profiles_dir': '/Users/azadsolanki/.dbt', 'debug': 'False', 'empty': 'None', 'introspect': 'True', 'quiet': 'False', 'version_check': 'True', 'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt debug'}
[0m15:57:49.349688 [info ] [MainThread]: dbt version: 1.10.10
[0m15:57:49.350040 [info ] [MainThread]: python version: 3.9.6
[0m15:57:49.350273 [info ] [MainThread]: python path: /Users/azadsolanki/dev/data-engineering/airflow-env/bin/python3
[0m15:57:49.350494 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m15:57:51.682301 [info ] [MainThread]: Using profiles dir at /Users/azadsolanki/.dbt
[0m15:57:51.682674 [info ] [MainThread]: Using profiles.yml file at /Users/azadsolanki/.dbt/profiles.yml
[0m15:57:51.682902 [info ] [MainThread]: Using dbt_project.yml file at /Users/azadsolanki/dev/data-engineering/analytics-engineering/dbt_project.yml
[0m15:57:51.683127 [info ] [MainThread]: adapter type: bigquery
[0m15:57:51.683332 [info ] [MainThread]: adapter version: 1.10.1
[0m15:57:51.748742 [info ] [MainThread]: Configuration:
[0m15:57:51.749164 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:57:51.749397 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:57:51.749614 [info ] [MainThread]: Required dependencies:
[0m15:57:51.749922 [debug] [MainThread]: Executing "git --help"
[0m15:57:51.784894 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:57:51.785589 [debug] [MainThread]: STDERR: "b''"
[0m15:57:51.785869 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:57:51.786147 [info ] [MainThread]: Connection:
[0m15:57:51.786469 [info ] [MainThread]:   method: service-account
[0m15:57:51.786686 [info ] [MainThread]:   database: data-products-441119
[0m15:57:51.786894 [info ] [MainThread]:   execution_project: data-products-441119
[0m15:57:51.787103 [info ] [MainThread]:   schema: educative
[0m15:57:51.787310 [info ] [MainThread]:   location: US
[0m15:57:51.787514 [info ] [MainThread]:   priority: interactive
[0m15:57:51.787718 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:57:51.787922 [info ] [MainThread]:   impersonate_service_account: None
[0m15:57:51.788127 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:57:51.788330 [info ] [MainThread]:   job_retries: 1
[0m15:57:51.788538 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:57:51.788747 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:57:51.788948 [info ] [MainThread]:   timeout_seconds: 300
[0m15:57:51.789149 [info ] [MainThread]:   client_id: None
[0m15:57:51.789355 [info ] [MainThread]:   token_uri: None
[0m15:57:51.789556 [info ] [MainThread]:   compute_region: None
[0m15:57:51.789757 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:57:51.789958 [info ] [MainThread]:   gcs_bucket: None
[0m15:57:51.790158 [info ] [MainThread]:   dataproc_batch: None
[0m15:57:51.790624 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m15:57:51.961696 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:57:51.962139 [debug] [MainThread]: On debug: select 1 as id
[0m15:57:51.962413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:57:52.874271 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:a7b8f906-2f1c-4738-91d3-2f462892ae19&page=queryresults
[0m15:57:53.401993 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:57:53.402959 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:57:53.422322 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.135887, "process_in_blocks": "0", "process_kernel_time": 0.476023, "process_mem_max_rss": "361136128", "process_out_blocks": "0", "process_user_time": 2.381156}
[0m15:57:53.423713 [debug] [MainThread]: Command `dbt debug` succeeded at 15:57:53.423511 after 4.14 seconds
[0m15:57:53.424491 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:57:53.425111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728ef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104655e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143f49370>]}
[0m15:57:53.425795 [debug] [MainThread]: Flushing usage events
[0m15:57:53.771721 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:04.796453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae7280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae7550>]}


============================== 16:20:04.799394 | a13650e6-a233-4d0c-9553-bab1e9b1b87e ==============================
[0m16:20:04.799394 [info ] [MainThread]: Running with dbt=1.10.10
[0m16:20:04.799804 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'invocation_command': 'dbt debug', 'debug': 'False', 'write_json': 'True', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'quiet': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'no_print': 'None'}
[0m16:20:04.810652 [info ] [MainThread]: dbt version: 1.10.10
[0m16:20:04.810999 [info ] [MainThread]: python version: 3.9.6
[0m16:20:04.811234 [info ] [MainThread]: python path: /Users/azadsolanki/dev/data-engineering/airflow-env/bin/python3
[0m16:20:04.811456 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m16:20:06.631677 [info ] [MainThread]: Using profiles dir at /Users/azadsolanki/.dbt
[0m16:20:06.632037 [info ] [MainThread]: Using profiles.yml file at /Users/azadsolanki/.dbt/profiles.yml
[0m16:20:06.632274 [info ] [MainThread]: Using dbt_project.yml file at /Users/azadsolanki/dev/data-engineering/analytics-engineering/dbt_project.yml
[0m16:20:06.632508 [info ] [MainThread]: adapter type: bigquery
[0m16:20:06.632718 [info ] [MainThread]: adapter version: 1.10.1
[0m16:20:06.697689 [info ] [MainThread]: Configuration:
[0m16:20:06.698059 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:20:06.698283 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:20:06.698494 [info ] [MainThread]: Required dependencies:
[0m16:20:06.698763 [debug] [MainThread]: Executing "git --help"
[0m16:20:06.719086 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:20:06.719725 [debug] [MainThread]: STDERR: "b''"
[0m16:20:06.720010 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:20:06.720265 [info ] [MainThread]: Connection:
[0m16:20:06.720590 [info ] [MainThread]:   method: service-account
[0m16:20:06.720806 [info ] [MainThread]:   database: data-products-441119
[0m16:20:06.721015 [info ] [MainThread]:   execution_project: data-products-441119
[0m16:20:06.721220 [info ] [MainThread]:   schema: educative
[0m16:20:06.721426 [info ] [MainThread]:   location: US
[0m16:20:06.721633 [info ] [MainThread]:   priority: interactive
[0m16:20:06.721840 [info ] [MainThread]:   maximum_bytes_billed: None
[0m16:20:06.722045 [info ] [MainThread]:   impersonate_service_account: None
[0m16:20:06.722249 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m16:20:06.722455 [info ] [MainThread]:   job_retries: 1
[0m16:20:06.722662 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m16:20:06.722868 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m16:20:06.723071 [info ] [MainThread]:   timeout_seconds: 300
[0m16:20:06.723274 [info ] [MainThread]:   client_id: None
[0m16:20:06.723477 [info ] [MainThread]:   token_uri: None
[0m16:20:06.723681 [info ] [MainThread]:   compute_region: None
[0m16:20:06.723882 [info ] [MainThread]:   dataproc_cluster_name: None
[0m16:20:06.724085 [info ] [MainThread]:   gcs_bucket: None
[0m16:20:06.724288 [info ] [MainThread]:   dataproc_batch: None
[0m16:20:06.724870 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:20:06.893476 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m16:20:06.893911 [debug] [MainThread]: On debug: select 1 as id
[0m16:20:06.894171 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:07.688481 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:e461a431-ebeb-4774-8172-18f86a080964&page=queryresults
[0m16:20:08.239299 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:20:08.240343 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:20:08.247975 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.4997168, "process_in_blocks": "0", "process_kernel_time": 0.41653, "process_mem_max_rss": "362348544", "process_out_blocks": "0", "process_user_time": 2.325495}
[0m16:20:08.249425 [debug] [MainThread]: Command `dbt debug` succeeded at 16:20:08.249187 after 3.50 seconds
[0m16:20:08.250631 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:20:08.251474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f579d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131add430>]}
[0m16:20:08.252211 [debug] [MainThread]: Flushing usage events
[0m16:20:08.646545 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:36.675805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104ebf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d8a220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d8a4f0>]}


============================== 16:24:36.678744 | 8c62f473-3537-44a8-8cd0-7f4cefe5eaa9 ==============================
[0m16:24:36.678744 [info ] [MainThread]: Running with dbt=1.10.10
[0m16:24:36.679142 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'partial_parse': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'write_json': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'empty': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False', 'target_path': 'None'}
[0m16:24:36.690068 [info ] [MainThread]: dbt version: 1.10.10
[0m16:24:36.690395 [info ] [MainThread]: python version: 3.9.6
[0m16:24:36.690626 [info ] [MainThread]: python path: /Users/azadsolanki/dev/data-engineering/airflow-env/bin/python3
[0m16:24:36.690846 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m16:24:38.494487 [info ] [MainThread]: Using profiles dir at /Users/azadsolanki/.dbt
[0m16:24:38.494836 [info ] [MainThread]: Using profiles.yml file at /Users/azadsolanki/.dbt/profiles.yml
[0m16:24:38.495075 [info ] [MainThread]: Using dbt_project.yml file at /Users/azadsolanki/dev/data-engineering/analytics-engineering/dbt_project.yml
[0m16:24:38.495307 [info ] [MainThread]: adapter type: bigquery
[0m16:24:38.495517 [info ] [MainThread]: adapter version: 1.10.1
[0m16:24:38.562017 [info ] [MainThread]: Configuration:
[0m16:24:38.562394 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:24:38.562622 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:24:38.562835 [info ] [MainThread]: Required dependencies:
[0m16:24:38.563105 [debug] [MainThread]: Executing "git --help"
[0m16:24:38.583724 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:24:38.584377 [debug] [MainThread]: STDERR: "b''"
[0m16:24:38.584667 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:24:38.584939 [info ] [MainThread]: Connection:
[0m16:24:38.585262 [info ] [MainThread]:   method: service-account
[0m16:24:38.585481 [info ] [MainThread]:   database: data-products-441119
[0m16:24:38.585690 [info ] [MainThread]:   execution_project: data-products-441119
[0m16:24:38.585905 [info ] [MainThread]:   schema: educative
[0m16:24:38.586110 [info ] [MainThread]:   location: US
[0m16:24:38.586316 [info ] [MainThread]:   priority: interactive
[0m16:24:38.586525 [info ] [MainThread]:   maximum_bytes_billed: None
[0m16:24:38.586729 [info ] [MainThread]:   impersonate_service_account: None
[0m16:24:38.586935 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m16:24:38.587144 [info ] [MainThread]:   job_retries: 1
[0m16:24:38.587349 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m16:24:38.587556 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m16:24:38.587762 [info ] [MainThread]:   timeout_seconds: 300
[0m16:24:38.587973 [info ] [MainThread]:   client_id: None
[0m16:24:38.588175 [info ] [MainThread]:   token_uri: None
[0m16:24:38.588380 [info ] [MainThread]:   compute_region: None
[0m16:24:38.588582 [info ] [MainThread]:   dataproc_cluster_name: None
[0m16:24:38.588794 [info ] [MainThread]:   gcs_bucket: None
[0m16:24:38.588994 [info ] [MainThread]:   dataproc_batch: None
[0m16:24:38.589538 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:24:38.758140 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m16:24:38.758569 [debug] [MainThread]: On debug: select 1 as id
[0m16:24:38.758825 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:24:39.484648 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:5bfa0f3f-3474-44aa-b07b-e6a8be6d8a3c&page=queryresults
[0m16:24:39.976648 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:24:39.977666 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:24:39.985031 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.3603497, "process_in_blocks": "0", "process_kernel_time": 0.403995, "process_mem_max_rss": "362381312", "process_out_blocks": "0", "process_user_time": 2.300918}
[0m16:24:39.986127 [debug] [MainThread]: Command `dbt debug` succeeded at 16:24:39.985967 after 3.36 seconds
[0m16:24:39.986745 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:24:39.987374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104ebf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e44640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d1ed60>]}
[0m16:24:39.988118 [debug] [MainThread]: Flushing usage events
[0m16:24:40.358752 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:50.215993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ffbe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c54f0>]}


============================== 16:24:50.218326 | 09d326a2-73bd-4555-a1bb-5106c51fb43b ==============================
[0m16:24:50.218326 [info ] [MainThread]: Running with dbt=1.10.10
[0m16:24:50.218723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'empty': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'cache_selected_only': 'False', 'debug': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'introspect': 'True', 'no_print': 'None', 'warn_error': 'None', 'quiet': 'False', 'target_path': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'version_check': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:24:51.652506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09d326a2-73bd-4555-a1bb-5106c51fb43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10448f100>]}
[0m16:24:51.689428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09d326a2-73bd-4555-a1bb-5106c51fb43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103298dc0>]}
[0m16:24:51.689918 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:24:51.868884 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m16:24:51.938290 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m16:24:51.938685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '09d326a2-73bd-4555-a1bb-5106c51fb43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032d13d0>]}
[0m16:24:52.601498 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics-engineering.example
[0m16:24:52.605038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09d326a2-73bd-4555-a1bb-5106c51fb43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e85ca0>]}
[0m16:24:52.634589 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:24:52.636228 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:24:52.647568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09d326a2-73bd-4555-a1bb-5106c51fb43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d814160>]}
[0m16:24:52.648023 [info ] [MainThread]: Found 496 macros
[0m16:24:52.648284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09d326a2-73bd-4555-a1bb-5106c51fb43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d7f2c40>]}
[0m16:24:52.648904 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:24:52.649267 [debug] [MainThread]: Command end result
[0m16:24:52.664823 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:24:52.665857 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:24:52.668414 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m16:24:52.670999 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.498121, "process_in_blocks": "0", "process_kernel_time": 0.2961, "process_mem_max_rss": "362201088", "process_out_blocks": "0", "process_user_time": 2.919659}
[0m16:24:52.671378 [debug] [MainThread]: Command `dbt compile` succeeded at 16:24:52.671324 after 2.50 seconds
[0m16:24:52.671648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ffbe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032a12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d809d30>]}
[0m16:24:52.671918 [debug] [MainThread]: Flushing usage events
[0m16:24:52.990419 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:07.655297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10522afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f5460>]}


============================== 16:25:07.657619 | 68828567-ed68-4bf2-8b75-3ab110f048c3 ==============================
[0m16:25:07.657619 [info ] [MainThread]: Running with dbt=1.10.10
[0m16:25:07.658021 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'version_check': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'target_path': 'None', 'no_print': 'None', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'debug': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt compile', 'profiles_dir': '/Users/azadsolanki/.dbt', 'log_format': 'default', 'write_json': 'True'}
[0m16:25:09.069378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68828567-ed68-4bf2-8b75-3ab110f048c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054cb0d0>]}
[0m16:25:09.105073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68828567-ed68-4bf2-8b75-3ab110f048c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e8b2e0>]}
[0m16:25:09.105481 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:25:09.279974 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m16:25:09.310639 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:25:09.311037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '68828567-ed68-4bf2-8b75-3ab110f048c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b47f40>]}
[0m16:25:10.214251 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics-engineering.example
[0m16:25:10.218063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68828567-ed68-4bf2-8b75-3ab110f048c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a681eb0>]}
[0m16:25:10.277195 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:25:10.278532 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:25:10.289407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68828567-ed68-4bf2-8b75-3ab110f048c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a625c10>]}
[0m16:25:10.289791 [info ] [MainThread]: Found 2 models, 4 data tests, 496 macros
[0m16:25:10.290045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68828567-ed68-4bf2-8b75-3ab110f048c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a525430>]}
[0m16:25:10.290926 [info ] [MainThread]: 
[0m16:25:10.291202 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:25:10.291431 [info ] [MainThread]: 
[0m16:25:10.291777 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:25:10.294557 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_educative'
[0m16:25:10.294828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:10.838427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68828567-ed68-4bf2-8b75-3ab110f048c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc4c10>]}
[0m16:25:10.839475 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:25:10.941591 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_first_dbt_model
[0m16:25:10.941939 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_educative, now model.digital_marketing.my_first_dbt_model)
[0m16:25:10.942206 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_first_dbt_model
[0m16:25:10.947806 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_first_dbt_model"
[0m16:25:10.948565 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_first_dbt_model
[0m16:25:10.948842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:25:11.013955 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_first_dbt_model
[0m16:25:11.014408 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_second_dbt_model
[0m16:25:11.014675 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.my_first_dbt_model, now model.digital_marketing.my_second_dbt_model)
[0m16:25:11.014921 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_second_dbt_model
[0m16:25:11.017009 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_second_dbt_model"
[0m16:25:11.017433 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_second_dbt_model
[0m16:25:11.017703 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:25:11.082686 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_second_dbt_model
[0m16:25:11.082969 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:25:11.083239 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.my_second_dbt_model, now test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710)
[0m16:25:11.083491 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:25:11.091294 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:25:11.091845 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:25:11.092122 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:25:11.157208 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:25:11.157482 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:25:11.157743 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710, now test.digital_marketing.unique_my_first_dbt_model_id.16e066b321)
[0m16:25:11.157987 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:25:11.162350 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_my_first_dbt_model_id.16e066b321"
[0m16:25:11.162892 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:25:11.163182 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:25:11.228125 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:25:11.228402 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:25:11.228665 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_my_first_dbt_model_id.16e066b321, now test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778)
[0m16:25:11.228909 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:25:11.232410 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778"
[0m16:25:11.232883 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:25:11.233146 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:25:11.298114 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:25:11.298382 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:25:11.298639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778, now test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493)
[0m16:25:11.298882 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:25:11.301724 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:25:11.302165 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:25:11.302426 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:25:11.367730 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:25:11.368317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:11.368543 [debug] [MainThread]: Connection 'test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m16:25:11.369275 [debug] [MainThread]: Command end result
[0m16:25:11.385356 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:25:11.386269 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:25:11.390707 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m16:25:11.393174 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.7814314, "process_in_blocks": "0", "process_kernel_time": 0.290179, "process_mem_max_rss": "374767616", "process_out_blocks": "0", "process_user_time": 3.791341}
[0m16:25:11.393531 [debug] [MainThread]: Command `dbt compile` succeeded at 16:25:11.393481 after 3.78 seconds
[0m16:25:11.393789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10522afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054db970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054cb0d0>]}
[0m16:25:11.394041 [debug] [MainThread]: Flushing usage events
[0m16:25:11.717704 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:30:53.724717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103447f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104911250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104911550>]}


============================== 16:30:53.727689 | 77f5ba2a-f35d-466d-92ef-8bdb175f4514 ==============================
[0m16:30:53.727689 [info ] [MainThread]: Running with dbt=1.10.10
[0m16:30:53.728121 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'write_json': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'printer_width': '80', 'static_parser': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'debug': 'False', 'quiet': 'False', 'empty': 'False', 'partial_parse': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt compile', 'log_format': 'default'}
[0m16:30:55.658710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77f5ba2a-f35d-466d-92ef-8bdb175f4514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117ed2c70>]}
[0m16:30:55.695408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77f5ba2a-f35d-466d-92ef-8bdb175f4514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048bef10>]}
[0m16:30:55.695927 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:30:55.876906 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m16:30:55.944754 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:30:55.945140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '77f5ba2a-f35d-466d-92ef-8bdb175f4514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d453d0>]}
[0m16:30:56.763493 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.digital_marketing.unique_my_first_dbt_model_id.16e066b321' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' which is disabled
[0m16:30:56.763839 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' which is disabled
[0m16:30:56.764071 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' which is disabled
[0m16:30:56.764286 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' which is disabled
[0m16:30:56.829212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77f5ba2a-f35d-466d-92ef-8bdb175f4514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187ceee0>]}
[0m16:30:56.885765 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:30:56.887163 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:30:56.899229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77f5ba2a-f35d-466d-92ef-8bdb175f4514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11880be50>]}
[0m16:30:56.899617 [info ] [MainThread]: Found 496 macros
[0m16:30:56.899864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77f5ba2a-f35d-466d-92ef-8bdb175f4514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118810610>]}
[0m16:30:56.900522 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:30:56.900895 [debug] [MainThread]: Command end result
[0m16:30:56.917356 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:30:56.918485 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:30:56.920914 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m16:30:56.923701 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.2476907, "process_in_blocks": "0", "process_kernel_time": 0.407146, "process_mem_max_rss": "368181248", "process_out_blocks": "0", "process_user_time": 3.241345}
[0m16:30:56.924133 [debug] [MainThread]: Command `dbt compile` succeeded at 16:30:56.924077 after 3.25 seconds
[0m16:30:56.924439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103447f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048bef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188103a0>]}
[0m16:30:56.924736 [debug] [MainThread]: Flushing usage events
[0m16:30:57.266880 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:41.579352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b97f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105061250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105061550>]}


============================== 16:31:41.581891 | 13cb3d9d-0066-4349-a8fd-834edf2706d9 ==============================
[0m16:31:41.581891 [info ] [MainThread]: Running with dbt=1.10.10
[0m16:31:41.582280 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'invocation_command': 'dbt compile', 'use_colors': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'debug': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'indirect_selection': 'eager', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'target_path': 'None', 'static_parser': 'True', 'warn_error': 'None', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False'}
[0m16:31:43.460634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13cb3d9d-0066-4349-a8fd-834edf2706d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14240bf40>]}
[0m16:31:43.496626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13cb3d9d-0066-4349-a8fd-834edf2706d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1426212e0>]}
[0m16:31:43.497035 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:31:43.672752 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m16:31:43.760490 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:31:43.760894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '13cb3d9d-0066-4349-a8fd-834edf2706d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104494be0>]}
[0m16:31:44.658174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13cb3d9d-0066-4349-a8fd-834edf2706d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14379beb0>]}
[0m16:31:44.712617 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:31:44.714002 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:31:44.725500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13cb3d9d-0066-4349-a8fd-834edf2706d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14382f820>]}
[0m16:31:44.725879 [info ] [MainThread]: Found 2 models, 4 data tests, 496 macros
[0m16:31:44.726133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13cb3d9d-0066-4349-a8fd-834edf2706d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14383bd90>]}
[0m16:31:44.726988 [info ] [MainThread]: 
[0m16:31:44.727249 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:31:44.727470 [info ] [MainThread]: 
[0m16:31:44.727806 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:31:44.730840 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_educative'
[0m16:31:44.731258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:45.368040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13cb3d9d-0066-4349-a8fd-834edf2706d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff82b0>]}
[0m16:31:45.368756 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:45.453932 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_first_dbt_model
[0m16:31:45.454312 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_educative, now model.digital_marketing.my_first_dbt_model)
[0m16:31:45.454572 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_first_dbt_model
[0m16:31:45.460304 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_first_dbt_model"
[0m16:31:45.461164 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_first_dbt_model
[0m16:31:45.461456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:31:45.527192 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_first_dbt_model
[0m16:31:45.527685 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_second_dbt_model
[0m16:31:45.527972 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.my_first_dbt_model, now model.digital_marketing.my_second_dbt_model)
[0m16:31:45.528220 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_second_dbt_model
[0m16:31:45.530467 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_second_dbt_model"
[0m16:31:45.531739 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_second_dbt_model
[0m16:31:45.532017 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:31:45.597484 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_second_dbt_model
[0m16:31:45.597833 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:31:45.598109 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.my_second_dbt_model, now test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710)
[0m16:31:45.598354 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:31:45.606425 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:31:45.606953 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:31:45.607230 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:31:45.672485 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:31:45.672842 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:31:45.673233 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710, now test.digital_marketing.unique_my_first_dbt_model_id.16e066b321)
[0m16:31:45.673530 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:31:45.677949 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_my_first_dbt_model_id.16e066b321"
[0m16:31:45.678428 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:31:45.678695 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:31:45.745012 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:31:45.745370 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:31:45.745649 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_my_first_dbt_model_id.16e066b321, now test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778)
[0m16:31:45.745899 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:31:45.749667 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778"
[0m16:31:45.750179 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:31:45.750448 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:31:45.815889 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:31:45.816255 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:31:45.816562 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778, now test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493)
[0m16:31:45.816821 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:31:45.819844 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:31:45.820316 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:31:45.820583 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:31:45.885742 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:31:45.886283 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:45.886518 [debug] [MainThread]: Connection 'test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m16:31:45.887264 [debug] [MainThread]: Command end result
[0m16:31:45.902695 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:31:45.903592 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:31:45.908208 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m16:31:45.910651 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.3760195, "process_in_blocks": "0", "process_kernel_time": 0.396048, "process_mem_max_rss": "372604928", "process_out_blocks": "0", "process_user_time": 3.834021}
[0m16:31:45.911014 [debug] [MainThread]: Command `dbt compile` succeeded at 16:31:45.910963 after 4.38 seconds
[0m16:31:45.911269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b97f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1426212e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143831e80>]}
[0m16:31:45.911528 [debug] [MainThread]: Flushing usage events
[0m16:31:46.207527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:37:12.470436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740afa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d6520>]}


============================== 16:37:12.473316 | 86daad1c-bfc4-41c0-aa62-a4045de898c5 ==============================
[0m16:37:12.473316 [info ] [MainThread]: Running with dbt=1.10.10
[0m16:37:12.473740 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'debug': 'False', 'target_path': 'None', 'printer_width': '80', 'quiet': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'write_json': 'True', 'empty': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'static_parser': 'True', 'warn_error': 'None', 'log_format': 'default', 'fail_fast': 'False', 'introspect': 'True', 'invocation_command': 'dbt debug'}
[0m16:37:12.484667 [info ] [MainThread]: dbt version: 1.10.10
[0m16:37:12.485021 [info ] [MainThread]: python version: 3.9.6
[0m16:37:12.485253 [info ] [MainThread]: python path: /Users/azadsolanki/dev/data-engineering/airflow-env/bin/python3
[0m16:37:12.485473 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m16:37:14.279105 [info ] [MainThread]: Using profiles dir at /Users/azadsolanki/.dbt
[0m16:37:14.279461 [info ] [MainThread]: Using profiles.yml file at /Users/azadsolanki/.dbt/profiles.yml
[0m16:37:14.279698 [info ] [MainThread]: Using dbt_project.yml file at /Users/azadsolanki/dev/data-engineering/analytics-engineering/dbt_project.yml
[0m16:37:14.279929 [info ] [MainThread]: adapter type: bigquery
[0m16:37:14.280139 [info ] [MainThread]: adapter version: 1.10.1
[0m16:37:14.344686 [info ] [MainThread]: Configuration:
[0m16:37:14.345052 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:37:14.345276 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:37:14.345493 [info ] [MainThread]: Required dependencies:
[0m16:37:14.345759 [debug] [MainThread]: Executing "git --help"
[0m16:37:14.367491 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:37:14.368214 [debug] [MainThread]: STDERR: "b''"
[0m16:37:14.368509 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:37:14.368769 [info ] [MainThread]: Connection:
[0m16:37:14.369105 [info ] [MainThread]:   method: service-account
[0m16:37:14.369320 [info ] [MainThread]:   database: data-products-441119
[0m16:37:14.369532 [info ] [MainThread]:   execution_project: data-products-441119
[0m16:37:14.369743 [info ] [MainThread]:   schema: educative
[0m16:37:14.369951 [info ] [MainThread]:   location: US
[0m16:37:14.370171 [info ] [MainThread]:   priority: interactive
[0m16:37:14.370379 [info ] [MainThread]:   maximum_bytes_billed: None
[0m16:37:14.370587 [info ] [MainThread]:   impersonate_service_account: None
[0m16:37:14.370795 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m16:37:14.370999 [info ] [MainThread]:   job_retries: 1
[0m16:37:14.371209 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m16:37:14.371414 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m16:37:14.371616 [info ] [MainThread]:   timeout_seconds: 300
[0m16:37:14.371819 [info ] [MainThread]:   client_id: None
[0m16:37:14.372023 [info ] [MainThread]:   token_uri: None
[0m16:37:14.372227 [info ] [MainThread]:   compute_region: None
[0m16:37:14.372431 [info ] [MainThread]:   dataproc_cluster_name: None
[0m16:37:14.372641 [info ] [MainThread]:   gcs_bucket: None
[0m16:37:14.372843 [info ] [MainThread]:   dataproc_batch: None
[0m16:37:14.373295 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:37:14.542811 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m16:37:14.543248 [debug] [MainThread]: On debug: select 1 as id
[0m16:37:14.543505 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:37:15.368754 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:162fe13a-3466-4896-bd6c-50d926f7fd6d&page=queryresults
[0m16:37:15.899610 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:37:15.900791 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:37:15.908597 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.4857094, "process_in_blocks": "0", "process_kernel_time": 0.40265, "process_mem_max_rss": "361316352", "process_out_blocks": "0", "process_user_time": 2.322503}
[0m16:37:15.910418 [debug] [MainThread]: Command `dbt debug` succeeded at 16:37:15.910191 after 3.49 seconds
[0m16:37:15.911182 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:37:15.911984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740afa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0dd340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0dddc0>]}
[0m16:37:15.912686 [debug] [MainThread]: Flushing usage events
[0m16:37:16.265596 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:37:23.835443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105902fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dcd190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dcd460>]}


============================== 16:37:23.837785 | d435afde-6495-40e3-ab55-044fa478b7d1 ==============================
[0m16:37:23.837785 [info ] [MainThread]: Running with dbt=1.10.10
[0m16:37:23.838195 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_colors': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'target_path': 'None', 'introspect': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'log_format': 'default', 'static_parser': 'True', 'empty': 'False', 'debug': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt compile', 'profiles_dir': '/Users/azadsolanki/.dbt', 'no_print': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:37:25.459000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd435afde-6495-40e3-ab55-044fa478b7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d57d90>]}
[0m16:37:25.494938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd435afde-6495-40e3-ab55-044fa478b7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e01c70>]}
[0m16:37:25.495337 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:37:25.674188 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m16:37:25.766891 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:37:25.767322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd435afde-6495-40e3-ab55-044fa478b7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621ff40>]}
[0m16:37:26.661712 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics-engineering.offline_marketing
[0m16:37:26.665487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd435afde-6495-40e3-ab55-044fa478b7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a6cfeb0>]}
[0m16:37:26.719976 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:37:26.721233 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:37:26.732317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd435afde-6495-40e3-ab55-044fa478b7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a77e280>]}
[0m16:37:26.732742 [info ] [MainThread]: Found 2 models, 4 data tests, 496 macros
[0m16:37:26.733010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd435afde-6495-40e3-ab55-044fa478b7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a77e400>]}
[0m16:37:26.733909 [info ] [MainThread]: 
[0m16:37:26.734163 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:37:26.734383 [info ] [MainThread]: 
[0m16:37:26.734713 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:37:26.737698 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_educative'
[0m16:37:26.737935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:27.388597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd435afde-6495-40e3-ab55-044fa478b7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10629cc10>]}
[0m16:37:27.389548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:37:27.460497 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_first_dbt_model
[0m16:37:27.460910 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_educative, now model.digital_marketing.my_first_dbt_model)
[0m16:37:27.461196 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_first_dbt_model
[0m16:37:27.467530 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_first_dbt_model"
[0m16:37:27.468311 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_first_dbt_model
[0m16:37:27.468622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:37:27.540519 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_first_dbt_model
[0m16:37:27.541069 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_second_dbt_model
[0m16:37:27.541411 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.my_first_dbt_model, now model.digital_marketing.my_second_dbt_model)
[0m16:37:27.541748 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_second_dbt_model
[0m16:37:27.544185 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_second_dbt_model"
[0m16:37:27.544986 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_second_dbt_model
[0m16:37:27.545325 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:37:27.613712 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_second_dbt_model
[0m16:37:27.614126 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:37:27.614519 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.my_second_dbt_model, now test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710)
[0m16:37:27.614847 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:37:27.623629 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:37:27.624486 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:37:27.625054 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:37:27.695833 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:37:27.696251 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:37:27.696863 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710, now test.digital_marketing.unique_my_first_dbt_model_id.16e066b321)
[0m16:37:27.697230 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:37:27.702364 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_my_first_dbt_model_id.16e066b321"
[0m16:37:27.702959 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:37:27.703239 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:37:27.769308 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:37:27.769717 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:37:27.769996 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_my_first_dbt_model_id.16e066b321, now test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778)
[0m16:37:27.770249 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:37:27.774407 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778"
[0m16:37:27.774953 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:37:27.775248 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:37:27.847118 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:37:27.847557 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:37:27.847991 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778, now test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493)
[0m16:37:27.848298 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:37:27.852449 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:37:27.853090 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:37:27.853390 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:37:27.920780 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:37:27.921429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:27.921695 [debug] [MainThread]: Connection 'test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m16:37:27.922454 [debug] [MainThread]: Command end result
[0m16:37:27.939451 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:37:27.940526 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:37:27.945760 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m16:37:27.948953 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.1574216, "process_in_blocks": "0", "process_kernel_time": 0.322084, "process_mem_max_rss": "370851840", "process_out_blocks": "0", "process_user_time": 3.877938}
[0m16:37:27.949513 [debug] [MainThread]: Command `dbt compile` succeeded at 16:37:27.949395 after 4.16 seconds
[0m16:37:27.949818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105902fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e01c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10544c610>]}
[0m16:37:27.950113 [debug] [MainThread]: Flushing usage events
[0m16:37:28.260029 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:41:51.598480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c0fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d91c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d9490>]}


============================== 16:41:51.601375 | 0a376c32-ed47-4893-9d3b-519236e44edf ==============================
[0m16:41:51.601375 [info ] [MainThread]: Running with dbt=1.10.10
[0m16:41:51.601781 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'version_check': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'write_json': 'True', 'debug': 'False', 'introspect': 'True', 'printer_width': '80', 'empty': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt compile', 'no_print': 'None', 'warn_error': 'None', 'partial_parse': 'True'}
[0m16:41:53.511416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a376c32-ed47-4893-9d3b-519236e44edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cb9f70>]}
[0m16:41:53.547567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a376c32-ed47-4893-9d3b-519236e44edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10459fee0>]}
[0m16:41:53.548015 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:41:53.727249 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m16:41:53.794428 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:41:53.794805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0a376c32-ed47-4893-9d3b-519236e44edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104512dc0>]}
[0m16:41:54.679316 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.analytics-engineering.online_marketing
- models.analytics-engineering.offline_marketing
[0m16:41:54.682992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a376c32-ed47-4893-9d3b-519236e44edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139557130>]}
[0m16:41:54.736529 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:41:54.737737 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:41:54.749499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a376c32-ed47-4893-9d3b-519236e44edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1395bfcd0>]}
[0m16:41:54.749864 [info ] [MainThread]: Found 4 models, 4 data tests, 496 macros
[0m16:41:54.750114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a376c32-ed47-4893-9d3b-519236e44edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10373dd90>]}
[0m16:41:54.751035 [info ] [MainThread]: 
[0m16:41:54.751288 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:41:54.751509 [info ] [MainThread]: 
[0m16:41:54.751849 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:41:54.754825 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_educative'
[0m16:41:54.755092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:55.350401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a376c32-ed47-4893-9d3b-519236e44edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10504c850>]}
[0m16:41:55.351193 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:41:55.452484 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_first_dbt_model
[0m16:41:55.452887 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_educative, now model.digital_marketing.my_first_dbt_model)
[0m16:41:55.453161 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_first_dbt_model
[0m16:41:55.458920 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_first_dbt_model"
[0m16:41:55.459755 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_first_dbt_model
[0m16:41:55.460055 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:41:55.525304 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_first_dbt_model
[0m16:41:55.525580 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m16:41:55.525844 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.my_first_dbt_model, now model.digital_marketing.sea)
[0m16:41:55.526087 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m16:41:55.528161 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m16:41:55.529451 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m16:41:55.529721 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:41:55.594698 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m16:41:55.594985 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m16:41:55.595242 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m16:41:55.595485 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m16:41:55.597561 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m16:41:55.597999 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m16:41:55.598253 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:41:55.663465 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m16:41:55.663761 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_second_dbt_model
[0m16:41:55.664028 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.my_second_dbt_model)
[0m16:41:55.664276 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_second_dbt_model
[0m16:41:55.667063 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_second_dbt_model"
[0m16:41:55.667733 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_second_dbt_model
[0m16:41:55.668002 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:41:55.733669 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_second_dbt_model
[0m16:41:55.734015 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:41:55.734293 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.my_second_dbt_model, now test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710)
[0m16:41:55.734545 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:41:55.742391 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:41:55.742978 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:41:55.743263 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:41:55.808424 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:41:55.808757 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:41:55.809031 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710, now test.digital_marketing.unique_my_first_dbt_model_id.16e066b321)
[0m16:41:55.809284 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:41:55.813760 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_my_first_dbt_model_id.16e066b321"
[0m16:41:55.814251 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:41:55.814513 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:41:55.879429 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:41:55.879695 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:41:55.880030 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_my_first_dbt_model_id.16e066b321, now test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778)
[0m16:41:55.880279 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:41:55.883187 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778"
[0m16:41:55.883603 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:41:55.883856 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:41:55.948803 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:41:55.949080 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:41:55.949341 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778, now test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493)
[0m16:41:55.949582 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:41:55.952578 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:41:55.953015 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:41:55.953270 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:41:56.018385 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:41:56.018901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:56.019118 [debug] [MainThread]: Connection 'test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m16:41:56.019986 [debug] [MainThread]: Command end result
[0m16:41:56.036143 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:41:56.037146 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:41:56.041974 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m16:41:56.044786 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.4944367, "process_in_blocks": "0", "process_kernel_time": 0.41397, "process_mem_max_rss": "371015680", "process_out_blocks": "0", "process_user_time": 3.981311}
[0m16:41:56.045168 [debug] [MainThread]: Command `dbt compile` succeeded at 16:41:56.045116 after 4.49 seconds
[0m16:41:56.045427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c0fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1395f7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b12ac0>]}
[0m16:41:56.045690 [debug] [MainThread]: Flushing usage events
[0m16:41:56.396877 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:42:28.413596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eeef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083bb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083bb460>]}


============================== 16:42:28.416433 | 83a423ac-897d-484e-ac0b-4b342b746d71 ==============================
[0m16:42:28.416433 [info ] [MainThread]: Running with dbt=1.10.10
[0m16:42:28.416842 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'invocation_command': 'dbt clean', 'write_json': 'True', 'log_format': 'default', 'static_parser': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'printer_width': '80', 'profiles_dir': '/Users/azadsolanki/.dbt', 'quiet': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'empty': 'None', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'cache_selected_only': 'False', 'version_check': 'True', 'debug': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:42:28.495863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83a423ac-897d-484e-ac0b-4b342b746d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108316460>]}
[0m16:42:28.511436 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.14464483, "process_in_blocks": "0", "process_kernel_time": 0.114122, "process_mem_max_rss": "100384768", "process_out_blocks": "0", "process_user_time": 0.908103}
[0m16:42:28.512026 [debug] [MainThread]: Command `dbt clean` succeeded at 16:42:28.511963 after 0.15 seconds
[0m16:42:28.512306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eeef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108572dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b0160>]}
[0m16:42:28.512581 [debug] [MainThread]: Flushing usage events
[0m16:42:28.863632 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:43:07.274350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107946f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e13220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e134f0>]}


============================== 16:43:07.278291 | 2f429821-f84f-47c7-9c79-9a0d5e6c6603 ==============================
[0m16:43:07.278291 [info ] [MainThread]: Running with dbt=1.10.10
[0m16:43:07.278691 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'version_check': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt clean', 'debug': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'empty': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'target_path': 'None', 'profiles_dir': '/Users/azadsolanki/.dbt', 'no_print': 'None', 'indirect_selection': 'eager'}
[0m16:43:07.355114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f429821-f84f-47c7-9c79-9a0d5e6c6603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d84d90>]}
[0m16:43:07.366462 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.13830708, "process_in_blocks": "0", "process_kernel_time": 0.113999, "process_mem_max_rss": "100024320", "process_out_blocks": "0", "process_user_time": 0.894425}
[0m16:43:07.366864 [debug] [MainThread]: Command `dbt clean` succeeded at 16:43:07.366807 after 0.14 seconds
[0m16:43:07.367127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107946f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d84d90>]}
[0m16:43:07.367385 [debug] [MainThread]: Flushing usage events
[0m16:43:07.697371 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:43:12.558770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e3ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dda250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dda520>]}


============================== 16:43:12.562069 | 616122de-75e4-4511-84e2-853b10384134 ==============================
[0m16:43:12.562069 [info ] [MainThread]: Running with dbt=1.10.10
[0m16:43:12.562443 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error': 'None', 'quiet': 'False', 'version_check': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'printer_width': '80', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'debug': 'False', 'use_colors': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'write_json': 'True', 'invocation_command': 'dbt compile', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'static_parser': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'target_path': 'None'}
[0m16:43:14.473367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '616122de-75e4-4511-84e2-853b10384134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136fd2640>]}
[0m16:43:14.509030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '616122de-75e4-4511-84e2-853b10384134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136f842b0>]}
[0m16:43:14.509444 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:43:14.683999 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m16:43:14.684560 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:43:14.684836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '616122de-75e4-4511-84e2-853b10384134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1378f90d0>]}
[0m16:43:15.609704 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.analytics-engineering.offline_marketing
- models.analytics-engineering.online_marketing.social_media
[0m16:43:15.613456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '616122de-75e4-4511-84e2-853b10384134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14016f130>]}
[0m16:43:15.671076 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:43:15.672400 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:43:15.686240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '616122de-75e4-4511-84e2-853b10384134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14016f940>]}
[0m16:43:15.686644 [info ] [MainThread]: Found 4 models, 4 data tests, 496 macros
[0m16:43:15.686902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616122de-75e4-4511-84e2-853b10384134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140171730>]}
[0m16:43:15.688084 [info ] [MainThread]: 
[0m16:43:15.688415 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:43:15.688653 [info ] [MainThread]: 
[0m16:43:15.689010 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:43:15.692205 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_educative'
[0m16:43:15.692839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:16.299086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616122de-75e4-4511-84e2-853b10384134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1401f0ac0>]}
[0m16:43:16.299683 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:43:16.376562 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_first_dbt_model
[0m16:43:16.376964 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_educative, now model.digital_marketing.my_first_dbt_model)
[0m16:43:16.377223 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_first_dbt_model
[0m16:43:16.382671 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_first_dbt_model"
[0m16:43:16.383343 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_first_dbt_model
[0m16:43:16.383613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:43:16.450021 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_first_dbt_model
[0m16:43:16.450366 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m16:43:16.450642 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.my_first_dbt_model, now model.digital_marketing.sea)
[0m16:43:16.450889 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m16:43:16.453091 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m16:43:16.453850 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m16:43:16.454258 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:43:16.521094 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m16:43:16.521589 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m16:43:16.521993 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m16:43:16.522290 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m16:43:16.524768 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m16:43:16.525351 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m16:43:16.525625 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:43:16.592867 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m16:43:16.593245 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_second_dbt_model
[0m16:43:16.593536 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.my_second_dbt_model)
[0m16:43:16.593795 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_second_dbt_model
[0m16:43:16.596141 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_second_dbt_model"
[0m16:43:16.596691 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_second_dbt_model
[0m16:43:16.596970 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:43:16.662496 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_second_dbt_model
[0m16:43:16.662846 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:43:16.663125 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.my_second_dbt_model, now test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710)
[0m16:43:16.663375 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:43:16.671384 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:43:16.671956 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:43:16.672232 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:43:16.737402 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:43:16.737667 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:43:16.737923 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710, now test.digital_marketing.unique_my_first_dbt_model_id.16e066b321)
[0m16:43:16.738166 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:43:16.743092 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_my_first_dbt_model_id.16e066b321"
[0m16:43:16.743617 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:43:16.743885 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:43:16.809152 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m16:43:16.809420 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:43:16.809681 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_my_first_dbt_model_id.16e066b321, now test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778)
[0m16:43:16.809928 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:43:16.812900 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778"
[0m16:43:16.813365 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:43:16.813621 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:43:16.878626 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m16:43:16.878894 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:43:16.879149 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778, now test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493)
[0m16:43:16.879389 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:43:16.882281 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:43:16.882681 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:43:16.882931 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:43:16.948143 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m16:43:16.948773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:16.949022 [debug] [MainThread]: Connection 'test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m16:43:16.949903 [debug] [MainThread]: Command end result
[0m16:43:16.966797 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:43:16.967716 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:43:16.972248 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m16:43:16.974705 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.4602175, "process_in_blocks": "0", "process_kernel_time": 0.390908, "process_mem_max_rss": "373407744", "process_out_blocks": "0", "process_user_time": 3.946421}
[0m16:43:16.975062 [debug] [MainThread]: Command `dbt compile` succeeded at 16:43:16.975012 after 4.46 seconds
[0m16:43:16.975316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e3ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140013700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136f842b0>]}
[0m16:43:16.975570 [debug] [MainThread]: Flushing usage events
[0m16:43:17.294589 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:17:46.627132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e53ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11055b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11055b490>]}


============================== 17:17:46.631002 | d0ac5df1-d4bf-4f7a-95e6-3a479ab8ade7 ==============================
[0m17:17:46.631002 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:17:46.631406 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'fail_fast': 'False', 'introspect': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'log_cache_events': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error': 'None'}
[0m17:17:48.498061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0ac5df1-d4bf-4f7a-95e6-3a479ab8ade7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102581e20>]}
[0m17:17:48.535403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0ac5df1-d4bf-4f7a-95e6-3a479ab8ade7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de3f40>]}
[0m17:17:48.535905 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:17:48.717762 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m17:17:48.826825 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m17:17:48.827215 [debug] [MainThread]: Partial parsing: added file: digital_marketing://models/offline_marketing/television.sql
[0m17:17:48.827451 [debug] [MainThread]: Partial parsing: deleted file: digital_marketing://models/television.sql
[0m17:17:49.115363 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.analytics-engineering.online_marketing.social_media
- models.analytics-engineering.offline_marketing
[0m17:17:49.119148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0ac5df1-d4bf-4f7a-95e6-3a479ab8ade7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143fdceb0>]}
[0m17:17:49.174860 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:17:49.176545 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:17:49.188961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0ac5df1-d4bf-4f7a-95e6-3a479ab8ade7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14401df10>]}
[0m17:17:49.189321 [info ] [MainThread]: Found 4 models, 4 data tests, 496 macros
[0m17:17:49.189568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0ac5df1-d4bf-4f7a-95e6-3a479ab8ade7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143db47c0>]}
[0m17:17:49.190469 [info ] [MainThread]: 
[0m17:17:49.190725 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:17:49.190947 [info ] [MainThread]: 
[0m17:17:49.191286 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:17:49.194137 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m17:17:49.194402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:49.787772 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now list_data-products-441119_educative)
[0m17:17:49.788763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:50.478164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0ac5df1-d4bf-4f7a-95e6-3a479ab8ade7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103cc850>]}
[0m17:17:50.479053 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:50.569031 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_first_dbt_model
[0m17:17:50.569469 [info ] [Thread-1  ]: 1 of 4 START sql table model educative.my_first_dbt_model ...................... [RUN]
[0m17:17:50.569809 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_educative, now model.digital_marketing.my_first_dbt_model)
[0m17:17:50.570069 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_first_dbt_model
[0m17:17:50.575924 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_first_dbt_model"
[0m17:17:50.576740 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_first_dbt_model
[0m17:17:50.586721 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:17:51.188257 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.my_first_dbt_model"
[0m17:17:51.189760 [debug] [Thread-1  ]: On model.digital_marketing.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.my_first_dbt_model"} */

  
    

    create or replace table `data-products-441119`.`educative`.`my_first_dbt_model`
      
    
    

    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m17:17:51.743323 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:91107cc9-1700-4b87-9bc4-acbfc9235f57&page=queryresults
[0m17:17:53.792042 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ac5df1-d4bf-4f7a-95e6-3a479ab8ade7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135463940>]}
[0m17:17:53.792979 [info ] [Thread-1  ]: 1 of 4 OK created sql table model educative.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.22s]
[0m17:17:53.793690 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_first_dbt_model
[0m17:17:53.794207 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m17:17:53.794860 [info ] [Thread-1  ]: 2 of 4 START sql view model educative.sea ...................................... [RUN]
[0m17:17:53.795570 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.my_first_dbt_model, now model.digital_marketing.sea)
[0m17:17:53.796030 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m17:17:53.800361 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m17:17:53.801588 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m17:17:53.821161 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.sea"
[0m17:17:53.822014 [debug] [Thread-1  ]: On model.digital_marketing.sea: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.sea"} */


  create or replace view `data-products-441119`.`educative`.`sea`
  OPTIONS()
  as 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data;


[0m17:17:53.822412 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:17:54.534654 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:39abe800-38c7-4907-a9f5-6ab2d6508ee1&page=queryresults
[0m17:17:54.963350 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ac5df1-d4bf-4f7a-95e6-3a479ab8ade7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135463940>]}
[0m17:17:54.964822 [info ] [Thread-1  ]: 2 of 4 OK created sql view model educative.sea ................................. [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m17:17:54.966003 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m17:17:54.966888 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m17:17:54.967979 [info ] [Thread-1  ]: 3 of 4 START sql view model educative.social_media ............................. [RUN]
[0m17:17:54.968873 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m17:17:54.969627 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m17:17:54.975416 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m17:17:54.976644 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m17:17:54.981839 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.social_media"
[0m17:17:54.982801 [debug] [Thread-1  ]: On model.digital_marketing.social_media: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.social_media"} */


  create or replace view `data-products-441119`.`educative`.`social_media`
  OPTIONS()
  as 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data;


[0m17:17:54.983407 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:17:55.800384 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:e6ae4aa1-d302-487b-8afb-b2c16403cf36&page=queryresults
[0m17:17:56.189494 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ac5df1-d4bf-4f7a-95e6-3a479ab8ade7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135463940>]}
[0m17:17:56.190974 [info ] [Thread-1  ]: 3 of 4 OK created sql view model educative.social_media ........................ [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m17:17:56.192126 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m17:17:56.192945 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_second_dbt_model
[0m17:17:56.194013 [info ] [Thread-1  ]: 4 of 4 START sql view model educative.my_second_dbt_model ...................... [RUN]
[0m17:17:56.195025 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.my_second_dbt_model)
[0m17:17:56.195828 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_second_dbt_model
[0m17:17:56.202484 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_second_dbt_model"
[0m17:17:56.204535 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_second_dbt_model
[0m17:17:56.211326 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.my_second_dbt_model"
[0m17:17:56.212441 [debug] [Thread-1  ]: On model.digital_marketing.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.my_second_dbt_model"} */


  create or replace view `data-products-441119`.`educative`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `data-products-441119`.`educative`.`my_first_dbt_model`
where id = 1;


[0m17:17:56.213046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:17:57.029253 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:2cf0a376-13b4-4d2f-976c-39563e0e753e&page=queryresults
[0m17:17:57.420286 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ac5df1-d4bf-4f7a-95e6-3a479ab8ade7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135463940>]}
[0m17:17:57.421638 [info ] [Thread-1  ]: 4 of 4 OK created sql view model educative.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m17:17:57.422760 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_second_dbt_model
[0m17:17:57.424242 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:57.518221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:57.518586 [debug] [MainThread]: Connection 'model.digital_marketing.my_second_dbt_model' was properly closed.
[0m17:17:57.518881 [info ] [MainThread]: 
[0m17:17:57.519136 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 8.33 seconds (8.33s).
[0m17:17:57.519809 [debug] [MainThread]: Command end result
[0m17:17:57.536585 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:17:57.537745 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:17:57.541961 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m17:17:57.542206 [info ] [MainThread]: 
[0m17:17:57.542474 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:17:57.542705 [info ] [MainThread]: 
[0m17:17:57.542950 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:17:57.545789 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.965836, "process_in_blocks": "0", "process_kernel_time": 0.462947, "process_mem_max_rss": "376258560", "process_out_blocks": "0", "process_user_time": 3.778178}
[0m17:17:57.546247 [debug] [MainThread]: Command `dbt run` succeeded at 17:17:57.546190 after 10.97 seconds
[0m17:17:57.546521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e53ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143ffe100>]}
[0m17:17:57.546790 [debug] [MainThread]: Flushing usage events
[0m17:17:57.884123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:23:09.248854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eeaf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db6460>]}


============================== 17:23:09.253040 | 83a88ac3-2de8-4d34-82d9-ecea28010511 ==============================
[0m17:23:09.253040 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:23:09.253439 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'log_format': 'default', 'quiet': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt compile', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'empty': 'False', 'no_print': 'None', 'use_colors': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m17:23:11.187274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83a88ac3-2de8-4d34-82d9-ecea28010511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f413850>]}
[0m17:23:11.224325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83a88ac3-2de8-4d34-82d9-ecea28010511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db6ee0>]}
[0m17:23:11.224824 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:23:11.405009 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m17:23:11.473983 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:23:11.474386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '83a88ac3-2de8-4d34-82d9-ecea28010511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10511b700>]}
[0m17:23:12.365199 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.analytics-engineering.offline_marketing
- models.analytics-engineering.online_marketing.social_media
- models.analytics-engineering
[0m17:23:12.368961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83a88ac3-2de8-4d34-82d9-ecea28010511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140e97130>]}
[0m17:23:12.425197 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:23:12.426637 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:23:12.438447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83a88ac3-2de8-4d34-82d9-ecea28010511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140ed04f0>]}
[0m17:23:12.438836 [info ] [MainThread]: Found 4 models, 4 data tests, 496 macros
[0m17:23:12.439094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83a88ac3-2de8-4d34-82d9-ecea28010511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140e51220>]}
[0m17:23:12.440034 [info ] [MainThread]: 
[0m17:23:12.440286 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:12.440511 [info ] [MainThread]: 
[0m17:23:12.440852 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:23:12.443730 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_educative'
[0m17:23:12.443979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:12.994001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83a88ac3-2de8-4d34-82d9-ecea28010511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d4bb80>]}
[0m17:23:12.995026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:23:13.097288 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_first_dbt_model
[0m17:23:13.097672 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_educative, now model.digital_marketing.my_first_dbt_model)
[0m17:23:13.097941 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_first_dbt_model
[0m17:23:13.103693 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_first_dbt_model"
[0m17:23:13.104441 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_first_dbt_model
[0m17:23:13.104717 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:23:13.170557 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_first_dbt_model
[0m17:23:13.170907 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m17:23:13.171188 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.my_first_dbt_model, now model.digital_marketing.sea)
[0m17:23:13.171439 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m17:23:13.173762 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m17:23:13.174270 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m17:23:13.174534 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:23:13.240303 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m17:23:13.240634 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m17:23:13.240903 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m17:23:13.241150 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m17:23:13.243354 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m17:23:13.243831 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m17:23:13.244102 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:23:13.309768 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m17:23:13.310110 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_second_dbt_model
[0m17:23:13.310391 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.my_second_dbt_model)
[0m17:23:13.310647 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_second_dbt_model
[0m17:23:13.313548 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_second_dbt_model"
[0m17:23:13.314773 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_second_dbt_model
[0m17:23:13.315061 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:23:13.380728 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_second_dbt_model
[0m17:23:13.381085 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:23:13.381485 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.my_second_dbt_model, now test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710)
[0m17:23:13.381764 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:23:13.389591 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:23:13.390909 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:23:13.391185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:23:13.456572 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:23:13.456893 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m17:23:13.457234 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710, now test.digital_marketing.unique_my_first_dbt_model_id.16e066b321)
[0m17:23:13.457562 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m17:23:13.462002 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_my_first_dbt_model_id.16e066b321"
[0m17:23:13.462504 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m17:23:13.462783 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:23:13.528274 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m17:23:13.528590 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m17:23:13.528862 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_my_first_dbt_model_id.16e066b321, now test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778)
[0m17:23:13.529113 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m17:23:13.532380 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778"
[0m17:23:13.533605 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m17:23:13.533892 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:23:13.599546 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m17:23:13.599877 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m17:23:13.600163 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778, now test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493)
[0m17:23:13.600419 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m17:23:13.603414 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:23:13.604682 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m17:23:13.604961 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:23:13.670969 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m17:23:13.671673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:13.671938 [debug] [MainThread]: Connection 'test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m17:23:13.672851 [debug] [MainThread]: Command end result
[0m17:23:13.689423 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:23:13.690453 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:23:13.695195 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m17:23:13.697886 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.4977775, "process_in_blocks": "0", "process_kernel_time": 0.419199, "process_mem_max_rss": "373555200", "process_out_blocks": "0", "process_user_time": 4.015568}
[0m17:23:13.698324 [debug] [MainThread]: Command `dbt compile` succeeded at 17:23:13.698266 after 4.50 seconds
[0m17:23:13.698602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eeaf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104032730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f413850>]}
[0m17:23:13.698871 [debug] [MainThread]: Flushing usage events
[0m17:23:14.032506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:23:57.282444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032aaf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105276190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105276460>]}


============================== 17:23:57.286054 | 21672b00-bcb4-4de8-b20a-f2b65f74b83f ==============================
[0m17:23:57.286054 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:23:57.286451 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_colors': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'quiet': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'introspect': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'fail_fast': 'False', 'empty': 'False', 'log_format': 'default', 'debug': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt compile', 'printer_width': '80', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None'}
[0m17:23:59.129088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21672b00-bcb4-4de8-b20a-f2b65f74b83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f503310>]}
[0m17:23:59.165422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21672b00-bcb4-4de8-b20a-f2b65f74b83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f51d250>]}
[0m17:23:59.165839 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:23:59.343554 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m17:23:59.411611 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:23:59.412010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '21672b00-bcb4-4de8-b20a-f2b65f74b83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cdb700>]}
[0m17:24:00.291413 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.analytics-engineering.offline_marketing
- models.analytics-engineering.online_marketing.social_media
- models.analytics-engineering
[0m17:24:00.295215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21672b00-bcb4-4de8-b20a-f2b65f74b83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131a19130>]}
[0m17:24:00.350158 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:24:00.351513 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:24:00.363673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21672b00-bcb4-4de8-b20a-f2b65f74b83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131a7fd00>]}
[0m17:24:00.364066 [info ] [MainThread]: Found 4 models, 4 data tests, 496 macros
[0m17:24:00.364319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21672b00-bcb4-4de8-b20a-f2b65f74b83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cfe520>]}
[0m17:24:00.365254 [info ] [MainThread]: 
[0m17:24:00.365516 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:00.365737 [info ] [MainThread]: 
[0m17:24:00.366076 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:24:00.369018 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_educative'
[0m17:24:00.369322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:00.905331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21672b00-bcb4-4de8-b20a-f2b65f74b83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021f1b20>]}
[0m17:24:00.906398 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:24:01.005547 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_first_dbt_model
[0m17:24:01.005926 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_educative, now model.digital_marketing.my_first_dbt_model)
[0m17:24:01.006192 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_first_dbt_model
[0m17:24:01.012020 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_first_dbt_model"
[0m17:24:01.012505 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_first_dbt_model
[0m17:24:01.012786 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:24:01.078611 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_first_dbt_model
[0m17:24:01.078957 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m17:24:01.079240 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.my_first_dbt_model, now model.digital_marketing.sea)
[0m17:24:01.079490 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m17:24:01.081659 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m17:24:01.082204 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m17:24:01.082484 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:24:01.148046 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m17:24:01.148395 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m17:24:01.148670 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m17:24:01.148924 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m17:24:01.151124 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m17:24:01.151606 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m17:24:01.151876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:24:01.217573 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m17:24:01.217917 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_second_dbt_model
[0m17:24:01.218187 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.my_second_dbt_model)
[0m17:24:01.218447 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_second_dbt_model
[0m17:24:01.221355 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_second_dbt_model"
[0m17:24:01.221863 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_second_dbt_model
[0m17:24:01.222125 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:24:01.288039 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_second_dbt_model
[0m17:24:01.288390 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:24:01.288667 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.my_second_dbt_model, now test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710)
[0m17:24:01.288918 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:24:01.296878 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:24:01.297382 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:24:01.297651 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:24:01.362940 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:24:01.363237 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m17:24:01.363507 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710, now test.digital_marketing.unique_my_first_dbt_model_id.16e066b321)
[0m17:24:01.363758 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m17:24:01.368157 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_my_first_dbt_model_id.16e066b321"
[0m17:24:01.368646 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m17:24:01.368912 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:24:01.434093 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m17:24:01.434379 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m17:24:01.434646 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_my_first_dbt_model_id.16e066b321, now test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778)
[0m17:24:01.435007 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m17:24:01.438067 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778"
[0m17:24:01.438500 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m17:24:01.438756 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:24:01.503736 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m17:24:01.504016 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m17:24:01.504280 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778, now test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493)
[0m17:24:01.504533 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m17:24:01.507438 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:24:01.507871 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m17:24:01.508135 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:24:01.574856 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m17:24:01.575530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:01.575804 [debug] [MainThread]: Connection 'test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m17:24:01.576734 [debug] [MainThread]: Command end result
[0m17:24:01.593341 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:24:01.594327 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:24:01.599029 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m17:24:01.601495 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.3654313, "process_in_blocks": "0", "process_kernel_time": 0.390546, "process_mem_max_rss": "374128640", "process_out_blocks": "0", "process_user_time": 4.007222}
[0m17:24:01.601857 [debug] [MainThread]: Command `dbt compile` succeeded at 17:24:01.601805 after 4.37 seconds
[0m17:24:01.602119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032aaf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f51d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131ab6220>]}
[0m17:24:01.602378 [debug] [MainThread]: Flushing usage events
[0m17:24:01.956813 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:38.966764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d6af40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107435280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107435550>]}


============================== 17:24:38.969073 | 92e7de93-5b06-4100-98c9-156b0ca29a5a ==============================
[0m17:24:38.969073 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:24:38.969472 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'quiet': 'False', 'version_check': 'True', 'partial_parse': 'True', 'empty': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'static_parser': 'True', 'introspect': 'True', 'write_json': 'True', 'target_path': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'debug': 'False', 'invocation_command': 'dbt compile', 'no_print': 'None'}
[0m17:24:40.533072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92e7de93-5b06-4100-98c9-156b0ca29a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133117370>]}
[0m17:24:40.570048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92e7de93-5b06-4100-98c9-156b0ca29a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074056d0>]}
[0m17:24:40.570551 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:24:40.747119 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m17:24:40.814587 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:24:40.814967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '92e7de93-5b06-4100-98c9-156b0ca29a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067693d0>]}
[0m17:24:41.703923 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics-engineering.online_marketing.social_media
[0m17:24:41.707713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92e7de93-5b06-4100-98c9-156b0ca29a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133b97130>]}
[0m17:24:41.764164 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:24:41.765477 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:24:41.776316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92e7de93-5b06-4100-98c9-156b0ca29a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133c378b0>]}
[0m17:24:41.776727 [info ] [MainThread]: Found 4 models, 4 data tests, 496 macros
[0m17:24:41.776981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92e7de93-5b06-4100-98c9-156b0ca29a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad0e20>]}
[0m17:24:41.777931 [info ] [MainThread]: 
[0m17:24:41.778192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:41.778413 [info ] [MainThread]: 
[0m17:24:41.778748 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:24:41.781631 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_educative'
[0m17:24:41.781900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:42.237718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92e7de93-5b06-4100-98c9-156b0ca29a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cbeaf0>]}
[0m17:24:42.238760 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:24:42.339420 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_first_dbt_model
[0m17:24:42.339750 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_educative, now model.digital_marketing.my_first_dbt_model)
[0m17:24:42.340014 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_first_dbt_model
[0m17:24:42.345757 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_first_dbt_model"
[0m17:24:42.346215 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_first_dbt_model
[0m17:24:42.346481 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:24:42.411801 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_first_dbt_model
[0m17:24:42.412106 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m17:24:42.412373 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.my_first_dbt_model, now model.digital_marketing.sea)
[0m17:24:42.412619 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m17:24:42.414711 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m17:24:42.415212 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m17:24:42.415480 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:24:42.480651 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m17:24:42.480945 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m17:24:42.481209 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m17:24:42.481454 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m17:24:42.483607 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m17:24:42.484042 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m17:24:42.484299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:24:42.549520 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m17:24:42.549831 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_second_dbt_model
[0m17:24:42.550161 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.my_second_dbt_model)
[0m17:24:42.550443 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_second_dbt_model
[0m17:24:42.553255 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_second_dbt_model"
[0m17:24:42.553737 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_second_dbt_model
[0m17:24:42.554014 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:24:42.619975 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_second_dbt_model
[0m17:24:42.620323 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:24:42.620601 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.my_second_dbt_model, now test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710)
[0m17:24:42.620850 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:24:42.628862 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:24:42.630214 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:24:42.630505 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:24:42.696053 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:24:42.696376 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m17:24:42.696643 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_my_first_dbt_model_id.5fb22c2710, now test.digital_marketing.unique_my_first_dbt_model_id.16e066b321)
[0m17:24:42.696900 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m17:24:42.701540 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_my_first_dbt_model_id.16e066b321"
[0m17:24:42.702081 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m17:24:42.702365 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:24:42.770024 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_my_first_dbt_model_id.16e066b321
[0m17:24:42.770375 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m17:24:42.770747 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_my_first_dbt_model_id.16e066b321, now test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778)
[0m17:24:42.771007 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m17:24:42.774162 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778"
[0m17:24:42.774652 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m17:24:42.774912 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:24:42.840507 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778
[0m17:24:42.840818 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m17:24:42.841085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_my_second_dbt_model_id.151b76d778, now test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493)
[0m17:24:42.841331 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m17:24:42.844563 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:24:42.845194 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m17:24:42.845484 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:24:42.911298 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493
[0m17:24:42.911931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:42.912163 [debug] [MainThread]: Connection 'test.digital_marketing.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m17:24:42.913046 [debug] [MainThread]: Command end result
[0m17:24:42.929630 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:24:42.930608 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:24:42.935171 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m17:24:42.937654 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.0140157, "process_in_blocks": "0", "process_kernel_time": 0.305347, "process_mem_max_rss": "374177792", "process_out_blocks": "0", "process_user_time": 3.981451}
[0m17:24:42.938016 [debug] [MainThread]: Command `dbt compile` succeeded at 17:24:42.937966 after 4.01 seconds
[0m17:24:42.938278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d6af40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133bafac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10601c7f0>]}
[0m17:24:42.938535 [debug] [MainThread]: Flushing usage events
[0m17:24:43.247703 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:25:09.294387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b9ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107376280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107376550>]}


============================== 17:25:09.296768 | 4c7edb61-3916-4ae1-9cf1-ca6232655747 ==============================
[0m17:25:09.296768 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:25:09.297156 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'cache_selected_only': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'introspect': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'debug': 'False', 'quiet': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'empty': 'False'}
[0m17:25:10.678815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c7edb61-3916-4ae1-9cf1-ca6232655747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ae4f0>]}
[0m17:25:10.714654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c7edb61-3916-4ae1-9cf1-ca6232655747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730bca0>]}
[0m17:25:10.715109 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:25:10.892805 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m17:25:10.999003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:25:10.999315 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:25:11.088796 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics-engineering.online_marketing.social_media
[0m17:25:11.115272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c7edb61-3916-4ae1-9cf1-ca6232655747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c01940>]}
[0m17:25:11.170646 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:25:11.171943 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:25:11.185566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c7edb61-3916-4ae1-9cf1-ca6232655747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1422068b0>]}
[0m17:25:11.185960 [info ] [MainThread]: Found 4 models, 4 data tests, 496 macros
[0m17:25:11.186214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c7edb61-3916-4ae1-9cf1-ca6232655747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142418a60>]}
[0m17:25:11.187152 [info ] [MainThread]: 
[0m17:25:11.187411 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:11.187634 [info ] [MainThread]: 
[0m17:25:11.187964 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:25:11.191002 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m17:25:11.191313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:11.683244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now list_data-products-441119_educative)
[0m17:25:11.684239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:12.179223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c7edb61-3916-4ae1-9cf1-ca6232655747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c01b80>]}
[0m17:25:12.180111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:12.271176 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_first_dbt_model
[0m17:25:12.271562 [info ] [Thread-1  ]: 1 of 4 START sql table model educative.my_first_dbt_model ...................... [RUN]
[0m17:25:12.271882 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_educative, now model.digital_marketing.my_first_dbt_model)
[0m17:25:12.272145 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_first_dbt_model
[0m17:25:12.279663 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_first_dbt_model"
[0m17:25:12.280317 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_first_dbt_model
[0m17:25:12.308017 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.my_first_dbt_model"
[0m17:25:12.309195 [debug] [Thread-1  ]: On model.digital_marketing.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.my_first_dbt_model"} */

  
    

    create or replace table `data-products-441119`.`educative`.`my_first_dbt_model`
      
    
    

    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m17:25:12.309545 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:25:13.022243 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:65a96d0d-adda-468f-a142-822d7a293d58&page=queryresults
[0m17:25:15.520452 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c7edb61-3916-4ae1-9cf1-ca6232655747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107322b20>]}
[0m17:25:15.521603 [info ] [Thread-1  ]: 1 of 4 OK created sql table model educative.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.25s]
[0m17:25:15.522441 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_first_dbt_model
[0m17:25:15.523024 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m17:25:15.523714 [info ] [Thread-1  ]: 2 of 4 START sql view model educative.sea ...................................... [RUN]
[0m17:25:15.524413 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.my_first_dbt_model, now model.digital_marketing.sea)
[0m17:25:15.524942 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m17:25:15.528938 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m17:25:15.530108 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m17:25:15.551102 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.sea"
[0m17:25:15.551895 [debug] [Thread-1  ]: On model.digital_marketing.sea: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.sea"} */


  create or replace view `data-products-441119`.`educative`.`sea`
  OPTIONS()
  as 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data;


[0m17:25:15.552281 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:25:16.299750 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:160a5d86-9e71-496d-8139-6d05f4d6792e&page=queryresults
[0m17:25:16.690492 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c7edb61-3916-4ae1-9cf1-ca6232655747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107322b20>]}
[0m17:25:16.692067 [info ] [Thread-1  ]: 2 of 4 OK created sql view model educative.sea ................................. [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m17:25:16.693255 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m17:25:16.694084 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m17:25:16.695161 [info ] [Thread-1  ]: 3 of 4 START sql view model educative.social_media ............................. [RUN]
[0m17:25:16.696149 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m17:25:16.696941 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m17:25:16.702765 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m17:25:16.703893 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m17:25:16.709174 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.social_media"
[0m17:25:16.710121 [debug] [Thread-1  ]: On model.digital_marketing.social_media: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.social_media"} */


  create or replace view `data-products-441119`.`educative`.`social_media`
  OPTIONS()
  as 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data;


[0m17:25:16.710709 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:25:17.409714 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:c0700ee7-a6ad-46b1-82e3-90643bd1ca8e&page=queryresults
[0m17:25:17.962784 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c7edb61-3916-4ae1-9cf1-ca6232655747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f81be0>]}
[0m17:25:17.964197 [info ] [Thread-1  ]: 3 of 4 OK created sql view model educative.social_media ........................ [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m17:25:17.965147 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m17:25:17.965813 [debug] [Thread-1  ]: Began running node model.digital_marketing.my_second_dbt_model
[0m17:25:17.966574 [info ] [Thread-1  ]: 4 of 4 START sql view model educative.my_second_dbt_model ...................... [RUN]
[0m17:25:17.967294 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.my_second_dbt_model)
[0m17:25:17.968031 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.my_second_dbt_model
[0m17:25:17.974201 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.my_second_dbt_model"
[0m17:25:17.975359 [debug] [Thread-1  ]: Began executing node model.digital_marketing.my_second_dbt_model
[0m17:25:17.980279 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.my_second_dbt_model"
[0m17:25:17.981260 [debug] [Thread-1  ]: On model.digital_marketing.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.my_second_dbt_model"} */


  create or replace view `data-products-441119`.`educative`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `data-products-441119`.`educative`.`my_first_dbt_model`
where id = 1;


[0m17:25:17.981843 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:25:19.374124 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:4b59b697-27b4-45cd-a03d-881d4f7070a1&page=queryresults
[0m17:25:20.103046 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c7edb61-3916-4ae1-9cf1-ca6232655747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144980f10>]}
[0m17:25:20.104507 [info ] [Thread-1  ]: 4 of 4 OK created sql view model educative.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 2.14s]
[0m17:25:20.105656 [debug] [Thread-1  ]: Finished running node model.digital_marketing.my_second_dbt_model
[0m17:25:20.107410 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:25:20.202351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:20.202688 [debug] [MainThread]: Connection 'model.digital_marketing.my_second_dbt_model' was properly closed.
[0m17:25:20.202972 [info ] [MainThread]: 
[0m17:25:20.203228 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 9.02 seconds (9.02s).
[0m17:25:20.203914 [debug] [MainThread]: Command end result
[0m17:25:20.221737 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:25:20.223003 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:25:20.227489 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m17:25:20.227755 [info ] [MainThread]: 
[0m17:25:20.228033 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:20.228263 [info ] [MainThread]: 
[0m17:25:20.228508 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:25:20.231029 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.981314, "process_in_blocks": "0", "process_kernel_time": 0.335223, "process_mem_max_rss": "369197056", "process_out_blocks": "0", "process_user_time": 3.544194}
[0m17:25:20.231440 [debug] [MainThread]: Command `dbt run` succeeded at 17:25:20.231382 after 10.98 seconds
[0m17:25:20.231708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b9ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034ebb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1d7f0>]}
[0m17:25:20.231971 [debug] [MainThread]: Flushing usage events
[0m17:25:20.595287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:48.805203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057afee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7a1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7a490>]}


============================== 17:27:48.808149 | 3d1d99f2-da74-455e-9678-b2013b9f8033 ==============================
[0m17:27:48.808149 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:27:48.808548 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'invocation_command': 'dbt run', 'no_print': 'None', 'debug': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'version_check': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'empty': 'False', 'introspect': 'True', 'write_json': 'True', 'printer_width': '80', 'target_path': 'None', 'fail_fast': 'False'}
[0m17:27:50.687756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d1d99f2-da74-455e-9678-b2013b9f8033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2d2550>]}
[0m17:27:50.724180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d1d99f2-da74-455e-9678-b2013b9f8033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c06760>]}
[0m17:27:50.724611 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:27:50.900177 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m17:27:51.008651 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 0 files added, 0 files changed.
[0m17:27:51.009128 [debug] [MainThread]: Partial parsing: deleted file: digital_marketing://models/example/my_first_dbt_model.sql
[0m17:27:51.009352 [debug] [MainThread]: Partial parsing: deleted file: digital_marketing://models/example/my_second_dbt_model.sql
[0m17:27:51.237939 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics-engineering.online_marketing.social_media
[0m17:27:51.241485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d1d99f2-da74-455e-9678-b2013b9f8033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a966130>]}
[0m17:27:51.285170 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:27:51.286570 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:27:51.298094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d1d99f2-da74-455e-9678-b2013b9f8033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a868820>]}
[0m17:27:51.298447 [info ] [MainThread]: Found 3 models, 496 macros
[0m17:27:51.298705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d1d99f2-da74-455e-9678-b2013b9f8033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a95fdc0>]}
[0m17:27:51.299550 [info ] [MainThread]: 
[0m17:27:51.299805 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:27:51.300029 [info ] [MainThread]: 
[0m17:27:51.300363 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:27:51.303184 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m17:27:51.303467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:51.898465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now list_data-products-441119_educative)
[0m17:27:51.899387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:52.439457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d1d99f2-da74-455e-9678-b2013b9f8033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a88ea60>]}
[0m17:27:52.440474 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:27:52.541857 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m17:27:52.542315 [info ] [Thread-1  ]: 1 of 3 START sql view model educative.sea ...................................... [RUN]
[0m17:27:52.542643 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_educative, now model.digital_marketing.sea)
[0m17:27:52.542898 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m17:27:52.548480 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m17:27:52.549760 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m17:27:52.570355 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.sea"
[0m17:27:52.571082 [debug] [Thread-1  ]: On model.digital_marketing.sea: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.sea"} */


  create or replace view `data-products-441119`.`educative`.`sea`
  OPTIONS()
  as 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data;


[0m17:27:52.571386 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:27:53.273080 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:8b83eb65-45bd-43d0-bcf4-809acebe4b49&page=queryresults
[0m17:27:53.863466 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d1d99f2-da74-455e-9678-b2013b9f8033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a9e11f0>]}
[0m17:27:53.864052 [info ] [Thread-1  ]: 1 of 3 OK created sql view model educative.sea ................................. [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m17:27:53.864517 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m17:27:53.864849 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m17:27:53.865253 [info ] [Thread-1  ]: 2 of 3 START sql view model educative.social_media ............................. [RUN]
[0m17:27:53.865606 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m17:27:53.865907 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m17:27:53.868390 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m17:27:53.868898 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m17:27:53.871693 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.social_media"
[0m17:27:53.872612 [debug] [Thread-1  ]: On model.digital_marketing.social_media: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.social_media"} */


  create or replace view `data-products-441119`.`educative`.`social_media`
  OPTIONS()
  as 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data;


[0m17:27:53.873097 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:27:54.661967 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:8563bdd3-b0d8-438a-8e94-4fece4e31cc3&page=queryresults
[0m17:27:55.064645 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d1d99f2-da74-455e-9678-b2013b9f8033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10569cc70>]}
[0m17:27:55.066113 [info ] [Thread-1  ]: 2 of 3 OK created sql view model educative.social_media ........................ [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m17:27:55.067279 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m17:27:55.068104 [debug] [Thread-1  ]: Began running node model.digital_marketing.television
[0m17:27:55.069136 [info ] [Thread-1  ]: 3 of 3 START sql view model educative.television ............................... [RUN]
[0m17:27:55.070113 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.television)
[0m17:27:55.070892 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.television
[0m17:27:55.075671 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.television"
[0m17:27:55.077117 [debug] [Thread-1  ]: Began executing node model.digital_marketing.television
[0m17:27:55.083779 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.television"
[0m17:27:55.085221 [debug] [Thread-1  ]: On model.digital_marketing.television: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.television"} */


  create or replace view `data-products-441119`.`educative`.`television`
  OPTIONS()
  as SELECT 1 AS ad_id, "Pink soap" AS ad_name
UNION ALL
SELECT 2 AS ad_id, "Green shoes" AS ad_name;


[0m17:27:55.085816 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:27:55.940264 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:cef52db5-8124-4b20-8ae9-ee4c1ef6114b&page=queryresults
[0m17:27:56.357538 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d1d99f2-da74-455e-9678-b2013b9f8033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a9e11f0>]}
[0m17:27:56.358594 [info ] [Thread-1  ]: 3 of 3 OK created sql view model educative.television .......................... [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m17:27:56.359322 [debug] [Thread-1  ]: Finished running node model.digital_marketing.television
[0m17:27:56.360427 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:27:56.441664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:56.441968 [debug] [MainThread]: Connection 'model.digital_marketing.television' was properly closed.
[0m17:27:56.442235 [info ] [MainThread]: 
[0m17:27:56.442471 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m17:27:56.443065 [debug] [MainThread]: Command end result
[0m17:27:56.458550 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:27:56.459818 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:27:56.464291 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m17:27:56.464549 [info ] [MainThread]: 
[0m17:27:56.464831 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:27:56.465067 [info ] [MainThread]: 
[0m17:27:56.465315 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m17:27:56.467824 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.712158, "process_in_blocks": "0", "process_kernel_time": 0.445725, "process_mem_max_rss": "374407168", "process_out_blocks": "0", "process_user_time": 3.465973}
[0m17:27:56.468185 [debug] [MainThread]: Command `dbt run` succeeded at 17:27:56.468135 after 7.71 seconds
[0m17:27:56.468445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057afee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c06760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a9e1be0>]}
[0m17:27:56.468708 [debug] [MainThread]: Flushing usage events
[0m17:27:56.765201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:32:47.037211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d4bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108215280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108215550>]}


============================== 17:32:47.041768 | c17f6c20-388e-485c-813b-ee3126e00fa6 ==============================
[0m17:32:47.041768 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:32:47.042206 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt compile', 'log_format': 'default', 'empty': 'False', 'introspect': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'write_json': 'True', 'version_check': 'True', 'no_print': 'None', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'warn_error': 'None', 'debug': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'static_parser': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False'}
[0m17:32:48.943625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c17f6c20-388e-485c-813b-ee3126e00fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d3a60>]}
[0m17:32:48.979828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c17f6c20-388e-485c-813b-ee3126e00fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082548b0>]}
[0m17:32:48.980265 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:32:49.161727 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m17:32:49.208555 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:32:49.208916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c17f6c20-388e-485c-813b-ee3126e00fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076493d0>]}
[0m17:32:49.985258 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.analytics-engineering.online_marketing
- models.analytics-engineering.online_marketing.social_media
[0m17:32:49.988841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c17f6c20-388e-485c-813b-ee3126e00fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d1e3130>]}
[0m17:32:50.030986 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:32:50.032304 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:32:50.043310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c17f6c20-388e-485c-813b-ee3126e00fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d1dc490>]}
[0m17:32:50.043665 [info ] [MainThread]: Found 3 models, 496 macros
[0m17:32:50.043919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c17f6c20-388e-485c-813b-ee3126e00fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d29f8e0>]}
[0m17:32:50.044745 [info ] [MainThread]: 
[0m17:32:50.045002 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:32:50.045225 [info ] [MainThread]: 
[0m17:32:50.045570 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:32:50.048321 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_educative'
[0m17:32:50.048637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:50.797784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c17f6c20-388e-485c-813b-ee3126e00fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d296d00>]}
[0m17:32:50.798494 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:32:50.882843 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m17:32:50.883318 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_educative, now model.digital_marketing.sea)
[0m17:32:50.883600 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m17:32:50.889790 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m17:32:50.891734 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m17:32:50.892062 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:32:50.960097 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m17:32:50.960532 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m17:32:50.960947 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m17:32:50.961278 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m17:32:50.964284 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m17:32:50.965656 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m17:32:50.965933 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:32:51.032964 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m17:32:51.033347 [debug] [Thread-1  ]: Began running node model.digital_marketing.television
[0m17:32:51.033627 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.television)
[0m17:32:51.033880 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.television
[0m17:32:51.035599 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.television"
[0m17:32:51.036126 [debug] [Thread-1  ]: Began executing node model.digital_marketing.television
[0m17:32:51.036393 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:32:51.102515 [debug] [Thread-1  ]: Finished running node model.digital_marketing.television
[0m17:32:51.103127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:51.103366 [debug] [MainThread]: Connection 'model.digital_marketing.television' was properly closed.
[0m17:32:51.103901 [debug] [MainThread]: Command end result
[0m17:32:51.119133 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:32:51.120126 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:32:51.125201 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m17:32:51.127738 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.1387124, "process_in_blocks": "0", "process_kernel_time": 0.41394, "process_mem_max_rss": "367181824", "process_out_blocks": "0", "process_user_time": 3.491713}
[0m17:32:51.128119 [debug] [MainThread]: Command `dbt compile` succeeded at 17:32:51.128066 after 4.14 seconds
[0m17:32:51.128386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d4bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082548b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2a5100>]}
[0m17:32:51.128650 [debug] [MainThread]: Flushing usage events
[0m17:32:51.460088 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:34:57.144635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105687f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10764a280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10764a550>]}


============================== 17:34:57.148451 | 25e9a55e-1638-49f5-852e-d7ffbc613283 ==============================
[0m17:34:57.148451 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:34:57.148847 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'use_colors': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'write_json': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'version_check': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'target_path': 'None', 'introspect': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/azadsolanki/.dbt', 'use_experimental_parser': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default'}
[0m17:34:59.028839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25e9a55e-1638-49f5-852e-d7ffbc613283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451d7c0>]}
[0m17:34:59.064821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25e9a55e-1638-49f5-852e-d7ffbc613283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141a126d0>]}
[0m17:34:59.065265 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:34:59.245939 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m17:34:59.334732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:34:59.335062 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:34:59.339748 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.analytics-engineering.online_marketing
- models.analytics-engineering.online_marketing.social_media
[0m17:34:59.443029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25e9a55e-1638-49f5-852e-d7ffbc613283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141a30520>]}
[0m17:34:59.487922 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:34:59.489143 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:34:59.501809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25e9a55e-1638-49f5-852e-d7ffbc613283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1428def70>]}
[0m17:34:59.502210 [info ] [MainThread]: Found 3 models, 496 macros
[0m17:34:59.502464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25e9a55e-1638-49f5-852e-d7ffbc613283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107601460>]}
[0m17:34:59.503283 [info ] [MainThread]: 
[0m17:34:59.503547 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:34:59.503771 [info ] [MainThread]: 
[0m17:34:59.504106 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:34:59.507065 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m17:34:59.507376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:00.107420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now list_data-products-441119_educative)
[0m17:35:00.108329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:00.663414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25e9a55e-1638-49f5-852e-d7ffbc613283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141a972e0>]}
[0m17:35:00.664413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:00.766321 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m17:35:00.766825 [info ] [Thread-1  ]: 1 of 3 START sql view model educative.sea ...................................... [RUN]
[0m17:35:00.767168 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_educative, now model.digital_marketing.sea)
[0m17:35:00.767434 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m17:35:00.774170 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m17:35:00.775119 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m17:35:00.795596 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.sea"
[0m17:35:00.796640 [debug] [Thread-1  ]: On model.digital_marketing.sea: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.sea"} */


  create or replace view `data-products-441119`.`educative`.`sea`
  OPTIONS()
  as 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data;


[0m17:35:00.796954 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:35:02.053741 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:18388825-ace3-4ab4-bdae-07f4d5580252&page=queryresults
[0m17:35:02.888445 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e9a55e-1638-49f5-852e-d7ffbc613283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141a8c580>]}
[0m17:35:02.889085 [info ] [Thread-1  ]: 1 of 3 OK created sql view model educative.sea ................................. [[32mCREATE VIEW (0 processed)[0m in 2.12s]
[0m17:35:02.889563 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m17:35:02.889898 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m17:35:02.890323 [info ] [Thread-1  ]: 2 of 3 START sql view model educative.social_media ............................. [RUN]
[0m17:35:02.890715 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m17:35:02.891038 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m17:35:02.893535 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m17:35:02.894055 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m17:35:02.896857 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.social_media"
[0m17:35:02.897558 [debug] [Thread-1  ]: On model.digital_marketing.social_media: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.social_media"} */


  create or replace view `data-products-441119`.`educative`.`social_media`
  OPTIONS()
  as 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data;


[0m17:35:02.897934 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:35:03.585646 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:b39c57c5-a733-4764-ab82-804b196b7341&page=queryresults
[0m17:35:03.997981 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e9a55e-1638-49f5-852e-d7ffbc613283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105580c40>]}
[0m17:35:03.999538 [info ] [Thread-1  ]: 2 of 3 OK created sql view model educative.social_media ........................ [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m17:35:04.000711 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m17:35:04.001543 [debug] [Thread-1  ]: Began running node model.digital_marketing.television
[0m17:35:04.002635 [info ] [Thread-1  ]: 3 of 3 START sql view model educative.television ............................... [RUN]
[0m17:35:04.003648 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.television)
[0m17:35:04.004407 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.television
[0m17:35:04.010534 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.television"
[0m17:35:04.011788 [debug] [Thread-1  ]: Began executing node model.digital_marketing.television
[0m17:35:04.017040 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.television"
[0m17:35:04.018215 [debug] [Thread-1  ]: On model.digital_marketing.television: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.television"} */


  create or replace view `data-products-441119`.`educative`.`television`
  OPTIONS()
  as SELECT 1 AS ad_id, "Pink soap" AS ad_name
UNION ALL
SELECT 2 AS ad_id, "Green shoes" AS ad_name;


[0m17:35:04.018849 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:35:04.723042 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:cde05547-730c-4d45-ab03-9d2ff8610ad8&page=queryresults
[0m17:35:05.341156 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e9a55e-1638-49f5-852e-d7ffbc613283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107424fa0>]}
[0m17:35:05.342624 [info ] [Thread-1  ]: 3 of 3 OK created sql view model educative.television .......................... [[32mCREATE VIEW (0 processed)[0m in 1.34s]
[0m17:35:05.343769 [debug] [Thread-1  ]: Finished running node model.digital_marketing.television
[0m17:35:05.345428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:35:05.441241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:05.441605 [debug] [MainThread]: Connection 'model.digital_marketing.television' was properly closed.
[0m17:35:05.441918 [info ] [MainThread]: 
[0m17:35:05.442211 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.94 seconds (5.94s).
[0m17:35:05.442841 [debug] [MainThread]: Command end result
[0m17:35:05.458678 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:35:05.459888 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:35:05.464169 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m17:35:05.464421 [info ] [MainThread]: 
[0m17:35:05.464695 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:35:05.464927 [info ] [MainThread]: 
[0m17:35:05.465178 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m17:35:05.467721 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.369032, "process_in_blocks": "0", "process_kernel_time": 0.449352, "process_mem_max_rss": "368771072", "process_out_blocks": "0", "process_user_time": 3.347169}
[0m17:35:05.468074 [debug] [MainThread]: Command `dbt run` succeeded at 17:35:05.468025 after 8.37 seconds
[0m17:35:05.468334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105687f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e0b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d6cd0>]}
[0m17:35:05.468596 [debug] [MainThread]: Flushing usage events
[0m17:35:05.824199 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:41:28.486388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f6bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e38190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e38460>]}


============================== 17:41:28.490407 | edad6a22-33e0-472b-b3ef-c9e628e996ce ==============================
[0m17:41:28.490407 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:41:28.490830 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'version_check': 'True', 'no_print': 'None', 'profiles_dir': '/Users/azadsolanki/.dbt', 'introspect': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'printer_width': '80', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'write_json': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'use_colors': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'empty': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt compile --select social_media', 'fail_fast': 'False', 'quiet': 'False', 'cache_selected_only': 'False'}
[0m17:41:30.368433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edad6a22-33e0-472b-b3ef-c9e628e996ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fc56dc0>]}
[0m17:41:30.404448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edad6a22-33e0-472b-b3ef-c9e628e996ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041bd760>]}
[0m17:41:30.404854 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:41:30.582776 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m17:41:30.669457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:41:30.669773 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:41:30.674202 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.analytics-engineering.online_marketing
- models.analytics-engineering.online_marketing.social_media
[0m17:41:30.779159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edad6a22-33e0-472b-b3ef-c9e628e996ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10046d070>]}
[0m17:41:30.824756 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:41:30.826213 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:41:30.838322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edad6a22-33e0-472b-b3ef-c9e628e996ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fbf26a0>]}
[0m17:41:30.838712 [info ] [MainThread]: Found 3 models, 496 macros
[0m17:41:30.838970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edad6a22-33e0-472b-b3ef-c9e628e996ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fbf2eb0>]}
[0m17:41:30.839674 [info ] [MainThread]: 
[0m17:41:30.839927 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:41:30.840149 [info ] [MainThread]: 
[0m17:41:30.840485 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:41:30.843254 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_educative'
[0m17:41:30.843549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:31.481082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edad6a22-33e0-472b-b3ef-c9e628e996ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e75b80>]}
[0m17:41:31.482085 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:41:31.583199 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m17:41:31.583631 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_educative, now model.digital_marketing.social_media)
[0m17:41:31.583912 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m17:41:31.608147 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m17:41:31.609002 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m17:41:31.609351 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:41:31.677370 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m17:41:31.678021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:31.678287 [debug] [MainThread]: Connection 'model.digital_marketing.social_media' was properly closed.
[0m17:41:31.678701 [debug] [MainThread]: Command end result
[0m17:41:31.695074 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:41:31.696017 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:41:31.700683 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m17:41:31.700937 [info ] [MainThread]: Compiled node 'social_media' is:


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
[0m17:41:31.703769 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.2670639, "process_in_blocks": "0", "process_kernel_time": 0.397161, "process_mem_max_rss": "363462656", "process_out_blocks": "0", "process_user_time": 2.72818}
[0m17:41:31.704250 [debug] [MainThread]: Command `dbt compile` succeeded at 17:41:31.704195 after 3.27 seconds
[0m17:41:31.704519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f6bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041a7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103313dc0>]}
[0m17:41:31.704794 [debug] [MainThread]: Flushing usage events
[0m17:41:32.088530 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:45:27.895544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fabf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10525c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10525c5b0>]}


============================== 17:45:27.899493 | 08c8cd25-e66f-45dc-95e6-4ced9b93879f ==============================
[0m17:45:27.899493 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:45:27.899915 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'fail_fast': 'False', 'target_path': 'None', 'debug': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/azadsolanki/.dbt', 'invocation_command': 'dbt compile --select social_media', 'empty': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'introspect': 'True', 'printer_width': '80', 'quiet': 'False', 'warn_error': 'None', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'log_cache_events': 'False', 'use_experimental_parser': 'False'}
[0m17:45:29.808700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08c8cd25-e66f-45dc-95e6-4ced9b93879f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e41370>]}
[0m17:45:29.846341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08c8cd25-e66f-45dc-95e6-4ced9b93879f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052998b0>]}
[0m17:45:29.846860 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:45:30.027698 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m17:45:30.076135 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:45:30.076524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '08c8cd25-e66f-45dc-95e6-4ced9b93879f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041a9be0>]}
[0m17:45:30.854394 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.analytics-engineering.online_marketing
- models.analytics-engineering.online_marketing.social_media
[0m17:45:30.858086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08c8cd25-e66f-45dc-95e6-4ced9b93879f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140262130>]}
[0m17:45:30.901879 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:45:30.903318 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:45:30.915129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08c8cd25-e66f-45dc-95e6-4ced9b93879f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14024aee0>]}
[0m17:45:30.915520 [info ] [MainThread]: Found 3 models, 496 macros
[0m17:45:30.915775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08c8cd25-e66f-45dc-95e6-4ced9b93879f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140327940>]}
[0m17:45:30.916451 [info ] [MainThread]: 
[0m17:45:30.916710 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:30.916936 [info ] [MainThread]: 
[0m17:45:30.917283 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:45:30.920150 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_dbt_dev'
[0m17:45:30.920467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:31.651002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08c8cd25-e66f-45dc-95e6-4ced9b93879f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1403179a0>]}
[0m17:45:31.652779 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:31.757084 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m17:45:31.757455 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev, now model.digital_marketing.social_media)
[0m17:45:31.757728 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m17:45:31.763883 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m17:45:31.764589 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m17:45:31.764869 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:45:31.830659 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m17:45:31.831343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:31.831610 [debug] [MainThread]: Connection 'model.digital_marketing.social_media' was properly closed.
[0m17:45:31.832045 [debug] [MainThread]: Command end result
[0m17:45:31.849147 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:45:31.850296 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:45:31.855305 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m17:45:31.855595 [info ] [MainThread]: Compiled node 'social_media' is:


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
[0m17:45:31.858226 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.010984, "process_in_blocks": "0", "process_kernel_time": 0.414241, "process_mem_max_rss": "367640576", "process_out_blocks": "0", "process_user_time": 3.36169}
[0m17:45:31.858673 [debug] [MainThread]: Command `dbt compile` succeeded at 17:45:31.858613 after 4.01 seconds
[0m17:45:31.858971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fabf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052998b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103356ee0>]}
[0m17:45:31.859267 [debug] [MainThread]: Flushing usage events
[0m17:45:32.165764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:46:24.804686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107422f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ee190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ee460>]}


============================== 17:46:24.808696 | 2d3235d5-998a-46c5-85b8-fce88b717bb0 ==============================
[0m17:46:24.808696 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:46:24.809141 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'invocation_command': 'dbt run', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'debug': 'False', 'log_format': 'default', 'no_print': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'empty': 'False'}
[0m17:46:26.720622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d3235d5-998a-46c5-85b8-fce88b717bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b069af0>]}
[0m17:46:26.757125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d3235d5-998a-46c5-85b8-fce88b717bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10885d340>]}
[0m17:46:26.757559 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:46:26.933986 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m17:46:27.019920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:46:27.020232 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:46:27.024548 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.analytics-engineering.online_marketing
- models.analytics-engineering.online_marketing.social_media
[0m17:46:27.130461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d3235d5-998a-46c5-85b8-fce88b717bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108896f40>]}
[0m17:46:27.174592 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:46:27.175834 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:46:27.188574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d3235d5-998a-46c5-85b8-fce88b717bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d2b20>]}
[0m17:46:27.188961 [info ] [MainThread]: Found 3 models, 496 macros
[0m17:46:27.189214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d3235d5-998a-46c5-85b8-fce88b717bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d768b0>]}
[0m17:46:27.190014 [info ] [MainThread]: 
[0m17:46:27.190273 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:46:27.190493 [info ] [MainThread]: 
[0m17:46:27.190830 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:46:27.193666 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m17:46:27.193921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:27.767705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now create_data-products-441119_dbt_dev)
[0m17:46:27.768681 [debug] [ThreadPool]: Creating schema "database: "data-products-441119"
schema: "dbt_dev"
"
[0m17:46:27.777452 [debug] [ThreadPool]: On create_data-products-441119_dbt_dev: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "connection_name": "create_data-products-441119_dbt_dev"} */
create schema if not exists `data-products-441119`.`dbt_dev`
  
[0m17:46:27.777886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:28.614021 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:d63b6d2c-4309-40fc-914c-e42f785c4d79&page=queryresults
[0m17:46:29.432829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data-products-441119_dbt_dev, now list_data-products-441119_dbt_dev)
[0m17:46:29.433288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:29.957583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d3235d5-998a-46c5-85b8-fce88b717bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106551b20>]}
[0m17:46:29.958712 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:46:30.060659 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m17:46:30.061055 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt_dev.sea ........................................ [RUN]
[0m17:46:30.061566 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.digital_marketing.sea'
[0m17:46:30.061827 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m17:46:30.067383 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m17:46:30.068273 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m17:46:30.085155 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.sea"
[0m17:46:30.086298 [debug] [Thread-1  ]: On model.digital_marketing.sea: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.sea"} */


  create or replace view `data-products-441119`.`dbt_dev`.`sea`
  OPTIONS()
  as 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data;


[0m17:46:30.086611 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:46:30.863206 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:800711c6-3243-4b6e-b753-05db932970e3&page=queryresults
[0m17:46:31.267509 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d3235d5-998a-46c5-85b8-fce88b717bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c705dc0>]}
[0m17:46:31.268494 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt_dev.sea ................................... [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m17:46:31.269301 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m17:46:31.269824 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m17:46:31.270482 [info ] [Thread-1  ]: 2 of 3 START sql view model dbt_dev.social_media ............................... [RUN]
[0m17:46:31.271116 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m17:46:31.271606 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m17:46:31.275944 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m17:46:31.277024 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m17:46:31.281844 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.social_media"
[0m17:46:31.282621 [debug] [Thread-1  ]: On model.digital_marketing.social_media: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.social_media"} */


  create or replace view `data-products-441119`.`dbt_dev`.`social_media`
  OPTIONS()
  as 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data;


[0m17:46:31.283083 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:46:31.929111 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:af06599c-30c3-40f2-ac3d-b38877ef2b36&page=queryresults
[0m17:46:32.328163 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d3235d5-998a-46c5-85b8-fce88b717bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073048e0>]}
[0m17:46:32.329622 [info ] [Thread-1  ]: 2 of 3 OK created sql view model dbt_dev.social_media .......................... [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m17:46:32.330780 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m17:46:32.331602 [debug] [Thread-1  ]: Began running node model.digital_marketing.television
[0m17:46:32.332629 [info ] [Thread-1  ]: 3 of 3 START sql view model dbt_dev.television ................................. [RUN]
[0m17:46:32.333618 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.television)
[0m17:46:32.334406 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.television
[0m17:46:32.339138 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.television"
[0m17:46:32.341436 [debug] [Thread-1  ]: Began executing node model.digital_marketing.television
[0m17:46:32.346693 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.television"
[0m17:46:32.347676 [debug] [Thread-1  ]: On model.digital_marketing.television: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.television"} */


  create or replace view `data-products-441119`.`dbt_dev`.`television`
  OPTIONS()
  as SELECT 1 AS ad_id, "Pink soap" AS ad_name
UNION ALL
SELECT 2 AS ad_id, "Green shoes" AS ad_name;


[0m17:46:32.348268 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:46:33.067031 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:7a8536f8-e604-452a-9fe7-3f0e6863c5e9&page=queryresults
[0m17:46:33.464026 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d3235d5-998a-46c5-85b8-fce88b717bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c6bb340>]}
[0m17:46:33.465094 [info ] [Thread-1  ]: 3 of 3 OK created sql view model dbt_dev.television ............................ [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m17:46:33.465889 [debug] [Thread-1  ]: Finished running node model.digital_marketing.television
[0m17:46:33.467126 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:46:33.553599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:46:33.554059 [debug] [MainThread]: Connection 'list_data-products-441119_dbt_dev' was properly closed.
[0m17:46:33.554397 [debug] [MainThread]: Connection 'model.digital_marketing.television' was properly closed.
[0m17:46:33.554700 [info ] [MainThread]: 
[0m17:46:33.554955 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 6.36 seconds (6.36s).
[0m17:46:33.555587 [debug] [MainThread]: Command end result
[0m17:46:33.571219 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:46:33.572394 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:46:33.577881 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m17:46:33.578204 [info ] [MainThread]: 
[0m17:46:33.578491 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:46:33.578730 [info ] [MainThread]: 
[0m17:46:33.578978 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m17:46:33.581615 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.826597, "process_in_blocks": "0", "process_kernel_time": 0.458289, "process_mem_max_rss": "369475584", "process_out_blocks": "0", "process_user_time": 3.520452}
[0m17:46:33.582036 [debug] [MainThread]: Command `dbt run` succeeded at 17:46:33.581981 after 8.83 seconds
[0m17:46:33.582310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107422f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a36d0>]}
[0m17:46:33.582574 [debug] [MainThread]: Flushing usage events
[0m17:46:33.868901 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:47:48.911182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059abf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107876280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107876550>]}


============================== 17:47:48.915022 | ade99b07-6bb8-4c7b-9a73-6cb0389dda97 ==============================
[0m17:47:48.915022 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:47:48.915412 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'version_check': 'True', 'partial_parse': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None', 'empty': 'False', 'introspect': 'True', 'no_print': 'None', 'profiles_dir': '/Users/azadsolanki/.dbt', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'warn_error': 'None'}
[0m17:47:50.916815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ade99b07-6bb8-4c7b-9a73-6cb0389dda97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d38e0>]}
[0m17:47:50.955194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ade99b07-6bb8-4c7b-9a73-6cb0389dda97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e11c40>]}
[0m17:47:50.955715 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:47:51.138058 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m17:47:51.184668 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:47:51.185030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ade99b07-6bb8-4c7b-9a73-6cb0389dda97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba93d0>]}
[0m17:47:51.967213 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.analytics-engineering
- models.analytics-engineering.online_marketing.social_media
- models.analytics-engineering.online_marketing
[0m17:47:51.970832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ade99b07-6bb8-4c7b-9a73-6cb0389dda97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c859130>]}
[0m17:47:52.012646 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:47:52.013830 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:47:52.025531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ade99b07-6bb8-4c7b-9a73-6cb0389dda97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c927e20>]}
[0m17:47:52.025895 [info ] [MainThread]: Found 3 models, 496 macros
[0m17:47:52.026145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ade99b07-6bb8-4c7b-9a73-6cb0389dda97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c85c1f0>]}
[0m17:47:52.026989 [info ] [MainThread]: 
[0m17:47:52.027254 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:47:52.027477 [info ] [MainThread]: 
[0m17:47:52.027815 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:47:52.030632 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m17:47:52.030917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:52.566885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now list_data-products-441119_dbt_dev)
[0m17:47:52.567891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:53.118204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ade99b07-6bb8-4c7b-9a73-6cb0389dda97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078322b0>]}
[0m17:47:53.119327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:47:53.220991 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m17:47:53.221389 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt_dev.sea ........................................ [RUN]
[0m17:47:53.221714 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev, now model.digital_marketing.sea)
[0m17:47:53.221968 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m17:47:53.227965 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m17:47:53.228695 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m17:47:53.247501 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.sea"
[0m17:47:53.248382 [debug] [Thread-1  ]: On model.digital_marketing.sea: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.sea"} */


  create or replace view `data-products-441119`.`dbt_dev`.`sea`
  OPTIONS()
  as 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data;


[0m17:47:53.248671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:47:53.921701 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:6a4ad435-5494-440a-9bc9-b1f5d57793ca&page=queryresults
[0m17:47:54.364681 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade99b07-6bb8-4c7b-9a73-6cb0389dda97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c9ea100>]}
[0m17:47:54.365313 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt_dev.sea ................................... [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m17:47:54.365789 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m17:47:54.366121 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m17:47:54.366530 [info ] [Thread-1  ]: 2 of 3 START sql view model dbt_dev.social_media ............................... [RUN]
[0m17:47:54.366884 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m17:47:54.367183 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m17:47:54.369697 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m17:47:54.370340 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m17:47:54.373215 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.social_media"
[0m17:47:54.373726 [debug] [Thread-1  ]: On model.digital_marketing.social_media: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.social_media"} */


  create or replace view `data-products-441119`.`dbt_dev`.`social_media`
  OPTIONS()
  as 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data;


[0m17:47:54.374044 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:47:54.977507 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:294a7b45-0b73-4aff-8cbc-1877b04b1c39&page=queryresults
[0m17:47:55.324128 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade99b07-6bb8-4c7b-9a73-6cb0389dda97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c9ea100>]}
[0m17:47:55.325593 [info ] [Thread-1  ]: 2 of 3 OK created sql view model dbt_dev.social_media .......................... [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m17:47:55.326747 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m17:47:55.327560 [debug] [Thread-1  ]: Began running node model.digital_marketing.television
[0m17:47:55.328674 [info ] [Thread-1  ]: 3 of 3 START sql view model dbt_dev.television ................................. [RUN]
[0m17:47:55.329559 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.television)
[0m17:47:55.330229 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.television
[0m17:47:55.335982 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.television"
[0m17:47:55.338095 [debug] [Thread-1  ]: Began executing node model.digital_marketing.television
[0m17:47:55.343548 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.television"
[0m17:47:55.344948 [debug] [Thread-1  ]: On model.digital_marketing.television: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.television"} */


  create or replace view `data-products-441119`.`dbt_dev`.`television`
  OPTIONS()
  as SELECT 1 AS ad_id, "Pink soap" AS ad_name
UNION ALL
SELECT 2 AS ad_id, "Green shoes" AS ad_name;


[0m17:47:55.345606 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:47:55.981887 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:fb078733-a86e-4b79-ad12-3132237eba43&page=queryresults
[0m17:47:56.360614 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade99b07-6bb8-4c7b-9a73-6cb0389dda97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c9ea100>]}
[0m17:47:56.361997 [info ] [Thread-1  ]: 3 of 3 OK created sql view model dbt_dev.television ............................ [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m17:47:56.363145 [debug] [Thread-1  ]: Finished running node model.digital_marketing.television
[0m17:47:56.364840 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:47:56.458946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:56.459298 [debug] [MainThread]: Connection 'model.digital_marketing.television' was properly closed.
[0m17:47:56.459583 [info ] [MainThread]: 
[0m17:47:56.459834 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.43 seconds (4.43s).
[0m17:47:56.460461 [debug] [MainThread]: Command end result
[0m17:47:56.477968 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:47:56.479045 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:47:56.483850 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m17:47:56.484110 [info ] [MainThread]: 
[0m17:47:56.484397 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:47:56.484630 [info ] [MainThread]: 
[0m17:47:56.484878 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m17:47:56.487522 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.624134, "process_in_blocks": "0", "process_kernel_time": 0.469434, "process_mem_max_rss": "367558656", "process_out_blocks": "0", "process_user_time": 4.033395}
[0m17:47:56.487900 [debug] [MainThread]: Command `dbt run` succeeded at 17:47:56.487848 after 7.62 seconds
[0m17:47:56.488169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059abf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e11c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c918160>]}
[0m17:47:56.488496 [debug] [MainThread]: Flushing usage events
[0m17:47:56.825192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:50:54.944727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102df7eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c2220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c24f0>]}


============================== 17:50:54.948773 | 498eccc1-bec9-44f0-b580-57a29e3cbb21 ==============================
[0m17:50:54.948773 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:50:54.949171 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'profiles_dir': '/Users/azadsolanki/.dbt', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error': 'None', 'invocation_command': 'dbt compile', 'empty': 'False', 'debug': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'write_json': 'True', 'partial_parse': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default'}
[0m17:50:56.823074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '498eccc1-bec9-44f0-b580-57a29e3cbb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f9700>]}
[0m17:50:56.859070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '498eccc1-bec9-44f0-b580-57a29e3cbb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10379dd30>]}
[0m17:50:56.859497 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:50:57.036832 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m17:50:57.084309 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:50:57.084692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '498eccc1-bec9-44f0-b580-57a29e3cbb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036fa1f0>]}
[0m17:50:57.884672 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.analytics-engineering.offline_marketing
- models.analytics-engineering.online_marketing
- models.analytics-engineering.online_marketing.social_media
[0m17:50:57.888216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '498eccc1-bec9-44f0-b580-57a29e3cbb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140f25130>]}
[0m17:50:57.931739 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:50:57.932974 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:50:57.944480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '498eccc1-bec9-44f0-b580-57a29e3cbb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140a539d0>]}
[0m17:50:57.944859 [info ] [MainThread]: Found 3 models, 496 macros
[0m17:50:57.945113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '498eccc1-bec9-44f0-b580-57a29e3cbb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140f59880>]}
[0m17:50:57.945941 [info ] [MainThread]: 
[0m17:50:57.946198 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:57.946420 [info ] [MainThread]: 
[0m17:50:57.946756 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:50:57.949544 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_dbt_dev'
[0m17:50:57.949798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:58.595619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '498eccc1-bec9-44f0-b580-57a29e3cbb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1408b0a30>]}
[0m17:50:58.596863 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:58.700334 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m17:50:58.700706 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev, now model.digital_marketing.sea)
[0m17:50:58.700963 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m17:50:58.706523 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m17:50:58.707383 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m17:50:58.707670 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:58.772932 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m17:50:58.773206 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m17:50:58.773468 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m17:50:58.773710 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m17:50:58.776198 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m17:50:58.776611 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m17:50:58.776862 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:58.842278 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m17:50:58.842611 [debug] [Thread-1  ]: Began running node model.digital_marketing.television
[0m17:50:58.842888 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.television)
[0m17:50:58.843140 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.television
[0m17:50:58.844807 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.television"
[0m17:50:58.845947 [debug] [Thread-1  ]: Began executing node model.digital_marketing.television
[0m17:50:58.846224 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:58.911389 [debug] [Thread-1  ]: Finished running node model.digital_marketing.television
[0m17:50:58.911914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:58.912171 [debug] [MainThread]: Connection 'model.digital_marketing.television' was properly closed.
[0m17:50:58.912726 [debug] [MainThread]: Command end result
[0m17:50:58.928079 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:50:58.929020 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:50:58.933871 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m17:50:58.936372 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.038812, "process_in_blocks": "0", "process_kernel_time": 0.401323, "process_mem_max_rss": "367607808", "process_out_blocks": "0", "process_user_time": 3.483206}
[0m17:50:58.936734 [debug] [MainThread]: Command `dbt compile` succeeded at 17:50:58.936682 after 4.04 seconds
[0m17:50:58.936991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102df7eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10379dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140f60dc0>]}
[0m17:50:58.937250 [debug] [MainThread]: Flushing usage events
[0m17:50:59.279710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:51:09.180956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b36fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105002250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105002520>]}


============================== 17:51:09.184163 | 5c0b13fd-b434-422f-a8f6-33e436509b5b ==============================
[0m17:51:09.184163 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:51:09.184546 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'introspect': 'True', 'debug': 'False', 'write_json': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'version_check': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'use_experimental_parser': 'False', 'quiet': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt clean', 'use_colors': 'True', 'no_print': 'None', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'printer_width': '80', 'warn_error': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m17:51:09.263363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c0b13fd-b434-422f-a8f6-33e436509b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c7220>]}
[0m17:51:09.275313 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.13752975, "process_in_blocks": "0", "process_kernel_time": 0.099979, "process_mem_max_rss": "99565568", "process_out_blocks": "0", "process_user_time": 0.889228}
[0m17:51:09.276131 [debug] [MainThread]: Command `dbt clean` succeeded at 17:51:09.276042 after 0.14 seconds
[0m17:51:09.276488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b36fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105092820>]}
[0m17:51:09.277064 [debug] [MainThread]: Flushing usage events
[0m17:51:09.568355 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:51:12.524792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105353eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681f4f0>]}


============================== 17:51:12.528133 | 204fe1d4-0950-4b2b-af78-c149e15be2a6 ==============================
[0m17:51:12.528133 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:51:12.528531 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'quiet': 'False', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'empty': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'debug': 'False'}
[0m17:51:14.083859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '204fe1d4-0950-4b2b-af78-c149e15be2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119fb1cd0>]}
[0m17:51:14.120117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '204fe1d4-0950-4b2b-af78-c149e15be2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c3d1f0>]}
[0m17:51:14.120533 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:51:14.296267 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m17:51:14.296840 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:51:14.297116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '204fe1d4-0950-4b2b-af78-c149e15be2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a0568e0>]}
[0m17:51:15.078002 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.analytics-engineering.offline_marketing
- models.analytics-engineering.online_marketing.social_media
- models.analytics-engineering.online_marketing
[0m17:51:15.081556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '204fe1d4-0950-4b2b-af78-c149e15be2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a4cfeb0>]}
[0m17:51:15.125795 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:51:15.127104 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:51:15.135813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '204fe1d4-0950-4b2b-af78-c149e15be2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a58c5e0>]}
[0m17:51:15.136197 [info ] [MainThread]: Found 3 models, 496 macros
[0m17:51:15.136448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '204fe1d4-0950-4b2b-af78-c149e15be2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a585850>]}
[0m17:51:15.137282 [info ] [MainThread]: 
[0m17:51:15.137534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:15.137752 [info ] [MainThread]: 
[0m17:51:15.138089 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:51:15.140894 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m17:51:15.141147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:15.679567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now list_data-products-441119_dbt_dev)
[0m17:51:15.680590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:16.363656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '204fe1d4-0950-4b2b-af78-c149e15be2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b7b20>]}
[0m17:51:16.364671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:16.466193 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m17:51:16.466597 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt_dev.sea ........................................ [RUN]
[0m17:51:16.466917 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev, now model.digital_marketing.sea)
[0m17:51:16.467178 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m17:51:16.472768 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m17:51:16.473513 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m17:51:16.493986 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.sea"
[0m17:51:16.494773 [debug] [Thread-1  ]: On model.digital_marketing.sea: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.sea"} */


  create or replace view `data-products-441119`.`dbt_dev`.`sea`
  OPTIONS()
  as 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data;


[0m17:51:16.495067 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:51:17.270405 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:a0b2ce6b-1ec3-4fac-a3a5-4576141cf53d&page=queryresults
[0m17:51:17.756986 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '204fe1d4-0950-4b2b-af78-c149e15be2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a5cea90>]}
[0m17:51:17.757661 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt_dev.sea ................................... [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m17:51:17.758185 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m17:51:17.758548 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m17:51:17.758984 [info ] [Thread-1  ]: 2 of 3 START sql view model dbt_dev.social_media ............................... [RUN]
[0m17:51:17.759338 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m17:51:17.759642 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m17:51:17.762168 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m17:51:17.762715 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m17:51:17.765703 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.social_media"
[0m17:51:17.766649 [debug] [Thread-1  ]: On model.digital_marketing.social_media: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.social_media"} */


  create or replace view `data-products-441119`.`dbt_dev`.`social_media`
  OPTIONS()
  as 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data;


[0m17:51:17.767024 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:51:18.474328 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:0877c69d-bae6-4e56-afe1-ba42daf9a00a&page=queryresults
[0m17:51:18.839440 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '204fe1d4-0950-4b2b-af78-c149e15be2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a655f70>]}
[0m17:51:18.840821 [info ] [Thread-1  ]: 2 of 3 OK created sql view model dbt_dev.social_media .......................... [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m17:51:18.841984 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m17:51:18.842790 [debug] [Thread-1  ]: Began running node model.digital_marketing.television
[0m17:51:18.843824 [info ] [Thread-1  ]: 3 of 3 START sql view model dbt_dev.television ................................. [RUN]
[0m17:51:18.844807 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.television)
[0m17:51:18.845596 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.television
[0m17:51:18.851364 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.television"
[0m17:51:18.852762 [debug] [Thread-1  ]: Began executing node model.digital_marketing.television
[0m17:51:18.859371 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.television"
[0m17:51:18.860403 [debug] [Thread-1  ]: On model.digital_marketing.television: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.television"} */


  create or replace view `data-products-441119`.`dbt_dev`.`television`
  OPTIONS()
  as SELECT 1 AS ad_id, "Pink soap" AS ad_name
UNION ALL
SELECT 2 AS ad_id, "Green shoes" AS ad_name;


[0m17:51:18.861004 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:51:19.521986 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:3becf4f4-9a1e-40b2-a49c-526b4918a4ce&page=queryresults
[0m17:51:20.100358 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '204fe1d4-0950-4b2b-af78-c149e15be2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aa6c190>]}
[0m17:51:20.101894 [info ] [Thread-1  ]: 3 of 3 OK created sql view model dbt_dev.television ............................ [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m17:51:20.103072 [debug] [Thread-1  ]: Finished running node model.digital_marketing.television
[0m17:51:20.104778 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:51:20.200418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:20.200775 [debug] [MainThread]: Connection 'model.digital_marketing.television' was properly closed.
[0m17:51:20.201064 [info ] [MainThread]: 
[0m17:51:20.201315 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.06 seconds (5.06s).
[0m17:51:20.201937 [debug] [MainThread]: Command end result
[0m17:51:20.217918 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:51:20.219093 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:51:20.223548 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m17:51:20.223841 [info ] [MainThread]: 
[0m17:51:20.224125 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:51:20.224363 [info ] [MainThread]: 
[0m17:51:20.224616 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m17:51:20.227104 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.7458463, "process_in_blocks": "0", "process_kernel_time": 0.374194, "process_mem_max_rss": "374013952", "process_out_blocks": "0", "process_user_time": 3.926432}
[0m17:51:20.227466 [debug] [MainThread]: Command `dbt run` succeeded at 17:51:20.227414 after 7.75 seconds
[0m17:51:20.227728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105353eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eadcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119eba0a0>]}
[0m17:51:20.227992 [debug] [MainThread]: Flushing usage events
[0m17:51:20.541751 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:55:30.800016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c7ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107149280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107149550>]}


============================== 17:55:30.804008 | 1c87afad-bd6c-43d1-932a-ae643c817d0b ==============================
[0m17:55:30.804008 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:55:30.804443 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'no_print': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'printer_width': '80', 'quiet': 'False', 'introspect': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'invocation_command': 'dbt compile', 'empty': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs'}
[0m17:55:32.618017 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'offline_marketing' in "<unicode string>", line 36, column 3 in
file
`/Users/azadsolanki/dev/data-engineering/analytics-engineering/dbt_project.yml`
[0m17:55:32.618414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1c87afad-bd6c-43d1-932a-ae643c817d0b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a74c250>]}
[0m17:55:32.705176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c87afad-bd6c-43d1-932a-ae643c817d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf1370>]}
[0m17:55:32.741565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c87afad-bd6c-43d1-932a-ae643c817d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bf580>]}
[0m17:55:32.741991 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:55:32.917859 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m17:55:32.964820 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:55:32.965184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1c87afad-bd6c-43d1-932a-ae643c817d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10657dbe0>]}
[0m17:55:33.770274 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.offline_marketing.social_media
- models.offline_marketing
[0m17:55:33.773969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c87afad-bd6c-43d1-932a-ae643c817d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ad74130>]}
[0m17:55:33.817916 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:55:33.819368 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:55:33.830976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c87afad-bd6c-43d1-932a-ae643c817d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ad7c580>]}
[0m17:55:33.831366 [info ] [MainThread]: Found 3 models, 496 macros
[0m17:55:33.831664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c87afad-bd6c-43d1-932a-ae643c817d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae1a5b0>]}
[0m17:55:33.832489 [info ] [MainThread]: 
[0m17:55:33.832747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:33.832968 [info ] [MainThread]: 
[0m17:55:33.833303 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:55:33.836078 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_dbt_dev'
[0m17:55:33.836414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:34.371607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c87afad-bd6c-43d1-932a-ae643c817d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dadb80>]}
[0m17:55:34.372633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:55:34.473466 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m17:55:34.473803 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev, now model.digital_marketing.sea)
[0m17:55:34.474064 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m17:55:34.479740 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m17:55:34.480242 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m17:55:34.480519 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:55:34.545832 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m17:55:34.546133 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m17:55:34.546404 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m17:55:34.546656 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m17:55:34.549204 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m17:55:34.550514 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m17:55:34.550792 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:55:34.616171 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m17:55:34.616502 [debug] [Thread-1  ]: Began running node model.digital_marketing.television
[0m17:55:34.616772 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.television)
[0m17:55:34.617030 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.television
[0m17:55:34.618767 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.television"
[0m17:55:34.620068 [debug] [Thread-1  ]: Began executing node model.digital_marketing.television
[0m17:55:34.620357 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:55:34.686197 [debug] [Thread-1  ]: Finished running node model.digital_marketing.television
[0m17:55:34.686813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:34.687058 [debug] [MainThread]: Connection 'model.digital_marketing.television' was properly closed.
[0m17:55:34.687669 [debug] [MainThread]: Command end result
[0m17:55:34.729431 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:55:34.733002 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:55:34.737694 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m17:55:34.738084 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:55:34.740701 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.989659, "process_in_blocks": "0", "process_kernel_time": 0.417312, "process_mem_max_rss": "367624192", "process_out_blocks": "0", "process_user_time": 3.506977}
[0m17:55:34.741098 [debug] [MainThread]: Command `dbt compile` succeeded at 17:55:34.741045 after 3.99 seconds
[0m17:55:34.741365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c7ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bf580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae21cd0>]}
[0m17:55:34.741630 [debug] [MainThread]: Flushing usage events
[0m17:55:35.085640 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:57:39.945445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10504afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106516190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106516460>]}


============================== 17:57:39.949339 | e0390cc0-69de-45b2-99b3-47675beb8ac8 ==============================
[0m17:57:39.949339 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:57:39.949734 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/azadsolanki/.dbt', 'partial_parse': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'printer_width': '80', 'cache_selected_only': 'False', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'write_json': 'True', 'fail_fast': 'False', 'debug': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'no_print': 'None'}
[0m17:57:41.838424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0390cc0-69de-45b2-99b3-47675beb8ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10422b310>]}
[0m17:57:41.874785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0390cc0-69de-45b2-99b3-47675beb8ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11693dd60>]}
[0m17:57:41.875220 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:57:42.050887 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m17:57:42.098137 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:57:42.098527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e0390cc0-69de-45b2-99b3-47675beb8ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105966f40>]}
[0m17:57:42.871160 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.analytics-engineering.online_marketing.social_media
- models.analytics-engineering.online_marketing
- models.analytics-engineering.offline_marketing
[0m17:57:42.874743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0390cc0-69de-45b2-99b3-47675beb8ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1de130>]}
[0m17:57:42.918115 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:57:42.919382 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:57:42.930385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0390cc0-69de-45b2-99b3-47675beb8ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a29e100>]}
[0m17:57:42.930738 [info ] [MainThread]: Found 3 models, 496 macros
[0m17:57:42.930992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0390cc0-69de-45b2-99b3-47675beb8ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a29e1f0>]}
[0m17:57:42.931798 [info ] [MainThread]: 
[0m17:57:42.932055 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:42.932275 [info ] [MainThread]: 
[0m17:57:42.932610 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:57:42.935385 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_dbt_dev'
[0m17:57:42.935702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:43.539495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0390cc0-69de-45b2-99b3-47675beb8ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a193460>]}
[0m17:57:43.540036 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:43.614762 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m17:57:43.615152 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev, now model.digital_marketing.sea)
[0m17:57:43.615417 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m17:57:43.620923 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m17:57:43.621566 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m17:57:43.621849 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:43.687185 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m17:57:43.687479 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m17:57:43.687745 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m17:57:43.687996 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m17:57:43.690561 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m17:57:43.691798 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m17:57:43.692059 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:43.757326 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m17:57:43.757643 [debug] [Thread-1  ]: Began running node model.digital_marketing.television
[0m17:57:43.757909 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.television)
[0m17:57:43.758154 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.television
[0m17:57:43.759818 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.television"
[0m17:57:43.761068 [debug] [Thread-1  ]: Began executing node model.digital_marketing.television
[0m17:57:43.761319 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:43.826403 [debug] [Thread-1  ]: Finished running node model.digital_marketing.television
[0m17:57:43.826918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:43.827136 [debug] [MainThread]: Connection 'model.digital_marketing.television' was properly closed.
[0m17:57:43.827661 [debug] [MainThread]: Command end result
[0m17:57:43.843642 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:57:43.844660 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:57:43.849204 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m17:57:43.851718 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.9521987, "process_in_blocks": "0", "process_kernel_time": 0.397482, "process_mem_max_rss": "368754688", "process_out_blocks": "0", "process_user_time": 3.439841}
[0m17:57:43.852076 [debug] [MainThread]: Command `dbt compile` succeeded at 17:57:43.852025 after 3.95 seconds
[0m17:57:43.852334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10504afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11693dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2a4d00>]}
[0m17:57:43.852598 [debug] [MainThread]: Flushing usage events
[0m17:57:44.168275 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:59:37.143255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b1af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe5460>]}


============================== 17:59:37.147262 | a41f6e67-6d38-4be0-b3e7-36c01c10e87e ==============================
[0m17:59:37.147262 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:59:37.147689 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'quiet': 'False', 'target_path': 'None', 'profiles_dir': '/Users/azadsolanki/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'static_parser': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'partial_parse': 'True', 'printer_width': '80', 'warn_error': 'None', 'introspect': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile'}
[0m17:59:39.017076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a41f6e67-6d38-4be0-b3e7-36c01c10e87e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ad432b0>]}
[0m17:59:39.053978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a41f6e67-6d38-4be0-b3e7-36c01c10e87e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa22e0>]}
[0m17:59:39.054459 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:59:39.233707 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m17:59:39.280866 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:59:39.281252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a41f6e67-6d38-4be0-b3e7-36c01c10e87e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844a700>]}
[0m17:59:40.055203 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.online_marketing.social_media
- models.offline_marketing
- models.online_marketing
[0m17:59:40.058873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a41f6e67-6d38-4be0-b3e7-36c01c10e87e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b596130>]}
[0m17:59:40.103643 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:59:40.104932 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:59:40.116181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a41f6e67-6d38-4be0-b3e7-36c01c10e87e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c85f070>]}
[0m17:59:40.116541 [info ] [MainThread]: Found 3 models, 496 macros
[0m17:59:40.116790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a41f6e67-6d38-4be0-b3e7-36c01c10e87e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b1dc250>]}
[0m17:59:40.117623 [info ] [MainThread]: 
[0m17:59:40.117882 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:40.118101 [info ] [MainThread]: 
[0m17:59:40.118430 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:59:40.121183 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_dbt_dev'
[0m17:59:40.121499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:40.639871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a41f6e67-6d38-4be0-b3e7-36c01c10e87e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b1ce9d0>]}
[0m17:59:40.640835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:40.742359 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m17:59:40.742688 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev, now model.digital_marketing.sea)
[0m17:59:40.742950 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m17:59:40.748509 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m17:59:40.749015 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m17:59:40.749281 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:59:40.814258 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m17:59:40.814529 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m17:59:40.814784 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m17:59:40.815025 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m17:59:40.817482 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m17:59:40.818263 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m17:59:40.818551 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:59:40.884154 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m17:59:40.884503 [debug] [Thread-1  ]: Began running node model.digital_marketing.television
[0m17:59:40.884777 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.television)
[0m17:59:40.885031 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.television
[0m17:59:40.886748 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.television"
[0m17:59:40.888387 [debug] [Thread-1  ]: Began executing node model.digital_marketing.television
[0m17:59:40.888681 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:59:40.953891 [debug] [Thread-1  ]: Finished running node model.digital_marketing.television
[0m17:59:40.954411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:40.954646 [debug] [MainThread]: Connection 'model.digital_marketing.television' was properly closed.
[0m17:59:40.955174 [debug] [MainThread]: Command end result
[0m17:59:40.973174 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:59:40.974331 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:59:40.979215 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m17:59:40.981879 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.8874924, "process_in_blocks": "0", "process_kernel_time": 0.399487, "process_mem_max_rss": "368541696", "process_out_blocks": "0", "process_user_time": 3.482981}
[0m17:59:40.982269 [debug] [MainThread]: Command `dbt compile` succeeded at 17:59:40.982218 after 3.89 seconds
[0m17:59:40.982540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b1af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa22e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c865df0>]}
[0m17:59:40.982804 [debug] [MainThread]: Flushing usage events
[0m17:59:41.307723 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:00:10.542959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a6af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b5a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b5a460>]}


============================== 18:00:10.546737 | f20069d2-c8d4-483b-971e-d2034ddddf73 ==============================
[0m18:00:10.546737 [info ] [MainThread]: Running with dbt=1.10.10
[0m18:00:10.547140 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'use_colors': 'True', 'version_check': 'True', 'write_json': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'debug': 'False', 'printer_width': '80', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'introspect': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'no_print': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None'}
[0m18:00:12.388922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f20069d2-c8d4-483b-971e-d2034ddddf73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141ec32b0>]}
[0m18:00:12.424922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f20069d2-c8d4-483b-971e-d2034ddddf73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b2a100>]}
[0m18:00:12.425324 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:00:12.601585 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m18:00:12.688006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:00:12.688312 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:00:12.692644 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.online_marketing.social_media
- models.online_marketing
- models.offline_marketing
[0m18:00:12.794575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f20069d2-c8d4-483b-971e-d2034ddddf73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107992c70>]}
[0m18:00:12.838397 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m18:00:12.839969 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m18:00:12.852433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f20069d2-c8d4-483b-971e-d2034ddddf73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141f39eb0>]}
[0m18:00:12.852813 [info ] [MainThread]: Found 3 models, 496 macros
[0m18:00:12.853061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f20069d2-c8d4-483b-971e-d2034ddddf73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1428dc9a0>]}
[0m18:00:12.853905 [info ] [MainThread]: 
[0m18:00:12.854166 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:12.854391 [info ] [MainThread]: 
[0m18:00:12.854727 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:00:12.857588 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m18:00:12.857879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:13.511401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now list_data-products-441119_dbt_dev)
[0m18:00:13.512380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:14.065125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f20069d2-c8d4-483b-971e-d2034ddddf73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104abdb20>]}
[0m18:00:14.066201 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:14.168074 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m18:00:14.168486 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt_dev.sea ........................................ [RUN]
[0m18:00:14.168820 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev, now model.digital_marketing.sea)
[0m18:00:14.169082 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m18:00:14.175737 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m18:00:14.176300 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m18:00:14.196668 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.sea"
[0m18:00:14.197662 [debug] [Thread-1  ]: On model.digital_marketing.sea: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.sea"} */


  create or replace view `data-products-441119`.`dbt_dev`.`sea`
  OPTIONS()
  as 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data;


[0m18:00:14.198007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:00:14.937971 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:a7a02a57-1413-4bfb-ab6d-20ac3c2a1ea2&page=queryresults
[0m18:00:15.383500 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20069d2-c8d4-483b-971e-d2034ddddf73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142d72700>]}
[0m18:00:15.384112 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt_dev.sea ................................... [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m18:00:15.384593 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m18:00:15.384927 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m18:00:15.385345 [info ] [Thread-1  ]: 2 of 3 START sql view model dbt_dev.social_media ............................... [RUN]
[0m18:00:15.385735 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m18:00:15.386054 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m18:00:15.388530 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m18:00:15.389137 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m18:00:15.391963 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.social_media"
[0m18:00:15.392519 [debug] [Thread-1  ]: On model.digital_marketing.social_media: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.social_media"} */


  create or replace view `data-products-441119`.`dbt_dev`.`social_media`
  OPTIONS()
  as 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data;


[0m18:00:15.392850 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:00:16.063867 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:75df047c-b4b7-4e71-9ab4-5ac3f4b4d5b9&page=queryresults
[0m18:00:16.601455 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20069d2-c8d4-483b-971e-d2034ddddf73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10594c8e0>]}
[0m18:00:16.602882 [info ] [Thread-1  ]: 2 of 3 OK created sql view model dbt_dev.social_media .......................... [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m18:00:16.604034 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m18:00:16.604848 [debug] [Thread-1  ]: Began running node model.digital_marketing.television
[0m18:00:16.605906 [info ] [Thread-1  ]: 3 of 3 START sql view model dbt_dev.television ................................. [RUN]
[0m18:00:16.606896 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.television)
[0m18:00:16.607688 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.television
[0m18:00:16.613622 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.television"
[0m18:00:16.614907 [debug] [Thread-1  ]: Began executing node model.digital_marketing.television
[0m18:00:16.619930 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.television"
[0m18:00:16.621125 [debug] [Thread-1  ]: On model.digital_marketing.television: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.television"} */


  create or replace view `data-products-441119`.`dbt_dev`.`television`
  OPTIONS()
  as SELECT 1 AS ad_id, "Pink soap" AS ad_name
UNION ALL
SELECT 2 AS ad_id, "Green shoes" AS ad_name;


[0m18:00:16.621947 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:00:17.222654 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:591e0bcd-cb6e-4f8f-b786-a42675383a08&page=queryresults
[0m18:00:17.607412 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20069d2-c8d4-483b-971e-d2034ddddf73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142d72700>]}
[0m18:00:17.608780 [info ] [Thread-1  ]: 3 of 3 OK created sql view model dbt_dev.television ............................ [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m18:00:17.609908 [debug] [Thread-1  ]: Finished running node model.digital_marketing.television
[0m18:00:17.611537 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:00:17.708563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:17.708893 [debug] [MainThread]: Connection 'model.digital_marketing.television' was properly closed.
[0m18:00:17.709177 [info ] [MainThread]: 
[0m18:00:17.709422 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.85 seconds (4.85s).
[0m18:00:17.710036 [debug] [MainThread]: Command end result
[0m18:00:17.726104 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m18:00:17.727151 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m18:00:17.731286 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m18:00:17.731529 [info ] [MainThread]: 
[0m18:00:17.731802 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:17.732033 [info ] [MainThread]: 
[0m18:00:17.732273 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m18:00:17.734757 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.2372227, "process_in_blocks": "0", "process_kernel_time": 0.441728, "process_mem_max_rss": "368721920", "process_out_blocks": "0", "process_user_time": 3.366771}
[0m18:00:17.735112 [debug] [MainThread]: Command `dbt run` succeeded at 18:00:17.735062 after 7.24 seconds
[0m18:00:17.735367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a6af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10327d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142d876d0>]}
[0m18:00:17.735624 [debug] [MainThread]: Flushing usage events
[0m18:00:18.029062 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:01:56.193201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f2efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063fc160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063fc430>]}


============================== 18:01:56.197222 | 9f610a85-be8d-42b4-8c1b-5005c94a7f3f ==============================
[0m18:01:56.197222 [info ] [MainThread]: Running with dbt=1.10.10
[0m18:01:56.197636 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'target_path': 'None', 'profiles_dir': '/Users/azadsolanki/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'empty': 'False', 'write_json': 'True', 'introspect': 'True', 'no_print': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'static_parser': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select models/online_marketing/social_media.sql', 'warn_error': 'None', 'partial_parse': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'fail_fast': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True'}
[0m18:01:58.075142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f610a85-be8d-42b4-8c1b-5005c94a7f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141c126d0>]}
[0m18:01:58.112636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f610a85-be8d-42b4-8c1b-5005c94a7f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141c554f0>]}
[0m18:01:58.113132 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:01:58.288225 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m18:01:58.373935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:58.374252 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:58.378619 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.online_marketing.social_media
- models.offline_marketing
- models.online_marketing
[0m18:01:58.480735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f610a85-be8d-42b4-8c1b-5005c94a7f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105882b50>]}
[0m18:01:58.525818 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m18:01:58.527230 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m18:01:58.540090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f610a85-be8d-42b4-8c1b-5005c94a7f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106369220>]}
[0m18:01:58.540498 [info ] [MainThread]: Found 3 models, 496 macros
[0m18:01:58.540766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f610a85-be8d-42b4-8c1b-5005c94a7f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10639a550>]}
[0m18:01:58.541536 [info ] [MainThread]: 
[0m18:01:58.541788 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:58.542009 [info ] [MainThread]: 
[0m18:01:58.542345 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:01:58.542906 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m18:01:58.543172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:59.157894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now list_data-products-441119_dbt_dev)
[0m18:01:59.158855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:59.716792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f610a85-be8d-42b4-8c1b-5005c94a7f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ba250>]}
[0m18:01:59.717829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:59.818787 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m18:01:59.819196 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt_dev.social_media ............................... [RUN]
[0m18:01:59.819526 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev, now model.digital_marketing.social_media)
[0m18:01:59.819788 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m18:01:59.826590 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m18:01:59.827311 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m18:01:59.847370 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.social_media"
[0m18:01:59.848089 [debug] [Thread-1  ]: On model.digital_marketing.social_media: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "marketing", "target_name": "dev", "node_id": "model.digital_marketing.social_media"} */


  create or replace view `data-products-441119`.`dbt_dev`.`social_media`
  OPTIONS()
  as 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data;


[0m18:01:59.848469 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:02:00.577852 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:fe9016dd-8e73-4d26-9298-bdcf87f6360d&page=queryresults
[0m18:02:01.034380 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f610a85-be8d-42b4-8c1b-5005c94a7f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a3640>]}
[0m18:02:01.035022 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt_dev.social_media .......................... [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m18:02:01.035540 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m18:02:01.036254 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:02:01.105401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:01.105738 [debug] [MainThread]: Connection 'model.digital_marketing.social_media' was properly closed.
[0m18:02:01.105985 [info ] [MainThread]: 
[0m18:02:01.106242 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m18:02:01.106694 [debug] [MainThread]: Command end result
[0m18:02:01.121817 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m18:02:01.122807 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m18:02:01.126885 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m18:02:01.127141 [info ] [MainThread]: 
[0m18:02:01.127438 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:02:01.127673 [info ] [MainThread]: 
[0m18:02:01.127918 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:02:01.130457 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.9849653, "process_in_blocks": "0", "process_kernel_time": 0.420131, "process_mem_max_rss": "369836032", "process_out_blocks": "0", "process_user_time": 3.022578}
[0m18:02:01.130817 [debug] [MainThread]: Command `dbt run` succeeded at 18:02:01.130767 after 4.99 seconds
[0m18:02:01.131080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f2efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058824f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141c126d0>]}
[0m18:02:01.131338 [debug] [MainThread]: Flushing usage events
[0m18:02:01.475038 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:21:55.172336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105442fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106912190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106912460>]}


============================== 22:21:55.176390 | 84a0d148-2b64-4f7a-9cbb-a7b6d951bb3f ==============================
[0m22:21:55.176390 [info ] [MainThread]: Running with dbt=1.10.10
[0m22:21:55.176806 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'profiles_dir': '/Users/azadsolanki/.dbt', 'partial_parse': 'True', 'target_path': 'None', 'no_print': 'None', 'empty': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'quiet': 'False', 'use_colors': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'write_json': 'True', 'printer_width': '80', 'static_parser': 'True', 'invocation_command': 'dbt ls -s online_marketing'}
[0m22:21:57.164100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84a0d148-2b64-4f7a-9cbb-a7b6d951bb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c455b20>]}
[0m22:21:57.199879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84a0d148-2b64-4f7a-9cbb-a7b6d951bb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c5c09d0>]}
[0m22:21:57.200291 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:21:57.379050 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m22:21:57.466445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:21:57.466831 [debug] [MainThread]: Partial parsing: added file: digital_marketing://macros/generate_schema_name.sql
[0m22:21:57.468851 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m22:21:58.199074 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.offline_marketing
- models.online_marketing
- models.online_marketing.social_media
[0m22:21:58.202612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84a0d148-2b64-4f7a-9cbb-a7b6d951bb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d4fe130>]}
[0m22:21:58.245854 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:21:58.247269 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:21:58.258968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84a0d148-2b64-4f7a-9cbb-a7b6d951bb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2d1970>]}
[0m22:21:58.259376 [info ] [MainThread]: Found 3 models, 497 macros
[0m22:21:58.259663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84a0d148-2b64-4f7a-9cbb-a7b6d951bb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d550af0>]}
[0m22:21:58.260055 [info ] [MainThread]: digital_marketing.online_marketing.sea
[0m22:21:58.260298 [info ] [MainThread]: digital_marketing.online_marketing.social_media
[0m22:21:58.263306 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 3.1403797, "process_in_blocks": "0", "process_kernel_time": 0.430374, "process_mem_max_rss": "364199936", "process_out_blocks": "0", "process_user_time": 3.026463}
[0m22:21:58.263677 [debug] [MainThread]: Command `dbt ls` succeeded at 22:21:58.263621 after 3.14 seconds
[0m22:21:58.263943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105442fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049110d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d5508b0>]}
[0m22:21:58.264192 [debug] [MainThread]: Flushing usage events
[0m22:21:58.643389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:44:03.845509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037fbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc7160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc7460>]}


============================== 22:44:03.848473 | c94a138c-df38-4b50-837d-0ef38ad1c1ae ==============================
[0m22:44:03.848473 [info ] [MainThread]: Running with dbt=1.10.10
[0m22:44:03.848917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'warn_error': 'None', 'log_cache_events': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'quiet': 'False', 'version_check': 'True', 'empty': 'None', 'write_json': 'True', 'target_path': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt clean', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'no_print': 'None', 'introspect': 'True'}
[0m22:44:03.941639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c94a138c-df38-4b50-837d-0ef38ad1c1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc7460>]}
[0m22:44:03.956209 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.15844588, "process_in_blocks": "0", "process_kernel_time": 0.13429, "process_mem_max_rss": "99811328", "process_out_blocks": "0", "process_user_time": 0.906586}
[0m22:44:03.956643 [debug] [MainThread]: Command `dbt clean` succeeded at 22:44:03.956584 after 0.16 seconds
[0m22:44:03.956907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037fbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c71580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e7fca0>]}
[0m22:44:03.957179 [debug] [MainThread]: Flushing usage events
[0m22:44:04.269381 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:56:16.158900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10577bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c45190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c45490>]}


============================== 22:56:16.161977 | 03cb29c2-1b4f-46b6-ae9f-6fcaa09ea96e ==============================
[0m22:56:16.161977 [info ] [MainThread]: Running with dbt=1.10.10
[0m22:56:16.162391 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'introspect': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'log_cache_events': 'False', 'log_format': 'default', 'profiles_dir': '/Users/azadsolanki/.dbt', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'no_print': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt compile', 'printer_width': '80', 'partial_parse': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'version_check': 'True', 'debug': 'False'}
[0m22:56:18.262627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03cb29c2-1b4f-46b6-ae9f-6fcaa09ea96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104825f70>]}
[0m22:56:18.298513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03cb29c2-1b4f-46b6-ae9f-6fcaa09ea96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba2640>]}
[0m22:56:18.298922 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:56:18.477544 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m22:56:18.478113 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:56:18.478390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '03cb29c2-1b4f-46b6-ae9f-6fcaa09ea96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a0bd30>]}
[0m22:56:19.348800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03cb29c2-1b4f-46b6-ae9f-6fcaa09ea96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12910e130>]}
[0m22:56:19.400841 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:56:19.402183 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:56:19.415678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03cb29c2-1b4f-46b6-ae9f-6fcaa09ea96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1290d5fd0>]}
[0m22:56:19.416089 [info ] [MainThread]: Found 3 models, 1 source, 497 macros
[0m22:56:19.416347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03cb29c2-1b4f-46b6-ae9f-6fcaa09ea96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1290de790>]}
[0m22:56:19.417212 [info ] [MainThread]: 
[0m22:56:19.417478 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:56:19.417702 [info ] [MainThread]: 
[0m22:56:19.418047 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:56:19.420847 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_dbt_dev'
[0m22:56:19.421095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:20.008158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03cb29c2-1b4f-46b6-ae9f-6fcaa09ea96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb8850>]}
[0m22:56:20.009124 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:56:20.109580 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m22:56:20.109987 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev, now model.digital_marketing.sea)
[0m22:56:20.110259 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m22:56:20.115902 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m22:56:20.116578 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m22:56:20.116864 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:56:20.183294 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m22:56:20.183646 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m22:56:20.183927 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m22:56:20.184174 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m22:56:20.186387 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m22:56:20.186916 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m22:56:20.187189 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:56:20.253085 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m22:56:20.253447 [debug] [Thread-1  ]: Began running node model.digital_marketing.television
[0m22:56:20.253723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.television)
[0m22:56:20.253976 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.television
[0m22:56:20.255684 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.television"
[0m22:56:20.256362 [debug] [Thread-1  ]: Began executing node model.digital_marketing.television
[0m22:56:20.256658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:56:20.322430 [debug] [Thread-1  ]: Finished running node model.digital_marketing.television
[0m22:56:20.323132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:56:20.323368 [debug] [MainThread]: Connection 'model.digital_marketing.television' was properly closed.
[0m22:56:20.323926 [debug] [MainThread]: Command end result
[0m22:56:20.340427 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:56:20.341456 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:56:20.345834 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m22:56:20.348704 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.242186, "process_in_blocks": "0", "process_kernel_time": 0.467475, "process_mem_max_rss": "360136704", "process_out_blocks": "0", "process_user_time": 3.593296}
[0m22:56:20.349129 [debug] [MainThread]: Command `dbt compile` succeeded at 22:56:20.349044 after 4.24 seconds
[0m22:56:20.349396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10577bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104825f70>]}
[0m22:56:20.349667 [debug] [MainThread]: Flushing usage events
[0m22:56:20.665052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:56:33.173661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10472afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dca280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dca580>]}


============================== 22:56:33.176699 | 842e8ff4-76b1-461b-bee0-a1bd87389c97 ==============================
[0m22:56:33.176699 [info ] [MainThread]: Running with dbt=1.10.10
[0m22:56:33.177140 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_format': 'default', 'target_path': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'printer_width': '80', 'use_colors': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'quiet': 'False', 'write_json': 'True', 'partial_parse': 'True', 'no_print': 'None', 'version_check': 'True'}
[0m22:56:33.258787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '842e8ff4-76b1-461b-bee0-a1bd87389c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cb0d0>]}
[0m22:56:33.271861 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.14598545, "process_in_blocks": "0", "process_kernel_time": 0.112506, "process_mem_max_rss": "100122624", "process_out_blocks": "0", "process_user_time": 0.913167}
[0m22:56:33.272272 [debug] [MainThread]: Command `dbt clean` succeeded at 22:56:33.272214 after 0.15 seconds
[0m22:56:33.272536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10472afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dcacd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107093d60>]}
[0m22:56:33.272801 [debug] [MainThread]: Flushing usage events
[0m22:56:33.592149 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:56:41.905933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eeafa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096b5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096b5460>]}


============================== 22:56:41.908936 | 9b4a5cff-1fd5-4d28-b8bd-c04b9432170f ==============================
[0m22:56:41.908936 [info ] [MainThread]: Running with dbt=1.10.10
[0m22:56:41.909364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'invocation_command': 'dbt compile', 'profiles_dir': '/Users/azadsolanki/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'empty': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'no_print': 'None', 'debug': 'False', 'version_check': 'True', 'static_parser': 'True', 'log_format': 'default', 'partial_parse': 'True'}
[0m22:56:43.742061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b4a5cff-1fd5-4d28-b8bd-c04b9432170f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e9310>]}
[0m22:56:43.778987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b4a5cff-1fd5-4d28-b8bd-c04b9432170f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e71c0>]}
[0m22:56:43.779505 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:56:43.956234 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m22:56:43.956779 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:56:43.957060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9b4a5cff-1fd5-4d28-b8bd-c04b9432170f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c53b4f0>]}
[0m22:56:44.827949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b4a5cff-1fd5-4d28-b8bd-c04b9432170f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cc8b130>]}
[0m22:56:44.879219 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:56:44.880588 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:56:44.893639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b4a5cff-1fd5-4d28-b8bd-c04b9432170f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e6100>]}
[0m22:56:44.894058 [info ] [MainThread]: Found 3 models, 1 source, 497 macros
[0m22:56:44.894316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b4a5cff-1fd5-4d28-b8bd-c04b9432170f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cc0ed30>]}
[0m22:56:44.895178 [info ] [MainThread]: 
[0m22:56:44.895443 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:56:44.895668 [info ] [MainThread]: 
[0m22:56:44.896029 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:56:44.898884 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_dbt_dev'
[0m22:56:44.899159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:45.400891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b4a5cff-1fd5-4d28-b8bd-c04b9432170f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e1dc10>]}
[0m22:56:45.401905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:56:45.501262 [debug] [Thread-1  ]: Began running node model.digital_marketing.sea
[0m22:56:45.501639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev, now model.digital_marketing.sea)
[0m22:56:45.501901 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.sea
[0m22:56:45.507579 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.sea"
[0m22:56:45.508273 [debug] [Thread-1  ]: Began executing node model.digital_marketing.sea
[0m22:56:45.508548 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:56:45.574255 [debug] [Thread-1  ]: Finished running node model.digital_marketing.sea
[0m22:56:45.574574 [debug] [Thread-1  ]: Began running node model.digital_marketing.social_media
[0m22:56:45.574841 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.sea, now model.digital_marketing.social_media)
[0m22:56:45.575086 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.social_media
[0m22:56:45.577243 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.social_media"
[0m22:56:45.577843 [debug] [Thread-1  ]: Began executing node model.digital_marketing.social_media
[0m22:56:45.578117 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:56:45.643944 [debug] [Thread-1  ]: Finished running node model.digital_marketing.social_media
[0m22:56:45.644350 [debug] [Thread-1  ]: Began running node model.digital_marketing.television
[0m22:56:45.644666 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.social_media, now model.digital_marketing.television)
[0m22:56:45.644975 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.television
[0m22:56:45.646680 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.television"
[0m22:56:45.647234 [debug] [Thread-1  ]: Began executing node model.digital_marketing.television
[0m22:56:45.647507 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:56:45.714537 [debug] [Thread-1  ]: Finished running node model.digital_marketing.television
[0m22:56:45.715194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:56:45.715461 [debug] [MainThread]: Connection 'model.digital_marketing.television' was properly closed.
[0m22:56:45.716041 [debug] [MainThread]: Command end result
[0m22:56:45.732457 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:56:45.733504 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:56:45.738773 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m22:56:45.741452 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.8816645, "process_in_blocks": "0", "process_kernel_time": 0.396731, "process_mem_max_rss": "366542848", "process_out_blocks": "0", "process_user_time": 3.557648}
[0m22:56:45.741830 [debug] [MainThread]: Command `dbt compile` succeeded at 22:56:45.741779 after 3.88 seconds
[0m22:56:45.742095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eeafa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e71c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e6100>]}
[0m22:56:45.742356 [debug] [MainThread]: Flushing usage events
[0m22:56:46.055432 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:50:39.266295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a27d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee5af0>]}


============================== 17:50:39.269294 | f4709c09-6a2b-4256-8fba-f6a5e3ebaa22 ==============================
[0m17:50:39.269294 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:50:39.269686 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'invocation_command': 'dbt debug', 'warn_error': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_format': 'default', 'version_check': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'profiles_dir': '/Users/azadsolanki/.dbt', 'target_path': 'None', 'introspect': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'debug': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'empty': 'None', 'partial_parse': 'True'}
[0m17:50:39.281308 [info ] [MainThread]: dbt version: 1.10.10
[0m17:50:39.281639 [info ] [MainThread]: python version: 3.9.6
[0m17:50:39.281866 [info ] [MainThread]: python path: /Users/azadsolanki/dev/data-engineering/airflow-env/bin/python3
[0m17:50:39.282082 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m17:50:43.405115 [info ] [MainThread]: Using profiles dir at /Users/azadsolanki/.dbt
[0m17:50:43.405466 [info ] [MainThread]: Using profiles.yml file at /Users/azadsolanki/.dbt/profiles.yml
[0m17:50:43.405695 [info ] [MainThread]: Using dbt_project.yml file at /Users/azadsolanki/dev/data-engineering/analytics-engineering/dbt_project.yml
[0m17:50:43.405917 [info ] [MainThread]: adapter type: bigquery
[0m17:50:43.406119 [info ] [MainThread]: adapter version: 1.10.1
[0m17:50:43.471351 [info ] [MainThread]: Configuration:
[0m17:50:43.471720 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:50:43.471950 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:50:43.472161 [info ] [MainThread]: Required dependencies:
[0m17:50:43.472435 [debug] [MainThread]: Executing "git --help"
[0m17:50:43.494696 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:50:43.495344 [debug] [MainThread]: STDERR: "b''"
[0m17:50:43.495616 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:50:43.495866 [info ] [MainThread]: Connection:
[0m17:50:43.496177 [info ] [MainThread]:   method: service-account
[0m17:50:43.496384 [info ] [MainThread]:   database: data-products-441119
[0m17:50:43.496591 [info ] [MainThread]:   execution_project: data-products-441119
[0m17:50:43.496795 [info ] [MainThread]:   schema: dbt_dev
[0m17:50:43.497004 [info ] [MainThread]:   location: US
[0m17:50:43.497202 [info ] [MainThread]:   priority: interactive
[0m17:50:43.497403 [info ] [MainThread]:   maximum_bytes_billed: None
[0m17:50:43.497602 [info ] [MainThread]:   impersonate_service_account: None
[0m17:50:43.497799 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m17:50:43.497998 [info ] [MainThread]:   job_retries: 1
[0m17:50:43.498330 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m17:50:43.498598 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m17:50:43.498831 [info ] [MainThread]:   timeout_seconds: 300
[0m17:50:43.499042 [info ] [MainThread]:   client_id: None
[0m17:50:43.499249 [info ] [MainThread]:   token_uri: None
[0m17:50:43.499450 [info ] [MainThread]:   compute_region: None
[0m17:50:43.499648 [info ] [MainThread]:   dataproc_cluster_name: None
[0m17:50:43.499847 [info ] [MainThread]:   gcs_bucket: None
[0m17:50:43.500043 [info ] [MainThread]:   dataproc_batch: None
[0m17:50:43.500523 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:50:43.693511 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m17:50:43.693937 [debug] [MainThread]: On debug: select 1 as id
[0m17:50:43.694185 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:44.788566 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:b6398c58-0c60-4b65-94e7-bf10d36e0265&page=queryresults
[0m17:50:45.612017 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:50:45.613250 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:50:45.642514 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 6.426498, "process_in_blocks": "0", "process_kernel_time": 0.509974, "process_mem_max_rss": "362201088", "process_out_blocks": "0", "process_user_time": 2.562148}
[0m17:50:45.643624 [debug] [MainThread]: Command `dbt debug` succeeded at 17:50:45.643460 after 6.43 seconds
[0m17:50:45.644249 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:50:45.644877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a27d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126c85fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13499a670>]}
[0m17:50:45.645548 [debug] [MainThread]: Flushing usage events
[0m17:50:45.969027 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:15:18.221702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031f7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b9af0>]}


============================== 19:15:18.225811 | e2fb8428-2d1f-4333-9c5f-a34a3717bee7 ==============================
[0m19:15:18.225811 [info ] [MainThread]: Running with dbt=1.10.10
[0m19:15:18.226246 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error': 'None', 'write_json': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'static_parser': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'no_print': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'debug': 'False', 'use_colors': 'True'}
[0m19:15:18.237146 [info ] [MainThread]: dbt version: 1.10.10
[0m19:15:18.237482 [info ] [MainThread]: python version: 3.9.6
[0m19:15:18.237712 [info ] [MainThread]: python path: /Users/azadsolanki/dev/data-engineering/airflow-env/bin/python3
[0m19:15:18.237929 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m19:15:20.103887 [info ] [MainThread]: Using profiles dir at /Users/azadsolanki/.dbt
[0m19:15:20.104240 [info ] [MainThread]: Using profiles.yml file at /Users/azadsolanki/.dbt/profiles.yml
[0m19:15:20.104466 [info ] [MainThread]: Using dbt_project.yml file at /Users/azadsolanki/dev/data-engineering/analytics-engineering/dbt_project.yml
[0m19:15:20.104691 [info ] [MainThread]: adapter type: bigquery
[0m19:15:20.104896 [info ] [MainThread]: adapter version: 1.10.1
[0m19:15:20.174003 [info ] [MainThread]: Configuration:
[0m19:15:20.174363 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:15:20.174595 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:15:20.174803 [info ] [MainThread]: Required dependencies:
[0m19:15:20.175066 [debug] [MainThread]: Executing "git --help"
[0m19:15:20.194469 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:15:20.195105 [debug] [MainThread]: STDERR: "b''"
[0m19:15:20.195386 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:15:20.195630 [info ] [MainThread]: Connection:
[0m19:15:20.195945 [info ] [MainThread]:   method: service-account
[0m19:15:20.196158 [info ] [MainThread]:   database: data-products-441119
[0m19:15:20.196361 [info ] [MainThread]:   execution_project: data-products-441119
[0m19:15:20.196561 [info ] [MainThread]:   schema: dbt_dev_analytics
[0m19:15:20.196760 [info ] [MainThread]:   location: US
[0m19:15:20.196959 [info ] [MainThread]:   priority: interactive
[0m19:15:20.197158 [info ] [MainThread]:   maximum_bytes_billed: None
[0m19:15:20.197353 [info ] [MainThread]:   impersonate_service_account: None
[0m19:15:20.197551 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m19:15:20.197746 [info ] [MainThread]:   job_retries: 1
[0m19:15:20.197943 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m19:15:20.198139 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m19:15:20.198332 [info ] [MainThread]:   timeout_seconds: 300
[0m19:15:20.198529 [info ] [MainThread]:   client_id: None
[0m19:15:20.198723 [info ] [MainThread]:   token_uri: None
[0m19:15:20.198917 [info ] [MainThread]:   compute_region: None
[0m19:15:20.199112 [info ] [MainThread]:   dataproc_cluster_name: None
[0m19:15:20.199305 [info ] [MainThread]:   gcs_bucket: None
[0m19:15:20.199499 [info ] [MainThread]:   dataproc_batch: None
[0m19:15:20.199995 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:15:20.370500 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m19:15:20.370933 [debug] [MainThread]: On debug: select 1 as id
[0m19:15:20.371198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:15:21.366392 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:78fea1c2-327e-4fa7-a76d-961f5512f0bf&page=queryresults
[0m19:15:21.906831 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:15:21.908061 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:15:21.917500 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.7514215, "process_in_blocks": "0", "process_kernel_time": 0.447421, "process_mem_max_rss": "358809600", "process_out_blocks": "0", "process_user_time": 2.372483}
[0m19:15:21.918736 [debug] [MainThread]: Command `dbt debug` succeeded at 19:15:21.918556 after 3.75 seconds
[0m19:15:21.919646 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:15:21.920438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031f7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046538b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104666df0>]}
[0m19:15:21.921297 [debug] [MainThread]: Flushing usage events
[0m19:15:22.232366 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:43:59.528705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c3df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c85880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c85b50>]}


============================== 19:43:59.532618 | 4b10cca4-4b30-41c7-a220-c144acfba9ec ==============================
[0m19:43:59.532618 [info ] [MainThread]: Running with dbt=1.10.10
[0m19:43:59.533009 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'use_experimental_parser': 'False', 'static_parser': 'True', 'empty': 'None', 'printer_width': '80', 'version_check': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'quiet': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'partial_parse': 'True', 'fail_fast': 'False', 'warn_error': 'None'}
[0m19:43:59.543391 [info ] [MainThread]: dbt version: 1.10.10
[0m19:43:59.543773 [info ] [MainThread]: python version: 3.9.6
[0m19:43:59.544102 [info ] [MainThread]: python path: /Users/azadsolanki/dev/data-engineering/airflow-env/bin/python3
[0m19:43:59.544380 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m19:44:01.361523 [info ] [MainThread]: Using profiles dir at /Users/azadsolanki/.dbt
[0m19:44:01.361873 [info ] [MainThread]: Using profiles.yml file at /Users/azadsolanki/.dbt/profiles.yml
[0m19:44:01.362100 [info ] [MainThread]: Using dbt_project.yml file at /Users/azadsolanki/dev/data-engineering/analytics-engineering/dbt_project.yml
[0m19:44:01.362330 [info ] [MainThread]: adapter type: bigquery
[0m19:44:01.362532 [info ] [MainThread]: adapter version: 1.10.1
[0m19:44:01.441244 [info ] [MainThread]: Configuration:
[0m19:44:01.441618 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:44:01.441837 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:44:01.442039 [info ] [MainThread]: Required dependencies:
[0m19:44:01.442310 [debug] [MainThread]: Executing "git --help"
[0m19:44:01.462615 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:44:01.463282 [debug] [MainThread]: STDERR: "b''"
[0m19:44:01.463542 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:44:01.463799 [info ] [MainThread]: Connection:
[0m19:44:01.464102 [info ] [MainThread]:   method: service-account
[0m19:44:01.464312 [info ] [MainThread]:   database: data-products-441119
[0m19:44:01.464514 [info ] [MainThread]:   execution_project: data-products-441119
[0m19:44:01.464715 [info ] [MainThread]:   schema: dbt_dev_analytics
[0m19:44:01.464918 [info ] [MainThread]:   location: US
[0m19:44:01.465119 [info ] [MainThread]:   priority: interactive
[0m19:44:01.465318 [info ] [MainThread]:   maximum_bytes_billed: None
[0m19:44:01.465515 [info ] [MainThread]:   impersonate_service_account: None
[0m19:44:01.465711 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m19:44:01.465907 [info ] [MainThread]:   job_retries: 1
[0m19:44:01.466103 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m19:44:01.466299 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m19:44:01.466496 [info ] [MainThread]:   timeout_seconds: 300
[0m19:44:01.466692 [info ] [MainThread]:   client_id: None
[0m19:44:01.466887 [info ] [MainThread]:   token_uri: None
[0m19:44:01.467087 [info ] [MainThread]:   compute_region: None
[0m19:44:01.467283 [info ] [MainThread]:   dataproc_cluster_name: None
[0m19:44:01.467478 [info ] [MainThread]:   gcs_bucket: None
[0m19:44:01.467673 [info ] [MainThread]:   dataproc_batch: None
[0m19:44:01.468125 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:44:01.636642 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m19:44:01.637077 [debug] [MainThread]: On debug: select 1 as id
[0m19:44:01.637335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:44:02.415757 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:e89f4aed-06de-4c33-80ab-3343ba3bfa03&page=queryresults
[0m19:44:02.944360 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:44:02.945325 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:44:02.954123 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.4753535, "process_in_blocks": "0", "process_kernel_time": 0.431719, "process_mem_max_rss": "361922560", "process_out_blocks": "0", "process_user_time": 2.326868}
[0m19:44:02.955419 [debug] [MainThread]: Command `dbt debug` succeeded at 19:44:02.955223 after 3.48 seconds
[0m19:44:02.956059 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:44:02.956695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c3df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c85160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1393e08b0>]}
[0m19:44:02.957367 [debug] [MainThread]: Flushing usage events
[0m19:44:03.310829 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:07:50.010199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dbbe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627dc40>]}


============================== 21:07:50.014138 | 43fe639b-4c7d-4a50-b977-607e635c56d0 ==============================
[0m21:07:50.014138 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:07:50.014554 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'invocation_command': 'dbt parse', 'static_parser': 'True', 'printer_width': '80', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'version_check': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'use_colors': 'True', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'write_json': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'empty': 'None', 'cache_selected_only': 'False'}
[0m21:07:52.357837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43fe639b-4c7d-4a50-b977-607e635c56d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f3b430>]}
[0m21:07:52.395273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43fe639b-4c7d-4a50-b977-607e635c56d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127fc2df0>]}
[0m21:07:52.395686 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:07:52.576509 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 3 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m21:07:52.588007 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 2.6313636, "process_in_blocks": "0", "process_kernel_time": 0.450217, "process_mem_max_rss": "349224960", "process_out_blocks": "0", "process_user_time": 2.291464}
[0m21:07:52.588607 [debug] [MainThread]: Command `dbt parse` failed at 21:07:52.588531 after 2.63 seconds
[0m21:07:52.588973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dbbe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1301caf10>]}
[0m21:07:52.589277 [debug] [MainThread]: Flushing usage events
[0m21:07:52.947418 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:08:43.842873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10711bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085dc790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085dca60>]}


============================== 21:08:43.846062 | b012e841-4d8b-445e-8f37-846733be4964 ==============================
[0m21:08:43.846062 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:08:43.846429 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'empty': 'None', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'invocation_command': 'dbt deps', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None', 'use_colors': 'True', 'version_check': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'warn_error': 'None', 'quiet': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'debug': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'fail_fast': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'introspect': 'True'}
[0m21:08:43.933309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b012e841-4d8b-445e-8f37-846733be4964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c5340>]}
[0m21:08:43.948383 [debug] [MainThread]: Set downloads directory='/var/folders/c8/gn1lrrq12g70rs4vwktnqdf80000gn/T/dbt-downloads-t9ufp4ks'
[0m21:08:43.948812 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:08:44.026448 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:08:44.027945 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:08:44.076216 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:08:44.084289 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m21:08:44.123829 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m21:08:44.125755 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m21:08:44.126155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b012e841-4d8b-445e-8f37-846733be4964', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f14f0>]}
[0m21:08:44.129168 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/elementary-data/elementary.json
[0m21:08:44.402254 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/elementary-data/elementary.json 200
[0m21:08:44.422818 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m21:08:44.579043 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m21:08:44.613896 [info ] [MainThread]: Updating lock file in file path: /Users/azadsolanki/dev/data-engineering/analytics-engineering/package-lock.yml
[0m21:08:44.619233 [debug] [MainThread]: Set downloads directory='/var/folders/c8/gn1lrrq12g70rs4vwktnqdf80000gn/T/dbt-downloads-buxs5vm6'
[0m21:08:44.637609 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:08:45.025502 [info ] [MainThread]: Installed from version 1.1.1
[0m21:08:45.025887 [info ] [MainThread]: Updated version available: 1.3.0
[0m21:08:45.026193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b012e841-4d8b-445e-8f37-846733be4964', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ced30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073debe0>]}
[0m21:08:45.026519 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m21:08:45.646595 [info ] [MainThread]: Installed from version 0.10.1
[0m21:08:45.646957 [info ] [MainThread]: Updated version available: 0.10.4
[0m21:08:45.647234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b012e841-4d8b-445e-8f37-846733be4964', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108894400>]}
[0m21:08:45.647529 [info ] [MainThread]: Installing elementary-data/elementary
[0m21:08:46.138297 [info ] [MainThread]: Installed from version 0.13.1
[0m21:08:46.138648 [info ] [MainThread]: Updated version available: 0.19.4
[0m21:08:46.138919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b012e841-4d8b-445e-8f37-846733be4964', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ec070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740bc40>]}
[0m21:08:46.139204 [info ] [MainThread]: Installing calogica/dbt_date
[0m21:08:46.398711 [info ] [MainThread]: Installed from version 0.10.1
[0m21:08:46.399186 [info ] [MainThread]: Up to date!
[0m21:08:46.399584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b012e841-4d8b-445e-8f37-846733be4964', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ee8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108731c10>]}
[0m21:08:46.400027 [info ] [MainThread]: 
[0m21:08:46.400386 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_expectations', 'elementary-data/elementary']                 
Update your versions in packages.yml, then run dbt deps
[0m21:08:46.402041 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:08:46.404340 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.6060889, "process_in_blocks": "0", "process_kernel_time": 0.256175, "process_mem_max_rss": "115343360", "process_out_blocks": "0", "process_user_time": 1.310174}
[0m21:08:46.404948 [debug] [MainThread]: Command `dbt deps` succeeded at 21:08:46.404857 after 2.61 seconds
[0m21:08:46.405428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10711bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073cb100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073debe0>]}
[0m21:08:46.405891 [debug] [MainThread]: Flushing usage events
[0m21:08:46.724946 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:09:01.292706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d67e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104229970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104229c40>]}


============================== 21:09:01.296247 | 2bbe6c55-8254-43c2-bde7-e7d0703ee73d ==============================
[0m21:09:01.296247 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:09:01.296633 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'cache_selected_only': 'False', 'quiet': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'warn_error': 'None', 'write_json': 'True', 'target_path': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt debug', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'version_check': 'True', 'static_parser': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'use_colors': 'True', 'empty': 'None', 'partial_parse': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:09:01.305799 [info ] [MainThread]: dbt version: 1.10.10
[0m21:09:01.306396 [info ] [MainThread]: python version: 3.9.6
[0m21:09:01.306660 [info ] [MainThread]: python path: /Users/azadsolanki/dev/data-engineering/airflow-env/bin/python3
[0m21:09:01.306880 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m21:09:02.989650 [info ] [MainThread]: Using profiles dir at /Users/azadsolanki/.dbt
[0m21:09:02.990025 [info ] [MainThread]: Using profiles.yml file at /Users/azadsolanki/.dbt/profiles.yml
[0m21:09:02.990247 [info ] [MainThread]: Using dbt_project.yml file at /Users/azadsolanki/dev/data-engineering/analytics-engineering/dbt_project.yml
[0m21:09:02.990471 [info ] [MainThread]: adapter type: bigquery
[0m21:09:02.990672 [info ] [MainThread]: adapter version: 1.10.1
[0m21:09:03.097825 [info ] [MainThread]: Configuration:
[0m21:09:03.098194 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:09:03.098409 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:09:03.098616 [info ] [MainThread]: Required dependencies:
[0m21:09:03.098894 [debug] [MainThread]: Executing "git --help"
[0m21:09:03.116875 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:09:03.117537 [debug] [MainThread]: STDERR: "b''"
[0m21:09:03.117808 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:09:03.118078 [info ] [MainThread]: Connection:
[0m21:09:03.118386 [info ] [MainThread]:   method: service-account
[0m21:09:03.118710 [info ] [MainThread]:   database: data-products-441119
[0m21:09:03.119126 [info ] [MainThread]:   execution_project: data-products-441119
[0m21:09:03.119406 [info ] [MainThread]:   schema: dbt_dev_analytics
[0m21:09:03.119625 [info ] [MainThread]:   location: US
[0m21:09:03.119838 [info ] [MainThread]:   priority: interactive
[0m21:09:03.120044 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:09:03.120243 [info ] [MainThread]:   impersonate_service_account: None
[0m21:09:03.120444 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:09:03.120641 [info ] [MainThread]:   job_retries: 1
[0m21:09:03.120837 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:09:03.121035 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m21:09:03.121355 [info ] [MainThread]:   timeout_seconds: 300
[0m21:09:03.121650 [info ] [MainThread]:   client_id: None
[0m21:09:03.121890 [info ] [MainThread]:   token_uri: None
[0m21:09:03.122102 [info ] [MainThread]:   compute_region: None
[0m21:09:03.122305 [info ] [MainThread]:   dataproc_cluster_name: None
[0m21:09:03.122587 [info ] [MainThread]:   gcs_bucket: None
[0m21:09:03.122918 [info ] [MainThread]:   dataproc_batch: None
[0m21:09:03.123633 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:09:03.295160 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:09:03.295603 [debug] [MainThread]: On debug: select 1 as id
[0m21:09:03.295860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:09:04.313775 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:0d1fdd35-ce19-412d-aed1-15051cab5353&page=queryresults
[0m21:09:04.832861 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:09:04.833813 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:09:04.841498 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.5954118, "process_in_blocks": "0", "process_kernel_time": 0.380665, "process_mem_max_rss": "362266624", "process_out_blocks": "0", "process_user_time": 2.36912}
[0m21:09:04.843565 [debug] [MainThread]: Command `dbt debug` succeeded at 21:09:04.843307 after 3.60 seconds
[0m21:09:04.844288 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:09:04.844944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d67e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041df2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ec02790>]}
[0m21:09:04.845657 [debug] [MainThread]: Flushing usage events
[0m21:09:05.148826 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:09:09.218936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035efdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab1b50>]}


============================== 21:09:09.222246 | 7481c431-561e-4967-8bc6-f4cf0b58ac11 ==============================
[0m21:09:09.222246 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:09:09.222640 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'invocation_command': 'dbt clean', 'version_check': 'True', 'quiet': 'False', 'printer_width': '80', 'warn_error': 'None', 'empty': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'target_path': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs'}
[0m21:09:09.310111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7481c431-561e-4967-8bc6-f4cf0b58ac11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1e3d0>]}
[0m21:09:09.380515 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20672324, "process_in_blocks": "0", "process_kernel_time": 0.148171, "process_mem_max_rss": "99975168", "process_out_blocks": "0", "process_user_time": 0.897384}
[0m21:09:09.381133 [debug] [MainThread]: Command `dbt clean` succeeded at 21:09:09.381043 after 0.21 seconds
[0m21:09:09.381458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035efdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f08ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c7ad60>]}
[0m21:09:09.381751 [debug] [MainThread]: Flushing usage events
[0m21:09:09.682321 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:10:42.660173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10307fd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104543a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104543cd0>]}


============================== 21:10:42.663494 | 30916d3b-5939-4d66-8777-a22977b7f161 ==============================
[0m21:10:42.663494 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:10:42.663868 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'debug': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --models tag:staging', 'introspect': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'no_print': 'None', 'target_path': 'None', 'partial_parse': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'write_json': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'empty': 'False', 'quiet': 'False', 'static_parser': 'True', 'cache_selected_only': 'False'}
[0m21:10:42.664182 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:10:42.664439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '30916d3b-5939-4d66-8777-a22977b7f161', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104543a00>]}
[0m21:10:44.102988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30916d3b-5939-4d66-8777-a22977b7f161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020f1e80>]}
[0m21:10:44.139929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30916d3b-5939-4d66-8777-a22977b7f161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117ae3070>]}
[0m21:10:44.140321 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:10:44.314501 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 3 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m21:10:44.315078 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:10:44.318204 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7020255, "process_in_blocks": "0", "process_kernel_time": 0.286959, "process_mem_max_rss": "348848128", "process_out_blocks": "0", "process_user_time": 2.168951}
[0m21:10:44.318717 [debug] [MainThread]: Command `dbt run` failed at 21:10:44.318652 after 1.70 seconds
[0m21:10:44.319029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10307fd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117cdcbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117cdcb50>]}
[0m21:10:44.319319 [debug] [MainThread]: Flushing usage events
[0m21:10:44.636066 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:11:54.265269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10352fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a00190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a00460>]}


============================== 21:11:54.268701 | e69318a0-8a92-4cbb-95d3-05360992b7d7 ==============================
[0m21:11:54.268701 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:11:54.269071 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'log_cache_events': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'invocation_command': 'dbt run --models tag:staging', 'empty': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'static_parser': 'True', 'no_print': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None'}
[0m21:11:54.269389 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:11:54.269641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e69318a0-8a92-4cbb-95d3-05360992b7d7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a00280>]}
[0m21:11:55.781977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e69318a0-8a92-4cbb-95d3-05360992b7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e0915b0>]}
[0m21:11:55.819894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e69318a0-8a92-4cbb-95d3-05360992b7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e0974f0>]}
[0m21:11:55.820399 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:11:55.994579 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 3 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m21:11:55.995165 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:11:55.997700 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7772492, "process_in_blocks": "0", "process_kernel_time": 0.298176, "process_mem_max_rss": "348258304", "process_out_blocks": "0", "process_user_time": 2.194705}
[0m21:11:55.998112 [debug] [MainThread]: Command `dbt run` failed at 21:11:55.998050 after 1.78 seconds
[0m21:11:55.998477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10352fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e25dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e25d580>]}
[0m21:11:55.998808 [debug] [MainThread]: Flushing usage events
[0m21:11:56.301940 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:12:19.208583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bac820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bacaf0>]}


============================== 21:12:19.212176 | 69494113-3a8a-4f98-9fc5-9dbe456c8de3 ==============================
[0m21:12:19.212176 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:12:19.212573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'fail_fast': 'False', 'quiet': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error': 'None', 'no_print': 'None', 'target_path': 'None', 'static_parser': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt deps', 'partial_parse': 'True', 'log_cache_events': 'False', 'empty': 'None', 'write_json': 'True', 'debug': 'False', 'version_check': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'use_experimental_parser': 'False'}
[0m21:12:19.299757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69494113-3a8a-4f98-9fc5-9dbe456c8de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b78430>]}
[0m21:12:19.319374 [debug] [MainThread]: Set downloads directory='/var/folders/c8/gn1lrrq12g70rs4vwktnqdf80000gn/T/dbt-downloads-fkfqwoc1'
[0m21:12:19.319760 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:12:19.415782 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:12:19.417546 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:12:19.464681 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:12:19.470690 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m21:12:19.536681 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m21:12:19.539342 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m21:12:19.539854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '69494113-3a8a-4f98-9fc5-9dbe456c8de3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ed0a60>]}
[0m21:12:19.543590 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/elementary-data/elementary.json
[0m21:12:19.616702 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/elementary-data/elementary.json 200
[0m21:12:19.630295 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m21:12:19.721814 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m21:12:19.728813 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:12:20.123000 [info ] [MainThread]: Installed from version 1.1.1
[0m21:12:20.123406 [info ] [MainThread]: Updated version available: 1.3.0
[0m21:12:20.123726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '69494113-3a8a-4f98-9fc5-9dbe456c8de3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e43a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107490ac0>]}
[0m21:12:20.124063 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m21:12:20.761637 [info ] [MainThread]: Installed from version 0.10.1
[0m21:12:20.761993 [info ] [MainThread]: Updated version available: 0.10.4
[0m21:12:20.762267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '69494113-3a8a-4f98-9fc5-9dbe456c8de3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ed0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ed0fa0>]}
[0m21:12:20.762568 [info ] [MainThread]: Installing elementary-data/elementary
[0m21:12:21.260078 [info ] [MainThread]: Installed from version 0.13.1
[0m21:12:21.260489 [info ] [MainThread]: Updated version available: 0.19.4
[0m21:12:21.260763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '69494113-3a8a-4f98-9fc5-9dbe456c8de3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e43a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ed0730>]}
[0m21:12:21.261056 [info ] [MainThread]: Installing calogica/dbt_date
[0m21:12:21.550908 [info ] [MainThread]: Installed from version 0.10.1
[0m21:12:21.551347 [info ] [MainThread]: Up to date!
[0m21:12:21.551717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '69494113-3a8a-4f98-9fc5-9dbe456c8de3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ed05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ed0eb0>]}
[0m21:12:21.552106 [info ] [MainThread]: 
[0m21:12:21.552435 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_expectations', 'elementary-data/elementary']                 
Update your versions in packages.yml, then run dbt deps
[0m21:12:21.554144 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:12:21.556095 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.3956153, "process_in_blocks": "0", "process_kernel_time": 0.240882, "process_mem_max_rss": "114933760", "process_out_blocks": "0", "process_user_time": 1.267087}
[0m21:12:21.556628 [debug] [MainThread]: Command `dbt deps` succeeded at 21:12:21.556546 after 2.40 seconds
[0m21:12:21.556969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106291370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e4880>]}
[0m21:12:21.557458 [debug] [MainThread]: Flushing usage events
[0m21:12:21.902645 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:13:41.607183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032dbdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479cac0>]}


============================== 21:13:41.610943 | e99e46f3-7476-452a-b42d-11ebce4eb023 ==============================
[0m21:13:41.610943 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:13:41.611321 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_format': 'default', 'introspect': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'quiet': 'False', 'debug': 'False', 'log_cache_events': 'False', 'empty': 'None'}
[0m21:13:41.713265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e99e46f3-7476-452a-b42d-11ebce4eb023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104784910>]}
[0m21:13:41.727388 [debug] [MainThread]: Set downloads directory='/var/folders/c8/gn1lrrq12g70rs4vwktnqdf80000gn/T/dbt-downloads-r6640u3y'
[0m21:13:41.727737 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:13:41.818823 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:13:41.820570 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:13:41.918742 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:13:41.932303 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m21:13:42.058600 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m21:13:42.065190 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/elementary-data/elementary.json
[0m21:13:42.176831 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/elementary-data/elementary.json 200
[0m21:13:42.195156 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m21:13:42.242584 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m21:13:42.245351 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m21:13:42.245940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e99e46f3-7476-452a-b42d-11ebce4eb023', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a9970>]}
[0m21:13:42.273813 [info ] [MainThread]: Updating lock file in file path: /Users/azadsolanki/dev/data-engineering/analytics-engineering/package-lock.yml
[0m21:13:42.348260 [debug] [MainThread]: Set downloads directory='/var/folders/c8/gn1lrrq12g70rs4vwktnqdf80000gn/T/dbt-downloads-3gn31xpx'
[0m21:13:42.359059 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:13:42.753490 [info ] [MainThread]: Installed from version 1.1.1
[0m21:13:42.753913 [info ] [MainThread]: Updated version available: 1.3.0
[0m21:13:42.754316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e99e46f3-7476-452a-b42d-11ebce4eb023', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104868700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499c9a0>]}
[0m21:13:42.754750 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m21:13:43.427006 [info ] [MainThread]: Installed from version 0.10.1
[0m21:13:43.427353 [info ] [MainThread]: Updated version available: 0.10.9
[0m21:13:43.427622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e99e46f3-7476-452a-b42d-11ebce4eb023', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103585ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031c3400>]}
[0m21:13:43.427910 [info ] [MainThread]: Installing elementary-data/elementary
[0m21:13:44.003246 [info ] [MainThread]: Installed from version 0.13.1
[0m21:13:44.003580 [info ] [MainThread]: Updated version available: 0.19.4
[0m21:13:44.003847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e99e46f3-7476-452a-b42d-11ebce4eb023', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104868700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c7070>]}
[0m21:13:44.004137 [info ] [MainThread]: Installing calogica/dbt_date
[0m21:13:44.285871 [info ] [MainThread]: Installed from version 0.10.1
[0m21:13:44.286467 [info ] [MainThread]: Up to date!
[0m21:13:44.286975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e99e46f3-7476-452a-b42d-11ebce4eb023', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499c7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499c4c0>]}
[0m21:13:44.287517 [info ] [MainThread]: 
[0m21:13:44.288007 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'metaplane/dbt_expectations', 'elementary-data/elementary']                 
Update your versions in packages.yml, then run dbt deps
[0m21:13:44.290102 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:13:44.292758 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.7333198, "process_in_blocks": "0", "process_kernel_time": 0.343772, "process_mem_max_rss": "112934912", "process_out_blocks": "0", "process_user_time": 1.328747}
[0m21:13:44.293766 [debug] [MainThread]: Command `dbt deps` succeeded at 21:13:44.293352 after 2.73 seconds
[0m21:13:44.294335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032dbdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102385370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031c3400>]}
[0m21:13:44.294881 [debug] [MainThread]: Flushing usage events
[0m21:13:44.640553 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:14:57.504448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e8fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104350880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104350b50>]}


============================== 21:14:57.508247 | 21f8e737-40f3-4ccd-87c8-d3dd9d175466 ==============================
[0m21:14:57.508247 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:14:57.508623 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'quiet': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/azadsolanki/.dbt', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt deps', 'write_json': 'True', 'introspect': 'True', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'fail_fast': 'False', 'no_print': 'None', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'partial_parse': 'True', 'empty': 'None', 'use_colors': 'True', 'debug': 'False'}
[0m21:14:57.564478 [error] [MainThread]: Encountered an error:
'version'
[0m21:14:57.572939 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/azadsolanki/dev/data-engineering/airflow-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/azadsolanki/dev/data-engineering/airflow-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/azadsolanki/dev/data-engineering/airflow-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "/Users/azadsolanki/dev/data-engineering/airflow-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 290, in wrapper
    project = load_project(
  File "/Users/azadsolanki/dev/data-engineering/airflow-env/lib/python3.9/site-packages/dbt/config/runtime.py", line 58, in load_project
    project = Project.from_project_root(
  File "/Users/azadsolanki/dev/data-engineering/airflow-env/lib/python3.9/site-packages/dbt/config/project.py", line 771, in from_project_root
    return partial.render(renderer)
  File "/Users/azadsolanki/dev/data-engineering/airflow-env/lib/python3.9/site-packages/dbt/config/project.py", line 337, in render
    return self.create_project(rendered)
  File "/Users/azadsolanki/dev/data-engineering/airflow-env/lib/python3.9/site-packages/dbt/config/project.py", line 484, in create_project
    packages: PackageConfig = package_config_from_data(
  File "/Users/azadsolanki/dev/data-engineering/airflow-env/lib/python3.9/site-packages/dbt/config/project.py", line 148, in package_config_from_data
    PackageConfig.validate(packages_data)
  File "/Users/azadsolanki/dev/data-engineering/airflow-env/lib/python3.9/site-packages/dbt/contracts/project.py", line 140, in validate
    if not package["version"]:
KeyError: 'version'

[0m21:14:57.574568 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.11692671, "process_in_blocks": "0", "process_kernel_time": 0.106156, "process_mem_max_rss": "98893824", "process_out_blocks": "0", "process_user_time": 0.879052}
[0m21:14:57.574965 [debug] [MainThread]: Command `dbt deps` failed at 21:14:57.574902 after 0.12 seconds
[0m21:14:57.575213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e8fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104308a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104308340>]}
[0m21:14:57.575476 [debug] [MainThread]: Flushing usage events
[0m21:14:57.917159 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:15:14.529273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12102d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12102daf0>]}


============================== 21:15:14.532891 | 090512c3-b2b2-4a12-8824-db9bfafe1ef4 ==============================
[0m21:15:14.532891 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:15:14.533271 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'printer_width': '80', 'invocation_command': 'dbt clean', 'partial_parse': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_colors': 'True', 'write_json': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'empty': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'static_parser': 'True', 'version_check': 'True', 'quiet': 'False', 'no_print': 'None'}
[0m21:15:14.633844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '090512c3-b2b2-4a12-8824-db9bfafe1ef4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef5e80>]}
[0m21:15:14.724260 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2419282, "process_in_blocks": "0", "process_kernel_time": 0.140568, "process_mem_max_rss": "101187584", "process_out_blocks": "0", "process_user_time": 0.898589}
[0m21:15:14.724693 [debug] [MainThread]: Command `dbt clean` succeeded at 21:15:14.724630 after 0.24 seconds
[0m21:15:14.724954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120b8f2b0>]}
[0m21:15:14.725221 [debug] [MainThread]: Flushing usage events
[0m21:15:15.064199 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:15:38.120092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059bfdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8f460>]}


============================== 21:15:38.123412 | d1016c22-9d16-4912-aa10-8f5b328891d5 ==============================
[0m21:15:38.123412 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:15:38.123780 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'quiet': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'debug': 'False', 'use_colors': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --models tag:staging', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'static_parser': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'write_json': 'True', 'printer_width': '80'}
[0m21:15:38.124091 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:15:38.124340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd1016c22-9d16-4912-aa10-8f5b328891d5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8f280>]}
[0m21:15:39.970613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1016c22-9d16-4912-aa10-8f5b328891d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a69340>]}
[0m21:15:40.008301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1016c22-9d16-4912-aa10-8f5b328891d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033d1e50>]}
[0m21:15:40.008777 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:15:40.180518 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 3 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m21:15:40.181117 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:15:40.183675 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.107503, "process_in_blocks": "0", "process_kernel_time": 0.329748, "process_mem_max_rss": "349519872", "process_out_blocks": "0", "process_user_time": 2.197359}
[0m21:15:40.184083 [debug] [MainThread]: Command `dbt run` failed at 21:15:40.184022 after 2.11 seconds
[0m21:15:40.184399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059bfdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a6dddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a6dd160>]}
[0m21:15:40.184707 [debug] [MainThread]: Flushing usage events
[0m21:15:40.514675 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:18:00.156334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068db190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068db460>]}


============================== 21:18:00.160239 | 9e3904d5-898d-4aa7-b6df-bcdee1817326 ==============================
[0m21:18:00.160239 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:18:00.160644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'use_colors': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run --select tag:staging', 'use_experimental_parser': 'False', 'debug': 'False', 'target_path': 'None', 'no_print': 'None', 'introspect': 'True'}
[0m21:18:02.046545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e3904d5-898d-4aa7-b6df-bcdee1817326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a375280>]}
[0m21:18:02.085077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e3904d5-898d-4aa7-b6df-bcdee1817326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a3c2220>]}
[0m21:18:02.085559 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:18:02.256568 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 3 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m21:18:02.259291 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1527367, "process_in_blocks": "0", "process_kernel_time": 0.37828, "process_mem_max_rss": "347848704", "process_out_blocks": "0", "process_user_time": 2.197903}
[0m21:18:02.259717 [debug] [MainThread]: Command `dbt run` failed at 21:18:02.259653 after 2.15 seconds
[0m21:18:02.260069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a549fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a549370>]}
[0m21:18:02.260364 [debug] [MainThread]: Flushing usage events
[0m21:18:02.579658 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:18:08.459367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118dac790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118daca60>]}


============================== 21:18:08.462559 | c4216718-ac26-4ac8-b7af-18c89d387fe8 ==============================
[0m21:18:08.462559 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:18:08.462947 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'use_colors': 'True', 'version_check': 'True', 'empty': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'quiet': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt deps', 'printer_width': '80', 'profiles_dir': '/Users/azadsolanki/.dbt', 'introspect': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'target_path': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None'}
[0m21:18:08.547567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4216718-ac26-4ac8-b7af-18c89d387fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af5250>]}
[0m21:18:08.565024 [debug] [MainThread]: Set downloads directory='/var/folders/c8/gn1lrrq12g70rs4vwktnqdf80000gn/T/dbt-downloads-xx4l5b80'
[0m21:18:08.565380 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:18:08.640515 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:18:08.642016 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:18:08.691121 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:18:08.696966 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m21:18:08.845459 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m21:18:08.856643 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/elementary-data/elementary.json
[0m21:18:08.913205 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/elementary-data/elementary.json 200
[0m21:18:08.931334 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m21:18:08.978242 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m21:18:08.981525 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m21:18:08.982207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c4216718-ac26-4ac8-b7af-18c89d387fe8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1191ddca0>]}
[0m21:18:08.986510 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:18:09.400634 [info ] [MainThread]: Installed from version 1.1.1
[0m21:18:09.401013 [info ] [MainThread]: Updated version available: 1.3.0
[0m21:18:09.401319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c4216718-ac26-4ac8-b7af-18c89d387fe8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118fdebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ae7f0>]}
[0m21:18:09.401644 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m21:18:09.967115 [info ] [MainThread]: Installed from version 0.10.1
[0m21:18:09.967473 [info ] [MainThread]: Updated version available: 0.10.9
[0m21:18:09.967742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c4216718-ac26-4ac8-b7af-18c89d387fe8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1191d0fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1191d0220>]}
[0m21:18:09.968027 [info ] [MainThread]: Installing elementary-data/elementary
[0m21:18:10.450567 [info ] [MainThread]: Installed from version 0.13.1
[0m21:18:10.450909 [info ] [MainThread]: Updated version available: 0.19.4
[0m21:18:10.451173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c4216718-ac26-4ac8-b7af-18c89d387fe8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079dbc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1191d08b0>]}
[0m21:18:10.451463 [info ] [MainThread]: Installing calogica/dbt_date
[0m21:18:10.724606 [info ] [MainThread]: Installed from version 0.10.1
[0m21:18:10.725125 [info ] [MainThread]: Up to date!
[0m21:18:10.725573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c4216718-ac26-4ac8-b7af-18c89d387fe8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1191d0820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1191d0f70>]}
[0m21:18:10.726128 [info ] [MainThread]: 
[0m21:18:10.726574 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'metaplane/dbt_expectations', 'elementary-data/elementary']                 
Update your versions in packages.yml, then run dbt deps
[0m21:18:10.728475 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:18:10.730874 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.3152814, "process_in_blocks": "0", "process_kernel_time": 0.251164, "process_mem_max_rss": "114868224", "process_out_blocks": "0", "process_user_time": 1.280681}
[0m21:18:10.731454 [debug] [MainThread]: Command `dbt deps` succeeded at 21:18:10.731365 after 2.32 seconds
[0m21:18:10.731998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10799b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af5250>]}
[0m21:18:10.732433 [debug] [MainThread]: Flushing usage events
[0m21:18:11.027201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:19:20.783211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b57df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050197f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105019ac0>]}


============================== 21:19:20.787012 | 1d9016ec-ca05-451f-8fd5-ae90de4f88e8 ==============================
[0m21:19:20.787012 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:19:20.787400 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'debug': 'False', 'warn_error': 'None', 'log_format': 'default', 'target_path': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'printer_width': '80', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'quiet': 'False', 'write_json': 'True', 'partial_parse': 'True', 'version_check': 'True', 'no_print': 'None'}
[0m21:19:20.797099 [info ] [MainThread]: dbt version: 1.10.10
[0m21:19:20.797399 [info ] [MainThread]: python version: 3.9.6
[0m21:19:20.797615 [info ] [MainThread]: python path: /Users/azadsolanki/dev/data-engineering/airflow-env/bin/python3
[0m21:19:20.797824 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m21:19:22.690159 [info ] [MainThread]: Using profiles dir at /Users/azadsolanki/.dbt
[0m21:19:22.690529 [info ] [MainThread]: Using profiles.yml file at /Users/azadsolanki/.dbt/profiles.yml
[0m21:19:22.690753 [info ] [MainThread]: Using dbt_project.yml file at /Users/azadsolanki/dev/data-engineering/analytics-engineering/dbt_project.yml
[0m21:19:22.690983 [info ] [MainThread]: adapter type: bigquery
[0m21:19:22.691185 [info ] [MainThread]: adapter version: 1.10.1
[0m21:19:22.766235 [info ] [MainThread]: Configuration:
[0m21:19:22.766606 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:19:22.766822 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:19:22.767029 [info ] [MainThread]: Required dependencies:
[0m21:19:22.767295 [debug] [MainThread]: Executing "git --help"
[0m21:19:22.787628 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:19:22.788247 [debug] [MainThread]: STDERR: "b''"
[0m21:19:22.788508 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:19:22.788752 [info ] [MainThread]: Connection:
[0m21:19:22.789068 [info ] [MainThread]:   method: service-account
[0m21:19:22.789286 [info ] [MainThread]:   database: data-products-441119
[0m21:19:22.789492 [info ] [MainThread]:   execution_project: data-products-441119
[0m21:19:22.789689 [info ] [MainThread]:   schema: dbt_dev_analytics
[0m21:19:22.789889 [info ] [MainThread]:   location: US
[0m21:19:22.790084 [info ] [MainThread]:   priority: interactive
[0m21:19:22.790282 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:19:22.790476 [info ] [MainThread]:   impersonate_service_account: None
[0m21:19:22.790676 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:19:22.790869 [info ] [MainThread]:   job_retries: 1
[0m21:19:22.791063 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:19:22.791257 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m21:19:22.791456 [info ] [MainThread]:   timeout_seconds: 300
[0m21:19:22.791652 [info ] [MainThread]:   client_id: None
[0m21:19:22.791843 [info ] [MainThread]:   token_uri: None
[0m21:19:22.792037 [info ] [MainThread]:   compute_region: None
[0m21:19:22.792230 [info ] [MainThread]:   dataproc_cluster_name: None
[0m21:19:22.792422 [info ] [MainThread]:   gcs_bucket: None
[0m21:19:22.792614 [info ] [MainThread]:   dataproc_batch: None
[0m21:19:22.793072 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:19:22.963998 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:19:22.964414 [debug] [MainThread]: On debug: select 1 as id
[0m21:19:22.964669 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:19:23.738061 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:95271854-9d2b-48f2-9e2a-34571500b79a&page=queryresults
[0m21:19:24.256201 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:19:24.256652 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:19:24.259704 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.5244312, "process_in_blocks": "0", "process_kernel_time": 0.423711, "process_mem_max_rss": "361332736", "process_out_blocks": "0", "process_user_time": 2.345809}
[0m21:19:24.260180 [debug] [MainThread]: Command `dbt debug` succeeded at 21:19:24.260108 after 3.52 seconds
[0m21:19:24.260447 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:19:24.260725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b57df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fd1040>]}
[0m21:19:24.261048 [debug] [MainThread]: Flushing usage events
[0m21:19:24.573055 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:19:40.433611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10716bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862db50>]}


============================== 21:19:40.436860 | 717eb83d-18ff-4dad-93e0-8790ec871447 ==============================
[0m21:19:40.436860 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:19:40.437233 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error': 'None', 'empty': 'None', 'version_check': 'True', 'partial_parse': 'True', 'quiet': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'static_parser': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'no_print': 'None', 'printer_width': '80', 'log_format': 'default', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'invocation_command': 'dbt parse', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m21:19:41.801561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '717eb83d-18ff-4dad-93e0-8790ec871447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9f6a0>]}
[0m21:19:41.838844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '717eb83d-18ff-4dad-93e0-8790ec871447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10860af70>]}
[0m21:19:41.839242 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:19:42.027537 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m21:19:42.028160 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:19:42.028424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '717eb83d-18ff-4dad-93e0-8790ec871447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e4fe80>]}
[0m21:19:42.165773 [warn ] [MainThread]: [[33mWARNING[0m][UnexpectedJinjaBlockDeprecation]: Deprecated functionality
Found unexpected 'endmacro' block tag. in file `macros/business_logic.sql`
[0m21:19:42.166148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '717eb83d-18ff-4dad-93e0-8790ec871447', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13127a7f0>]}
[0m21:19:44.385088 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 04:19:40 ===
[0m21:19:44.394068 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m21:19:44.977873 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.accepted_range`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m21:19:44.978264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '717eb83d-18ff-4dad-93e0-8790ec871447', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13435f0d0>]}
[0m21:19:45.045250 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models/staging/_sources.yml @ sources: {'name': 'thelook_ecommerce', 'description': 'TheLook E-commerce public dataset - comprehensive retail data', 'database': 'bigquery-public-data', 'schema': 'thelook_ecommerce', 'freshness': {'warns_after': {'count': 1, 'period': 'day'}, 'error_after': {'count': 7, 'period': 'day'}}, 'loaded_at_field': 'created_at', 'tables': [{'name': 'users', 'description': 'Customer master data including demographics and registration info', 'columns': [{'name': 'id', 'description': 'Unique user identfied', 'tests': ['unique', 'not_null']}, {'name': 'email', 'description': 'User email address', 'tests': ['unique', 'not_null']}, {'name': 'created_at', 'description': 'User registration timestamp', 'tests': ['not_null']}]}, {'name': 'orders', 'description': 'Order transactions with status and timing', 'columns': [{'name': 'order_id', 'description': 'Unique order id', 'tests': ['unique', 'not_null']}, {'name': 'user_id', 'description': 'Customer who placed the order', 'tests': ['not_null', {'relationships': {'to': "sources('thelook_ecommerce', 'users')", 'field': 'id'}}]}]}, {'name': 'order_items', 'description': 'individual line items within orders', 'columns': [{'name': 'id', 'description': 'Unique order item identifier', 'tests': ['unique', 'not_null']}, {'name': 'order_id', 'description': 'Parent order references', 'tests': ['not_null', {'relationships': {'to': "sources('thelook_ecommerce', 'orders')", 'field': 'order_id'}}]}]}, {'name': 'products', 'description': 'Product catalog with pricing and categorization', 'columns': [{'name': 'id', 'description': 'Unique product identifier', 'tests': ['unique', 'not_null']}]}, {'name': 'inventory_items', 'description': 'Individual investory item tracking'}, {'name': 'events', 'description': 'User behaviour and interaction events'}]} - at path ['freshness']: {'warns_after': {'count': 1, 'period': 'day'}, 'error_after': {'count': 7, 'period': 'day'}} is not valid under any of the given schemas
[0m21:19:45.045928 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- UnexpectedJinjaBlockDeprecation: 1 occurrence
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:19:45.048452 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 4.658467, "process_in_blocks": "0", "process_kernel_time": 0.331172, "process_mem_max_rss": "386695168", "process_out_blocks": "0", "process_user_time": 5.088776}
[0m21:19:45.048814 [debug] [MainThread]: Command `dbt parse` failed at 21:19:45.048761 after 4.66 seconds
[0m21:19:45.049069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10716bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13432f7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133a3f910>]}
[0m21:19:45.049320 [debug] [MainThread]: Flushing usage events
[0m21:19:45.369528 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:25:36.275835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10906d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10906daf0>]}


============================== 21:25:36.279861 | a7cd19d9-02a1-42e5-8eb8-237b7bdae887 ==============================
[0m21:25:36.279861 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:25:36.280267 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'write_json': 'True', 'invocation_command': 'dbt parse', 'profiles_dir': '/Users/azadsolanki/.dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'fail_fast': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'partial_parse': 'True', 'empty': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None', 'target_path': 'None'}
[0m21:25:38.198329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7cd19d9-02a1-42e5-8eb8-237b7bdae887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1434ca820>]}
[0m21:25:38.236336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7cd19d9-02a1-42e5-8eb8-237b7bdae887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ca4f250>]}
[0m21:25:38.236846 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:25:38.429161 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m21:25:38.429824 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:25:38.430097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a7cd19d9-02a1-42e5-8eb8-237b7bdae887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1436ce8e0>]}
[0m21:25:40.791580 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 04:25:36 ===
[0m21:25:40.800412 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m21:25:41.402635 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m21:25:41.403030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a7cd19d9-02a1-42e5-8eb8-237b7bdae887', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146568d60>]}
[0m21:25:41.465460 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/marts/_core_models.yml @ models: {'name': 'dim_products', 'description': 'Product dimension with sales performance metrics', 'columns': [{'name': 'product_id', 'description': None, 'tests': ['unique', 'not_null']}, {'name': 'product_name', 'description': 'Product name', 'tests': ['not_null']}], 'original_file_path': 'models/marts/_core_models.yml', 'yaml_key': 'models', 'package_name': 'digital_marketing'} - at path ['columns'][0]['description']: None is not of type 'string'
[0m21:25:41.465990 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:25:41.468592 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 5.2404633, "process_in_blocks": "0", "process_kernel_time": 0.431112, "process_mem_max_rss": "384516096", "process_out_blocks": "0", "process_user_time": 5.165686}
[0m21:25:41.468989 [debug] [MainThread]: Command `dbt parse` failed at 21:25:41.468932 after 5.24 seconds
[0m21:25:41.469255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14656aa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14663f4c0>]}
[0m21:25:41.469523 [debug] [MainThread]: Flushing usage events
[0m21:25:41.786145 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:47.880470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a1bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edd820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eddaf0>]}


============================== 21:28:47.883883 | 1a88a4b0-5fad-4fae-bc71-4b7e4c650e1a ==============================
[0m21:28:47.883883 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:28:47.884254 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'debug': 'False', 'write_json': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'partial_parse': 'True', 'version_check': 'True', 'invocation_command': 'dbt parse', 'printer_width': '80', 'no_print': 'None', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'fail_fast': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'log_format': 'default'}
[0m21:28:49.544202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a88a4b0-5fad-4fae-bc71-4b7e4c650e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac5e80>]}
[0m21:28:49.581806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a88a4b0-5fad-4fae-bc71-4b7e4c650e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d786d0>]}
[0m21:28:49.582211 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:28:49.775875 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m21:28:49.776506 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:28:49.776773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1a88a4b0-5fad-4fae-bc71-4b7e4c650e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131b1e100>]}
[0m21:28:52.117550 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 04:28:47 ===
[0m21:28:52.126859 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m21:28:52.721073 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m21:28:52.721464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1a88a4b0-5fad-4fae-bc71-4b7e4c650e1a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1348d1310>]}
[0m21:28:52.795906 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_product_metrics' in the 'models' section of file 'models/intermediate/_intermediate_models.yml'
[0m21:28:52.978526 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.digital_marketing.dim_products' (models/marts/dim_products.sql) depends on a node named 'int_product_metrics' which was not found
[0m21:28:52.979001 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:28:52.981587 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 5.1463103, "process_in_blocks": "0", "process_kernel_time": 0.370482, "process_mem_max_rss": "385646592", "process_out_blocks": "0", "process_user_time": 5.309911}
[0m21:28:52.981948 [debug] [MainThread]: Command `dbt parse` failed at 21:28:52.981892 after 5.15 seconds
[0m21:28:52.982209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a1bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1348982e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1348bf8b0>]}
[0m21:28:52.982473 [debug] [MainThread]: Flushing usage events
[0m21:28:53.350009 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:29:00.285539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088dd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ddac0>]}


============================== 21:29:00.288695 | 483277dd-4cae-434b-b062-3637fdb954a2 ==============================
[0m21:29:00.288695 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:29:00.289079 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'debug': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_colors': 'True', 'no_print': 'None', 'profiles_dir': '/Users/azadsolanki/.dbt', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt clean', 'cache_selected_only': 'False', 'static_parser': 'True', 'printer_width': '80', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'write_json': 'True', 'empty': 'None', 'introspect': 'True', 'quiet': 'False', 'version_check': 'True'}
[0m21:29:00.372998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '483277dd-4cae-434b-b062-3637fdb954a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c4910>]}
[0m21:29:00.458968 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2172025, "process_in_blocks": "0", "process_kernel_time": 0.135508, "process_mem_max_rss": "100270080", "process_out_blocks": "0", "process_user_time": 0.894117}
[0m21:29:00.459389 [debug] [MainThread]: Command `dbt clean` succeeded at 21:29:00.459330 after 0.22 seconds
[0m21:29:00.459663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088dd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a08130>]}
[0m21:29:00.459934 [debug] [MainThread]: Flushing usage events
[0m21:29:00.787666 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:29:06.700972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058dfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da1a60>]}


============================== 21:29:06.704260 | 4da86756-9342-4e46-947c-9291c7b24382 ==============================
[0m21:29:06.704260 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:29:06.704649 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'empty': 'None', 'use_colors': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/Users/azadsolanki/.dbt', 'log_cache_events': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'version_check': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'debug': 'False', 'printer_width': '80', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'log_format': 'default', 'no_print': 'None', 'invocation_command': 'dbt parse'}
[0m21:29:08.069420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4da86756-9342-4e46-947c-9291c7b24382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1171cd880>]}
[0m21:29:08.106657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4da86756-9342-4e46-947c-9291c7b24382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6ec10>]}
[0m21:29:08.107072 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:29:08.277169 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 3 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m21:29:08.280115 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 1.6229665, "process_in_blocks": "0", "process_kernel_time": 0.280882, "process_mem_max_rss": "348012544", "process_out_blocks": "0", "process_user_time": 2.181302}
[0m21:29:08.280594 [debug] [MainThread]: Command `dbt parse` failed at 21:29:08.280533 after 1.62 seconds
[0m21:29:08.280900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058dfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a547c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a547c10>]}
[0m21:29:08.281190 [debug] [MainThread]: Flushing usage events
[0m21:29:08.586718 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:29:25.651347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103acfe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f90820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f90af0>]}


============================== 21:29:25.654656 | 0a25104d-0473-40e9-b4ac-f921122104dd ==============================
[0m21:29:25.654656 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:29:25.655037 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/azadsolanki/.dbt', 'log_cache_events': 'False', 'log_format': 'default', 'quiet': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'invocation_command': 'dbt deps', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'empty': 'None', 'no_print': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'debug': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'printer_width': '80', 'version_check': 'True', 'fail_fast': 'False'}
[0m21:29:25.739684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a25104d-0473-40e9-b4ac-f921122104dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b79610>]}
[0m21:29:25.754340 [debug] [MainThread]: Set downloads directory='/var/folders/c8/gn1lrrq12g70rs4vwktnqdf80000gn/T/dbt-downloads-1tcps69j'
[0m21:29:25.754697 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:29:25.846672 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:29:25.848292 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:29:25.895726 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:29:25.901526 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m21:29:26.115979 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m21:29:26.127378 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/elementary-data/elementary.json
[0m21:29:26.297291 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/elementary-data/elementary.json 200
[0m21:29:26.317065 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m21:29:26.372774 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m21:29:26.376320 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m21:29:26.377128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0a25104d-0473-40e9-b4ac-f921122104dd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10519dd90>]}
[0m21:29:26.382184 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:29:26.811894 [info ] [MainThread]: Installed from version 1.1.1
[0m21:29:26.812292 [info ] [MainThread]: Updated version available: 1.3.0
[0m21:29:26.812602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0a25104d-0473-40e9-b4ac-f921122104dd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d56b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fb6070>]}
[0m21:29:26.812930 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m21:29:27.442867 [info ] [MainThread]: Installed from version 0.10.1
[0m21:29:27.443207 [info ] [MainThread]: Updated version available: 0.10.9
[0m21:29:27.443471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0a25104d-0473-40e9-b4ac-f921122104dd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105190460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105190700>]}
[0m21:29:27.443759 [info ] [MainThread]: Installing elementary-data/elementary
[0m21:29:27.918258 [info ] [MainThread]: Installed from version 0.13.1
[0m21:29:27.918602 [info ] [MainThread]: Updated version available: 0.19.4
[0m21:29:27.918867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0a25104d-0473-40e9-b4ac-f921122104dd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d93880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051909d0>]}
[0m21:29:27.919155 [info ] [MainThread]: Installing calogica/dbt_date
[0m21:29:28.213338 [info ] [MainThread]: Installed from version 0.10.1
[0m21:29:28.213914 [info ] [MainThread]: Up to date!
[0m21:29:28.214419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0a25104d-0473-40e9-b4ac-f921122104dd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105190070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051907c0>]}
[0m21:29:28.214911 [info ] [MainThread]: 
[0m21:29:28.215312 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'metaplane/dbt_expectations', 'elementary-data/elementary']                 
Update your versions in packages.yml, then run dbt deps
[0m21:29:28.217288 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:29:28.219794 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.6125453, "process_in_blocks": "0", "process_kernel_time": 0.251162, "process_mem_max_rss": "114196480", "process_out_blocks": "0", "process_user_time": 1.304137}
[0m21:29:28.220617 [debug] [MainThread]: Command `dbt deps` succeeded at 21:29:28.220476 after 2.61 seconds
[0m21:29:28.221203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103acfe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fb6070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b79610>]}
[0m21:29:28.221704 [debug] [MainThread]: Flushing usage events
[0m21:29:28.641843 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:29:38.627519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10321be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046dd970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ddc40>]}


============================== 21:29:38.630777 | 27aa2ef1-2be4-44cf-b6a1-fbb862c13bff ==============================
[0m21:29:38.630777 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:29:38.631162 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'warn_error': 'None', 'use_colors': 'True', 'version_check': 'True', 'invocation_command': 'dbt parse', 'fail_fast': 'False', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'indirect_selection': 'eager', 'target_path': 'None'}
[0m21:29:40.249084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27aa2ef1-2be4-44cf-b6a1-fbb862c13bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022c5610>]}
[0m21:29:40.286413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27aa2ef1-2be4-44cf-b6a1-fbb862c13bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046a90d0>]}
[0m21:29:40.286807 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:29:40.477414 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m21:29:40.478037 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:29:40.478304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '27aa2ef1-2be4-44cf-b6a1-fbb862c13bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117f8e070>]}
[0m21:29:42.788775 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 04:29:38 ===
[0m21:29:42.797694 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m21:29:43.397262 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m21:29:43.397663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '27aa2ef1-2be4-44cf-b6a1-fbb862c13bff', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119169790>]}
[0m21:29:43.471963 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_product_metrics' in the 'models' section of file 'models/intermediate/_intermediate_models.yml'
[0m21:29:43.654304 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.digital_marketing.dim_products' (models/marts/dim_products.sql) depends on a node named 'int_product_metrics' which was not found
[0m21:29:43.654781 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:29:43.657366 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 5.074987, "process_in_blocks": "0", "process_kernel_time": 0.357286, "process_mem_max_rss": "387923968", "process_out_blocks": "0", "process_user_time": 5.298856}
[0m21:29:43.657730 [debug] [MainThread]: Command `dbt parse` failed at 21:29:43.657679 after 5.08 seconds
[0m21:29:43.657994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10321be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10334ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11912ad00>]}
[0m21:29:43.658265 [debug] [MainThread]: Flushing usage events
[0m21:29:43.947169 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:31:15.748314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b6bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703b460>]}


============================== 21:31:15.752059 | 79348452-6b09-44c6-bc8c-3139855cc1c3 ==============================
[0m21:31:15.752059 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:31:15.752445 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'printer_width': '80', 'use_colors': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'write_json': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'invocation_command': 'dbt run --select tag:staging', 'partial_parse': 'True', 'empty': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'log_format': 'default'}
[0m21:31:17.595360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79348452-6b09-44c6-bc8c-3139855cc1c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139f54f40>]}
[0m21:31:17.632624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79348452-6b09-44c6-bc8c-3139855cc1c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107003940>]}
[0m21:31:17.633043 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:31:17.824262 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m21:31:17.824893 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:31:17.825152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '79348452-6b09-44c6-bc8c-3139855cc1c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a9f37c0>]}
[0m21:31:20.160626 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 04:31:15 ===
[0m21:31:20.170339 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m21:31:20.792068 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m21:31:20.792528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '79348452-6b09-44c6-bc8c-3139855cc1c3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c691520>]}
[0m21:31:20.875875 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_product_metrics' in the 'models' section of file 'models/intermediate/_intermediate_models.yml'
[0m21:31:21.062572 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.digital_marketing.dim_products' (models/marts/dim_products.sql) depends on a node named 'int_product_metrics' which was not found
[0m21:31:21.063072 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:31:21.065648 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.363906, "process_in_blocks": "0", "process_kernel_time": 0.40322, "process_mem_max_rss": "386514944", "process_out_blocks": "0", "process_user_time": 5.362089}
[0m21:31:21.066033 [debug] [MainThread]: Command `dbt run` failed at 21:31:21.065978 after 5.36 seconds
[0m21:31:21.066290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b6bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c5f91f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb03d0>]}
[0m21:31:21.066551 [debug] [MainThread]: Flushing usage events
[0m21:31:21.386499 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:33:17.852201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ebcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ad7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072adac0>]}


============================== 21:33:17.855768 | 11644bff-e38a-4876-9ab2-71cf97eb04c1 ==============================
[0m21:33:17.855768 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:33:17.856165 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'profiles_dir': '/Users/azadsolanki/.dbt', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'static_parser': 'True', 'version_check': 'True', 'partial_parse': 'True', 'empty': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'no_print': 'None', 'invocation_command': 'dbt parse', 'write_json': 'True', 'printer_width': '80', 'debug': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'introspect': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'cache_selected_only': 'False'}
[0m21:33:19.505677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11644bff-e38a-4876-9ab2-71cf97eb04c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104189190>]}
[0m21:33:19.542691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11644bff-e38a-4876-9ab2-71cf97eb04c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1305bb160>]}
[0m21:33:19.543088 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:33:19.734154 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m21:33:19.734781 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:33:19.735054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '11644bff-e38a-4876-9ab2-71cf97eb04c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14277cbe0>]}
[0m21:33:22.055067 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 04:33:17 ===
[0m21:33:22.064050 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m21:33:22.659580 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m21:33:22.659984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '11644bff-e38a-4876-9ab2-71cf97eb04c1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f916a0>]}
[0m21:33:23.044032 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.reports
- models.thelook_analytics.marts.finance
- models.thelook_analytics.staging
- models.thelook_analytics.marts.core
- models.thelook_analytics.intermediate
- seeds.thelook_analytics.customer_segments
- seeds.thelook_analytics.product_categories
- snapshots.thelook_analytics
[0m21:33:23.056123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11644bff-e38a-4876-9ab2-71cf97eb04c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143915a60>]}
[0m21:33:23.059240 [info ] [MainThread]: Performance info: /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/perf_info.json
[0m21:33:23.204324 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m21:33:23.206141 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m21:33:23.206504 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:33:23.209079 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 5.4040823, "process_in_blocks": "0", "process_kernel_time": 0.377556, "process_mem_max_rss": "394248192", "process_out_blocks": "0", "process_user_time": 5.59491}
[0m21:33:23.209458 [debug] [MainThread]: Command `dbt parse` succeeded at 21:33:23.209405 after 5.40 seconds
[0m21:33:23.209715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ebcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1305bb160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046fdac0>]}
[0m21:33:23.209974 [debug] [MainThread]: Flushing usage events
[0m21:33:23.546313 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:34:05.173320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103397d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104867220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048674f0>]}


============================== 21:34:05.178778 | c6b4bff8-54a3-4532-878d-48047d5b952c ==============================
[0m21:34:05.178778 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:34:05.179296 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'profiles_dir': '/Users/azadsolanki/.dbt', 'partial_parse': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'static_parser': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'quiet': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select tag:staging', 'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m21:34:06.892015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6b4bff8-54a3-4532-878d-48047d5b952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f7d9d90>]}
[0m21:34:06.929269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6b4bff8-54a3-4532-878d-48047d5b952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cc8970>]}
[0m21:34:06.929672 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:34:07.123936 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m21:34:07.456851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:34:07.457198 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:34:07.463942 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.staging
- models.thelook_analytics.marts.finance
- models.thelook_analytics.marts.core
- models.thelook_analytics.intermediate
- models.thelook_analytics.reports
- models.thelook_analytics.marts.marketing
- seeds.thelook_analytics.customer_segments
- seeds.thelook_analytics.product_categories
- snapshots.thelook_analytics
[0m21:34:07.526872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6b4bff8-54a3-4532-878d-48047d5b952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138c87e50>]}
[0m21:34:07.666429 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m21:34:07.668183 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m21:34:07.690012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6b4bff8-54a3-4532-878d-48047d5b952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138c8d970>]}
[0m21:34:07.690507 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 44 data tests, 6 sources, 1492 macros
[0m21:34:07.690779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6b4bff8-54a3-4532-878d-48047d5b952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fff9100>]}
[0m21:34:07.692241 [info ] [MainThread]: 
[0m21:34:07.692531 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:34:07.692748 [info ] [MainThread]: 
[0m21:34:07.693096 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:34:07.696627 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m21:34:07.697162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:08.384386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now create_data-products-441119_dbt_dev_analytics)
[0m21:34:08.385582 [debug] [ThreadPool]: Creating schema "database: "data-products-441119"
schema: "dbt_dev_analytics"
"
[0m21:34:08.407104 [debug] [ThreadPool]: On create_data-products-441119_dbt_dev_analytics: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "create_data-products-441119_dbt_dev_analytics"} */
create schema if not exists `data-products-441119`.`dbt_dev_analytics`
  
[0m21:34:08.407870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:09.098189 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:d04f0362-fa56-42c2-8138-103012567ae0&page=queryresults
[0m21:34:10.166925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data-products-441119_dbt_dev_analytics, now list_data-products-441119_dbt_dev_analytics)
[0m21:34:10.167399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:10.647967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev_analytics, now list_data-products-441119_snapshot)
[0m21:34:10.648829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:11.353904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6b4bff8-54a3-4532-878d-48047d5b952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138c5c670>]}
[0m21:34:11.377645 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 04:34:05 ===
[0m21:34:11.378571 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m21:34:11.382753 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m21:34:11.383719 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m21:34:11.390044 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m21:34:11.391630 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m21:34:11.392227 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m21:34:11.392740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:34:12.169871 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:4e9d5b5f-2966-4850-b2ff-c246582e6e9c&page=queryresults
[0m21:34:12.558554 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.17s]
[0m21:34:12.609969 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m21:34:12.611522 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m21:34:12.612053 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.05s]
[0m21:34:12.612416 [info ] [MainThread]: 
[0m21:34:12.618727 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_events
[0m21:34:12.619293 [info ] [Thread-1  ]: 1 of 5 START sql view model dbt_dev_analytics.stg_events ....................... [RUN]
[0m21:34:12.619798 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.digital_marketing.stg_events'
[0m21:34:12.620153 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_events
[0m21:34:12.628081 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_events"
[0m21:34:12.628958 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_events
[0m21:34:12.651192 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_events"
[0m21:34:12.652133 [debug] [Thread-1  ]: On model.digital_marketing.stg_events: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_events"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_events`
  OPTIONS()
  as 

select
    id as event_id,
    user_id,
    sequence_number,
    session_id,
    created_at as event_timestamp,
    ip_address,
    city,
    state,
    postal_code,
    browser,
    traffic_source,
    uri,
    event_type,
    
    -- Event categorization
    case 
        when event_type = 'home' then 'Navigation'
        when event_type in ('department', 'category', 'brand') then 'Browse'
        when event_type = 'product' then 'Product View'
        when event_type = 'cart' then 'Add to Cart'
        when event_type = 'purchase' then 'Purchase'
        else 'Other'
    end as event_category,
    
    -- Session analysis
    extract(hour from created_at) as event_hour,
    extract(dayofweek from created_at) as event_day_of_week,
    
    -- Geographic
    case when state is not null then state else 'Unknown' end as user_state,
    case when city is not null then city else 'Unknown' end as user_city,
    
    -- Device/browser categorization
    case 
        when lower(browser) like '%chrome%' then 'Chrome'
        when lower(browser) like '%safari%' then 'Safari'
        when lower(browser) like '%firefox%' then 'Firefox'
        when lower(browser) like '%edge%' then 'Edge'
        else 'Other'
    end as browser_family,
    
    -- Data quality
    case when user_id is null then true else false end as has_missing_user,
    case when session_id is null then true else false end as has_missing_session

from `bigquery-public-data`.`thelook_ecommerce`.`events`
where created_at >= '2019-01-01'
  and created_at <= '2024-12-31'

-- Development environment filter

    qualify row_number() over (order by created_at desc) <= 50000
;


[0m21:34:12.652496 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:34:13.348414 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:992e9ab7-1a9d-4d30-8533-b2b9bc9caa2b&page=queryresults
[0m21:34:13.744117 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6b4bff8-54a3-4532-878d-48047d5b952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104811070>]}
[0m21:34:13.745128 [info ] [Thread-1  ]: 1 of 5 OK created sql view model dbt_dev_analytics.stg_events .................. [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m21:34:13.745861 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_events
[0m21:34:13.746354 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_order_items
[0m21:34:13.746993 [info ] [Thread-1  ]: 2 of 5 START sql view model dbt_dev_analytics.stg_order_items .................. [RUN]
[0m21:34:13.747609 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_events, now model.digital_marketing.stg_order_items)
[0m21:34:13.748090 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_order_items
[0m21:34:13.757093 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_order_items"
[0m21:34:13.758001 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_order_items
[0m21:34:13.764974 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_order_items"
[0m21:34:13.765837 [debug] [Thread-1  ]: On model.digital_marketing.stg_order_items: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_order_items"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
  OPTIONS()
  as 

select
    id as order_item_id,
    order_id,
    user_id,
    product_id,
    inventory_item_id,
    status as item_status,
    created_at as order_item_date,
    shipped_at as item_shipped_date,
    delivered_at as item_delivered_date,
    returned_at as item_returned_date,
    sale_price,
    
    -- Quantity handling (TheLook assumes 1 item per line)
    1 as quantity,
    sale_price as line_total,
    0 as discount_amount,
    
    -- Item status flags
    case when returned_at is not null then true else false end as is_returned,
    case when shipped_at is not null then true else false end as is_shipped,
    case when delivered_at is not null then true else false end as is_delivered,
    case when status = 'Complete' then true else false end as is_complete,
    case when status = 'Cancelled' then true else false end as is_cancelled,
    
    -- Timing analysis
    case when shipped_at is not null then
        date_diff(shipped_at, created_at, day) end as days_to_ship_item,
    case when delivered_at is not null and shipped_at is not null then
        date_diff(delivered_at, shipped_at, day) end as days_in_transit_item,
        
    created_at,
    
    -- Data quality flags
    case when sale_price <= 0 then true else false end as has_invalid_price,
    case when sale_price > 10000 then true else false end as has_extreme_price,
    case when product_id is null then true else false end as has_missing_product,
    case when user_id is null then true else false end as has_missing_user

from `bigquery-public-data`.`thelook_ecommerce`.`order_items`
where created_at >= '2019-01-01'
  and created_at <= '2024-12-31'

-- Development environment filter

    qualify row_number() over (order by created_at desc) <= 50000
;


[0m21:34:13.766325 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:34:14.525920 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:02a82514-0872-4d5e-94ab-aac816cbfd83&page=queryresults
[0m21:34:14.890863 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6b4bff8-54a3-4532-878d-48047d5b952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104811070>]}
[0m21:34:14.892401 [info ] [Thread-1  ]: 2 of 5 OK created sql view model dbt_dev_analytics.stg_order_items ............. [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m21:34:14.893615 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_order_items
[0m21:34:14.894433 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_orders
[0m21:34:14.895465 [info ] [Thread-1  ]: 3 of 5 START sql view model dbt_dev_analytics.stg_orders ....................... [RUN]
[0m21:34:14.896468 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_order_items, now model.digital_marketing.stg_orders)
[0m21:34:14.897113 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_orders
[0m21:34:14.910629 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_orders"
[0m21:34:14.911742 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_orders
[0m21:34:14.919796 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_orders"
[0m21:34:14.920810 [debug] [Thread-1  ]: On model.digital_marketing.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_orders"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
  OPTIONS()
  as 

select
    order_id,
    user_id,
    status as order_status,
    gender as customer_gender,
    created_at as order_date,
    returned_at,
    shipped_at,
    delivered_at,
    num_of_item as item_count,
    created_at,
    
    -- Order status flags
    case when returned_at is not null then true else false end as is_returned,
    case when shipped_at is not null then true else false end as is_shipped,
    case when delivered_at is not null then true else false end as is_delivered,
    case when status = 'Complete' then true else false end as is_complete,
    case when status = 'Cancelled' then true else false end as is_cancelled,
    
    -- Delivery timing calculations
    case when shipped_at is not null then
        date_diff(shipped_at, created_at, hour) end as hours_to_ship,
    case when delivered_at is not null and shipped_at is not null then
        date_diff(delivered_at, shipped_at, hour) end as hours_in_transit,
    case when delivered_at is not null then
        date_diff(delivered_at, created_at, hour) end as total_delivery_hours,
        
    -- Convert to days for easier analysis
    case when delivered_at is not null then
        date_diff(delivered_at, created_at, day) end as delivery_days,
        
    -- Order timing analysis
    extract(hour from created_at) as order_hour,
    extract(dayofweek from created_at) as order_day_of_week,
    extract(month from created_at) as order_month,
    extract(quarter from created_at) as order_quarter,
    extract(year from created_at) as order_year,
    
    case 
        when extract(hour from created_at) between 6 and 11 then 'Morning'
        when extract(hour from created_at) between 12 and 17 then 'Afternoon'
        when extract(hour from created_at) between 18 and 21 then 'Evening'
        else 'Night'
    end as order_time_of_day,
    
    case extract(dayofweek from created_at)
        when 1 then 'Sunday'
        when 2 then 'Monday'
        when 3 then 'Tuesday'
        when 4 then 'Wednesday'
        when 5 then 'Thursday'
        when 6 then 'Friday'
        when 7 then 'Saturday'
    end as order_day_name,
    
    case when extract(dayofweek from created_at) in (1, 7) then true else false end as is_weekend,
    
    -- Data quality checks
    case when user_id is null then true else false end as has_missing_user,
    case when num_of_item <= 0 then true else false end as has_invalid_item_count,
    case when created_at > current_timestamp() then true else false end as is_future_order

from `bigquery-public-data`.`thelook_ecommerce`.`orders`
where created_at >= '2019-01-01'
  and created_at <= '2024-12-31'

-- Development environment filter

    qualify row_number() over (order by created_at desc) <= 50000
;


[0m21:34:14.921449 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:34:15.856617 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:2eab6909-2a49-429a-8003-33025b7300df&page=queryresults
[0m21:34:16.234208 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6b4bff8-54a3-4532-878d-48047d5b952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104811070>]}
[0m21:34:16.235586 [info ] [Thread-1  ]: 3 of 5 OK created sql view model dbt_dev_analytics.stg_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.34s]
[0m21:34:16.236690 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_orders
[0m21:34:16.237460 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_products
[0m21:34:16.238506 [info ] [Thread-1  ]: 4 of 5 START sql view model dbt_dev_analytics.stg_products ..................... [RUN]
[0m21:34:16.239479 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_orders, now model.digital_marketing.stg_products)
[0m21:34:16.240247 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_products
[0m21:34:16.250817 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_products"
[0m21:34:16.252037 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_products
[0m21:34:16.259423 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_products"
[0m21:34:16.260508 [debug] [Thread-1  ]: On model.digital_marketing.stg_products: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_products"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_products`
  OPTIONS()
  as 

select
    id as product_id,
    cost,
    category,
    name as product_name,
    brand,
    retail_price,
    department,
    sku,
    distribution_center_id,
    
    -- Margin calculations
    retail_price - cost as margin_amount,
    case when retail_price > 0 then
        round((retail_price - cost) / retail_price * 100, 2)
        else 0 end as margin_percentage,
    
    -- Product categorization
    case 
        when retail_price - cost > 100 then 'Premium'
        when retail_price - cost > 50 then 'High'
        when retail_price - cost > 20 then 'Standard'
        when retail_price - cost > 5 then 'Economy'
        else 'Low'
    end as margin_tier,
    
    case
        when retail_price >= 200 then 'Luxury'
        when retail_price >= 100 then 'Premium'
        when retail_price >= 50 then 'Mid-Range'
        when retail_price >= 20 then 'Budget'
        else 'Economy'
    end as price_category,
    
    -- Category grouping (simplified)
    case 
        when lower(category) like '%apparel%' or lower(category) like '%clothing%' then 'Apparel'
        when lower(category) like '%shoe%' or lower(category) like '%footwear%' then 'Footwear'
        when lower(category) like '%accessori%' or lower(category) like '%jewelry%' then 'Accessories'
        when lower(category) like '%home%' or lower(category) like '%decor%' then 'Home & Decor'
        when lower(category) like '%sport%' or lower(category) like '%outdoor%' then 'Sports & Outdoors'
        else 'Other'
    end as category_group,
    
    -- Brand tier (based on average retail price)
    case 
        when brand in ('Calvin Klein', 'Diesel', 'Hugo Boss') then 'Premium'
        when brand in ('Adidas', 'Nike', 'Levi''s') then 'Popular'
        else 'Standard'
    end as brand_tier,
    
    -- Data quality flags
    case when cost <= 0 then true else false end as has_invalid_cost,
    case when retail_price <= 0 then true else false end as has_invalid_price,
    case when retail_price < cost then true else false end as has_negative_margin,
    case when cost > 5000 or retail_price > 10000 then true else false end as has_extreme_values,
    case when product_name is null or trim(product_name) = '' then true else false end as has_missing_name

from `bigquery-public-data`.`thelook_ecommerce`.`products`;


[0m21:34:16.261221 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:34:16.726641 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:3a5807b2-072c-4055-aea3-d0cd0ec6efe9&page=queryresults
[0m21:34:16.728766 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:3a5807b2-072c-4055-aea3-d0cd0ec6efe9&page=queryresults
[0m21:34:16.794618 [debug] [Thread-1  ]: Database Error in model stg_products (models/staging/stg_products.sql)
  Syntax error: concatenated string literals must be separated by whitespace or comments at [55:48]
  compiled code at target/run/digital_marketing/models/staging/stg_products.sql
[0m21:34:16.795199 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6b4bff8-54a3-4532-878d-48047d5b952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139747700>]}
[0m21:34:16.795769 [error] [Thread-1  ]: 4 of 5 ERROR creating sql view model dbt_dev_analytics.stg_products ............ [[31mERROR[0m in 0.56s]
[0m21:34:16.796251 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_products
[0m21:34:16.796591 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_users
[0m21:34:16.797018 [debug] [Thread-4  ]: Marking all children of 'model.digital_marketing.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models/staging/stg_products.sql)
  Syntax error: concatenated string literals must be separated by whitespace or comments at [55:48]
  compiled code at target/run/digital_marketing/models/staging/stg_products.sql.
[0m21:34:16.797444 [info ] [Thread-1  ]: 5 of 5 START sql view model dbt_dev_analytics.stg_users ........................ [RUN]
[0m21:34:16.797966 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_products, now model.digital_marketing.stg_users)
[0m21:34:16.798298 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_users
[0m21:34:16.805326 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_users"
[0m21:34:16.805971 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_users
[0m21:34:16.809858 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_users"
[0m21:34:16.810413 [debug] [Thread-1  ]: On model.digital_marketing.stg_users: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_users"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_users`
  OPTIONS()
  as 

select 
    id, 
    first_name, 
    last_name, 
    concat(coalesce(first_name, ''), ' ', coalesce(last_name, '')) as full_name,
    email,
    age,
    gender,
    state,
    country, 
    latitude,
    longitude,
    traffic_source,
    created_at as registration_date,
    created_at,
    
    -- calculate demographics
    CASE 
        WHEN age BETWEEN 13 and 17 THEN 'Gen Z (13 - 17)'
        WHEN age BETWEEN 18 and 24 THEN 'Gen Z (18 - 24)'
        WHEN age BETWEEN 25 and 40 THEN 'Millennial'
        WHEN age BETWEEN 41 and 56 THEN 'Gen X'
        when age between 57 and 75 then 'Boomer'
        WHEN age > 75 THEN 'Silent'
        ELSE  'Unknown'
    END AS generation,

    CASE 
        WHEN age < 25 THEN  '18-24'
        when age < 35 then '25-34'
        when age < 45 then '35-44'
        when age < 55 then '45-54'
        when age < 65 then '55-64'
        ELSE '65+' 
    END as age_group,

    -- Geographic standardization 
    CASE 
        WHEN country = 'USA' THEN state  
        ELSE country
    END as region,

    CASE 
        WHEN country = 'USA' THEN true
        ELSE false
    END is_domestic,

    -- Acquisition channel grouping
    case 
        when lower(traffic_source) in ('google', 'search', 'organic') then 'Organic Search'
        when lower(traffic_source) in ('facebook', 'instagram', 'social') then 'Social Media'
        when lower(traffic_source) = 'email' then 'Email'
        when lower(traffic_source) in ('youtube', 'video') then 'Video'
        when lower(traffic_source) in ('display', 'banner') then 'Display'
        else 'Other'
    end as acquisition_channel,
    
    -- Data quality flags
    case when email is null or email = '' or not regexp_contains(email, r'^[^@]+@[^@]+\.[^@]+$') 
         then true else false end as has_invalid_email,
    case when age < 13 or age > 120 then true else false end as has_invalid_age,
    case when first_name is null and last_name is null then true else false end as has_missing_name,
    case when latitude is null or longitude is null then true else false end as has_missing_coordinates

from `bigquery-public-data`.`thelook_ecommerce`.`users`
where created_at >= '2019-01-01'
  and created_at <= '2024-12-31'

-- Development environment filter

    qualify row_number() over (order by created_at desc) <= 50000
;


[0m21:34:16.810792 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:34:17.496368 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:c7e80784-d65f-41df-83d8-331173f07cb8&page=queryresults
[0m21:34:17.896484 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6b4bff8-54a3-4532-878d-48047d5b952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139823c70>]}
[0m21:34:17.897899 [info ] [Thread-1  ]: 5 of 5 OK created sql view model dbt_dev_analytics.stg_users ................... [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m21:34:17.899017 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_users
[0m21:34:17.900669 [info ] [MainThread]: 
[0m21:34:17.911360 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m21:34:17.912330 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m21:34:17.913226 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m21:34:17.913972 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m21:34:17.948946 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m21:34:17.962764 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m21:34:17.968820 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m21:34:17.981393 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m21:34:17.982093 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m21:34:17.982439 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.07s]
[0m21:34:17.982696 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:34:18.049329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:34:18.049648 [debug] [MainThread]: Connection 'list_data-products-441119_snapshot' was properly closed.
[0m21:34:18.049853 [debug] [MainThread]: Connection 'model.digital_marketing.stg_users' was properly closed.
[0m21:34:18.050131 [info ] [MainThread]: 
[0m21:34:18.050363 [info ] [MainThread]: Finished running 5 project hooks, 5 view models in 0 hours 0 minutes and 10.36 seconds (10.36s).
[0m21:34:18.051432 [debug] [MainThread]: Command end result
[0m21:34:18.113462 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m21:34:18.114824 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m21:34:18.119269 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m21:34:18.119565 [info ] [MainThread]: 
[0m21:34:18.119839 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:34:18.120072 [info ] [MainThread]: 
[0m21:34:18.120343 [error] [MainThread]: [31mFailure in model stg_products (models/staging/stg_products.sql)[0m
[0m21:34:18.120601 [error] [MainThread]:   Database Error in model stg_products (models/staging/stg_products.sql)
  Syntax error: concatenated string literals must be separated by whitespace or comments at [55:48]
  compiled code at target/run/digital_marketing/models/staging/stg_products.sql
[0m21:34:18.120814 [info ] [MainThread]: 
[0m21:34:18.121055 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/stg_products.sql
[0m21:34:18.121276 [info ] [MainThread]: 
[0m21:34:18.121502 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=10
[0m21:34:18.124067 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.002926, "process_in_blocks": "0", "process_kernel_time": 0.458793, "process_mem_max_rss": "386547712", "process_out_blocks": "0", "process_user_time": 4.478638}
[0m21:34:18.124413 [debug] [MainThread]: Command `dbt run` failed at 21:34:18.124366 after 13.00 seconds
[0m21:34:18.124667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103397d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cc8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fcc95b0>]}
[0m21:34:18.124918 [debug] [MainThread]: Flushing usage events
[0m21:34:18.567776 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:43:34.579908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c63dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106134190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106134460>]}


============================== 21:43:34.583871 | ff2f97a1-934d-4b00-a9e2-c5732a56a417 ==============================
[0m21:43:34.583871 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:43:34.584280 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'write_json': 'True', 'printer_width': '80', 'empty': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'quiet': 'False', 'invocation_command': 'dbt run --select tag:staging', 'version_check': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'log_cache_events': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'introspect': 'True'}
[0m21:43:36.534189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff2f97a1-934d-4b00-a9e2-c5732a56a417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d0d340>]}
[0m21:43:36.571449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff2f97a1-934d-4b00-a9e2-c5732a56a417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060fc940>]}
[0m21:43:36.571858 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:43:36.762270 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m21:43:37.101280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:43:37.101928 [debug] [MainThread]: Partial parsing: updated file: digital_marketing://models/staging/stg_products.sql
[0m21:43:37.407365 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.reports
- models.thelook_analytics.intermediate
- models.thelook_analytics.staging
- models.thelook_analytics.marts.finance
- models.thelook_analytics.marts.core
- seeds.thelook_analytics.product_categories
- seeds.thelook_analytics.customer_segments
- snapshots.thelook_analytics
[0m21:43:37.421404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff2f97a1-934d-4b00-a9e2-c5732a56a417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144794ee0>]}
[0m21:43:37.562583 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m21:43:37.564313 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m21:43:37.584091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff2f97a1-934d-4b00-a9e2-c5732a56a417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1438efe50>]}
[0m21:43:37.584494 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 44 data tests, 6 sources, 1492 macros
[0m21:43:37.584741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff2f97a1-934d-4b00-a9e2-c5732a56a417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14478fca0>]}
[0m21:43:37.586062 [info ] [MainThread]: 
[0m21:43:37.586330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:43:37.586546 [info ] [MainThread]: 
[0m21:43:37.586876 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:43:37.589798 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m21:43:37.590040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:38.226766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now list_data-products-441119_dbt_dev_analytics)
[0m21:43:38.227823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:43:38.788204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev_analytics, now list_data-products-441119_snapshot)
[0m21:43:38.790497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:43:39.390503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff2f97a1-934d-4b00-a9e2-c5732a56a417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a6850>]}
[0m21:43:39.411234 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 04:43:34 ===
[0m21:43:39.412036 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m21:43:39.418983 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m21:43:39.419759 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m21:43:39.426004 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m21:43:39.427112 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m21:43:39.427687 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m21:43:39.428192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:43:40.156222 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:9a0b582c-b8aa-4908-9122-46ab11398914&page=queryresults
[0m21:43:40.625494 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.20s]
[0m21:43:40.675336 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m21:43:40.677718 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m21:43:40.678271 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.05s]
[0m21:43:40.678637 [info ] [MainThread]: 
[0m21:43:40.684004 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_events
[0m21:43:40.684663 [info ] [Thread-1  ]: 1 of 5 START sql view model dbt_dev_analytics.stg_events ....................... [RUN]
[0m21:43:40.685238 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_snapshot, now model.digital_marketing.stg_events)
[0m21:43:40.685620 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_events
[0m21:43:40.692480 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_events"
[0m21:43:40.693067 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_events
[0m21:43:40.718589 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_events"
[0m21:43:40.719274 [debug] [Thread-1  ]: On model.digital_marketing.stg_events: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_events"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_events`
  OPTIONS()
  as 

select
    id as event_id,
    user_id,
    sequence_number,
    session_id,
    created_at as event_timestamp,
    ip_address,
    city,
    state,
    postal_code,
    browser,
    traffic_source,
    uri,
    event_type,
    
    -- Event categorization
    case 
        when event_type = 'home' then 'Navigation'
        when event_type in ('department', 'category', 'brand') then 'Browse'
        when event_type = 'product' then 'Product View'
        when event_type = 'cart' then 'Add to Cart'
        when event_type = 'purchase' then 'Purchase'
        else 'Other'
    end as event_category,
    
    -- Session analysis
    extract(hour from created_at) as event_hour,
    extract(dayofweek from created_at) as event_day_of_week,
    
    -- Geographic
    case when state is not null then state else 'Unknown' end as user_state,
    case when city is not null then city else 'Unknown' end as user_city,
    
    -- Device/browser categorization
    case 
        when lower(browser) like '%chrome%' then 'Chrome'
        when lower(browser) like '%safari%' then 'Safari'
        when lower(browser) like '%firefox%' then 'Firefox'
        when lower(browser) like '%edge%' then 'Edge'
        else 'Other'
    end as browser_family,
    
    -- Data quality
    case when user_id is null then true else false end as has_missing_user,
    case when session_id is null then true else false end as has_missing_session

from `bigquery-public-data`.`thelook_ecommerce`.`events`
where created_at >= '2019-01-01'
  and created_at <= '2024-12-31'

-- Development environment filter

    qualify row_number() over (order by created_at desc) <= 50000
;


[0m21:43:40.719631 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:43:41.383954 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:4cf46d3a-3018-461b-b5f2-46e1a34dced0&page=queryresults
[0m21:43:41.753353 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff2f97a1-934d-4b00-a9e2-c5732a56a417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14479a340>]}
[0m21:43:41.754259 [info ] [Thread-1  ]: 1 of 5 OK created sql view model dbt_dev_analytics.stg_events .................. [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m21:43:41.754967 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_events
[0m21:43:41.755463 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_order_items
[0m21:43:41.756098 [info ] [Thread-1  ]: 2 of 5 START sql view model dbt_dev_analytics.stg_order_items .................. [RUN]
[0m21:43:41.756701 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_events, now model.digital_marketing.stg_order_items)
[0m21:43:41.757165 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_order_items
[0m21:43:41.766441 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_order_items"
[0m21:43:41.767500 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_order_items
[0m21:43:41.773755 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_order_items"
[0m21:43:41.774427 [debug] [Thread-1  ]: On model.digital_marketing.stg_order_items: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_order_items"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
  OPTIONS()
  as 

select
    id as order_item_id,
    order_id,
    user_id,
    product_id,
    inventory_item_id,
    status as item_status,
    created_at as order_item_date,
    shipped_at as item_shipped_date,
    delivered_at as item_delivered_date,
    returned_at as item_returned_date,
    sale_price,
    
    -- Quantity handling (TheLook assumes 1 item per line)
    1 as quantity,
    sale_price as line_total,
    0 as discount_amount,
    
    -- Item status flags
    case when returned_at is not null then true else false end as is_returned,
    case when shipped_at is not null then true else false end as is_shipped,
    case when delivered_at is not null then true else false end as is_delivered,
    case when status = 'Complete' then true else false end as is_complete,
    case when status = 'Cancelled' then true else false end as is_cancelled,
    
    -- Timing analysis
    case when shipped_at is not null then
        date_diff(shipped_at, created_at, day) end as days_to_ship_item,
    case when delivered_at is not null and shipped_at is not null then
        date_diff(delivered_at, shipped_at, day) end as days_in_transit_item,
        
    created_at,
    
    -- Data quality flags
    case when sale_price <= 0 then true else false end as has_invalid_price,
    case when sale_price > 10000 then true else false end as has_extreme_price,
    case when product_id is null then true else false end as has_missing_product,
    case when user_id is null then true else false end as has_missing_user

from `bigquery-public-data`.`thelook_ecommerce`.`order_items`
where created_at >= '2019-01-01'
  and created_at <= '2024-12-31'

-- Development environment filter

    qualify row_number() over (order by created_at desc) <= 50000
;


[0m21:43:41.774889 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:43:42.512910 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:e1606d83-a6f1-4f7f-8ae3-de1a864e4111&page=queryresults
[0m21:43:42.996819 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff2f97a1-934d-4b00-a9e2-c5732a56a417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144fded00>]}
[0m21:43:42.998267 [info ] [Thread-1  ]: 2 of 5 OK created sql view model dbt_dev_analytics.stg_order_items ............. [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m21:43:42.999397 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_order_items
[0m21:43:43.000202 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_orders
[0m21:43:43.001218 [info ] [Thread-1  ]: 3 of 5 START sql view model dbt_dev_analytics.stg_orders ....................... [RUN]
[0m21:43:43.002169 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_order_items, now model.digital_marketing.stg_orders)
[0m21:43:43.002896 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_orders
[0m21:43:43.115057 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_orders"
[0m21:43:43.115673 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_orders
[0m21:43:43.118982 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_orders"
[0m21:43:43.119492 [debug] [Thread-1  ]: On model.digital_marketing.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_orders"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
  OPTIONS()
  as 

select
    order_id,
    user_id,
    status as order_status,
    gender as customer_gender,
    created_at as order_date,
    returned_at,
    shipped_at,
    delivered_at,
    num_of_item as item_count,
    created_at,
    
    -- Order status flags
    case when returned_at is not null then true else false end as is_returned,
    case when shipped_at is not null then true else false end as is_shipped,
    case when delivered_at is not null then true else false end as is_delivered,
    case when status = 'Complete' then true else false end as is_complete,
    case when status = 'Cancelled' then true else false end as is_cancelled,
    
    -- Delivery timing calculations
    case when shipped_at is not null then
        date_diff(shipped_at, created_at, hour) end as hours_to_ship,
    case when delivered_at is not null and shipped_at is not null then
        date_diff(delivered_at, shipped_at, hour) end as hours_in_transit,
    case when delivered_at is not null then
        date_diff(delivered_at, created_at, hour) end as total_delivery_hours,
        
    -- Convert to days for easier analysis
    case when delivered_at is not null then
        date_diff(delivered_at, created_at, day) end as delivery_days,
        
    -- Order timing analysis
    extract(hour from created_at) as order_hour,
    extract(dayofweek from created_at) as order_day_of_week,
    extract(month from created_at) as order_month,
    extract(quarter from created_at) as order_quarter,
    extract(year from created_at) as order_year,
    
    case 
        when extract(hour from created_at) between 6 and 11 then 'Morning'
        when extract(hour from created_at) between 12 and 17 then 'Afternoon'
        when extract(hour from created_at) between 18 and 21 then 'Evening'
        else 'Night'
    end as order_time_of_day,
    
    case extract(dayofweek from created_at)
        when 1 then 'Sunday'
        when 2 then 'Monday'
        when 3 then 'Tuesday'
        when 4 then 'Wednesday'
        when 5 then 'Thursday'
        when 6 then 'Friday'
        when 7 then 'Saturday'
    end as order_day_name,
    
    case when extract(dayofweek from created_at) in (1, 7) then true else false end as is_weekend,
    
    -- Data quality checks
    case when user_id is null then true else false end as has_missing_user,
    case when num_of_item <= 0 then true else false end as has_invalid_item_count,
    case when created_at > current_timestamp() then true else false end as is_future_order

from `bigquery-public-data`.`thelook_ecommerce`.`orders`
where created_at >= '2019-01-01'
  and created_at <= '2024-12-31'

-- Development environment filter

    qualify row_number() over (order by created_at desc) <= 50000
;


[0m21:43:43.119855 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:43:43.834267 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:448666e8-3dbf-49ad-b04c-d8e4a9aaea9d&page=queryresults
[0m21:43:44.176151 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff2f97a1-934d-4b00-a9e2-c5732a56a417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144fad640>]}
[0m21:43:44.177545 [info ] [Thread-1  ]: 3 of 5 OK created sql view model dbt_dev_analytics.stg_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m21:43:44.178643 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_orders
[0m21:43:44.179428 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_products
[0m21:43:44.180324 [info ] [Thread-1  ]: 4 of 5 START sql view model dbt_dev_analytics.stg_products ..................... [RUN]
[0m21:43:44.181287 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_orders, now model.digital_marketing.stg_products)
[0m21:43:44.182114 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_products
[0m21:43:44.194337 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_products"
[0m21:43:44.195386 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_products
[0m21:43:44.202734 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_products"
[0m21:43:44.204116 [debug] [Thread-1  ]: On model.digital_marketing.stg_products: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_products"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_products`
  OPTIONS()
  as 

select
    id as product_id,
    cost,
    category,
    name as product_name,
    brand,
    retail_price,
    department,
    sku,
    distribution_center_id,
    
    -- Margin calculations
    retail_price - cost as margin_amount,
    case when retail_price > 0 then
        round((retail_price - cost) / retail_price * 100, 2)
        else 0 end as margin_percentage,
    
    -- Product categorization
    case 
        when retail_price - cost > 100 then 'Premium'
        when retail_price - cost > 50 then 'High'
        when retail_price - cost > 20 then 'Standard'
        when retail_price - cost > 5 then 'Economy'
        else 'Low'
    end as margin_tier,
    
    case
        when retail_price >= 200 then 'Luxury'
        when retail_price >= 100 then 'Premium'
        when retail_price >= 50 then 'Mid-Range'
        when retail_price >= 20 then 'Budget'
        else 'Economy'
    end as price_category,
    
    -- Category grouping (simplified)
    case 
        when lower(category) like '%apparel%' or lower(category) like '%clothing%' then 'Apparel'
        when lower(category) like '%shoe%' or lower(category) like '%footwear%' then 'Footwear'
        when lower(category) like '%accessori%' or lower(category) like '%jewelry%' then 'Accessories'
        when lower(category) like '%home%' or lower(category) like '%decor%' then 'Home & Decor'
        when lower(category) like '%sport%' or lower(category) like '%outdoor%' then 'Sports & Outdoors'
        else 'Other'
    end as category_group,
    
    -- Brand tier (based on average retail price)
    case 
        when brand in ('Calvin Klein', 'Diesel', 'Hugo Boss') then 'Premium'
        when brand in ('Adidas', 'Nike', "Levi's") then 'Popular'
        else 'Standard'
    end as brand_tier,
    
    -- Data quality flags
    case when cost <= 0 then true else false end as has_invalid_cost,
    case when retail_price <= 0 then true else false end as has_invalid_price,
    case when retail_price < cost then true else false end as has_negative_margin,
    case when cost > 5000 or retail_price > 10000 then true else false end as has_extreme_values,
    case when product_name is null or trim(product_name) = '' then true else false end as has_missing_name

from `bigquery-public-data`.`thelook_ecommerce`.`products`;


[0m21:43:44.204767 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:43:44.968820 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:8edc7879-0a85-4fce-8fa5-f669b5dea731&page=queryresults
[0m21:43:45.135720 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:8edc7879-0a85-4fce-8fa5-f669b5dea731&page=queryresults
[0m21:43:45.200585 [debug] [Thread-1  ]: Database Error in model stg_products (models/staging/stg_products.sql)
  Unrecognized name: product_name at [64:15]
  compiled code at target/run/digital_marketing/models/staging/stg_products.sql
[0m21:43:45.201214 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff2f97a1-934d-4b00-a9e2-c5732a56a417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14479a340>]}
[0m21:43:45.201821 [error] [Thread-1  ]: 4 of 5 ERROR creating sql view model dbt_dev_analytics.stg_products ............ [[31mERROR[0m in 1.02s]
[0m21:43:45.202344 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_products
[0m21:43:45.202703 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_users
[0m21:43:45.203128 [debug] [Thread-4  ]: Marking all children of 'model.digital_marketing.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models/staging/stg_products.sql)
  Unrecognized name: product_name at [64:15]
  compiled code at target/run/digital_marketing/models/staging/stg_products.sql.
[0m21:43:45.203554 [info ] [Thread-1  ]: 5 of 5 START sql view model dbt_dev_analytics.stg_users ........................ [RUN]
[0m21:43:45.204065 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_products, now model.digital_marketing.stg_users)
[0m21:43:45.204396 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_users
[0m21:43:45.211866 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_users"
[0m21:43:45.212487 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_users
[0m21:43:45.216702 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_users"
[0m21:43:45.217437 [debug] [Thread-1  ]: On model.digital_marketing.stg_users: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_users"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_users`
  OPTIONS()
  as 

select 
    id, 
    first_name, 
    last_name, 
    concat(coalesce(first_name, ''), ' ', coalesce(last_name, '')) as full_name,
    email,
    age,
    gender,
    state,
    country, 
    latitude,
    longitude,
    traffic_source,
    created_at as registration_date,
    created_at,
    
    -- calculate demographics
    CASE 
        WHEN age BETWEEN 13 and 17 THEN 'Gen Z (13 - 17)'
        WHEN age BETWEEN 18 and 24 THEN 'Gen Z (18 - 24)'
        WHEN age BETWEEN 25 and 40 THEN 'Millennial'
        WHEN age BETWEEN 41 and 56 THEN 'Gen X'
        when age between 57 and 75 then 'Boomer'
        WHEN age > 75 THEN 'Silent'
        ELSE  'Unknown'
    END AS generation,

    CASE 
        WHEN age < 25 THEN  '18-24'
        when age < 35 then '25-34'
        when age < 45 then '35-44'
        when age < 55 then '45-54'
        when age < 65 then '55-64'
        ELSE '65+' 
    END as age_group,

    -- Geographic standardization 
    CASE 
        WHEN country = 'USA' THEN state  
        ELSE country
    END as region,

    CASE 
        WHEN country = 'USA' THEN true
        ELSE false
    END is_domestic,

    -- Acquisition channel grouping
    case 
        when lower(traffic_source) in ('google', 'search', 'organic') then 'Organic Search'
        when lower(traffic_source) in ('facebook', 'instagram', 'social') then 'Social Media'
        when lower(traffic_source) = 'email' then 'Email'
        when lower(traffic_source) in ('youtube', 'video') then 'Video'
        when lower(traffic_source) in ('display', 'banner') then 'Display'
        else 'Other'
    end as acquisition_channel,
    
    -- Data quality flags
    case when email is null or email = '' or not regexp_contains(email, r'^[^@]+@[^@]+\.[^@]+$') 
         then true else false end as has_invalid_email,
    case when age < 13 or age > 120 then true else false end as has_invalid_age,
    case when first_name is null and last_name is null then true else false end as has_missing_name,
    case when latitude is null or longitude is null then true else false end as has_missing_coordinates

from `bigquery-public-data`.`thelook_ecommerce`.`users`
where created_at >= '2019-01-01'
  and created_at <= '2024-12-31'

-- Development environment filter

    qualify row_number() over (order by created_at desc) <= 50000
;


[0m21:43:45.217834 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:43:45.992201 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:40fcb07b-2d96-487d-9819-174487d498ac&page=queryresults
[0m21:43:46.307590 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff2f97a1-934d-4b00-a9e2-c5732a56a417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14479a340>]}
[0m21:43:46.309027 [info ] [Thread-1  ]: 5 of 5 OK created sql view model dbt_dev_analytics.stg_users ................... [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m21:43:46.310149 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_users
[0m21:43:46.311811 [info ] [MainThread]: 
[0m21:43:46.321509 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m21:43:46.322346 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m21:43:46.323171 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m21:43:46.323900 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m21:43:46.361425 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m21:43:46.375251 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m21:43:46.380693 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m21:43:46.393190 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m21:43:46.393918 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m21:43:46.394259 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.07s]
[0m21:43:46.394515 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:43:46.461561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:43:46.461881 [debug] [MainThread]: Connection 'model.digital_marketing.stg_users' was properly closed.
[0m21:43:46.462165 [info ] [MainThread]: 
[0m21:43:46.462403 [info ] [MainThread]: Finished running 5 project hooks, 5 view models in 0 hours 0 minutes and 8.88 seconds (8.88s).
[0m21:43:46.463468 [debug] [MainThread]: Command end result
[0m21:43:46.526374 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m21:43:46.527869 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m21:43:46.532327 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m21:43:46.532571 [info ] [MainThread]: 
[0m21:43:46.532841 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:43:46.533076 [info ] [MainThread]: 
[0m21:43:46.533336 [error] [MainThread]: [31mFailure in model stg_products (models/staging/stg_products.sql)[0m
[0m21:43:46.533596 [error] [MainThread]:   Database Error in model stg_products (models/staging/stg_products.sql)
  Unrecognized name: product_name at [64:15]
  compiled code at target/run/digital_marketing/models/staging/stg_products.sql
[0m21:43:46.533797 [info ] [MainThread]: 
[0m21:43:46.534041 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/stg_products.sql
[0m21:43:46.534257 [info ] [MainThread]: 
[0m21:43:46.534488 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=10
[0m21:43:46.537053 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.005231, "process_in_blocks": "0", "process_kernel_time": 0.503305, "process_mem_max_rss": "394723328", "process_out_blocks": "0", "process_user_time": 4.730665}
[0m21:43:46.537407 [debug] [MainThread]: Command `dbt run` failed at 21:43:46.537359 after 12.01 seconds
[0m21:43:46.537659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c63dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143494f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14479a7f0>]}
[0m21:43:46.537923 [debug] [MainThread]: Flushing usage events
[0m21:43:46.923168 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:47:46.213482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10916f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10916fc40>]}


============================== 21:47:46.217452 | 6bc29258-c570-4f82-b32f-5adedd5a7381 ==============================
[0m21:47:46.217452 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:47:46.217845 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'debug': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'log_format': 'default', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'target_path': 'None', 'static_parser': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'quiet': 'False', 'empty': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select tag:staging', 'version_check': 'True', 'indirect_selection': 'eager'}
[0m21:47:48.114070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bc29258-c570-4f82-b32f-5adedd5a7381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13360e850>]}
[0m21:47:48.152463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bc29258-c570-4f82-b32f-5adedd5a7381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133817c10>]}
[0m21:47:48.152956 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:47:48.343596 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m21:47:48.681323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:47:48.681984 [debug] [MainThread]: Partial parsing: updated file: digital_marketing://models/staging/stg_products.sql
[0m21:47:48.985172 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.staging
- models.thelook_analytics.reports
- models.thelook_analytics.marts.core
- models.thelook_analytics.marts.finance
- models.thelook_analytics.intermediate
- seeds.thelook_analytics.product_categories
- seeds.thelook_analytics.customer_segments
- snapshots.thelook_analytics
[0m21:47:48.999016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bc29258-c570-4f82-b32f-5adedd5a7381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135a179d0>]}
[0m21:47:49.140401 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m21:47:49.142168 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m21:47:49.160701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bc29258-c570-4f82-b32f-5adedd5a7381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133be2040>]}
[0m21:47:49.161139 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 44 data tests, 6 sources, 1492 macros
[0m21:47:49.161399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bc29258-c570-4f82-b32f-5adedd5a7381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135a12c40>]}
[0m21:47:49.162772 [info ] [MainThread]: 
[0m21:47:49.163031 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:47:49.163246 [info ] [MainThread]: 
[0m21:47:49.163585 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:47:49.166952 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m21:47:49.167258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:47:49.785407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now list_data-products-441119_snapshot)
[0m21:47:49.786211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:47:50.324146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_snapshot, now list_data-products-441119_dbt_dev_analytics)
[0m21:47:50.325058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:47:50.942170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bc29258-c570-4f82-b32f-5adedd5a7381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107184880>]}
[0m21:47:50.962145 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 04:47:46 ===
[0m21:47:50.962891 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m21:47:50.968036 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m21:47:50.968873 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m21:47:50.975556 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m21:47:50.977329 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m21:47:50.977884 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m21:47:50.978375 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:47:51.649628 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:355a7adc-6829-47f9-82df-80863cdea2a6&page=queryresults
[0m21:47:52.128094 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.16s]
[0m21:47:52.179922 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m21:47:52.181802 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m21:47:52.182352 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.05s]
[0m21:47:52.182725 [info ] [MainThread]: 
[0m21:47:52.188293 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_events
[0m21:47:52.189045 [info ] [Thread-1  ]: 1 of 5 START sql view model dbt_dev_analytics.stg_events ....................... [RUN]
[0m21:47:52.189488 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev_analytics, now model.digital_marketing.stg_events)
[0m21:47:52.189849 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_events
[0m21:47:52.196874 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_events"
[0m21:47:52.197449 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_events
[0m21:47:52.223107 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_events"
[0m21:47:52.223806 [debug] [Thread-1  ]: On model.digital_marketing.stg_events: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_events"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_events`
  OPTIONS()
  as 

select
    id as event_id,
    user_id,
    sequence_number,
    session_id,
    created_at as event_timestamp,
    ip_address,
    city,
    state,
    postal_code,
    browser,
    traffic_source,
    uri,
    event_type,
    
    -- Event categorization
    case 
        when event_type = 'home' then 'Navigation'
        when event_type in ('department', 'category', 'brand') then 'Browse'
        when event_type = 'product' then 'Product View'
        when event_type = 'cart' then 'Add to Cart'
        when event_type = 'purchase' then 'Purchase'
        else 'Other'
    end as event_category,
    
    -- Session analysis
    extract(hour from created_at) as event_hour,
    extract(dayofweek from created_at) as event_day_of_week,
    
    -- Geographic
    case when state is not null then state else 'Unknown' end as user_state,
    case when city is not null then city else 'Unknown' end as user_city,
    
    -- Device/browser categorization
    case 
        when lower(browser) like '%chrome%' then 'Chrome'
        when lower(browser) like '%safari%' then 'Safari'
        when lower(browser) like '%firefox%' then 'Firefox'
        when lower(browser) like '%edge%' then 'Edge'
        else 'Other'
    end as browser_family,
    
    -- Data quality
    case when user_id is null then true else false end as has_missing_user,
    case when session_id is null then true else false end as has_missing_session

from `bigquery-public-data`.`thelook_ecommerce`.`events`
where created_at >= '2019-01-01'
  and created_at <= '2024-12-31'

-- Development environment filter

    qualify row_number() over (order by created_at desc) <= 50000
;


[0m21:47:52.224159 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:47:53.080097 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:b374af61-fa0d-4f89-a3b7-d29148cb5e6c&page=queryresults
[0m21:47:53.435435 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bc29258-c570-4f82-b32f-5adedd5a7381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1371daa30>]}
[0m21:47:53.436293 [info ] [Thread-1  ]: 1 of 5 OK created sql view model dbt_dev_analytics.stg_events .................. [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m21:47:53.436976 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_events
[0m21:47:53.437452 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_order_items
[0m21:47:53.438068 [info ] [Thread-1  ]: 2 of 5 START sql view model dbt_dev_analytics.stg_order_items .................. [RUN]
[0m21:47:53.438661 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_events, now model.digital_marketing.stg_order_items)
[0m21:47:53.439131 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_order_items
[0m21:47:53.448616 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_order_items"
[0m21:47:53.449818 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_order_items
[0m21:47:53.456131 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_order_items"
[0m21:47:53.456930 [debug] [Thread-1  ]: On model.digital_marketing.stg_order_items: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_order_items"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
  OPTIONS()
  as 

select
    id as order_item_id,
    order_id,
    user_id,
    product_id,
    inventory_item_id,
    status as item_status,
    created_at as order_item_date,
    shipped_at as item_shipped_date,
    delivered_at as item_delivered_date,
    returned_at as item_returned_date,
    sale_price,
    
    -- Quantity handling (TheLook assumes 1 item per line)
    1 as quantity,
    sale_price as line_total,
    0 as discount_amount,
    
    -- Item status flags
    case when returned_at is not null then true else false end as is_returned,
    case when shipped_at is not null then true else false end as is_shipped,
    case when delivered_at is not null then true else false end as is_delivered,
    case when status = 'Complete' then true else false end as is_complete,
    case when status = 'Cancelled' then true else false end as is_cancelled,
    
    -- Timing analysis
    case when shipped_at is not null then
        date_diff(shipped_at, created_at, day) end as days_to_ship_item,
    case when delivered_at is not null and shipped_at is not null then
        date_diff(delivered_at, shipped_at, day) end as days_in_transit_item,
        
    created_at,
    
    -- Data quality flags
    case when sale_price <= 0 then true else false end as has_invalid_price,
    case when sale_price > 10000 then true else false end as has_extreme_price,
    case when product_id is null then true else false end as has_missing_product,
    case when user_id is null then true else false end as has_missing_user

from `bigquery-public-data`.`thelook_ecommerce`.`order_items`
where created_at >= '2019-01-01'
  and created_at <= '2024-12-31'

-- Development environment filter

    qualify row_number() over (order by created_at desc) <= 50000
;


[0m21:47:53.457411 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:47:54.313303 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:89c10065-573d-41a7-8df3-4076f93f59c2&page=queryresults
[0m21:47:54.707096 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bc29258-c570-4f82-b32f-5adedd5a7381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071973a0>]}
[0m21:47:54.708569 [info ] [Thread-1  ]: 2 of 5 OK created sql view model dbt_dev_analytics.stg_order_items ............. [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m21:47:54.709708 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_order_items
[0m21:47:54.710490 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_orders
[0m21:47:54.711485 [info ] [Thread-1  ]: 3 of 5 START sql view model dbt_dev_analytics.stg_orders ....................... [RUN]
[0m21:47:54.712577 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_order_items, now model.digital_marketing.stg_orders)
[0m21:47:54.713343 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_orders
[0m21:47:54.828400 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_orders"
[0m21:47:54.828978 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_orders
[0m21:47:54.832405 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_orders"
[0m21:47:54.833201 [debug] [Thread-1  ]: On model.digital_marketing.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_orders"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
  OPTIONS()
  as 

select
    order_id,
    user_id,
    status as order_status,
    gender as customer_gender,
    created_at as order_date,
    returned_at,
    shipped_at,
    delivered_at,
    num_of_item as item_count,
    created_at,
    
    -- Order status flags
    case when returned_at is not null then true else false end as is_returned,
    case when shipped_at is not null then true else false end as is_shipped,
    case when delivered_at is not null then true else false end as is_delivered,
    case when status = 'Complete' then true else false end as is_complete,
    case when status = 'Cancelled' then true else false end as is_cancelled,
    
    -- Delivery timing calculations
    case when shipped_at is not null then
        date_diff(shipped_at, created_at, hour) end as hours_to_ship,
    case when delivered_at is not null and shipped_at is not null then
        date_diff(delivered_at, shipped_at, hour) end as hours_in_transit,
    case when delivered_at is not null then
        date_diff(delivered_at, created_at, hour) end as total_delivery_hours,
        
    -- Convert to days for easier analysis
    case when delivered_at is not null then
        date_diff(delivered_at, created_at, day) end as delivery_days,
        
    -- Order timing analysis
    extract(hour from created_at) as order_hour,
    extract(dayofweek from created_at) as order_day_of_week,
    extract(month from created_at) as order_month,
    extract(quarter from created_at) as order_quarter,
    extract(year from created_at) as order_year,
    
    case 
        when extract(hour from created_at) between 6 and 11 then 'Morning'
        when extract(hour from created_at) between 12 and 17 then 'Afternoon'
        when extract(hour from created_at) between 18 and 21 then 'Evening'
        else 'Night'
    end as order_time_of_day,
    
    case extract(dayofweek from created_at)
        when 1 then 'Sunday'
        when 2 then 'Monday'
        when 3 then 'Tuesday'
        when 4 then 'Wednesday'
        when 5 then 'Thursday'
        when 6 then 'Friday'
        when 7 then 'Saturday'
    end as order_day_name,
    
    case when extract(dayofweek from created_at) in (1, 7) then true else false end as is_weekend,
    
    -- Data quality checks
    case when user_id is null then true else false end as has_missing_user,
    case when num_of_item <= 0 then true else false end as has_invalid_item_count,
    case when created_at > current_timestamp() then true else false end as is_future_order

from `bigquery-public-data`.`thelook_ecommerce`.`orders`
where created_at >= '2019-01-01'
  and created_at <= '2024-12-31'

-- Development environment filter

    qualify row_number() over (order by created_at desc) <= 50000
;


[0m21:47:54.833561 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:47:55.642126 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:1c6822d0-67f5-477a-87c6-b40fd25417b4&page=queryresults
[0m21:47:56.062485 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bc29258-c570-4f82-b32f-5adedd5a7381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13745cd60>]}
[0m21:47:56.063949 [info ] [Thread-1  ]: 3 of 5 OK created sql view model dbt_dev_analytics.stg_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m21:47:56.065053 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_orders
[0m21:47:56.065829 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_products
[0m21:47:56.066866 [info ] [Thread-1  ]: 4 of 5 START sql view model dbt_dev_analytics.stg_products ..................... [RUN]
[0m21:47:56.067834 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_orders, now model.digital_marketing.stg_products)
[0m21:47:56.068605 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_products
[0m21:47:56.080590 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_products"
[0m21:47:56.081637 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_products
[0m21:47:56.088853 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_products"
[0m21:47:56.089810 [debug] [Thread-1  ]: On model.digital_marketing.stg_products: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_products"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_products`
  OPTIONS()
  as 

select
    id as product_id,
    cost,
    category,
    name as product_name,
    brand,
    retail_price,
    department,
    sku,
    distribution_center_id,
    
    -- Margin calculations
    retail_price - cost as margin_amount,
    case when retail_price > 0 then
        round((retail_price - cost) / retail_price * 100, 2)
        else 0 end as margin_percentage,
    
    -- Product categorization
    case 
        when retail_price - cost > 100 then 'Premium'
        when retail_price - cost > 50 then 'High'
        when retail_price - cost > 20 then 'Standard'
        when retail_price - cost > 5 then 'Economy'
        else 'Low'
    end as margin_tier,
    
    case
        when retail_price >= 200 then 'Luxury'
        when retail_price >= 100 then 'Premium'
        when retail_price >= 50 then 'Mid-Range'
        when retail_price >= 20 then 'Budget'
        else 'Economy'
    end as price_category,
    
    -- Category grouping (simplified)
    case 
        when lower(category) like '%apparel%' or lower(category) like '%clothing%' then 'Apparel'
        when lower(category) like '%shoe%' or lower(category) like '%footwear%' then 'Footwear'
        when lower(category) like '%accessori%' or lower(category) like '%jewelry%' then 'Accessories'
        when lower(category) like '%home%' or lower(category) like '%decor%' then 'Home & Decor'
        when lower(category) like '%sport%' or lower(category) like '%outdoor%' then 'Sports & Outdoors'
        else 'Other'
    end as category_group,
    
    -- Brand tier (based on average retail price)
    case 
        when brand in ('Calvin Klein', 'Diesel', 'Hugo Boss') then 'Premium'
        when brand in ('Adidas', 'Nike', "Levi's") then 'Popular'
        else 'Standard'
    end as brand_tier,
    
    -- Data quality flags
    case when cost <= 0 then true else false end as has_invalid_cost,
    case when retail_price <= 0 then true else false end as has_invalid_price,
    case when retail_price < cost then true else false end as has_negative_margin,
    case when cost > 5000 or retail_price > 10000 then true else false end as has_extreme_values,
    case when name is null or trim(name) = '' then true else false end as has_missing_name

from `bigquery-public-data`.`thelook_ecommerce`.`products`;


[0m21:47:56.090435 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:47:56.844582 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:00d4b93c-9e9c-48a2-901b-190584afc80d&page=queryresults
[0m21:47:57.175423 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bc29258-c570-4f82-b32f-5adedd5a7381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13727d490>]}
[0m21:47:57.176910 [info ] [Thread-1  ]: 4 of 5 OK created sql view model dbt_dev_analytics.stg_products ................ [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m21:47:57.178056 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_products
[0m21:47:57.178833 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_users
[0m21:47:57.179889 [info ] [Thread-1  ]: 5 of 5 START sql view model dbt_dev_analytics.stg_users ........................ [RUN]
[0m21:47:57.181126 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_products, now model.digital_marketing.stg_users)
[0m21:47:57.181932 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_users
[0m21:47:57.196619 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_users"
[0m21:47:57.197689 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_users
[0m21:47:57.204964 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_users"
[0m21:47:57.205992 [debug] [Thread-1  ]: On model.digital_marketing.stg_users: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_users"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_users`
  OPTIONS()
  as 

select 
    id, 
    first_name, 
    last_name, 
    concat(coalesce(first_name, ''), ' ', coalesce(last_name, '')) as full_name,
    email,
    age,
    gender,
    state,
    country, 
    latitude,
    longitude,
    traffic_source,
    created_at as registration_date,
    created_at,
    
    -- calculate demographics
    CASE 
        WHEN age BETWEEN 13 and 17 THEN 'Gen Z (13 - 17)'
        WHEN age BETWEEN 18 and 24 THEN 'Gen Z (18 - 24)'
        WHEN age BETWEEN 25 and 40 THEN 'Millennial'
        WHEN age BETWEEN 41 and 56 THEN 'Gen X'
        when age between 57 and 75 then 'Boomer'
        WHEN age > 75 THEN 'Silent'
        ELSE  'Unknown'
    END AS generation,

    CASE 
        WHEN age < 25 THEN  '18-24'
        when age < 35 then '25-34'
        when age < 45 then '35-44'
        when age < 55 then '45-54'
        when age < 65 then '55-64'
        ELSE '65+' 
    END as age_group,

    -- Geographic standardization 
    CASE 
        WHEN country = 'USA' THEN state  
        ELSE country
    END as region,

    CASE 
        WHEN country = 'USA' THEN true
        ELSE false
    END is_domestic,

    -- Acquisition channel grouping
    case 
        when lower(traffic_source) in ('google', 'search', 'organic') then 'Organic Search'
        when lower(traffic_source) in ('facebook', 'instagram', 'social') then 'Social Media'
        when lower(traffic_source) = 'email' then 'Email'
        when lower(traffic_source) in ('youtube', 'video') then 'Video'
        when lower(traffic_source) in ('display', 'banner') then 'Display'
        else 'Other'
    end as acquisition_channel,
    
    -- Data quality flags
    case when email is null or email = '' or not regexp_contains(email, r'^[^@]+@[^@]+\.[^@]+$') 
         then true else false end as has_invalid_email,
    case when age < 13 or age > 120 then true else false end as has_invalid_age,
    case when first_name is null and last_name is null then true else false end as has_missing_name,
    case when latitude is null or longitude is null then true else false end as has_missing_coordinates

from `bigquery-public-data`.`thelook_ecommerce`.`users`
where created_at >= '2019-01-01'
  and created_at <= '2024-12-31'

-- Development environment filter

    qualify row_number() over (order by created_at desc) <= 50000
;


[0m21:47:57.206786 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:47:58.036832 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:9d384689-5237-41ae-93e4-2859ec4a6323&page=queryresults
[0m21:47:58.421607 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bc29258-c570-4f82-b32f-5adedd5a7381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13727d490>]}
[0m21:47:58.423136 [info ] [Thread-1  ]: 5 of 5 OK created sql view model dbt_dev_analytics.stg_users ................... [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m21:47:58.424263 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_users
[0m21:47:58.425902 [info ] [MainThread]: 
[0m21:47:58.435511 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m21:47:58.436558 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m21:47:58.437464 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m21:47:58.438265 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m21:47:58.474326 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m21:47:58.488063 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m21:47:58.493921 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m21:47:58.506072 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m21:47:58.507492 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m21:47:58.507872 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.07s]
[0m21:47:58.508148 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:47:58.574724 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:47:58.575041 [debug] [MainThread]: Connection 'model.digital_marketing.stg_users' was properly closed.
[0m21:47:58.575327 [info ] [MainThread]: 
[0m21:47:58.575567 [info ] [MainThread]: Finished running 5 project hooks, 5 view models in 0 hours 0 minutes and 9.41 seconds (9.41s).
[0m21:47:58.576642 [debug] [MainThread]: Command end result
[0m21:47:58.639058 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m21:47:58.640591 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m21:47:58.645040 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m21:47:58.645272 [info ] [MainThread]: 
[0m21:47:58.645545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:47:58.645766 [info ] [MainThread]: 
[0m21:47:58.646002 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m21:47:58.648539 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.484885, "process_in_blocks": "0", "process_kernel_time": 0.490558, "process_mem_max_rss": "395689984", "process_out_blocks": "0", "process_user_time": 4.639712}
[0m21:47:58.648890 [debug] [MainThread]: Command `dbt run` succeeded at 21:47:58.648841 after 12.49 seconds
[0m21:47:58.649146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072abd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ca67a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133be2040>]}
[0m21:47:58.649401 [debug] [MainThread]: Flushing usage events
[0m21:47:59.087665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:48:37.016268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10855f280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10855f550>]}


============================== 21:48:37.019709 | c552ef78-bb14-4356-986f-41a74ab65d88 ==============================
[0m21:48:37.019709 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:48:37.020081 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'write_json': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:staging', 'printer_width': '80', 'use_colors': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'log_format': 'default', 'debug': 'False', 'partial_parse': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'quiet': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None'}
[0m21:48:38.682760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c552ef78-bb14-4356-986f-41a74ab65d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb45eb0>]}
[0m21:48:38.724071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c552ef78-bb14-4356-986f-41a74ab65d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bc34700>]}
[0m21:48:38.724663 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:48:38.932947 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m21:48:39.307343 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:48:39.307720 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:48:39.314593 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.marts.core
- models.thelook_analytics.staging
- models.thelook_analytics.intermediate
- models.thelook_analytics.marts.finance
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.reports
- seeds.thelook_analytics.customer_segments
- seeds.thelook_analytics.product_categories
- snapshots.thelook_analytics
[0m21:48:39.390109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c552ef78-bb14-4356-986f-41a74ab65d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c5c7eb0>]}
[0m21:48:39.549790 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m21:48:39.551980 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m21:48:39.578554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c552ef78-bb14-4356-986f-41a74ab65d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c878070>]}
[0m21:48:39.579033 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 44 data tests, 6 sources, 1492 macros
[0m21:48:39.579299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c552ef78-bb14-4356-986f-41a74ab65d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c1434c0>]}
[0m21:48:39.581082 [info ] [MainThread]: 
[0m21:48:39.581386 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:48:39.581605 [info ] [MainThread]: 
[0m21:48:39.581960 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:48:39.588490 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_dbt_dev_analytics'
[0m21:48:39.588901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:40.209943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev_analytics, now list_data-products-441119_snapshot)
[0m21:48:40.212548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:48:40.848732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c552ef78-bb14-4356-986f-41a74ab65d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c6dc190>]}
[0m21:48:40.861700 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 04:48:37 ===
[0m21:48:40.862139 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m21:48:40.864142 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m21:48:40.864541 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.01s]
[0m21:48:40.868057 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m21:48:40.868958 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m21:48:40.869399 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m21:48:40.869824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:41.441536 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:69e11fb1-ec3d-4919-a5b6-2841c80d9625&page=queryresults
[0m21:48:41.853192 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 0.99s]
[0m21:48:42.239754 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m21:48:42.242421 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m21:48:42.243359 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.39s]
[0m21:48:42.244007 [info ] [MainThread]: 
[0m21:48:42.252761 [debug] [Thread-1  ]: Began running node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__1000__0.ddf03bf96f
[0m21:48:42.253573 [info ] [Thread-1  ]: 1 of 18 START test dbt_utils_accepted_range_stg_order_items_sale_price__1000__0  [RUN]
[0m21:48:42.254948 [debug] [Thread-1  ]: Acquiring new bigquery connection 'test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__1000__0.ddf03bf96f'
[0m21:48:42.255605 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__1000__0.ddf03bf96f
[0m21:48:42.275144 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__1000__0.ddf03bf96f"
[0m21:48:42.276214 [debug] [Thread-1  ]: Began executing node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__1000__0.ddf03bf96f
[0m21:48:42.301962 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__1000__0.ddf03bf96f"
[0m21:48:42.302788 [debug] [Thread-1  ]: On test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__1000__0.ddf03bf96f: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__1000__0.ddf03bf96f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sale_price >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sale_price <= 1000
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:48:42.303187 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:48:43.566063 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:e171bc46-c7d5-4cd7-a8d9-f0a40e7f6bea&page=queryresults
[0m21:48:44.296074 [info ] [Thread-1  ]: 1 of 18 PASS dbt_utils_accepted_range_stg_order_items_sale_price__1000__0 ...... [[32mPASS[0m in 2.04s]
[0m21:48:44.297457 [debug] [Thread-1  ]: Finished running node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__1000__0.ddf03bf96f
[0m21:48:44.298278 [debug] [Thread-1  ]: Began running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m21:48:44.299097 [info ] [Thread-1  ]: 2 of 18 START test dbt_utils_accepted_range_stg_users_age__120__13 ............. [RUN]
[0m21:48:44.299907 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__1000__0.ddf03bf96f, now test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2)
[0m21:48:44.300539 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m21:48:44.313356 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"
[0m21:48:44.314462 [debug] [Thread-1  ]: Began executing node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m21:48:44.321084 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"
[0m21:48:44.321900 [debug] [Thread-1  ]: On test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not age >= 13
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not age <= 120
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:48:44.322432 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:48:45.614273 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:d37cae47-bbdc-49b7-a57c-0e5c432fd346&page=queryresults
[0m21:48:46.171986 [error] [Thread-1  ]: 2 of 18 FAIL 870 dbt_utils_accepted_range_stg_users_age__120__13 ............... [[31mFAIL 870[0m in 1.87s]
[0m21:48:46.172656 [debug] [Thread-1  ]: Finished running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m21:48:46.173056 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:48:46.173478 [info ] [Thread-1  ]: 3 of 18 START test not_null_stg_order_items_order_item_id ...................... [RUN]
[0m21:48:46.173955 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2, now test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m21:48:46.174297 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:48:46.182959 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:48:46.183685 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:48:46.188524 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:48:46.189131 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m21:48:46.189464 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:48:47.323293 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:89a44b9f-53d1-43b1-93d3-17c58a98c726&page=queryresults
[0m21:48:47.874798 [info ] [Thread-1  ]: 3 of 18 PASS not_null_stg_order_items_order_item_id ............................ [[32mPASS[0m in 1.70s]
[0m21:48:47.876173 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:48:47.876980 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m21:48:47.877841 [info ] [Thread-1  ]: 4 of 18 START test not_null_stg_order_items_sale_price ......................... [RUN]
[0m21:48:47.878816 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0)
[0m21:48:47.879599 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m21:48:47.891445 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"
[0m21:48:47.892700 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m21:48:47.901530 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"
[0m21:48:47.902648 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sale_price
from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
where sale_price is null



  
  
      
    ) dbt_internal_test
[0m21:48:47.903250 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:48:48.926005 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:041b164f-e24c-4181-b91a-6ee62e9e1245&page=queryresults
[0m21:48:49.550303 [info ] [Thread-1  ]: 4 of 18 PASS not_null_stg_order_items_sale_price ............................... [[32mPASS[0m in 1.67s]
[0m21:48:49.551705 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m21:48:49.552521 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m21:48:49.553392 [info ] [Thread-1  ]: 5 of 18 START test not_null_stg_orders_order_date .............................. [RUN]
[0m21:48:49.554373 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0, now test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb)
[0m21:48:49.555145 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m21:48:49.566950 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"
[0m21:48:49.568376 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m21:48:49.575531 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"
[0m21:48:49.576427 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
where order_date is null



  
  
      
    ) dbt_internal_test
[0m21:48:49.577020 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:48:50.915909 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:3dc4ad5a-2cd1-4e05-b31e-102f6356fee4&page=queryresults
[0m21:48:51.505527 [info ] [Thread-1  ]: 5 of 18 PASS not_null_stg_orders_order_date .................................... [[32mPASS[0m in 1.95s]
[0m21:48:51.506885 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m21:48:51.507689 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m21:48:51.508553 [info ] [Thread-1  ]: 6 of 18 START test not_null_stg_orders_order_id ................................ [RUN]
[0m21:48:51.509520 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb, now test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64)
[0m21:48:51.510166 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m21:48:51.522886 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:48:51.524017 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m21:48:51.530841 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:48:51.531682 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:48:51.532207 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:48:52.827128 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:37e1b26b-805e-4f06-9e1d-c3e284ea97f7&page=queryresults
[0m21:48:53.405839 [info ] [Thread-1  ]: 6 of 18 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 1.90s]
[0m21:48:53.407188 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m21:48:53.407985 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m21:48:53.408872 [info ] [Thread-1  ]: 7 of 18 START test not_null_stg_orders_user_id ................................. [RUN]
[0m21:48:53.409856 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64, now test.digital_marketing.not_null_stg_orders_user_id.7d129d0209)
[0m21:48:53.410622 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m21:48:53.423846 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"
[0m21:48:53.425244 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m21:48:53.432439 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"
[0m21:48:53.433427 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_orders_user_id.7d129d0209: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m21:48:53.434027 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:48:54.627414 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:7ae030c6-3c40-48cf-a9cb-433dc8cc4d90&page=queryresults
[0m21:48:55.221624 [info ] [Thread-1  ]: 7 of 18 PASS not_null_stg_orders_user_id ....................................... [[32mPASS[0m in 1.81s]
[0m21:48:55.222943 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m21:48:55.223749 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m21:48:55.224620 [info ] [Thread-1  ]: 8 of 18 START test not_null_stg_products_product_id ............................ [RUN]
[0m21:48:55.225599 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_user_id.7d129d0209, now test.digital_marketing.not_null_stg_products_product_id.6373b0acf3)
[0m21:48:55.226377 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m21:48:55.238153 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"
[0m21:48:55.239581 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m21:48:55.248127 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"
[0m21:48:55.249246 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m21:48:55.249857 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:48:56.260980 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:22bc930b-b017-4e91-ba45-b453dc7eafcb&page=queryresults
[0m21:48:56.987019 [info ] [Thread-1  ]: 8 of 18 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 1.76s]
[0m21:48:56.988250 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m21:48:56.989042 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m21:48:56.989912 [info ] [Thread-1  ]: 9 of 18 START test not_null_stg_users_email .................................... [RUN]
[0m21:48:56.990881 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_products_product_id.6373b0acf3, now test.digital_marketing.not_null_stg_users_email.2723c62e0e)
[0m21:48:56.991647 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m21:48:57.003737 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_email.2723c62e0e"
[0m21:48:57.005386 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m21:48:57.013522 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_email.2723c62e0e"
[0m21:48:57.014561 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_email.2723c62e0e: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_email.2723c62e0e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where email is null



  
  
      
    ) dbt_internal_test
[0m21:48:57.015170 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:48:58.062820 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:dece6736-9461-4dab-a838-a0a8bfaf459c&page=queryresults
[0m21:48:58.655456 [info ] [Thread-1  ]: 9 of 18 PASS not_null_stg_users_email .......................................... [[32mPASS[0m in 1.66s]
[0m21:48:58.656780 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m21:48:58.657573 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m21:48:58.658424 [info ] [Thread-1  ]: 10 of 18 START test not_null_stg_users_full_name ............................... [RUN]
[0m21:48:58.659358 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_email.2723c62e0e, now test.digital_marketing.not_null_stg_users_full_name.6892d7acba)
[0m21:48:58.660109 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m21:48:58.672172 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_full_name.6892d7acba"
[0m21:48:58.673525 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m21:48:58.680641 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_full_name.6892d7acba"
[0m21:48:58.681518 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_full_name.6892d7acba: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_full_name.6892d7acba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select full_name
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where full_name is null



  
  
      
    ) dbt_internal_test
[0m21:48:58.682103 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:48:59.804609 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:960a44a1-5824-4e2a-8495-f313976c7706&page=queryresults
[0m21:49:00.402457 [info ] [Thread-1  ]: 10 of 18 PASS not_null_stg_users_full_name ..................................... [[32mPASS[0m in 1.74s]
[0m21:49:00.403779 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m21:49:00.404586 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_registration_date.a93f364730
[0m21:49:00.405427 [info ] [Thread-1  ]: 11 of 18 START test not_null_stg_users_registration_date ....................... [RUN]
[0m21:49:00.406370 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_full_name.6892d7acba, now test.digital_marketing.not_null_stg_users_registration_date.a93f364730)
[0m21:49:00.407137 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_registration_date.a93f364730
[0m21:49:00.420797 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_registration_date.a93f364730"
[0m21:49:00.422013 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_registration_date.a93f364730
[0m21:49:00.429117 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_registration_date.a93f364730"
[0m21:49:00.430296 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_registration_date.a93f364730: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_registration_date.a93f364730"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select registration_date
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where registration_date is null



  
  
      
    ) dbt_internal_test
[0m21:49:00.430911 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:49:01.589326 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:69c3a947-dfe0-40ca-a21d-b391f573327a&page=queryresults
[0m21:49:02.199093 [info ] [Thread-1  ]: 11 of 18 PASS not_null_stg_users_registration_date ............................. [[32mPASS[0m in 1.79s]
[0m21:49:02.200471 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_registration_date.a93f364730
[0m21:49:02.201287 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m21:49:02.202168 [info ] [Thread-1  ]: 12 of 18 START test not_null_stg_users_user_id ................................. [RUN]
[0m21:49:02.203138 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_registration_date.a93f364730, now test.digital_marketing.not_null_stg_users_user_id.980dfc1b77)
[0m21:49:02.203902 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m21:49:02.217171 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"
[0m21:49:02.218473 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m21:49:02.225619 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"
[0m21:49:02.226844 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m21:49:02.227430 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:49:02.868970 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:c9977186-aecd-4395-a7a8-3a67498392b2&page=queryresults
[0m21:49:02.870978 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:c9977186-aecd-4395-a7a8-3a67498392b2&page=queryresults
[0m21:49:02.931835 [debug] [Thread-1  ]: Database Error in test not_null_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:7]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/not_null_stg_users_user_id.sql
[0m21:49:02.932451 [error] [Thread-1  ]: 12 of 18 ERROR not_null_stg_users_user_id ...................................... [[31mERROR[0m in 0.73s]
[0m21:49:02.932979 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m21:49:02.933360 [debug] [Thread-1  ]: Began running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m21:49:02.933826 [debug] [Thread-4  ]: Marking all children of 'test.digital_marketing.not_null_stg_users_user_id.980dfc1b77' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:7]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/not_null_stg_users_user_id.sql.
[0m21:49:02.934221 [info ] [Thread-1  ]: 13 of 18 START test relationships_stg_orders_user_id__user_id__ref_stg_users_ .. [RUN]
[0m21:49:02.934819 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_user_id.980dfc1b77, now test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737)
[0m21:49:02.935200 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m21:49:02.944734 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"
[0m21:49:02.945607 [debug] [Thread-1  ]: Began executing node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m21:49:02.950501 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"
[0m21:49:02.951090 [debug] [Thread-1  ]: On test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
    where user_id is not null
),

parent as (
    select user_id as to_field
    from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:49:02.951425 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:49:03.738963 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:4fb055f0-43f9-4db3-9fec-3d1492bf1cc0&page=queryresults
[0m21:49:03.741062 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:4fb055f0-43f9-4db3-9fec-3d1492bf1cc0&page=queryresults
[0m21:49:03.769726 [debug] [Thread-1  ]: Database Error in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [21:12]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql
[0m21:49:03.770658 [error] [Thread-1  ]: 13 of 18 ERROR relationships_stg_orders_user_id__user_id__ref_stg_users_ ....... [[31mERROR[0m in 0.84s]
[0m21:49:03.771436 [debug] [Thread-1  ]: Finished running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m21:49:03.772002 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m21:49:03.772692 [debug] [Thread-4  ]: Marking all children of 'test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [21:12]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql.
[0m21:49:03.773273 [info ] [Thread-1  ]: 14 of 18 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m21:49:03.774046 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737, now test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108)
[0m21:49:03.774594 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m21:49:03.785772 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"
[0m21:49:03.786732 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m21:49:03.792781 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"
[0m21:49:03.793634 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_item_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
  where order_item_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:49:03.794268 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:49:05.172288 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:9ed4cb2f-58d0-4bbf-99dd-40dcb661eefd&page=queryresults
[0m21:49:05.739435 [info ] [Thread-1  ]: 14 of 18 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 1.97s]
[0m21:49:05.740842 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m21:49:05.741656 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m21:49:05.742526 [info ] [Thread-1  ]: 15 of 18 START test unique_stg_orders_order_id ................................. [RUN]
[0m21:49:05.743499 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108, now test.digital_marketing.unique_stg_orders_order_id.e3b841c71a)
[0m21:49:05.744285 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m21:49:05.756749 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"
[0m21:49:05.758049 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m21:49:05.765702 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"
[0m21:49:05.766877 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:49:05.767484 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:49:07.013828 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:65d57417-b52b-4079-91af-7d9d8c28620b&page=queryresults
[0m21:49:07.647839 [info ] [Thread-1  ]: 15 of 18 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 1.90s]
[0m21:49:07.649244 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m21:49:07.650041 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m21:49:07.650917 [info ] [Thread-1  ]: 16 of 18 START test unique_stg_products_product_id ............................. [RUN]
[0m21:49:07.651922 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_orders_order_id.e3b841c71a, now test.digital_marketing.unique_stg_products_product_id.7d950a1467)
[0m21:49:07.652703 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m21:49:07.664566 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_products_product_id.7d950a1467"
[0m21:49:07.665854 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m21:49:07.673296 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_products_product_id.7d950a1467"
[0m21:49:07.674203 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:49:07.674806 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:49:08.759159 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:84041593-2849-4fe6-89d5-231f64a3ffbd&page=queryresults
[0m21:49:09.433129 [info ] [Thread-1  ]: 16 of 18 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 1.78s]
[0m21:49:09.434488 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m21:49:09.435284 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m21:49:09.436159 [info ] [Thread-1  ]: 17 of 18 START test unique_stg_users_email ..................................... [RUN]
[0m21:49:09.437139 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_products_product_id.7d950a1467, now test.digital_marketing.unique_stg_users_email.7ba574d07b)
[0m21:49:09.437898 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m21:49:09.451635 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_users_email.7ba574d07b"
[0m21:49:09.452960 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m21:49:09.460252 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_users_email.7ba574d07b"
[0m21:49:09.461474 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_users_email.7ba574d07b: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_users_email.7ba574d07b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select email as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
  where email is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:49:09.462112 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:49:10.701080 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:2523c095-bd97-4867-8750-e824a196c354&page=queryresults
[0m21:49:11.317718 [error] [Thread-1  ]: 17 of 18 FAIL 3702 unique_stg_users_email ...................................... [[31mFAIL 3702[0m in 1.88s]
[0m21:49:11.319083 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m21:49:11.319869 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m21:49:11.320739 [info ] [Thread-1  ]: 18 of 18 START test unique_stg_users_user_id ................................... [RUN]
[0m21:49:11.321709 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_users_email.7ba574d07b, now test.digital_marketing.unique_stg_users_user_id.c2ff477e6b)
[0m21:49:11.322474 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m21:49:11.335594 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"
[0m21:49:11.336739 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m21:49:11.440973 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"
[0m21:49:11.441627 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:49:11.441926 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:49:12.340790 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:8902aa28-6fa4-416a-bc08-9b7453774853&page=queryresults
[0m21:49:12.342626 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:8902aa28-6fa4-416a-bc08-9b7453774853&page=queryresults
[0m21:49:12.371124 [debug] [Thread-1  ]: Database Error in test unique_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:9]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_user_id.sql
[0m21:49:12.372034 [error] [Thread-1  ]: 18 of 18 ERROR unique_stg_users_user_id ........................................ [[31mERROR[0m in 1.05s]
[0m21:49:12.372819 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m21:49:12.373475 [debug] [Thread-4  ]: Marking all children of 'test.digital_marketing.unique_stg_users_user_id.c2ff477e6b' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:9]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_user_id.sql.
[0m21:49:12.374770 [info ] [MainThread]: 
[0m21:49:12.381919 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m21:49:12.382483 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m21:49:12.383119 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m21:49:12.383714 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m21:49:12.420923 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m21:49:12.426543 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m21:49:12.435610 [debug] [MainThread]: Elementary: Handling test results.
[0m21:49:12.571683 [debug] [MainThread]: Elementary: Deleting temporary Elementary test tables: []
[0m21:49:12.582389 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m21:49:12.582740 [debug] [MainThread]: Elementary: Handled test results successfully.
[0m21:49:12.591749 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m21:49:12.593165 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m21:49:12.593506 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.21s]
[0m21:49:12.593760 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:49:12.659733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:12.660047 [debug] [MainThread]: Connection 'list_data-products-441119_snapshot' was properly closed.
[0m21:49:12.660253 [debug] [MainThread]: Connection 'test.digital_marketing.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m21:49:12.660524 [info ] [MainThread]: 
[0m21:49:12.660764 [info ] [MainThread]: Finished running 5 project hooks, 18 data tests in 0 hours 0 minutes and 33.08 seconds (33.08s).
[0m21:49:12.662811 [debug] [MainThread]: Command end result
[0m21:49:12.725863 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m21:49:12.727346 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m21:49:12.732218 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m21:49:12.732471 [info ] [MainThread]: 
[0m21:49:12.732729 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m21:49:12.732961 [info ] [MainThread]: 
[0m21:49:12.733226 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_stg_users_age__120__13 (models/staging/_staging_models.yml)[0m
[0m21:49:12.733477 [error] [MainThread]:   Got 870 results, configured to fail if != 0
[0m21:49:12.733678 [info ] [MainThread]: 
[0m21:49:12.733920 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/dbt_utils_accepted_range_stg_users_age__120__13.sql
[0m21:49:12.734128 [info ] [MainThread]: 
[0m21:49:12.734365 [error] [MainThread]: [31mFailure in test not_null_stg_users_user_id (models/staging/_staging_models.yml)[0m
[0m21:49:12.734610 [error] [MainThread]:   Database Error in test not_null_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:7]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/not_null_stg_users_user_id.sql
[0m21:49:12.734813 [info ] [MainThread]: 
[0m21:49:12.735044 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/not_null_stg_users_user_id.sql
[0m21:49:12.735249 [info ] [MainThread]: 
[0m21:49:12.735490 [error] [MainThread]: [31mFailure in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)[0m
[0m21:49:12.735738 [error] [MainThread]:   Database Error in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [21:12]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql
[0m21:49:12.735945 [info ] [MainThread]: 
[0m21:49:12.736178 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql
[0m21:49:12.736382 [info ] [MainThread]: 
[0m21:49:12.736616 [error] [MainThread]: [31mFailure in test unique_stg_users_email (models/staging/_staging_models.yml)[0m
[0m21:49:12.736847 [error] [MainThread]:   Got 3702 results, configured to fail if != 0
[0m21:49:12.737045 [info ] [MainThread]: 
[0m21:49:12.737273 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_email.sql
[0m21:49:12.737473 [info ] [MainThread]: 
[0m21:49:12.737785 [error] [MainThread]: [31mFailure in test unique_stg_users_user_id (models/staging/_staging_models.yml)[0m
[0m21:49:12.738149 [error] [MainThread]:   Database Error in test unique_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:9]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_user_id.sql
[0m21:49:12.738400 [info ] [MainThread]: 
[0m21:49:12.738655 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_user_id.sql
[0m21:49:12.738892 [info ] [MainThread]: 
[0m21:49:12.739129 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=23
[0m21:49:12.742185 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 35.77305, "process_in_blocks": "0", "process_kernel_time": 0.54455, "process_mem_max_rss": "388317184", "process_out_blocks": "0", "process_user_time": 6.74812}
[0m21:49:12.742695 [debug] [MainThread]: Command `dbt test` failed at 21:49:12.742639 after 35.77 seconds
[0m21:49:12.742960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c878fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c878dc0>]}
[0m21:49:12.743226 [debug] [MainThread]: Flushing usage events
[0m21:49:13.085050 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:51:55.982410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ffd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dcf220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dcf4f0>]}


============================== 21:51:55.986206 | c340b3ae-3aa4-4234-9b4c-65b7df7f0c08 ==============================
[0m21:51:55.986206 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:51:55.986585 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:staging', 'version_check': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'printer_width': '80', 'introspect': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'target_path': 'None', 'profiles_dir': '/Users/azadsolanki/.dbt', 'quiet': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'no_print': 'None', 'cache_selected_only': 'False'}
[0m21:51:57.838699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c340b3ae-3aa4-4234-9b4c-65b7df7f0c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143eabeb0>]}
[0m21:51:57.875841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c340b3ae-3aa4-4234-9b4c-65b7df7f0c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143fff3a0>]}
[0m21:51:57.876261 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:51:58.068398 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m21:51:58.399640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:51:58.400538 [debug] [MainThread]: Partial parsing: updated file: digital_marketing://models/staging/_staging_models.yml
[0m21:51:58.744419 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.marts.core
- models.thelook_analytics.staging
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.intermediate
- models.thelook_analytics.marts.finance
- models.thelook_analytics.reports
- seeds.thelook_analytics.product_categories
- seeds.thelook_analytics.customer_segments
- snapshots.thelook_analytics
[0m21:51:58.758603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c340b3ae-3aa4-4234-9b4c-65b7df7f0c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145b3bdc0>]}
[0m21:51:58.897182 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m21:51:58.900023 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m21:51:58.922848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c340b3ae-3aa4-4234-9b4c-65b7df7f0c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1459f9820>]}
[0m21:51:58.923245 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 43 data tests, 6 sources, 1492 macros
[0m21:51:58.923495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c340b3ae-3aa4-4234-9b4c-65b7df7f0c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1457922b0>]}
[0m21:51:58.925042 [info ] [MainThread]: 
[0m21:51:58.925294 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:51:58.925515 [info ] [MainThread]: 
[0m21:51:58.925842 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:51:58.931290 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_snapshot'
[0m21:51:58.931636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:59.562028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_snapshot, now list_data-products-441119_dbt_dev_analytics)
[0m21:51:59.563335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:52:00.099348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c340b3ae-3aa4-4234-9b4c-65b7df7f0c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1459f8190>]}
[0m21:52:00.118637 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 04:51:55 ===
[0m21:52:00.119282 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m21:52:00.123075 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m21:52:00.123744 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.02s]
[0m21:52:00.130257 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m21:52:00.132170 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m21:52:00.132761 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m21:52:00.133329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:52:00.788430 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:e6f10724-ac0d-4a4a-87d2-f38503f993ee&page=queryresults
[0m21:52:01.257189 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.13s]
[0m21:52:01.610260 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m21:52:01.612682 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m21:52:01.614063 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.36s]
[0m21:52:01.614755 [info ] [MainThread]: 
[0m21:52:01.620083 [debug] [Thread-1  ]: Began running node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m21:52:01.620640 [info ] [Thread-1  ]: 1 of 17 START test dbt_utils_accepted_range_stg_order_items_sale_price__10000__0  [RUN]
[0m21:52:01.621142 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev_analytics, now test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde)
[0m21:52:01.621449 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m21:52:01.626913 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde"
[0m21:52:01.627663 [debug] [Thread-1  ]: Began executing node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m21:52:01.651261 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde"
[0m21:52:01.652265 [debug] [Thread-1  ]: On test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sale_price >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sale_price <= 10000
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:52:01.652817 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:52:02.924496 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:d729cdc6-fafb-4b64-b8dd-ebf3341eb57e&page=queryresults
[0m21:52:03.561952 [info ] [Thread-1  ]: 1 of 17 PASS dbt_utils_accepted_range_stg_order_items_sale_price__10000__0 ..... [[32mPASS[0m in 1.94s]
[0m21:52:03.563333 [debug] [Thread-1  ]: Finished running node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m21:52:03.564084 [debug] [Thread-1  ]: Began running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m21:52:03.564698 [info ] [Thread-1  ]: 2 of 17 START test dbt_utils_accepted_range_stg_users_age__120__13 ............. [RUN]
[0m21:52:03.565401 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde, now test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2)
[0m21:52:03.566112 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m21:52:03.681295 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"
[0m21:52:03.681861 [debug] [Thread-1  ]: Began executing node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m21:52:03.685157 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"
[0m21:52:03.685612 [debug] [Thread-1  ]: On test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not age >= 13
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not age <= 120
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:52:03.685917 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:52:04.517701 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:c3324963-c178-4be7-bd18-af842aa4a4f3&page=queryresults
[0m21:52:05.053417 [error] [Thread-1  ]: 2 of 17 FAIL 870 dbt_utils_accepted_range_stg_users_age__120__13 ............... [[31mFAIL 870[0m in 1.49s]
[0m21:52:05.054165 [debug] [Thread-1  ]: Finished running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m21:52:05.054573 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:52:05.055029 [info ] [Thread-1  ]: 3 of 17 START test not_null_stg_order_items_order_item_id ...................... [RUN]
[0m21:52:05.055548 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2, now test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m21:52:05.055924 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:52:05.065578 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:52:05.066831 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:52:05.077015 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:52:05.078049 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m21:52:05.078642 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:52:05.907453 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:a8903848-ccc4-436d-9ab1-789748d73d6c&page=queryresults
[0m21:52:06.548981 [info ] [Thread-1  ]: 3 of 17 PASS not_null_stg_order_items_order_item_id ............................ [[32mPASS[0m in 1.49s]
[0m21:52:06.550313 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:52:06.551094 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m21:52:06.551947 [info ] [Thread-1  ]: 4 of 17 START test not_null_stg_order_items_sale_price ......................... [RUN]
[0m21:52:06.552909 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0)
[0m21:52:06.553683 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m21:52:06.565579 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"
[0m21:52:06.567032 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m21:52:06.575647 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"
[0m21:52:06.576664 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sale_price
from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
where sale_price is null



  
  
      
    ) dbt_internal_test
[0m21:52:06.577650 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:52:07.442094 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:99fb89e5-b2f9-4f39-a554-aa74a5634fbe&page=queryresults
[0m21:52:07.985792 [info ] [Thread-1  ]: 4 of 17 PASS not_null_stg_order_items_sale_price ............................... [[32mPASS[0m in 1.43s]
[0m21:52:07.987109 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m21:52:07.987897 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m21:52:07.988755 [info ] [Thread-1  ]: 5 of 17 START test not_null_stg_orders_order_date .............................. [RUN]
[0m21:52:07.989703 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0, now test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb)
[0m21:52:07.990462 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m21:52:08.002864 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"
[0m21:52:08.004047 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m21:52:08.011327 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"
[0m21:52:08.012452 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
where order_date is null



  
  
      
    ) dbt_internal_test
[0m21:52:08.013049 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:52:09.081548 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:8fbe5276-9835-4dda-8a84-9143c99c8bd4&page=queryresults
[0m21:52:09.704285 [info ] [Thread-1  ]: 5 of 17 PASS not_null_stg_orders_order_date .................................... [[32mPASS[0m in 1.71s]
[0m21:52:09.705654 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m21:52:09.706449 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m21:52:09.707306 [info ] [Thread-1  ]: 6 of 17 START test not_null_stg_orders_order_id ................................ [RUN]
[0m21:52:09.708262 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb, now test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64)
[0m21:52:09.709023 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m21:52:09.722948 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:52:09.724250 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m21:52:09.731347 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:52:09.732321 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:52:09.732903 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:52:10.884079 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:d5d483d6-f375-4b9c-b1f0-a812e632cfdf&page=queryresults
[0m21:52:11.509524 [info ] [Thread-1  ]: 6 of 17 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 1.80s]
[0m21:52:11.510877 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m21:52:11.511668 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m21:52:11.512531 [info ] [Thread-1  ]: 7 of 17 START test not_null_stg_orders_user_id ................................. [RUN]
[0m21:52:11.513509 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64, now test.digital_marketing.not_null_stg_orders_user_id.7d129d0209)
[0m21:52:11.514272 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m21:52:11.527755 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"
[0m21:52:11.529090 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m21:52:11.536201 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"
[0m21:52:11.537348 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_orders_user_id.7d129d0209: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m21:52:11.537960 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:52:12.665203 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:854d0dcf-570e-4439-97b1-0287500ffdda&page=queryresults
[0m21:52:13.238448 [info ] [Thread-1  ]: 7 of 17 PASS not_null_stg_orders_user_id ....................................... [[32mPASS[0m in 1.72s]
[0m21:52:13.239779 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m21:52:13.240584 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m21:52:13.241506 [info ] [Thread-1  ]: 8 of 17 START test not_null_stg_products_product_id ............................ [RUN]
[0m21:52:13.242524 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_user_id.7d129d0209, now test.digital_marketing.not_null_stg_products_product_id.6373b0acf3)
[0m21:52:13.243192 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m21:52:13.253936 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"
[0m21:52:13.254984 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m21:52:13.263721 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"
[0m21:52:13.264695 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m21:52:13.265335 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:52:14.099698 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:7c3e13b5-4f70-48f8-bb25-40832652e67b&page=queryresults
[0m21:52:14.618216 [info ] [Thread-1  ]: 8 of 17 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 1.38s]
[0m21:52:14.619510 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m21:52:14.620296 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m21:52:14.621147 [info ] [Thread-1  ]: 9 of 17 START test not_null_stg_users_email .................................... [RUN]
[0m21:52:14.622113 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_products_product_id.6373b0acf3, now test.digital_marketing.not_null_stg_users_email.2723c62e0e)
[0m21:52:14.622868 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m21:52:14.635681 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_email.2723c62e0e"
[0m21:52:14.637093 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m21:52:14.645337 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_email.2723c62e0e"
[0m21:52:14.646229 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_email.2723c62e0e: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_email.2723c62e0e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where email is null



  
  
      
    ) dbt_internal_test
[0m21:52:14.646802 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:52:15.460621 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:10ad62ff-be54-4792-95e0-897dea712ce2&page=queryresults
[0m21:52:16.155464 [info ] [Thread-1  ]: 9 of 17 PASS not_null_stg_users_email .......................................... [[32mPASS[0m in 1.53s]
[0m21:52:16.156795 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m21:52:16.157586 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m21:52:16.158436 [info ] [Thread-1  ]: 10 of 17 START test not_null_stg_users_full_name ............................... [RUN]
[0m21:52:16.159381 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_email.2723c62e0e, now test.digital_marketing.not_null_stg_users_full_name.6892d7acba)
[0m21:52:16.160137 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m21:52:16.172075 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_full_name.6892d7acba"
[0m21:52:16.173372 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m21:52:16.180533 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_full_name.6892d7acba"
[0m21:52:16.181391 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_full_name.6892d7acba: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_full_name.6892d7acba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select full_name
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where full_name is null



  
  
      
    ) dbt_internal_test
[0m21:52:16.181977 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:52:16.966068 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:8f15896b-fd7d-48ed-91f1-700f3e306ef9&page=queryresults
[0m21:52:17.607177 [info ] [Thread-1  ]: 10 of 17 PASS not_null_stg_users_full_name ..................................... [[32mPASS[0m in 1.45s]
[0m21:52:17.608494 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m21:52:17.609296 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m21:52:17.610138 [info ] [Thread-1  ]: 11 of 17 START test not_null_stg_users_user_id ................................. [RUN]
[0m21:52:17.611090 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_full_name.6892d7acba, now test.digital_marketing.not_null_stg_users_user_id.980dfc1b77)
[0m21:52:17.611850 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m21:52:17.625583 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"
[0m21:52:17.626738 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m21:52:17.633625 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"
[0m21:52:17.634472 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m21:52:17.635091 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:52:18.423264 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:4ecdbeb1-28ce-45df-9097-757d5c41fba5&page=queryresults
[0m21:52:18.425362 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:4ecdbeb1-28ce-45df-9097-757d5c41fba5&page=queryresults
[0m21:52:18.483885 [debug] [Thread-1  ]: Database Error in test not_null_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:7]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/not_null_stg_users_user_id.sql
[0m21:52:18.484491 [error] [Thread-1  ]: 11 of 17 ERROR not_null_stg_users_user_id ...................................... [[31mERROR[0m in 0.87s]
[0m21:52:18.485009 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m21:52:18.485384 [debug] [Thread-1  ]: Began running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m21:52:18.485848 [debug] [Thread-4  ]: Marking all children of 'test.digital_marketing.not_null_stg_users_user_id.980dfc1b77' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:7]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/not_null_stg_users_user_id.sql.
[0m21:52:18.486232 [info ] [Thread-1  ]: 12 of 17 START test relationships_stg_orders_user_id__user_id__ref_stg_users_ .. [RUN]
[0m21:52:18.486795 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_user_id.980dfc1b77, now test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737)
[0m21:52:18.487163 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m21:52:18.494773 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"
[0m21:52:18.495453 [debug] [Thread-1  ]: Began executing node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m21:52:18.499578 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"
[0m21:52:18.500098 [debug] [Thread-1  ]: On test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
    where user_id is not null
),

parent as (
    select user_id as to_field
    from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:52:18.500453 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:52:19.324508 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:ff9fbbb6-6c62-4a6b-af1e-f26e0c0afedd&page=queryresults
[0m21:52:19.326627 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:ff9fbbb6-6c62-4a6b-af1e-f26e0c0afedd&page=queryresults
[0m21:52:19.354485 [debug] [Thread-1  ]: Database Error in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [21:12]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql
[0m21:52:19.355372 [error] [Thread-1  ]: 12 of 17 ERROR relationships_stg_orders_user_id__user_id__ref_stg_users_ ....... [[31mERROR[0m in 0.87s]
[0m21:52:19.356127 [debug] [Thread-1  ]: Finished running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m21:52:19.356673 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m21:52:19.357348 [debug] [Thread-4  ]: Marking all children of 'test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [21:12]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql.
[0m21:52:19.357956 [info ] [Thread-1  ]: 13 of 17 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m21:52:19.358778 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737, now test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108)
[0m21:52:19.359319 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m21:52:19.370325 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"
[0m21:52:19.371239 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m21:52:19.378266 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"
[0m21:52:19.379084 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_item_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
  where order_item_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:52:19.379539 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:52:20.290014 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:c073aea3-b24a-4c14-8bb2-e49a2aef2de7&page=queryresults
[0m21:52:20.919963 [info ] [Thread-1  ]: 13 of 17 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 1.56s]
[0m21:52:20.921414 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m21:52:20.922217 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m21:52:20.923096 [info ] [Thread-1  ]: 14 of 17 START test unique_stg_orders_order_id ................................. [RUN]
[0m21:52:20.924056 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108, now test.digital_marketing.unique_stg_orders_order_id.e3b841c71a)
[0m21:52:20.924840 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m21:52:20.936229 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"
[0m21:52:20.937491 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m21:52:20.946341 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"
[0m21:52:20.947416 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:52:20.948019 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:52:21.997069 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:d6713cc4-dc5e-4968-abfc-b2a98a0fa9cf&page=queryresults
[0m21:52:22.587248 [info ] [Thread-1  ]: 14 of 17 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 1.66s]
[0m21:52:22.588673 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m21:52:22.589474 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m21:52:22.590323 [info ] [Thread-1  ]: 15 of 17 START test unique_stg_products_product_id ............................. [RUN]
[0m21:52:22.591278 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_orders_order_id.e3b841c71a, now test.digital_marketing.unique_stg_products_product_id.7d950a1467)
[0m21:52:22.592053 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m21:52:22.604095 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_products_product_id.7d950a1467"
[0m21:52:22.605436 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m21:52:22.613000 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_products_product_id.7d950a1467"
[0m21:52:22.614080 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:52:22.614671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:52:23.304510 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:327ecf9a-8ef8-458b-8f74-52d29de92deb&page=queryresults
[0m21:52:23.882153 [info ] [Thread-1  ]: 15 of 17 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 1.29s]
[0m21:52:23.883434 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m21:52:23.884222 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m21:52:23.885077 [info ] [Thread-1  ]: 16 of 17 START test unique_stg_users_email ..................................... [RUN]
[0m21:52:23.886042 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_products_product_id.7d950a1467, now test.digital_marketing.unique_stg_users_email.7ba574d07b)
[0m21:52:23.886801 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m21:52:23.899701 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_users_email.7ba574d07b"
[0m21:52:23.900902 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m21:52:23.907906 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_users_email.7ba574d07b"
[0m21:52:23.909026 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_users_email.7ba574d07b: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_users_email.7ba574d07b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select email as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
  where email is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:52:23.909638 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:52:24.752744 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:eb1adcd8-f5a5-4b51-a5d9-59440548b3a9&page=queryresults
[0m21:52:25.488211 [error] [Thread-1  ]: 16 of 17 FAIL 3702 unique_stg_users_email ...................................... [[31mFAIL 3702[0m in 1.60s]
[0m21:52:25.489533 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m21:52:25.490325 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m21:52:25.491169 [info ] [Thread-1  ]: 17 of 17 START test unique_stg_users_user_id ................................... [RUN]
[0m21:52:25.492125 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_users_email.7ba574d07b, now test.digital_marketing.unique_stg_users_user_id.c2ff477e6b)
[0m21:52:25.492880 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m21:52:25.505613 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"
[0m21:52:25.506861 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m21:52:25.514139 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"
[0m21:52:25.515259 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:52:25.515874 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:52:26.386037 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:4edaebab-92e8-4691-b8f1-10e795a22ea9&page=queryresults
[0m21:52:26.387123 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:4edaebab-92e8-4691-b8f1-10e795a22ea9&page=queryresults
[0m21:52:26.410901 [debug] [Thread-1  ]: Database Error in test unique_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:9]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_user_id.sql
[0m21:52:26.411699 [error] [Thread-1  ]: 17 of 17 ERROR unique_stg_users_user_id ........................................ [[31mERROR[0m in 0.92s]
[0m21:52:26.412368 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m21:52:26.412934 [debug] [Thread-4  ]: Marking all children of 'test.digital_marketing.unique_stg_users_user_id.c2ff477e6b' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:9]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_user_id.sql.
[0m21:52:26.414072 [info ] [MainThread]: 
[0m21:52:26.420559 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m21:52:26.421058 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m21:52:26.421599 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m21:52:26.422079 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m21:52:26.456106 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m21:52:26.461707 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m21:52:26.470383 [debug] [MainThread]: Elementary: Handling test results.
[0m21:52:26.604173 [debug] [MainThread]: Elementary: Deleting temporary Elementary test tables: []
[0m21:52:26.614877 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m21:52:26.615247 [debug] [MainThread]: Elementary: Handled test results successfully.
[0m21:52:26.624282 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m21:52:26.625760 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m21:52:26.626220 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.20s]
[0m21:52:26.626527 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:52:26.692371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:52:26.692704 [debug] [MainThread]: Connection 'test.digital_marketing.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m21:52:26.692975 [info ] [MainThread]: 
[0m21:52:26.693210 [info ] [MainThread]: Finished running 5 project hooks, 17 data tests in 0 hours 0 minutes and 27.77 seconds (27.77s).
[0m21:52:26.695158 [debug] [MainThread]: Command end result
[0m21:52:26.758181 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m21:52:26.759686 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m21:52:26.764169 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m21:52:26.764412 [info ] [MainThread]: 
[0m21:52:26.764670 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m21:52:26.764899 [info ] [MainThread]: 
[0m21:52:26.765163 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_stg_users_age__120__13 (models/staging/_staging_models.yml)[0m
[0m21:52:26.765417 [error] [MainThread]:   Got 870 results, configured to fail if != 0
[0m21:52:26.765623 [info ] [MainThread]: 
[0m21:52:26.765866 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/dbt_utils_accepted_range_stg_users_age__120__13.sql
[0m21:52:26.766078 [info ] [MainThread]: 
[0m21:52:26.766323 [error] [MainThread]: [31mFailure in test not_null_stg_users_user_id (models/staging/_staging_models.yml)[0m
[0m21:52:26.766574 [error] [MainThread]:   Database Error in test not_null_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:7]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/not_null_stg_users_user_id.sql
[0m21:52:26.766784 [info ] [MainThread]: 
[0m21:52:26.767016 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/not_null_stg_users_user_id.sql
[0m21:52:26.767221 [info ] [MainThread]: 
[0m21:52:26.767463 [error] [MainThread]: [31mFailure in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)[0m
[0m21:52:26.767708 [error] [MainThread]:   Database Error in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [21:12]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql
[0m21:52:26.767912 [info ] [MainThread]: 
[0m21:52:26.768146 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql
[0m21:52:26.768356 [info ] [MainThread]: 
[0m21:52:26.768591 [error] [MainThread]: [31mFailure in test unique_stg_users_email (models/staging/_staging_models.yml)[0m
[0m21:52:26.768829 [error] [MainThread]:   Got 3702 results, configured to fail if != 0
[0m21:52:26.769022 [info ] [MainThread]: 
[0m21:52:26.769355 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_email.sql
[0m21:52:26.769617 [info ] [MainThread]: 
[0m21:52:26.769903 [error] [MainThread]: [31mFailure in test unique_stg_users_user_id (models/staging/_staging_models.yml)[0m
[0m21:52:26.770161 [error] [MainThread]:   Database Error in test unique_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:9]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_user_id.sql
[0m21:52:26.770372 [info ] [MainThread]: 
[0m21:52:26.770607 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_user_id.sql
[0m21:52:26.770830 [info ] [MainThread]: 
[0m21:52:26.771056 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=22
[0m21:52:26.773593 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 30.837366, "process_in_blocks": "0", "process_kernel_time": 0.549751, "process_mem_max_rss": "401522688", "process_out_blocks": "0", "process_user_time": 6.748367}
[0m21:52:26.773941 [debug] [MainThread]: Command `dbt test` failed at 21:52:26.773892 after 30.84 seconds
[0m21:52:26.774193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ffd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143eabeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1459f8040>]}
[0m21:52:26.774445 [debug] [MainThread]: Flushing usage events
[0m21:52:27.155873 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:55:10.469854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c23dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f3460>]}


============================== 21:55:10.473459 | 4e693140-e625-469a-be47-791d5f16aeea ==============================
[0m21:55:10.473459 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:55:10.473849 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'target_path': 'None', 'use_colors': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:staging', 'version_check': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'quiet': 'False', 'empty': 'None', 'static_parser': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'debug': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default'}
[0m21:55:12.173463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e693140-e625-469a-be47-791d5f16aeea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174fb850>]}
[0m21:55:12.211628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e693140-e625-469a-be47-791d5f16aeea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d09c610>]}
[0m21:55:12.212094 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:55:12.405679 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m21:55:12.741036 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:55:12.741690 [debug] [MainThread]: Partial parsing: updated file: digital_marketing://models/staging/stg_users.sql
[0m21:55:13.054659 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.intermediate
- models.thelook_analytics.marts.core
- models.thelook_analytics.marts.finance
- models.thelook_analytics.reports
- models.thelook_analytics.staging
- models.thelook_analytics.marts.marketing
- seeds.thelook_analytics.product_categories
- seeds.thelook_analytics.customer_segments
- snapshots.thelook_analytics
[0m21:55:13.070446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e693140-e625-469a-be47-791d5f16aeea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e477130>]}
[0m21:55:13.211086 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m21:55:13.212723 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m21:55:13.235897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e693140-e625-469a-be47-791d5f16aeea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e540cd0>]}
[0m21:55:13.236317 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 43 data tests, 6 sources, 1492 macros
[0m21:55:13.236566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e693140-e625-469a-be47-791d5f16aeea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e0b7fa0>]}
[0m21:55:13.238139 [info ] [MainThread]: 
[0m21:55:13.238393 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:55:13.238609 [info ] [MainThread]: 
[0m21:55:13.238936 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:55:13.244099 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_dbt_dev_analytics'
[0m21:55:13.244417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:13.915960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev_analytics, now list_data-products-441119_snapshot)
[0m21:55:13.917768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:14.530006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e693140-e625-469a-be47-791d5f16aeea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e2f6c40>]}
[0m21:55:14.553684 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 04:55:10 ===
[0m21:55:14.554495 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m21:55:14.558473 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m21:55:14.559171 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m21:55:14.565825 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m21:55:14.566903 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m21:55:14.567440 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m21:55:14.567909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:55:15.205914 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:d7480800-2633-4f83-b87b-4382dd5fd62b&page=queryresults
[0m21:55:15.716996 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.16s]
[0m21:55:16.174355 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m21:55:16.177135 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m21:55:16.178082 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.46s]
[0m21:55:16.178746 [info ] [MainThread]: 
[0m21:55:16.188658 [debug] [Thread-1  ]: Began running node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m21:55:16.189757 [info ] [Thread-1  ]: 1 of 17 START test dbt_utils_accepted_range_stg_order_items_sale_price__10000__0  [RUN]
[0m21:55:16.190664 [debug] [Thread-1  ]: Acquiring new bigquery connection 'test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde'
[0m21:55:16.191280 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m21:55:16.201614 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde"
[0m21:55:16.202762 [debug] [Thread-1  ]: Began executing node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m21:55:16.232345 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde"
[0m21:55:16.233108 [debug] [Thread-1  ]: On test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sale_price >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sale_price <= 10000
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:55:16.233547 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:55:17.211958 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:051db723-e4d0-4927-8836-af5d04654dc1&page=queryresults
[0m21:55:17.798227 [info ] [Thread-1  ]: 1 of 17 PASS dbt_utils_accepted_range_stg_order_items_sale_price__10000__0 ..... [[32mPASS[0m in 1.61s]
[0m21:55:17.799574 [debug] [Thread-1  ]: Finished running node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m21:55:17.800365 [debug] [Thread-1  ]: Began running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m21:55:17.801143 [info ] [Thread-1  ]: 2 of 17 START test dbt_utils_accepted_range_stg_users_age__120__13 ............. [RUN]
[0m21:55:17.801938 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde, now test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2)
[0m21:55:17.802582 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m21:55:17.813414 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"
[0m21:55:17.815333 [debug] [Thread-1  ]: Began executing node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m21:55:17.823073 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"
[0m21:55:17.823964 [debug] [Thread-1  ]: On test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not age >= 13
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not age <= 120
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:55:17.824495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:18.624870 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:8ab49987-589f-4688-8ce5-35b4beb04834&page=queryresults
[0m21:55:19.451887 [error] [Thread-1  ]: 2 of 17 FAIL 870 dbt_utils_accepted_range_stg_users_age__120__13 ............... [[31mFAIL 870[0m in 1.65s]
[0m21:55:19.453237 [debug] [Thread-1  ]: Finished running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m21:55:19.454052 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:55:19.454939 [info ] [Thread-1  ]: 3 of 17 START test not_null_stg_order_items_order_item_id ...................... [RUN]
[0m21:55:19.455915 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2, now test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m21:55:19.456689 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:55:19.473507 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:55:19.475382 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:55:19.482196 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:55:19.483087 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m21:55:19.483641 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:20.264013 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:bc6c777a-44c6-4994-916e-3e8e8617033f&page=queryresults
[0m21:55:20.891786 [info ] [Thread-1  ]: 3 of 17 PASS not_null_stg_order_items_order_item_id ............................ [[32mPASS[0m in 1.44s]
[0m21:55:20.893125 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:55:20.893917 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m21:55:20.894759 [info ] [Thread-1  ]: 4 of 17 START test not_null_stg_order_items_sale_price ......................... [RUN]
[0m21:55:20.895706 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0)
[0m21:55:20.896477 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m21:55:20.910375 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"
[0m21:55:20.911571 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m21:55:20.918586 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"
[0m21:55:20.919543 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sale_price
from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
where sale_price is null



  
  
      
    ) dbt_internal_test
[0m21:55:20.920129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:21.798938 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:6e32b561-0285-4926-8cfd-a156a18594ec&page=queryresults
[0m21:55:22.625537 [info ] [Thread-1  ]: 4 of 17 PASS not_null_stg_order_items_sale_price ............................... [[32mPASS[0m in 1.73s]
[0m21:55:22.626877 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m21:55:22.627669 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m21:55:22.628548 [info ] [Thread-1  ]: 5 of 17 START test not_null_stg_orders_order_date .............................. [RUN]
[0m21:55:22.629500 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0, now test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb)
[0m21:55:22.630246 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m21:55:22.643578 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"
[0m21:55:22.644786 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m21:55:22.651556 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"
[0m21:55:22.652490 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
where order_date is null



  
  
      
    ) dbt_internal_test
[0m21:55:22.653113 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:23.846462 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:f9ca16a4-97e5-4703-bc21-a6e458ef595c&page=queryresults
[0m21:55:24.473327 [info ] [Thread-1  ]: 5 of 17 PASS not_null_stg_orders_order_date .................................... [[32mPASS[0m in 1.84s]
[0m21:55:24.474699 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m21:55:24.475513 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m21:55:24.476393 [info ] [Thread-1  ]: 6 of 17 START test not_null_stg_orders_order_id ................................ [RUN]
[0m21:55:24.477370 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb, now test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64)
[0m21:55:24.478154 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m21:55:24.489876 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:55:24.491111 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m21:55:24.499806 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:55:24.500872 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:55:24.501456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:25.689660 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:d02535dc-3929-48df-a5da-ab636eca862e&page=queryresults
[0m21:55:26.413285 [info ] [Thread-1  ]: 6 of 17 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 1.94s]
[0m21:55:26.414618 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m21:55:26.415421 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m21:55:26.416292 [info ] [Thread-1  ]: 7 of 17 START test not_null_stg_orders_user_id ................................. [RUN]
[0m21:55:26.417263 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64, now test.digital_marketing.not_null_stg_orders_user_id.7d129d0209)
[0m21:55:26.418045 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m21:55:26.430167 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"
[0m21:55:26.432268 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m21:55:26.440654 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"
[0m21:55:26.441681 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_orders_user_id.7d129d0209: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m21:55:26.442277 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:27.533767 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:f0cc3b6d-37fc-449e-a6f1-d14e89adda24&page=queryresults
[0m21:55:28.137776 [info ] [Thread-1  ]: 7 of 17 PASS not_null_stg_orders_user_id ....................................... [[32mPASS[0m in 1.72s]
[0m21:55:28.138386 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m21:55:28.138749 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m21:55:28.139131 [info ] [Thread-1  ]: 8 of 17 START test not_null_stg_products_product_id ............................ [RUN]
[0m21:55:28.139528 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_user_id.7d129d0209, now test.digital_marketing.not_null_stg_products_product_id.6373b0acf3)
[0m21:55:28.139838 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m21:55:28.145188 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"
[0m21:55:28.145872 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m21:55:28.149799 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"
[0m21:55:28.150387 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m21:55:28.150707 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:28.963163 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:e56e0812-98e3-4ca7-91cb-1802cb59320a&page=queryresults
[0m21:55:29.581617 [info ] [Thread-1  ]: 8 of 17 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 1.44s]
[0m21:55:29.582546 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m21:55:29.583120 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m21:55:29.583739 [info ] [Thread-1  ]: 9 of 17 START test not_null_stg_users_email .................................... [RUN]
[0m21:55:29.584430 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_products_product_id.6373b0acf3, now test.digital_marketing.not_null_stg_users_email.2723c62e0e)
[0m21:55:29.584967 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m21:55:29.594577 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_email.2723c62e0e"
[0m21:55:29.595530 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m21:55:29.601300 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_email.2723c62e0e"
[0m21:55:29.602206 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_email.2723c62e0e: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_email.2723c62e0e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where email is null



  
  
      
    ) dbt_internal_test
[0m21:55:29.602659 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:30.380388 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:c34836fd-8799-40ba-925b-e9ed701074c8&page=queryresults
[0m21:55:30.914573 [info ] [Thread-1  ]: 9 of 17 PASS not_null_stg_users_email .......................................... [[32mPASS[0m in 1.33s]
[0m21:55:30.915876 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m21:55:30.916547 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m21:55:30.917260 [info ] [Thread-1  ]: 10 of 17 START test not_null_stg_users_full_name ............................... [RUN]
[0m21:55:30.918163 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_email.2723c62e0e, now test.digital_marketing.not_null_stg_users_full_name.6892d7acba)
[0m21:55:30.918784 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m21:55:30.930664 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_full_name.6892d7acba"
[0m21:55:30.931914 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m21:55:30.938743 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_full_name.6892d7acba"
[0m21:55:30.939609 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_full_name.6892d7acba: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_full_name.6892d7acba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select full_name
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where full_name is null



  
  
      
    ) dbt_internal_test
[0m21:55:30.940115 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:31.830670 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:c8b8d66c-3ff8-4405-90b7-ffd3768c0c2d&page=queryresults
[0m21:55:32.443945 [info ] [Thread-1  ]: 10 of 17 PASS not_null_stg_users_full_name ..................................... [[32mPASS[0m in 1.53s]
[0m21:55:32.445580 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m21:55:32.446447 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m21:55:32.447304 [info ] [Thread-1  ]: 11 of 17 START test not_null_stg_users_user_id ................................. [RUN]
[0m21:55:32.448216 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_full_name.6892d7acba, now test.digital_marketing.not_null_stg_users_user_id.980dfc1b77)
[0m21:55:32.448964 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m21:55:32.460167 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"
[0m21:55:32.462142 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m21:55:32.470810 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"
[0m21:55:32.471900 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m21:55:32.472489 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:33.262274 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:0d0e0352-6a06-4bb3-ac49-c03eea9af1f7&page=queryresults
[0m21:55:33.263405 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:0d0e0352-6a06-4bb3-ac49-c03eea9af1f7&page=queryresults
[0m21:55:33.317416 [debug] [Thread-1  ]: Database Error in test not_null_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:7]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/not_null_stg_users_user_id.sql
[0m21:55:33.317995 [error] [Thread-1  ]: 11 of 17 ERROR not_null_stg_users_user_id ...................................... [[31mERROR[0m in 0.87s]
[0m21:55:33.318483 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m21:55:33.318838 [debug] [Thread-1  ]: Began running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m21:55:33.319276 [debug] [Thread-4  ]: Marking all children of 'test.digital_marketing.not_null_stg_users_user_id.980dfc1b77' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:7]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/not_null_stg_users_user_id.sql.
[0m21:55:33.319639 [info ] [Thread-1  ]: 12 of 17 START test relationships_stg_orders_user_id__user_id__ref_stg_users_ .. [RUN]
[0m21:55:33.320143 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_user_id.980dfc1b77, now test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737)
[0m21:55:33.320482 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m21:55:33.328845 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"
[0m21:55:33.329478 [debug] [Thread-1  ]: Began executing node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m21:55:33.334204 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"
[0m21:55:33.334908 [debug] [Thread-1  ]: On test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
    where user_id is not null
),

parent as (
    select user_id as to_field
    from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:55:33.335244 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:34.030505 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:8d234c60-2cc9-402b-81c7-cc02a14dfa65&page=queryresults
[0m21:55:34.032486 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:8d234c60-2cc9-402b-81c7-cc02a14dfa65&page=queryresults
[0m21:55:34.060328 [debug] [Thread-1  ]: Database Error in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [21:12]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql
[0m21:55:34.061287 [error] [Thread-1  ]: 12 of 17 ERROR relationships_stg_orders_user_id__user_id__ref_stg_users_ ....... [[31mERROR[0m in 0.74s]
[0m21:55:34.062152 [debug] [Thread-1  ]: Finished running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m21:55:34.062869 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m21:55:34.063706 [debug] [Thread-4  ]: Marking all children of 'test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [21:12]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql.
[0m21:55:34.064275 [info ] [Thread-1  ]: 13 of 17 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m21:55:34.065062 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737, now test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108)
[0m21:55:34.065586 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m21:55:34.076313 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"
[0m21:55:34.077217 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m21:55:34.082944 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"
[0m21:55:34.084063 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_item_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
  where order_item_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:55:34.084561 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:34.854126 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:68798df5-7c02-4309-b40a-e7c7f58ccd57&page=queryresults
[0m21:55:35.741744 [info ] [Thread-1  ]: 13 of 17 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 1.68s]
[0m21:55:35.743107 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m21:55:35.743904 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m21:55:35.744747 [info ] [Thread-1  ]: 14 of 17 START test unique_stg_orders_order_id ................................. [RUN]
[0m21:55:35.745692 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108, now test.digital_marketing.unique_stg_orders_order_id.e3b841c71a)
[0m21:55:35.746455 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m21:55:35.758132 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"
[0m21:55:35.759310 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m21:55:35.766663 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"
[0m21:55:35.770168 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:55:35.770773 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:36.852584 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:b259020e-50c0-4071-8ce3-accff9835cc1&page=queryresults
[0m21:55:37.421012 [info ] [Thread-1  ]: 14 of 17 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 1.67s]
[0m21:55:37.422414 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m21:55:37.423215 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m21:55:37.424077 [info ] [Thread-1  ]: 15 of 17 START test unique_stg_products_product_id ............................. [RUN]
[0m21:55:37.425030 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_orders_order_id.e3b841c71a, now test.digital_marketing.unique_stg_products_product_id.7d950a1467)
[0m21:55:37.425787 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m21:55:37.438987 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_products_product_id.7d950a1467"
[0m21:55:37.440164 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m21:55:37.447419 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_products_product_id.7d950a1467"
[0m21:55:37.448326 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:55:37.448992 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:38.171488 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:c6ac0c4a-2701-4db4-8d35-3e18c79b3e19&page=queryresults
[0m21:55:38.706821 [info ] [Thread-1  ]: 15 of 17 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 1.28s]
[0m21:55:38.708090 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m21:55:38.708872 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m21:55:38.709715 [info ] [Thread-1  ]: 16 of 17 START test unique_stg_users_email ..................................... [RUN]
[0m21:55:38.710697 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_products_product_id.7d950a1467, now test.digital_marketing.unique_stg_users_email.7ba574d07b)
[0m21:55:38.711471 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m21:55:38.724666 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_users_email.7ba574d07b"
[0m21:55:38.725832 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m21:55:38.732770 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_users_email.7ba574d07b"
[0m21:55:38.733665 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_users_email.7ba574d07b: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_users_email.7ba574d07b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select email as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
  where email is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:55:38.734499 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:39.457838 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:3d2cc1fc-4758-49f5-b642-a7972824b20b&page=queryresults
[0m21:55:39.998115 [error] [Thread-1  ]: 16 of 17 FAIL 3702 unique_stg_users_email ...................................... [[31mFAIL 3702[0m in 1.29s]
[0m21:55:39.998692 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m21:55:39.999009 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m21:55:39.999293 [info ] [Thread-1  ]: 17 of 17 START test unique_stg_users_user_id ................................... [RUN]
[0m21:55:39.999680 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_users_email.7ba574d07b, now test.digital_marketing.unique_stg_users_user_id.c2ff477e6b)
[0m21:55:40.000007 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m21:55:40.005288 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"
[0m21:55:40.005981 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m21:55:40.010721 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"
[0m21:55:40.011271 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:55:40.011645 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:40.843355 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:b8fb24fd-abaa-4cf7-84fd-0f9ca52622c0&page=queryresults
[0m21:55:40.845103 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:b8fb24fd-abaa-4cf7-84fd-0f9ca52622c0&page=queryresults
[0m21:55:40.873148 [debug] [Thread-1  ]: Database Error in test unique_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:9]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_user_id.sql
[0m21:55:40.874050 [error] [Thread-1  ]: 17 of 17 ERROR unique_stg_users_user_id ........................................ [[31mERROR[0m in 0.87s]
[0m21:55:40.875356 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m21:55:40.876066 [debug] [Thread-4  ]: Marking all children of 'test.digital_marketing.unique_stg_users_user_id.c2ff477e6b' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:9]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_user_id.sql.
[0m21:55:40.877357 [info ] [MainThread]: 
[0m21:55:40.884618 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m21:55:40.885249 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m21:55:40.885891 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m21:55:40.886441 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m21:55:40.923174 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m21:55:40.928805 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m21:55:40.937865 [debug] [MainThread]: Elementary: Handling test results.
[0m21:55:41.071906 [debug] [MainThread]: Elementary: Deleting temporary Elementary test tables: []
[0m21:55:41.082645 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m21:55:41.082999 [debug] [MainThread]: Elementary: Handled test results successfully.
[0m21:55:41.091781 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m21:55:41.093176 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m21:55:41.093499 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.21s]
[0m21:55:41.093750 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:55:41.159574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:41.159879 [debug] [MainThread]: Connection 'list_data-products-441119_snapshot' was properly closed.
[0m21:55:41.160078 [debug] [MainThread]: Connection 'test.digital_marketing.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m21:55:41.160333 [info ] [MainThread]: 
[0m21:55:41.160559 [info ] [MainThread]: Finished running 5 project hooks, 17 data tests in 0 hours 0 minutes and 27.92 seconds (27.92s).
[0m21:55:41.162506 [debug] [MainThread]: Command end result
[0m21:55:41.225872 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m21:55:41.227305 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m21:55:41.232020 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m21:55:41.232258 [info ] [MainThread]: 
[0m21:55:41.232514 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m21:55:41.232734 [info ] [MainThread]: 
[0m21:55:41.232988 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_stg_users_age__120__13 (models/staging/_staging_models.yml)[0m
[0m21:55:41.233238 [error] [MainThread]:   Got 870 results, configured to fail if != 0
[0m21:55:41.233441 [info ] [MainThread]: 
[0m21:55:41.233681 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/dbt_utils_accepted_range_stg_users_age__120__13.sql
[0m21:55:41.233894 [info ] [MainThread]: 
[0m21:55:41.234137 [error] [MainThread]: [31mFailure in test not_null_stg_users_user_id (models/staging/_staging_models.yml)[0m
[0m21:55:41.234379 [error] [MainThread]:   Database Error in test not_null_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:7]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/not_null_stg_users_user_id.sql
[0m21:55:41.234585 [info ] [MainThread]: 
[0m21:55:41.234818 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/not_null_stg_users_user_id.sql
[0m21:55:41.235109 [info ] [MainThread]: 
[0m21:55:41.235405 [error] [MainThread]: [31mFailure in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)[0m
[0m21:55:41.235678 [error] [MainThread]:   Database Error in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [21:12]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql
[0m21:55:41.235896 [info ] [MainThread]: 
[0m21:55:41.236141 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql
[0m21:55:41.236356 [info ] [MainThread]: 
[0m21:55:41.236601 [error] [MainThread]: [31mFailure in test unique_stg_users_email (models/staging/_staging_models.yml)[0m
[0m21:55:41.236920 [error] [MainThread]:   Got 3702 results, configured to fail if != 0
[0m21:55:41.237176 [info ] [MainThread]: 
[0m21:55:41.237432 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_email.sql
[0m21:55:41.237657 [info ] [MainThread]: 
[0m21:55:41.237907 [error] [MainThread]: [31mFailure in test unique_stg_users_user_id (models/staging/_staging_models.yml)[0m
[0m21:55:41.238158 [error] [MainThread]:   Database Error in test unique_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:9]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_user_id.sql
[0m21:55:41.238368 [info ] [MainThread]: 
[0m21:55:41.238607 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_user_id.sql
[0m21:55:41.238833 [info ] [MainThread]: 
[0m21:55:41.239063 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=22
[0m21:55:41.241624 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 30.818615, "process_in_blocks": "0", "process_kernel_time": 0.513477, "process_mem_max_rss": "399966208", "process_out_blocks": "0", "process_user_time": 6.621554}
[0m21:55:41.241980 [debug] [MainThread]: Command `dbt test` failed at 21:55:41.241930 after 30.82 seconds
[0m21:55:41.242236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c23dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e2f6130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e2f66d0>]}
[0m21:55:41.242493 [debug] [MainThread]: Flushing usage events
[0m21:55:41.626087 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:00:46.369983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107953df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e23280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e23550>]}


============================== 22:00:46.373411 | 3af8dff2-e58b-4ba1-a11c-f28cefe10662 ==============================
[0m22:00:46.373411 [info ] [MainThread]: Running with dbt=1.10.10
[0m22:00:46.373792 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'static_parser': 'True', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'use_colors': 'True', 'debug': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'printer_width': '80', 'invocation_command': 'dbt test --select stg_users', 'partial_parse': 'True', 'write_json': 'True', 'target_path': 'None', 'quiet': 'False'}
[0m22:00:48.039870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3af8dff2-e58b-4ba1-a11c-f28cefe10662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c5370>]}
[0m22:00:48.076987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3af8dff2-e58b-4ba1-a11c-f28cefe10662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12483b160>]}
[0m22:00:48.077385 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:00:48.268881 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m22:00:48.598552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:00:48.599192 [debug] [MainThread]: Partial parsing: updated file: digital_marketing://models/staging/stg_users.sql
[0m22:00:48.910512 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.marts.finance
- models.thelook_analytics.reports
- models.thelook_analytics.intermediate
- models.thelook_analytics.marts.core
- models.thelook_analytics.staging
- seeds.thelook_analytics.product_categories
- seeds.thelook_analytics.customer_segments
- snapshots.thelook_analytics
[0m22:00:48.925310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3af8dff2-e58b-4ba1-a11c-f28cefe10662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133fb8130>]}
[0m22:00:49.063087 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:00:49.064797 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:00:49.087297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3af8dff2-e58b-4ba1-a11c-f28cefe10662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1348bfa30>]}
[0m22:00:49.087694 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 43 data tests, 6 sources, 1492 macros
[0m22:00:49.087942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3af8dff2-e58b-4ba1-a11c-f28cefe10662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133ce3dc0>]}
[0m22:00:49.089398 [info ] [MainThread]: 
[0m22:00:49.089647 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:00:49.089860 [info ] [MainThread]: 
[0m22:00:49.090190 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:00:49.095637 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_snapshot'
[0m22:00:49.096167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:49.727580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_snapshot, now list_data-products-441119_dbt_dev_analytics)
[0m22:00:49.728568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:51.054283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3af8dff2-e58b-4ba1-a11c-f28cefe10662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1348bfd60>]}
[0m22:00:51.075836 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 05:00:46 ===
[0m22:00:51.076560 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m22:00:51.080650 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m22:00:51.081542 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m22:00:51.087374 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m22:00:51.088445 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m22:00:51.089335 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m22:00:51.089854 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:51.756764 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:e55016ca-0bb9-4a81-a61b-bbd80dc672ca&page=queryresults
[0m22:00:52.284397 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.20s]
[0m22:00:52.757993 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m22:00:52.760955 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m22:00:52.761948 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.48s]
[0m22:00:52.762619 [info ] [MainThread]: 
[0m22:00:52.772244 [debug] [Thread-1  ]: Began running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:00:52.773031 [info ] [Thread-1  ]: 1 of 7 START test dbt_utils_accepted_range_stg_users_age__120__13 .............. [RUN]
[0m22:00:52.773912 [debug] [Thread-1  ]: Acquiring new bigquery connection 'test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2'
[0m22:00:52.774527 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:00:52.784848 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"
[0m22:00:52.786287 [debug] [Thread-1  ]: Began executing node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:00:52.817055 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"
[0m22:00:52.818039 [debug] [Thread-1  ]: On test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not age >= 13
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not age <= 120
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m22:00:52.818481 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:00:53.881565 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:caea2b8a-55df-4c6e-822b-3abf069479c4&page=queryresults
[0m22:00:54.458723 [error] [Thread-1  ]: 1 of 7 FAIL 870 dbt_utils_accepted_range_stg_users_age__120__13 ................ [[31mFAIL 870[0m in 1.68s]
[0m22:00:54.460126 [debug] [Thread-1  ]: Finished running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:00:54.460928 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:00:54.461784 [info ] [Thread-1  ]: 2 of 7 START test not_null_stg_users_email ..................................... [RUN]
[0m22:00:54.462576 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2, now test.digital_marketing.not_null_stg_users_email.2723c62e0e)
[0m22:00:54.463205 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:00:54.477492 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_email.2723c62e0e"
[0m22:00:54.479366 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:00:54.486933 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_email.2723c62e0e"
[0m22:00:54.487780 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_email.2723c62e0e: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_email.2723c62e0e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where email is null



  
  
      
    ) dbt_internal_test
[0m22:00:54.488278 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:00:55.417072 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:83f204c9-f0d9-4cff-a7e6-4f2de106bc0e&page=queryresults
[0m22:00:56.024607 [info ] [Thread-1  ]: 2 of 7 PASS not_null_stg_users_email ........................................... [[32mPASS[0m in 1.56s]
[0m22:00:56.025934 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:00:56.026731 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m22:00:56.027595 [info ] [Thread-1  ]: 3 of 7 START test not_null_stg_users_full_name ................................. [RUN]
[0m22:00:56.028534 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_email.2723c62e0e, now test.digital_marketing.not_null_stg_users_full_name.6892d7acba)
[0m22:00:56.029298 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m22:00:56.041219 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_full_name.6892d7acba"
[0m22:00:56.042419 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m22:00:56.049674 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_full_name.6892d7acba"
[0m22:00:56.050743 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_full_name.6892d7acba: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_full_name.6892d7acba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select full_name
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where full_name is null



  
  
      
    ) dbt_internal_test
[0m22:00:56.051342 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:00:56.849728 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:20e1a523-1845-4a7d-ad3b-0cf51d19c236&page=queryresults
[0m22:00:57.471819 [info ] [Thread-1  ]: 3 of 7 PASS not_null_stg_users_full_name ....................................... [[32mPASS[0m in 1.44s]
[0m22:00:57.473132 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m22:00:57.473919 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:00:57.474791 [info ] [Thread-1  ]: 4 of 7 START test not_null_stg_users_user_id ................................... [RUN]
[0m22:00:57.475756 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_full_name.6892d7acba, now test.digital_marketing.not_null_stg_users_user_id.980dfc1b77)
[0m22:00:57.476517 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:00:57.490250 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"
[0m22:00:57.492141 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:00:57.499337 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"
[0m22:00:57.500391 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:00:57.500982 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:00:58.279599 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:4400bdf2-b60e-41af-be42-7cec2c25e2cc&page=queryresults
[0m22:00:58.281570 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:4400bdf2-b60e-41af-be42-7cec2c25e2cc&page=queryresults
[0m22:00:58.343321 [debug] [Thread-1  ]: Database Error in test not_null_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:7]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/not_null_stg_users_user_id.sql
[0m22:00:58.343929 [error] [Thread-1  ]: 4 of 7 ERROR not_null_stg_users_user_id ........................................ [[31mERROR[0m in 0.87s]
[0m22:00:58.344474 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:00:58.344933 [debug] [Thread-1  ]: Began running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:00:58.345371 [debug] [Thread-4  ]: Marking all children of 'test.digital_marketing.not_null_stg_users_user_id.980dfc1b77' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:7]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/not_null_stg_users_user_id.sql.
[0m22:00:58.345730 [info ] [Thread-1  ]: 5 of 7 START test relationships_stg_orders_user_id__user_id__ref_stg_users_ .... [RUN]
[0m22:00:58.346246 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_user_id.980dfc1b77, now test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737)
[0m22:00:58.346598 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:00:58.356199 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"
[0m22:00:58.357110 [debug] [Thread-1  ]: Began executing node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:00:58.361122 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"
[0m22:00:58.361944 [debug] [Thread-1  ]: On test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
    where user_id is not null
),

parent as (
    select user_id as to_field
    from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:00:58.362332 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:00:59.102876 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:1e84add9-c629-470a-a029-312a74d2db08&page=queryresults
[0m22:00:59.104914 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:1e84add9-c629-470a-a029-312a74d2db08&page=queryresults
[0m22:00:59.134018 [debug] [Thread-1  ]: Database Error in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [21:12]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql
[0m22:00:59.134969 [error] [Thread-1  ]: 5 of 7 ERROR relationships_stg_orders_user_id__user_id__ref_stg_users_ ......... [[31mERROR[0m in 0.79s]
[0m22:00:59.135758 [debug] [Thread-1  ]: Finished running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:00:59.136311 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m22:00:59.136986 [debug] [Thread-4  ]: Marking all children of 'test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [21:12]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql.
[0m22:00:59.137555 [info ] [Thread-1  ]: 6 of 7 START test unique_stg_users_email ....................................... [RUN]
[0m22:00:59.138351 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737, now test.digital_marketing.unique_stg_users_email.7ba574d07b)
[0m22:00:59.138877 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m22:00:59.150304 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_users_email.7ba574d07b"
[0m22:00:59.152019 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m22:00:59.158496 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_users_email.7ba574d07b"
[0m22:00:59.159200 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_users_email.7ba574d07b: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_users_email.7ba574d07b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select email as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
  where email is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:00:59.159655 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:01:00.330505 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:ef99d745-acfb-4a5c-9bef-53eadb3d9cc9&page=queryresults
[0m22:01:01.031926 [error] [Thread-1  ]: 6 of 7 FAIL 3702 unique_stg_users_email ........................................ [[31mFAIL 3702[0m in 1.89s]
[0m22:01:01.033365 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m22:01:01.034156 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:01:01.035012 [info ] [Thread-1  ]: 7 of 7 START test unique_stg_users_user_id ..................................... [RUN]
[0m22:01:01.035969 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_users_email.7ba574d07b, now test.digital_marketing.unique_stg_users_user_id.c2ff477e6b)
[0m22:01:01.036723 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:01:01.048765 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"
[0m22:01:01.049994 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:01:01.058757 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"
[0m22:01:01.059666 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:01:01.060252 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:01:01.887140 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:953f95a1-b6c3-4dcf-9eba-ebf5ad710c30&page=queryresults
[0m22:01:01.889442 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:953f95a1-b6c3-4dcf-9eba-ebf5ad710c30&page=queryresults
[0m22:01:01.919260 [debug] [Thread-1  ]: Database Error in test unique_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:9]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_user_id.sql
[0m22:01:01.920157 [error] [Thread-1  ]: 7 of 7 ERROR unique_stg_users_user_id .......................................... [[31mERROR[0m in 0.88s]
[0m22:01:01.920938 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:01:01.921740 [debug] [Thread-4  ]: Marking all children of 'test.digital_marketing.unique_stg_users_user_id.c2ff477e6b' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:9]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_user_id.sql.
[0m22:01:01.923047 [info ] [MainThread]: 
[0m22:01:01.930317 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m22:01:01.930908 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m22:01:01.931539 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m22:01:01.932086 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m22:01:01.968481 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m22:01:01.973885 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m22:01:01.983093 [debug] [MainThread]: Elementary: Handling test results.
[0m22:01:02.096040 [debug] [MainThread]: Elementary: Deleting temporary Elementary test tables: []
[0m22:01:02.106752 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m22:01:02.107108 [debug] [MainThread]: Elementary: Handled test results successfully.
[0m22:01:02.116045 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m22:01:02.117478 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m22:01:02.117817 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.19s]
[0m22:01:02.118069 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:01:02.184096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:02.184410 [debug] [MainThread]: Connection 'list_data-products-441119_dbt_dev_analytics' was properly closed.
[0m22:01:02.184614 [debug] [MainThread]: Connection 'test.digital_marketing.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m22:01:02.184871 [info ] [MainThread]: 
[0m22:01:02.185100 [info ] [MainThread]: Finished running 5 project hooks, 7 data tests in 0 hours 0 minutes and 13.09 seconds (13.09s).
[0m22:01:02.186319 [debug] [MainThread]: Command end result
[0m22:01:02.249053 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:01:02.250485 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:01:02.254953 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m22:01:02.255185 [info ] [MainThread]: 
[0m22:01:02.255441 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m22:01:02.255669 [info ] [MainThread]: 
[0m22:01:02.255924 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_stg_users_age__120__13 (models/staging/_staging_models.yml)[0m
[0m22:01:02.256165 [error] [MainThread]:   Got 870 results, configured to fail if != 0
[0m22:01:02.256361 [info ] [MainThread]: 
[0m22:01:02.256595 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/dbt_utils_accepted_range_stg_users_age__120__13.sql
[0m22:01:02.256801 [info ] [MainThread]: 
[0m22:01:02.257041 [error] [MainThread]: [31mFailure in test not_null_stg_users_user_id (models/staging/_staging_models.yml)[0m
[0m22:01:02.257285 [error] [MainThread]:   Database Error in test not_null_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:7]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/not_null_stg_users_user_id.sql
[0m22:01:02.257492 [info ] [MainThread]: 
[0m22:01:02.257726 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/not_null_stg_users_user_id.sql
[0m22:01:02.257933 [info ] [MainThread]: 
[0m22:01:02.258177 [error] [MainThread]: [31mFailure in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)[0m
[0m22:01:02.258427 [error] [MainThread]:   Database Error in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [21:12]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql
[0m22:01:02.258635 [info ] [MainThread]: 
[0m22:01:02.258871 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql
[0m22:01:02.259076 [info ] [MainThread]: 
[0m22:01:02.259312 [error] [MainThread]: [31mFailure in test unique_stg_users_email (models/staging/_staging_models.yml)[0m
[0m22:01:02.259547 [error] [MainThread]:   Got 3702 results, configured to fail if != 0
[0m22:01:02.259746 [info ] [MainThread]: 
[0m22:01:02.259977 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_email.sql
[0m22:01:02.260183 [info ] [MainThread]: 
[0m22:01:02.260538 [error] [MainThread]: [31mFailure in test unique_stg_users_user_id (models/staging/_staging_models.yml)[0m
[0m22:01:02.260831 [error] [MainThread]:   Database Error in test unique_stg_users_user_id (models/staging/_staging_models.yml)
  Unrecognized name: user_id at [18:9]
  compiled code at target/run/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_user_id.sql
[0m22:01:02.261040 [info ] [MainThread]: 
[0m22:01:02.261278 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/unique_stg_users_user_id.sql
[0m22:01:02.261493 [info ] [MainThread]: 
[0m22:01:02.261719 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=12
[0m22:01:02.264259 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 15.941196, "process_in_blocks": "0", "process_kernel_time": 0.451327, "process_mem_max_rss": "398311424", "process_out_blocks": "0", "process_user_time": 5.064421}
[0m22:01:02.264712 [debug] [MainThread]: Command `dbt test` failed at 22:01:02.264643 after 15.94 seconds
[0m22:01:02.264996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107953df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c037c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133cc59d0>]}
[0m22:01:02.265263 [debug] [MainThread]: Flushing usage events
[0m22:01:02.619118 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:02:40.092066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10774bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1b4f0>]}


============================== 22:02:40.095759 | f16488e9-8aa7-4004-94fa-1ee4875a83e0 ==============================
[0m22:02:40.095759 [info ] [MainThread]: Running with dbt=1.10.10
[0m22:02:40.096147 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --select stg_users', 'static_parser': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'debug': 'False', 'printer_width': '80', 'introspect': 'True', 'log_format': 'default', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error': 'None'}
[0m22:02:41.941614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f16488e9-8aa7-4004-94fa-1ee4875a83e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e47b0a0>]}
[0m22:02:41.978940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f16488e9-8aa7-4004-94fa-1ee4875a83e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bd2ee0>]}
[0m22:02:41.979347 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:02:42.171394 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m22:02:42.534431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:02:42.534768 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:02:42.540967 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.staging
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.marts.finance
- models.thelook_analytics.intermediate
- models.thelook_analytics.marts.core
- models.thelook_analytics.reports
- seeds.thelook_analytics.product_categories
- seeds.thelook_analytics.customer_segments
- snapshots.thelook_analytics
[0m22:02:42.603410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f16488e9-8aa7-4004-94fa-1ee4875a83e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12caf1130>]}
[0m22:02:42.742087 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:02:42.743736 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:02:42.762131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f16488e9-8aa7-4004-94fa-1ee4875a83e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c38d6a0>]}
[0m22:02:42.762520 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 43 data tests, 6 sources, 1492 macros
[0m22:02:42.762772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f16488e9-8aa7-4004-94fa-1ee4875a83e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cc2e130>]}
[0m22:02:42.764125 [info ] [MainThread]: 
[0m22:02:42.764377 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:02:42.764586 [info ] [MainThread]: 
[0m22:02:42.764908 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:02:42.765436 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m22:02:42.765694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:43.337882 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now list_data-products-441119_dbt_dev_analytics)
[0m22:02:43.338683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:43.905745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev_analytics, now list_data-products-441119_snapshot)
[0m22:02:43.907981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:44.456099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f16488e9-8aa7-4004-94fa-1ee4875a83e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12beddf40>]}
[0m22:02:44.481208 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 05:02:40 ===
[0m22:02:44.482046 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m22:02:44.487007 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m22:02:44.488054 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m22:02:44.493838 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m22:02:44.495127 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m22:02:44.495766 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m22:02:44.496265 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:02:45.088082 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:cfbc3b3a-e5f1-42bc-8f4d-b17654cd971b&page=queryresults
[0m22:02:45.555934 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.07s]
[0m22:02:45.605151 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m22:02:45.607082 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m22:02:45.607610 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.05s]
[0m22:02:45.607961 [info ] [MainThread]: 
[0m22:02:45.613731 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_users
[0m22:02:45.614297 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt_dev_analytics.stg_users ........................ [RUN]
[0m22:02:45.614969 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.digital_marketing.stg_users'
[0m22:02:45.615381 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_users
[0m22:02:45.622725 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_users"
[0m22:02:45.623341 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_users
[0m22:02:45.648617 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_users"
[0m22:02:45.649362 [debug] [Thread-1  ]: On model.digital_marketing.stg_users: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_users"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_users`
  OPTIONS()
  as 

select 
    id as user_id, 
    first_name, 
    last_name, 
    concat(coalesce(first_name, ''), ' ', coalesce(last_name, '')) as full_name,
    email,
    age,
    gender,
    state,
    country, 
    latitude,
    longitude,
    traffic_source,
    created_at as registration_date,
    created_at,
    
    -- calculate demographics
    CASE 
        WHEN age BETWEEN 13 and 17 THEN 'Gen Z (13 - 17)'
        WHEN age BETWEEN 18 and 24 THEN 'Gen Z (18 - 24)'
        WHEN age BETWEEN 25 and 40 THEN 'Millennial'
        WHEN age BETWEEN 41 and 56 THEN 'Gen X'
        when age between 57 and 75 then 'Boomer'
        WHEN age > 75 THEN 'Silent'
        ELSE  'Unknown'
    END AS generation,

    CASE 
        WHEN age < 25 THEN  '18-24'
        when age < 35 then '25-34'
        when age < 45 then '35-44'
        when age < 55 then '45-54'
        when age < 65 then '55-64'
        ELSE '65+' 
    END as age_group,

    -- Geographic standardization 
    CASE 
        WHEN country = 'USA' THEN state  
        ELSE country
    END as region,

    CASE 
        WHEN country = 'USA' THEN true
        ELSE false
    END as is_domestic,

    -- Acquisition channel grouping
    case 
        when lower(traffic_source) in ('google', 'search', 'organic') then 'Organic Search'
        when lower(traffic_source) in ('facebook', 'instagram', 'social') then 'Social Media'
        when lower(traffic_source) = 'email' then 'Email'
        when lower(traffic_source) in ('youtube', 'video') then 'Video'
        when lower(traffic_source) in ('display', 'banner') then 'Display'
        else 'Other'
    end as acquisition_channel,
    
    -- Data quality flags
    case when email is null or email = '' or not regexp_contains(email, r'^[^@]+@[^@]+\.[^@]+$') 
         then true else false end as has_invalid_email,
    case when age < 13 or age > 120 then true else false end as has_invalid_age,
    case when first_name is null and last_name is null then true else false end as has_missing_name,
    case when latitude is null or longitude is null then true else false end as has_missing_coordinates

from `bigquery-public-data`.`thelook_ecommerce`.`users`
where created_at >= '2019-01-01'
  and created_at <= '2024-12-31'

-- Development environment filter

    qualify row_number() over (order by created_at desc) <= 50000
;


[0m22:02:45.649747 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:02:46.401444 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:4309d978-61e4-475a-8152-b85709b272ac&page=queryresults
[0m22:02:46.984511 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16488e9-8aa7-4004-94fa-1ee4875a83e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc53d0>]}
[0m22:02:46.985437 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt_dev_analytics.stg_users ................... [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m22:02:46.986149 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_users
[0m22:02:46.987217 [info ] [MainThread]: 
[0m22:02:46.993905 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m22:02:46.994394 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m22:02:46.994942 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m22:02:46.995408 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m22:02:47.024009 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m22:02:47.036491 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m22:02:47.041288 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m22:02:47.052756 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m22:02:47.053425 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m22:02:47.053771 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.06s]
[0m22:02:47.054024 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:02:47.120514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:47.120823 [debug] [MainThread]: Connection 'list_data-products-441119_snapshot' was properly closed.
[0m22:02:47.121021 [debug] [MainThread]: Connection 'model.digital_marketing.stg_users' was properly closed.
[0m22:02:47.121274 [info ] [MainThread]: 
[0m22:02:47.121505 [info ] [MainThread]: Finished running 5 project hooks, 1 view model in 0 hours 0 minutes and 4.36 seconds (4.36s).
[0m22:02:47.122283 [debug] [MainThread]: Command end result
[0m22:02:47.184692 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:02:47.186191 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:02:47.190563 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m22:02:47.190805 [info ] [MainThread]: 
[0m22:02:47.191077 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:02:47.191300 [info ] [MainThread]: 
[0m22:02:47.191530 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m22:02:47.194123 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.1502213, "process_in_blocks": "0", "process_kernel_time": 0.452035, "process_mem_max_rss": "374030336", "process_out_blocks": "0", "process_user_time": 3.73582}
[0m22:02:47.194498 [debug] [MainThread]: Command `dbt run` succeeded at 22:02:47.194442 after 7.15 seconds
[0m22:02:47.194754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10774bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bd2ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cb10a60>]}
[0m22:02:47.195006 [debug] [MainThread]: Flushing usage events
[0m22:02:47.506604 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:03:27.302018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b67df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109037280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109037550>]}


============================== 22:03:27.305489 | 936e47bb-34d3-476f-a402-9b88de89f4cd ==============================
[0m22:03:27.305489 [info ] [MainThread]: Running with dbt=1.10.10
[0m22:03:27.305870 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'version_check': 'True', 'printer_width': '80', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'static_parser': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_colors': 'True', 'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'empty': 'None', 'invocation_command': 'dbt show --select stg_users --limit 3', 'introspect': 'True', 'fail_fast': 'False', 'target_path': 'None', 'quiet': 'False'}
[0m22:03:28.990496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '936e47bb-34d3-476f-a402-9b88de89f4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d35340>]}
[0m22:03:29.027627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '936e47bb-34d3-476f-a402-9b88de89f4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c5c5190>]}
[0m22:03:29.039881 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:03:29.233168 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m22:03:29.562475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:03:29.562802 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:03:29.568873 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.staging
- models.thelook_analytics.marts.finance
- models.thelook_analytics.intermediate
- models.thelook_analytics.marts.core
- models.thelook_analytics.reports
- seeds.thelook_analytics.product_categories
- seeds.thelook_analytics.customer_segments
- snapshots.thelook_analytics
[0m22:03:29.631432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '936e47bb-34d3-476f-a402-9b88de89f4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d1d4eb0>]}
[0m22:03:29.770968 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:03:29.772695 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:03:29.779529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '936e47bb-34d3-476f-a402-9b88de89f4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cbac0d0>]}
[0m22:03:29.779897 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 43 data tests, 6 sources, 1492 macros
[0m22:03:29.780151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '936e47bb-34d3-476f-a402-9b88de89f4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cbac8e0>]}
[0m22:03:29.781562 [info ] [MainThread]: 
[0m22:03:29.781818 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:03:29.782028 [info ] [MainThread]: 
[0m22:03:29.782375 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:03:29.787669 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_snapshot'
[0m22:03:29.788054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:30.405632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_snapshot, now list_data-products-441119_dbt_dev_analytics)
[0m22:03:30.406872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:03:30.964072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '936e47bb-34d3-476f-a402-9b88de89f4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cbacaf0>]}
[0m22:03:30.964983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:03:31.062579 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_users
[0m22:03:31.062957 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev_analytics, now model.digital_marketing.stg_users)
[0m22:03:31.063224 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_users
[0m22:03:31.073981 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_users"
[0m22:03:31.074514 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_users
[0m22:03:31.082419 [debug] [Thread-1  ]: On model.digital_marketing.stg_users: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_users"} */

  
  

select 
    id as user_id, 
    first_name, 
    last_name, 
    concat(coalesce(first_name, ''), ' ', coalesce(last_name, '')) as full_name,
    email,
    age,
    gender,
    state,
    country, 
    latitude,
    longitude,
    traffic_source,
    created_at as registration_date,
    created_at,
    
    -- calculate demographics
    CASE 
        WHEN age BETWEEN 13 and 17 THEN 'Gen Z (13 - 17)'
        WHEN age BETWEEN 18 and 24 THEN 'Gen Z (18 - 24)'
        WHEN age BETWEEN 25 and 40 THEN 'Millennial'
        WHEN age BETWEEN 41 and 56 THEN 'Gen X'
        when age between 57 and 75 then 'Boomer'
        WHEN age > 75 THEN 'Silent'
        ELSE  'Unknown'
    END AS generation,

    CASE 
        WHEN age < 25 THEN  '18-24'
        when age < 35 then '25-34'
        when age < 45 then '35-44'
        when age < 55 then '45-54'
        when age < 65 then '55-64'
        ELSE '65+' 
    END as age_group,

    -- Geographic standardization 
    CASE 
        WHEN country = 'USA' THEN state  
        ELSE country
    END as region,

    CASE 
        WHEN country = 'USA' THEN true
        ELSE false
    END as is_domestic,

    -- Acquisition channel grouping
    case 
        when lower(traffic_source) in ('google', 'search', 'organic') then 'Organic Search'
        when lower(traffic_source) in ('facebook', 'instagram', 'social') then 'Social Media'
        when lower(traffic_source) = 'email' then 'Email'
        when lower(traffic_source) in ('youtube', 'video') then 'Video'
        when lower(traffic_source) in ('display', 'banner') then 'Display'
        else 'Other'
    end as acquisition_channel,
    
    -- Data quality flags
    case when email is null or email = '' or not regexp_contains(email, r'^[^@]+@[^@]+\.[^@]+$') 
         then true else false end as has_invalid_email,
    case when age < 13 or age > 120 then true else false end as has_invalid_age,
    case when first_name is null and last_name is null then true else false end as has_missing_name,
    case when latitude is null or longitude is null then true else false end as has_missing_coordinates

from `bigquery-public-data`.`thelook_ecommerce`.`users`
where created_at >= '2019-01-01'
  and created_at <= '2024-12-31'

-- Development environment filter

    qualify row_number() over (order by created_at desc) <= 50000

  
  limit 3

[0m22:03:31.082780 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:03:32.502041 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:5ea8e612-a10f-4279-b395-de9c2a7d0eb9&page=queryresults
[0m22:03:33.151475 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_users
[0m22:03:33.153286 [debug] [Thread-1  ]: Began running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:03:33.154197 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_users, now test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2)
[0m22:03:33.154962 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:03:33.175982 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"
[0m22:03:33.177887 [debug] [Thread-1  ]: Began executing node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:03:33.188860 [debug] [Thread-1  ]: On test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"} */

  
  

with meet_condition as(
  select *
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not age >= 13
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not age <= 120
)

select *
from validation_errors


  
  limit 3

[0m22:03:33.189383 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:03:34.956571 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:151009ee-c749-4c47-8912-4047734bebfc&page=queryresults
[0m22:03:35.582612 [debug] [Thread-1  ]: Finished running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:03:35.583562 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:03:35.584493 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2, now test.digital_marketing.not_null_stg_users_email.2723c62e0e)
[0m22:03:35.585344 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:03:35.603829 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_email.2723c62e0e"
[0m22:03:35.605866 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:03:35.618054 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_email.2723c62e0e: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_email.2723c62e0e"} */

  
  
    
    



select email
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where email is null



  
  limit 3

[0m22:03:35.618628 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:03:36.989792 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:c3108609-d095-45dc-8ea8-e74155b986d2&page=queryresults
[0m22:03:37.585892 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:03:37.586899 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m22:03:37.587839 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_email.2723c62e0e, now test.digital_marketing.not_null_stg_users_full_name.6892d7acba)
[0m22:03:37.588695 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m22:03:37.600801 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_full_name.6892d7acba"
[0m22:03:37.601960 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m22:03:37.615136 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_full_name.6892d7acba: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_full_name.6892d7acba"} */

  
  
    
    



select full_name
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where full_name is null



  
  limit 3

[0m22:03:37.615768 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:03:38.832755 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:108c401d-d97a-4a5b-be05-26b624da0942&page=queryresults
[0m22:03:39.559019 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_full_name.6892d7acba
[0m22:03:39.560037 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:03:39.560971 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_full_name.6892d7acba, now test.digital_marketing.not_null_stg_users_user_id.980dfc1b77)
[0m22:03:39.561823 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:03:39.573718 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"
[0m22:03:39.575834 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:03:39.589080 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"} */

  
  
    
    



select user_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where user_id is null



  
  limit 3

[0m22:03:39.589740 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:03:40.894559 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:350ae893-cd1c-4c99-b7d6-91cbddc17e3d&page=queryresults
[0m22:03:41.537676 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:03:41.538795 [debug] [Thread-1  ]: Began running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:03:41.539756 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_user_id.980dfc1b77, now test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737)
[0m22:03:41.540618 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:03:41.559377 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"
[0m22:03:41.560546 [debug] [Thread-1  ]: Began executing node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:03:41.572039 [debug] [Thread-1  ]: On test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"} */

  
  
    
    

with child as (
    select user_id as from_field
    from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
    where user_id is not null
),

parent as (
    select user_id as to_field
    from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  limit 3

[0m22:03:41.572607 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:03:43.343688 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:e69ef4d4-4d5f-45cf-b665-5ac0fe2d4b68&page=queryresults
[0m22:03:43.944686 [debug] [Thread-1  ]: Finished running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:03:43.945709 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m22:03:43.946717 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737, now test.digital_marketing.unique_stg_users_email.7ba574d07b)
[0m22:03:43.947477 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m22:03:43.963247 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_users_email.7ba574d07b"
[0m22:03:43.965294 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m22:03:43.977036 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_users_email.7ba574d07b: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_users_email.7ba574d07b"} */

  
  
    
    

with dbt_test__target as (

  select email as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
  where email is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  limit 3

[0m22:03:43.977624 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:03:45.395326 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:b7e90045-04db-4a1d-bd3f-982cee2f4861&page=queryresults
[0m22:03:46.014504 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_users_email.7ba574d07b
[0m22:03:46.015506 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:03:46.016417 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_users_email.7ba574d07b, now test.digital_marketing.unique_stg_users_user_id.c2ff477e6b)
[0m22:03:46.017170 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:03:46.029888 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"
[0m22:03:46.031978 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:03:46.044750 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"} */

  
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  limit 3

[0m22:03:46.045363 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:03:47.653025 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:26a4b9b7-f565-4793-a5d5-5077b7cb70fb&page=queryresults
[0m22:03:48.341369 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:03:48.343084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:48.343816 [debug] [MainThread]: Connection 'test.digital_marketing.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m22:03:48.346711 [debug] [MainThread]: Command end result
[0m22:03:48.438898 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:03:48.440383 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:03:48.445467 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m22:03:48.445708 [debug] [MainThread]: Excluded node 'dbt_utils_accepted_range_stg_users_age__120__13' from results
[0m22:03:48.445904 [debug] [MainThread]: Excluded node 'not_null_stg_users_email' from results
[0m22:03:48.446089 [debug] [MainThread]: Excluded node 'not_null_stg_users_full_name' from results
[0m22:03:48.446268 [debug] [MainThread]: Excluded node 'not_null_stg_users_user_id' from results
[0m22:03:48.446460 [debug] [MainThread]: Excluded node 'relationships_stg_orders_user_id__user_id__ref_stg_users_' from results
[0m22:03:48.446641 [debug] [MainThread]: Excluded node 'unique_stg_users_email' from results
[0m22:03:48.446815 [debug] [MainThread]: Excluded node 'unique_stg_users_user_id' from results
[0m22:03:48.447068 [info ] [MainThread]: Previewing node 'stg_users':
| user_id | first_name | last_name | full_name         | email                | age | ... |
| ------- | ---------- | --------- | ----------------- | -------------------- | --- | --- |
|   44882 | Shane      | Lowe      | Shane Lowe        | shanelowe@example... |  36 | ... |
|   90828 | Kelly      | Carroll   | Kelly Carroll     | kellycarroll@exam... |  22 | ... |
|   11752 | Christina  | Webster   | Christina Webster | christinawebster@... |  49 | ... |

[0m22:03:48.449635 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 21.196878, "process_in_blocks": "0", "process_kernel_time": 0.445316, "process_mem_max_rss": "383287296", "process_out_blocks": "0", "process_user_time": 4.500881}
[0m22:03:48.449997 [debug] [MainThread]: Command `dbt show` succeeded at 22:03:48.449946 after 21.20 seconds
[0m22:03:48.450258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b67df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ad100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d881f10>]}
[0m22:03:48.450520 [debug] [MainThread]: Flushing usage events
[0m22:03:48.773777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:09:18.735525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10779bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6b460>]}


============================== 22:09:18.739715 | dfa454d4-8423-4075-b2bf-b58b5abbd80a ==============================
[0m22:09:18.739715 [info ] [MainThread]: Running with dbt=1.10.10
[0m22:09:18.740127 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt test --select stg_users', 'write_json': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'warn_error': 'None', 'log_format': 'default', 'quiet': 'False', 'empty': 'None', 'debug': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80'}
[0m22:09:20.615699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfa454d4-8423-4075-b2bf-b58b5abbd80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106655700>]}
[0m22:09:20.652727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfa454d4-8423-4075-b2bf-b58b5abbd80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119028820>]}
[0m22:09:20.653112 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:09:20.843075 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m22:09:21.184112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:09:21.184857 [debug] [MainThread]: Partial parsing: updated file: digital_marketing://models/staging/_staging_models.yml
[0m22:09:21.499049 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.intermediate
- models.thelook_analytics.reports
- models.thelook_analytics.staging
- models.thelook_analytics.marts.core
- models.thelook_analytics.marts.finance
- models.thelook_analytics.marts.marketing
- seeds.thelook_analytics.product_categories
- seeds.thelook_analytics.customer_segments
- snapshots.thelook_analytics
[0m22:09:21.513670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfa454d4-8423-4075-b2bf-b58b5abbd80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d337f70>]}
[0m22:09:21.652453 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:09:21.655112 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:09:21.678445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfa454d4-8423-4075-b2bf-b58b5abbd80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2ed6d0>]}
[0m22:09:21.678866 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 41 data tests, 6 sources, 1492 macros
[0m22:09:21.679124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfa454d4-8423-4075-b2bf-b58b5abbd80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b2520>]}
[0m22:09:21.680530 [info ] [MainThread]: 
[0m22:09:21.680778 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:09:21.680991 [info ] [MainThread]: 
[0m22:09:21.681318 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:09:21.686616 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_dbt_dev_analytics'
[0m22:09:21.686998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:22.259527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev_analytics, now list_data-products-441119_snapshot)
[0m22:09:22.261901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:09:22.931780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfa454d4-8423-4075-b2bf-b58b5abbd80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2f08b0>]}
[0m22:09:22.948478 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 05:09:18 ===
[0m22:09:22.949084 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m22:09:22.952522 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m22:09:22.953142 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.02s]
[0m22:09:22.958274 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m22:09:22.960276 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m22:09:22.960810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m22:09:22.961238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:09:23.681590 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:022ac93a-d94b-4ad6-91d2-38ab4953b67d&page=queryresults
[0m22:09:24.343304 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.39s]
[0m22:09:24.756570 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m22:09:24.759820 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m22:09:24.760847 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.42s]
[0m22:09:24.761527 [info ] [MainThread]: 
[0m22:09:24.770864 [debug] [Thread-1  ]: Began running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:09:24.771651 [info ] [Thread-1  ]: 1 of 5 START test dbt_utils_accepted_range_stg_users_age__120__13 .............. [RUN]
[0m22:09:24.772522 [debug] [Thread-1  ]: Acquiring new bigquery connection 'test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2'
[0m22:09:24.773123 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:09:24.783667 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"
[0m22:09:24.785079 [debug] [Thread-1  ]: Began executing node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:09:24.815320 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"
[0m22:09:24.816161 [debug] [Thread-1  ]: On test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not age >= 13
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not age <= 120
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m22:09:24.816617 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:09:26.084354 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:fe032ecf-ba7c-46ae-9859-0d2e18e12768&page=queryresults
[0m22:09:26.703605 [error] [Thread-1  ]: 1 of 5 FAIL 870 dbt_utils_accepted_range_stg_users_age__120__13 ................ [[31mFAIL 870[0m in 1.93s]
[0m22:09:26.704822 [debug] [Thread-1  ]: Finished running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:09:26.705482 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:09:26.706186 [info ] [Thread-1  ]: 2 of 5 START test not_null_stg_users_email ..................................... [RUN]
[0m22:09:26.706957 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2, now test.digital_marketing.not_null_stg_users_email.2723c62e0e)
[0m22:09:26.707582 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:09:26.721656 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_email.2723c62e0e"
[0m22:09:26.723646 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:09:26.731101 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_email.2723c62e0e"
[0m22:09:26.731996 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_email.2723c62e0e: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_email.2723c62e0e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where email is null



  
  
      
    ) dbt_internal_test
[0m22:09:26.732506 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:09:27.925382 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:403a0325-12ec-4dc6-b0cd-0d7213bbb30a&page=queryresults
[0m22:09:28.543081 [info ] [Thread-1  ]: 2 of 5 PASS not_null_stg_users_email ........................................... [[32mPASS[0m in 1.84s]
[0m22:09:28.544462 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:09:28.545256 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:09:28.546135 [info ] [Thread-1  ]: 3 of 5 START test not_null_stg_users_user_id ................................... [RUN]
[0m22:09:28.547103 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_email.2723c62e0e, now test.digital_marketing.not_null_stg_users_user_id.980dfc1b77)
[0m22:09:28.547873 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:09:28.559688 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"
[0m22:09:28.561721 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:09:28.568795 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"
[0m22:09:28.569857 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:09:28.570432 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:09:30.184983 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:246074a5-c9ba-41c3-97de-73f8de235551&page=queryresults
[0m22:09:30.800741 [info ] [Thread-1  ]: 3 of 5 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 2.25s]
[0m22:09:30.802040 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:09:30.802854 [debug] [Thread-1  ]: Began running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:09:30.803715 [info ] [Thread-1  ]: 4 of 5 START test relationships_stg_orders_user_id__user_id__ref_stg_users_ .... [RUN]
[0m22:09:30.804655 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_user_id.980dfc1b77, now test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737)
[0m22:09:30.805416 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:09:30.823883 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"
[0m22:09:30.824933 [debug] [Thread-1  ]: Began executing node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:09:30.831763 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"
[0m22:09:30.832786 [debug] [Thread-1  ]: On test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
    where user_id is not null
),

parent as (
    select user_id as to_field
    from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:09:30.833320 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:09:32.536150 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:5ded7f30-a4f1-43d0-ac63-ceb65e0b526b&page=queryresults
[0m22:09:33.177057 [error] [Thread-1  ]: 4 of 5 FAIL 16395 relationships_stg_orders_user_id__user_id__ref_stg_users_ .... [[31mFAIL 16395[0m in 2.37s]
[0m22:09:33.178244 [debug] [Thread-1  ]: Finished running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:09:33.178926 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:09:33.179606 [info ] [Thread-1  ]: 5 of 5 START test unique_stg_users_user_id ..................................... [RUN]
[0m22:09:33.180386 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737, now test.digital_marketing.unique_stg_users_user_id.c2ff477e6b)
[0m22:09:33.180959 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:09:33.194452 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"
[0m22:09:33.196329 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:09:33.202403 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"
[0m22:09:33.203341 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:09:33.203922 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:09:34.615381 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:5117f3c2-0bdf-42ef-a432-f705acc2813a&page=queryresults
[0m22:09:35.253824 [info ] [Thread-1  ]: 5 of 5 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 2.07s]
[0m22:09:35.255187 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:09:35.256923 [info ] [MainThread]: 
[0m22:09:35.266733 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m22:09:35.267559 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m22:09:35.268573 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m22:09:35.269433 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m22:09:35.313644 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m22:09:35.319612 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m22:09:35.329292 [debug] [MainThread]: Elementary: Handling test results.
[0m22:09:35.439216 [debug] [MainThread]: Elementary: Deleting temporary Elementary test tables: []
[0m22:09:35.449888 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m22:09:35.450244 [debug] [MainThread]: Elementary: Handled test results successfully.
[0m22:09:35.459353 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m22:09:35.460808 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m22:09:35.461144 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.19s]
[0m22:09:35.461403 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:09:35.527357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:09:35.527672 [debug] [MainThread]: Connection 'list_data-products-441119_snapshot' was properly closed.
[0m22:09:35.527885 [debug] [MainThread]: Connection 'test.digital_marketing.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m22:09:35.528137 [info ] [MainThread]: 
[0m22:09:35.528366 [info ] [MainThread]: Finished running 5 project hooks, 5 data tests in 0 hours 0 minutes and 13.85 seconds (13.85s).
[0m22:09:35.529436 [debug] [MainThread]: Command end result
[0m22:09:35.591410 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:09:35.592873 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:09:35.597228 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m22:09:35.597466 [info ] [MainThread]: 
[0m22:09:35.597733 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:09:35.597964 [info ] [MainThread]: 
[0m22:09:35.598229 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_stg_users_age__120__13 (models/staging/_staging_models.yml)[0m
[0m22:09:35.598480 [error] [MainThread]:   Got 870 results, configured to fail if != 0
[0m22:09:35.598689 [info ] [MainThread]: 
[0m22:09:35.598933 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/dbt_utils_accepted_range_stg_users_age__120__13.sql
[0m22:09:35.599148 [info ] [MainThread]: 
[0m22:09:35.599395 [error] [MainThread]: [31mFailure in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)[0m
[0m22:09:35.599635 [error] [MainThread]:   Got 16395 results, configured to fail if != 0
[0m22:09:35.599831 [info ] [MainThread]: 
[0m22:09:35.600067 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql
[0m22:09:35.600277 [info ] [MainThread]: 
[0m22:09:35.600501 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=10
[0m22:09:35.603063 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 16.916178, "process_in_blocks": "0", "process_kernel_time": 0.487951, "process_mem_max_rss": "395493376", "process_out_blocks": "0", "process_user_time": 4.698509}
[0m22:09:35.603573 [debug] [MainThread]: Command `dbt test` failed at 22:09:35.603505 after 16.92 seconds
[0m22:09:35.603911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10779bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2f01c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d35da30>]}
[0m22:09:35.604202 [debug] [MainThread]: Flushing usage events
[0m22:09:35.933221 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:19:36.701049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105237d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106708220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067084f0>]}


============================== 22:19:36.705061 | b6efba7c-a947-47f0-99de-9ae06ba20d7f ==============================
[0m22:19:36.705061 [info ] [MainThread]: Running with dbt=1.10.10
[0m22:19:36.705487 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'printer_width': '80', 'profiles_dir': '/Users/azadsolanki/.dbt', 'fail_fast': 'False', 'log_format': 'default', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'version_check': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'empty': 'False', 'partial_parse': 'True', 'quiet': 'False', 'debug': 'False', 'write_json': 'True', 'invocation_command': 'dbt run --select tag:staging'}
[0m22:19:38.625884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6efba7c-a947-47f0-99de-9ae06ba20d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116afba60>]}
[0m22:19:38.663196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6efba7c-a947-47f0-99de-9ae06ba20d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104433e20>]}
[0m22:19:38.663600 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:19:38.855210 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m22:19:39.194587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:19:39.194908 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:19:39.201120 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.marts.finance
- models.thelook_analytics.reports
- models.thelook_analytics.intermediate
- models.thelook_analytics.marts.core
- models.thelook_analytics.staging
- seeds.thelook_analytics.product_categories
- seeds.thelook_analytics.customer_segments
- snapshots.thelook_analytics
[0m22:19:39.263188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6efba7c-a947-47f0-99de-9ae06ba20d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a86b130>]}
[0m22:19:39.403325 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:19:39.404931 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:19:39.423207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6efba7c-a947-47f0-99de-9ae06ba20d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3ba880>]}
[0m22:19:39.423613 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 41 data tests, 6 sources, 1492 macros
[0m22:19:39.423860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6efba7c-a947-47f0-99de-9ae06ba20d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8802e0>]}
[0m22:19:39.425156 [info ] [MainThread]: 
[0m22:19:39.425409 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:19:39.425623 [info ] [MainThread]: 
[0m22:19:39.425957 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:19:39.428889 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m22:19:39.429179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:40.038743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now list_data-products-441119_snapshot)
[0m22:19:40.039808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:19:40.657154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_snapshot, now list_data-products-441119_dbt_dev_analytics)
[0m22:19:40.658643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:19:41.215557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6efba7c-a947-47f0-99de-9ae06ba20d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10439ea00>]}
[0m22:19:41.237560 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 05:19:36 ===
[0m22:19:41.238208 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m22:19:41.241930 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m22:19:41.242616 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m22:19:41.248871 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m22:19:41.250780 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m22:19:41.251379 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m22:19:41.251878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:19:41.915156 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:054eb43c-c0d5-48e5-bb8b-766d4d719dbe&page=queryresults
[0m22:19:42.387320 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.14s]
[0m22:19:42.437494 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m22:19:42.439409 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m22:19:42.439931 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.05s]
[0m22:19:42.440286 [info ] [MainThread]: 
[0m22:19:42.445910 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_events
[0m22:19:42.446482 [info ] [Thread-1  ]: 1 of 5 START sql view model dbt_dev_analytics.stg_events ....................... [RUN]
[0m22:19:42.447104 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.digital_marketing.stg_events'
[0m22:19:42.447521 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_events
[0m22:19:42.454838 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_events"
[0m22:19:42.455530 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_events
[0m22:19:42.480661 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_events"
[0m22:19:42.481307 [debug] [Thread-1  ]: On model.digital_marketing.stg_events: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_events"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_events`
  OPTIONS()
  as 

select
    id as event_id,
    user_id,
    sequence_number,
    session_id,
    created_at as event_timestamp,
    ip_address,
    city,
    state,
    postal_code,
    browser,
    traffic_source,
    uri,
    event_type,
    
    -- Event categorization
    case 
        when event_type = 'home' then 'Navigation'
        when event_type in ('department', 'category', 'brand') then 'Browse'
        when event_type = 'product' then 'Product View'
        when event_type = 'cart' then 'Add to Cart'
        when event_type = 'purchase' then 'Purchase'
        else 'Other'
    end as event_category,
    
    -- Session analysis
    extract(hour from created_at) as event_hour,
    extract(dayofweek from created_at) as event_day_of_week,
    
    -- Geographic
    case when state is not null then state else 'Unknown' end as user_state,
    case when city is not null then city else 'Unknown' end as user_city,
    
    -- Device/browser categorization
    case 
        when lower(browser) like '%chrome%' then 'Chrome'
        when lower(browser) like '%safari%' then 'Safari'
        when lower(browser) like '%firefox%' then 'Firefox'
        when lower(browser) like '%edge%' then 'Edge'
        else 'Other'
    end as browser_family,
    
    -- Data quality
    case when user_id is null then true else false end as has_missing_user,
    case when session_id is null then true else false end as has_missing_session

from `bigquery-public-data`.`thelook_ecommerce`.`events`
where created_at >= '2019-01-01'
  and created_at <= '2024-12-31'

-- Development environment filter

    qualify row_number() over (order by created_at desc) <= 50000
;


[0m22:19:42.481659 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:19:43.211817 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:9c3061b6-c111-4535-90f2-4207b8b18d9b&page=queryresults
[0m22:19:43.617492 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6efba7c-a947-47f0-99de-9ae06ba20d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11acea3a0>]}
[0m22:19:43.618461 [info ] [Thread-1  ]: 1 of 5 OK created sql view model dbt_dev_analytics.stg_events .................. [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m22:19:43.619152 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_events
[0m22:19:43.619642 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_order_items
[0m22:19:43.620264 [info ] [Thread-1  ]: 2 of 5 START sql view model dbt_dev_analytics.stg_order_items .................. [RUN]
[0m22:19:43.620854 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_events, now model.digital_marketing.stg_order_items)
[0m22:19:43.621322 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_order_items
[0m22:19:43.630406 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_order_items"
[0m22:19:43.631451 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_order_items
[0m22:19:43.637747 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_order_items"
[0m22:19:43.638409 [debug] [Thread-1  ]: On model.digital_marketing.stg_order_items: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_order_items"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
  OPTIONS()
  as 

select
    id as order_item_id,
    order_id,
    user_id,
    product_id,
    inventory_item_id,
    status as item_status,
    created_at as order_item_date,
    shipped_at as item_shipped_date,
    delivered_at as item_delivered_date,
    returned_at as item_returned_date,
    sale_price,
    
    -- Quantity handling (TheLook assumes 1 item per line)
    1 as quantity,
    sale_price as line_total,
    0 as discount_amount,
    
    -- Item status flags
    case when returned_at is not null then true else false end as is_returned,
    case when shipped_at is not null then true else false end as is_shipped,
    case when delivered_at is not null then true else false end as is_delivered,
    case when status = 'Complete' then true else false end as is_complete,
    case when status = 'Cancelled' then true else false end as is_cancelled,
    
    -- Timing analysis
    case when shipped_at is not null then
        date_diff(shipped_at, created_at, day) end as days_to_ship_item,
    case when delivered_at is not null and shipped_at is not null then
        date_diff(delivered_at, shipped_at, day) end as days_in_transit_item,
        
    created_at,
    
    -- Data quality flags
    case when sale_price <= 0 then true else false end as has_invalid_price,
    case when sale_price > 10000 then true else false end as has_extreme_price,
    case when product_id is null then true else false end as has_missing_product,
    case when user_id is null then true else false end as has_missing_user

from `bigquery-public-data`.`thelook_ecommerce`.`order_items`
where created_at >= '2019-01-01'
  and created_at <= '2024-12-31'

-- Development environment filter

    qualify row_number() over (order by created_at desc) <= 50000
;


[0m22:19:43.638867 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:19:44.475996 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:8ed7c67b-3a7c-48ac-b550-b6b6f8ce18de&page=queryresults
[0m22:19:44.804111 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6efba7c-a947-47f0-99de-9ae06ba20d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512ebe0>]}
[0m22:19:44.805517 [info ] [Thread-1  ]: 2 of 5 OK created sql view model dbt_dev_analytics.stg_order_items ............. [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m22:19:44.806627 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_order_items
[0m22:19:44.807405 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_orders
[0m22:19:44.808361 [info ] [Thread-1  ]: 3 of 5 START sql view model dbt_dev_analytics.stg_orders ....................... [RUN]
[0m22:19:44.809121 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_order_items, now model.digital_marketing.stg_orders)
[0m22:19:44.809734 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_orders
[0m22:19:44.822125 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_orders"
[0m22:19:44.823336 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_orders
[0m22:19:44.830363 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_orders"
[0m22:19:44.831275 [debug] [Thread-1  ]: On model.digital_marketing.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_orders"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
  OPTIONS()
  as 

select
    order_id,
    user_id,
    status as order_status,
    gender as customer_gender,
    created_at as order_date,
    returned_at,
    shipped_at,
    delivered_at,
    num_of_item as item_count,
    created_at,
    
    -- Order status flags
    case when returned_at is not null then true else false end as is_returned,
    case when shipped_at is not null then true else false end as is_shipped,
    case when delivered_at is not null then true else false end as is_delivered,
    case when status = 'Complete' then true else false end as is_complete,
    case when status = 'Cancelled' then true else false end as is_cancelled,
    
    -- Delivery timing calculations
    case when shipped_at is not null then
        date_diff(shipped_at, created_at, hour) end as hours_to_ship,
    case when delivered_at is not null and shipped_at is not null then
        date_diff(delivered_at, shipped_at, hour) end as hours_in_transit,
    case when delivered_at is not null then
        date_diff(delivered_at, created_at, hour) end as total_delivery_hours,
        
    -- Convert to days for easier analysis
    case when delivered_at is not null then
        date_diff(delivered_at, created_at, day) end as delivery_days,
        
    -- Order timing analysis
    extract(hour from created_at) as order_hour,
    extract(dayofweek from created_at) as order_day_of_week,
    extract(month from created_at) as order_month,
    extract(quarter from created_at) as order_quarter,
    extract(year from created_at) as order_year,
    
    case 
        when extract(hour from created_at) between 6 and 11 then 'Morning'
        when extract(hour from created_at) between 12 and 17 then 'Afternoon'
        when extract(hour from created_at) between 18 and 21 then 'Evening'
        else 'Night'
    end as order_time_of_day,
    
    case extract(dayofweek from created_at)
        when 1 then 'Sunday'
        when 2 then 'Monday'
        when 3 then 'Tuesday'
        when 4 then 'Wednesday'
        when 5 then 'Thursday'
        when 6 then 'Friday'
        when 7 then 'Saturday'
    end as order_day_name,
    
    case when extract(dayofweek from created_at) in (1, 7) then true else false end as is_weekend,
    
    -- Data quality checks
    case when user_id is null then true else false end as has_missing_user,
    case when num_of_item <= 0 then true else false end as has_invalid_item_count,
    case when created_at > current_timestamp() then true else false end as is_future_order

from `bigquery-public-data`.`thelook_ecommerce`.`orders`
where created_at >= '2019-01-01'
  and created_at <= '2024-12-31'

-- Development environment filter

    qualify row_number() over (order by created_at desc) <= 50000
;


[0m22:19:44.831919 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:19:45.602438 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:7581d959-08a3-416a-81ee-095769f7a217&page=queryresults
[0m22:19:45.961068 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6efba7c-a947-47f0-99de-9ae06ba20d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aeb2040>]}
[0m22:19:45.962497 [info ] [Thread-1  ]: 3 of 5 OK created sql view model dbt_dev_analytics.stg_orders .................. [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m22:19:45.963619 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_orders
[0m22:19:45.964400 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_products
[0m22:19:45.965406 [info ] [Thread-1  ]: 4 of 5 START sql view model dbt_dev_analytics.stg_products ..................... [RUN]
[0m22:19:45.966308 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_orders, now model.digital_marketing.stg_products)
[0m22:19:45.966928 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_products
[0m22:19:45.979111 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_products"
[0m22:19:45.980114 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_products
[0m22:19:45.987382 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_products"
[0m22:19:45.988382 [debug] [Thread-1  ]: On model.digital_marketing.stg_products: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_products"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_products`
  OPTIONS()
  as 

select
    id as product_id,
    cost,
    category,
    name as product_name,
    brand,
    retail_price,
    department,
    sku,
    distribution_center_id,
    
    -- Margin calculations
    retail_price - cost as margin_amount,
    case when retail_price > 0 then
        round((retail_price - cost) / retail_price * 100, 2)
        else 0 end as margin_percentage,
    
    -- Product categorization
    case 
        when retail_price - cost > 100 then 'Premium'
        when retail_price - cost > 50 then 'High'
        when retail_price - cost > 20 then 'Standard'
        when retail_price - cost > 5 then 'Economy'
        else 'Low'
    end as margin_tier,
    
    case
        when retail_price >= 200 then 'Luxury'
        when retail_price >= 100 then 'Premium'
        when retail_price >= 50 then 'Mid-Range'
        when retail_price >= 20 then 'Budget'
        else 'Economy'
    end as price_category,
    
    -- Category grouping (simplified)
    case 
        when lower(category) like '%apparel%' or lower(category) like '%clothing%' then 'Apparel'
        when lower(category) like '%shoe%' or lower(category) like '%footwear%' then 'Footwear'
        when lower(category) like '%accessori%' or lower(category) like '%jewelry%' then 'Accessories'
        when lower(category) like '%home%' or lower(category) like '%decor%' then 'Home & Decor'
        when lower(category) like '%sport%' or lower(category) like '%outdoor%' then 'Sports & Outdoors'
        else 'Other'
    end as category_group,
    
    -- Brand tier (based on average retail price)
    case 
        when brand in ('Calvin Klein', 'Diesel', 'Hugo Boss') then 'Premium'
        when brand in ('Adidas', 'Nike', "Levi's") then 'Popular'
        else 'Standard'
    end as brand_tier,
    
    -- Data quality flags
    case when cost <= 0 then true else false end as has_invalid_cost,
    case when retail_price <= 0 then true else false end as has_invalid_price,
    case when retail_price < cost then true else false end as has_negative_margin,
    case when cost > 5000 or retail_price > 10000 then true else false end as has_extreme_values,
    case when name is null or trim(name) = '' then true else false end as has_missing_name

from `bigquery-public-data`.`thelook_ecommerce`.`products`;


[0m22:19:45.988989 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:19:46.729573 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:a2ed36f1-6c14-466a-b28c-65f522111473&page=queryresults
[0m22:19:47.062372 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6efba7c-a947-47f0-99de-9ae06ba20d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af09e50>]}
[0m22:19:47.063774 [info ] [Thread-1  ]: 4 of 5 OK created sql view model dbt_dev_analytics.stg_products ................ [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m22:19:47.064890 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_products
[0m22:19:47.065676 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_users
[0m22:19:47.066742 [info ] [Thread-1  ]: 5 of 5 START sql view model dbt_dev_analytics.stg_users ........................ [RUN]
[0m22:19:47.067721 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_products, now model.digital_marketing.stg_users)
[0m22:19:47.068482 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_users
[0m22:19:47.082298 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_users"
[0m22:19:47.083280 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_users
[0m22:19:47.090932 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.stg_users"
[0m22:19:47.092091 [debug] [Thread-1  ]: On model.digital_marketing.stg_users: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.stg_users"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`stg_users`
  OPTIONS()
  as 

select 
    id as user_id, 
    first_name, 
    last_name, 
    concat(coalesce(first_name, ''), ' ', coalesce(last_name, '')) as full_name,
    email,
    age,
    gender,
    state,
    country, 
    latitude,
    longitude,
    traffic_source,
    created_at as registration_date,
    created_at,
    
    -- calculate demographics
    CASE 
        WHEN age BETWEEN 13 and 17 THEN 'Gen Z (13 - 17)'
        WHEN age BETWEEN 18 and 24 THEN 'Gen Z (18 - 24)'
        WHEN age BETWEEN 25 and 40 THEN 'Millennial'
        WHEN age BETWEEN 41 and 56 THEN 'Gen X'
        when age between 57 and 75 then 'Boomer'
        WHEN age > 75 THEN 'Silent'
        ELSE  'Unknown'
    END AS generation,

    CASE 
        WHEN age < 25 THEN  '18-24'
        when age < 35 then '25-34'
        when age < 45 then '35-44'
        when age < 55 then '45-54'
        when age < 65 then '55-64'
        ELSE '65+' 
    END as age_group,

    -- Geographic standardization 
    CASE 
        WHEN country = 'USA' THEN state  
        ELSE country
    END as region,

    CASE 
        WHEN country = 'USA' THEN true
        ELSE false
    END as is_domestic,

    -- Acquisition channel grouping
    case 
        when lower(traffic_source) in ('google', 'search', 'organic') then 'Organic Search'
        when lower(traffic_source) in ('facebook', 'instagram', 'social') then 'Social Media'
        when lower(traffic_source) = 'email' then 'Email'
        when lower(traffic_source) in ('youtube', 'video') then 'Video'
        when lower(traffic_source) in ('display', 'banner') then 'Display'
        else 'Other'
    end as acquisition_channel,
    
    -- Data quality flags
    case when email is null or email = '' or not regexp_contains(email, r'^[^@]+@[^@]+\.[^@]+$') 
         then true else false end as has_invalid_email,
    case when age < 13 or age > 120 then true else false end as has_invalid_age,
    case when first_name is null and last_name is null then true else false end as has_missing_name,
    case when latitude is null or longitude is null then true else false end as has_missing_coordinates

from `bigquery-public-data`.`thelook_ecommerce`.`users`
where created_at >= '2019-01-01'
  and created_at <= '2024-12-31'

-- Development environment filter

    qualify row_number() over (order by created_at desc) <= 50000
;


[0m22:19:47.092715 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:19:47.853970 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:e57438cb-2bf6-41d0-a485-14dcef4c921b&page=queryresults
[0m22:19:48.159833 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6efba7c-a947-47f0-99de-9ae06ba20d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af09e50>]}
[0m22:19:48.161366 [info ] [Thread-1  ]: 5 of 5 OK created sql view model dbt_dev_analytics.stg_users ................... [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m22:19:48.162497 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_users
[0m22:19:48.164226 [info ] [MainThread]: 
[0m22:19:48.173650 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m22:19:48.174516 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m22:19:48.175359 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m22:19:48.176102 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m22:19:48.212092 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m22:19:48.225874 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m22:19:48.231337 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m22:19:48.243394 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m22:19:48.244049 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m22:19:48.244380 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.07s]
[0m22:19:48.244633 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:19:48.311448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:19:48.311740 [debug] [MainThread]: Connection 'list_data-products-441119_dbt_dev_analytics' was properly closed.
[0m22:19:48.311941 [debug] [MainThread]: Connection 'model.digital_marketing.stg_users' was properly closed.
[0m22:19:48.312210 [info ] [MainThread]: 
[0m22:19:48.312441 [info ] [MainThread]: Finished running 5 project hooks, 5 view models in 0 hours 0 minutes and 8.89 seconds (8.89s).
[0m22:19:48.313489 [debug] [MainThread]: Command end result
[0m22:19:48.376239 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:19:48.377618 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:19:48.382210 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m22:19:48.382441 [info ] [MainThread]: 
[0m22:19:48.382698 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:19:48.382925 [info ] [MainThread]: 
[0m22:19:48.383160 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m22:19:48.385690 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.734272, "process_in_blocks": "0", "process_kernel_time": 0.464748, "process_mem_max_rss": "384352256", "process_out_blocks": "0", "process_user_time": 4.357043}
[0m22:19:48.386040 [debug] [MainThread]: Command `dbt run` succeeded at 22:19:48.385990 after 11.73 seconds
[0m22:19:48.386307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105237d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104433e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a874f40>]}
[0m22:19:48.386566 [debug] [MainThread]: Flushing usage events
[0m22:19:48.779993 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:20:27.710131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103953df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e23280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e23550>]}


============================== 22:20:27.713990 | c9c198e9-dca7-4dc8-9738-9dc57a8cb87c ==============================
[0m22:20:27.713990 [info ] [MainThread]: Running with dbt=1.10.10
[0m22:20:27.714371 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'no_print': 'None', 'invocation_command': 'dbt test --select tag:staging', 'use_experimental_parser': 'False', 'write_json': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'log_format': 'default', 'debug': 'False', 'printer_width': '80', 'version_check': 'True', 'empty': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False'}
[0m22:20:29.685802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9c198e9-dca7-4dc8-9738-9dc57a8cb87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152285eb0>]}
[0m22:20:29.722929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9c198e9-dca7-4dc8-9738-9dc57a8cb87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152374700>]}
[0m22:20:29.723320 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:20:29.914025 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m22:20:30.255485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:20:30.255813 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:20:30.261999 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.intermediate
- models.thelook_analytics.marts.finance
- models.thelook_analytics.marts.core
- models.thelook_analytics.staging
- models.thelook_analytics.reports
- models.thelook_analytics.marts.marketing
- seeds.thelook_analytics.customer_segments
- seeds.thelook_analytics.product_categories
- snapshots.thelook_analytics
[0m22:20:30.324521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9c198e9-dca7-4dc8-9738-9dc57a8cb87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15362a130>]}
[0m22:20:30.464231 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:20:30.465850 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:20:30.489055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9c198e9-dca7-4dc8-9738-9dc57a8cb87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1537fd610>]}
[0m22:20:30.489460 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 41 data tests, 6 sources, 1492 macros
[0m22:20:30.489709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9c198e9-dca7-4dc8-9738-9dc57a8cb87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153233970>]}
[0m22:20:30.491212 [info ] [MainThread]: 
[0m22:20:30.491458 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:20:30.491672 [info ] [MainThread]: 
[0m22:20:30.492006 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:20:30.497269 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_snapshot'
[0m22:20:30.497686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:31.098536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_snapshot, now list_data-products-441119_dbt_dev_analytics)
[0m22:20:31.100115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:20:31.582052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9c198e9-dca7-4dc8-9738-9dc57a8cb87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1537fda00>]}
[0m22:20:31.590888 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 05:20:27 ===
[0m22:20:31.591305 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m22:20:31.593840 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m22:20:31.594352 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.01s]
[0m22:20:31.600851 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m22:20:31.602432 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m22:20:31.603155 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m22:20:31.603797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:20:32.298598 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:39b647e1-db62-4f5d-bf34-c9b96b44e566&page=queryresults
[0m22:20:32.707558 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.11s]
[0m22:20:33.048513 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m22:20:33.051563 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m22:20:33.052516 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.34s]
[0m22:20:33.053172 [info ] [MainThread]: 
[0m22:20:33.062431 [debug] [Thread-1  ]: Began running node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m22:20:33.063232 [info ] [Thread-1  ]: 1 of 15 START test dbt_utils_accepted_range_stg_order_items_sale_price__10000__0  [RUN]
[0m22:20:33.064094 [debug] [Thread-1  ]: Acquiring new bigquery connection 'test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde'
[0m22:20:33.064705 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m22:20:33.085564 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde"
[0m22:20:33.086493 [debug] [Thread-1  ]: Began executing node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m22:20:33.112791 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde"
[0m22:20:33.113516 [debug] [Thread-1  ]: On test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sale_price >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sale_price <= 10000
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m22:20:33.113928 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:20:34.243645 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:c4c75371-1b2f-4fa9-b7ca-99bde02bcde9&page=queryresults
[0m22:20:34.882105 [info ] [Thread-1  ]: 1 of 15 PASS dbt_utils_accepted_range_stg_order_items_sale_price__10000__0 ..... [[32mPASS[0m in 1.82s]
[0m22:20:34.883473 [debug] [Thread-1  ]: Finished running node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m22:20:34.884195 [debug] [Thread-1  ]: Began running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:20:34.884933 [info ] [Thread-1  ]: 2 of 15 START test dbt_utils_accepted_range_stg_users_age__120__13 ............. [RUN]
[0m22:20:34.885713 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde, now test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2)
[0m22:20:34.886347 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:20:34.898560 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"
[0m22:20:34.900774 [debug] [Thread-1  ]: Began executing node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:20:34.907289 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"
[0m22:20:34.908314 [debug] [Thread-1  ]: On test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not age >= 13
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not age <= 120
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m22:20:34.908941 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:20:36.259736 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:96acf378-d5b9-4513-92a0-0c37bd53554c&page=queryresults
[0m22:20:36.821801 [error] [Thread-1  ]: 2 of 15 FAIL 870 dbt_utils_accepted_range_stg_users_age__120__13 ............... [[31mFAIL 870[0m in 1.94s]
[0m22:20:36.822892 [debug] [Thread-1  ]: Finished running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:20:36.823550 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m22:20:36.824268 [info ] [Thread-1  ]: 3 of 15 START test not_null_stg_order_items_order_item_id ...................... [RUN]
[0m22:20:36.825062 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2, now test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m22:20:36.825695 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m22:20:36.839348 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m22:20:36.841083 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m22:20:36.847053 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m22:20:36.848053 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m22:20:36.848517 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:20:38.133735 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:adfe104e-7bac-45b5-b607-2fd85480a729&page=queryresults
[0m22:20:38.883440 [info ] [Thread-1  ]: 3 of 15 PASS not_null_stg_order_items_order_item_id ............................ [[32mPASS[0m in 2.06s]
[0m22:20:38.884718 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m22:20:38.885507 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m22:20:38.886408 [info ] [Thread-1  ]: 4 of 15 START test not_null_stg_order_items_sale_price ......................... [RUN]
[0m22:20:38.887355 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0)
[0m22:20:38.888112 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m22:20:38.899930 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"
[0m22:20:38.901161 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m22:20:38.909647 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"
[0m22:20:38.911017 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sale_price
from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
where sale_price is null



  
  
      
    ) dbt_internal_test
[0m22:20:38.911779 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:20:40.154243 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:56588cf6-bed4-4ebf-aad8-093b18ab6104&page=queryresults
[0m22:20:40.798368 [info ] [Thread-1  ]: 4 of 15 PASS not_null_stg_order_items_sale_price ............................... [[32mPASS[0m in 1.91s]
[0m22:20:40.799300 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m22:20:40.799952 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m22:20:40.800497 [info ] [Thread-1  ]: 5 of 15 START test not_null_stg_orders_order_date .............................. [RUN]
[0m22:20:40.801114 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0, now test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb)
[0m22:20:40.801585 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m22:20:40.809193 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"
[0m22:20:40.809978 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m22:20:40.815919 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"
[0m22:20:40.816751 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
where order_date is null



  
  
      
    ) dbt_internal_test
[0m22:20:40.817353 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:20:41.960579 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:6362acc5-ff50-46b5-80b1-527ca5c70300&page=queryresults
[0m22:20:42.555338 [info ] [Thread-1  ]: 5 of 15 PASS not_null_stg_orders_order_date .................................... [[32mPASS[0m in 1.75s]
[0m22:20:42.556786 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m22:20:42.557610 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m22:20:42.558486 [info ] [Thread-1  ]: 6 of 15 START test not_null_stg_orders_order_id ................................ [RUN]
[0m22:20:42.559460 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb, now test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64)
[0m22:20:42.560226 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m22:20:42.572880 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"
[0m22:20:42.574053 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m22:20:42.581475 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"
[0m22:20:42.582523 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m22:20:42.583130 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:20:43.765912 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:cd263a40-9788-4ced-a0f9-457caa011292&page=queryresults
[0m22:20:44.589602 [info ] [Thread-1  ]: 6 of 15 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 2.03s]
[0m22:20:44.590914 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m22:20:44.591315 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m22:20:44.591737 [info ] [Thread-1  ]: 7 of 15 START test not_null_stg_orders_user_id ................................. [RUN]
[0m22:20:44.592260 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64, now test.digital_marketing.not_null_stg_orders_user_id.7d129d0209)
[0m22:20:44.592586 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m22:20:44.598188 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"
[0m22:20:44.599129 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m22:20:44.603155 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"
[0m22:20:44.603811 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_orders_user_id.7d129d0209: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:20:44.604123 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:20:45.812724 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:13b49104-7b08-4cc3-907b-62b77ee7f8f7&page=queryresults
[0m22:20:46.393925 [info ] [Thread-1  ]: 7 of 15 PASS not_null_stg_orders_user_id ....................................... [[32mPASS[0m in 1.80s]
[0m22:20:46.394777 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m22:20:46.395266 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m22:20:46.395826 [info ] [Thread-1  ]: 8 of 15 START test not_null_stg_products_product_id ............................ [RUN]
[0m22:20:46.396455 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_user_id.7d129d0209, now test.digital_marketing.not_null_stg_products_product_id.6373b0acf3)
[0m22:20:46.396934 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m22:20:46.405792 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"
[0m22:20:46.407515 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m22:20:46.412744 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"
[0m22:20:46.413516 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m22:20:46.413970 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:20:47.238679 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:32b71b01-bd18-4c60-8b2e-127e6103b9be&page=queryresults
[0m22:20:47.787690 [info ] [Thread-1  ]: 8 of 15 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 1.39s]
[0m22:20:47.789113 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m22:20:47.790052 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:20:47.790908 [info ] [Thread-1  ]: 9 of 15 START test not_null_stg_users_email .................................... [RUN]
[0m22:20:47.791798 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_products_product_id.6373b0acf3, now test.digital_marketing.not_null_stg_users_email.2723c62e0e)
[0m22:20:47.792565 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:20:47.804551 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_email.2723c62e0e"
[0m22:20:47.805854 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:20:47.814696 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_email.2723c62e0e"
[0m22:20:47.815884 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_email.2723c62e0e: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_email.2723c62e0e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where email is null



  
  
      
    ) dbt_internal_test
[0m22:20:47.816496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:20:49.091907 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:9002ddf4-8bf7-46cc-adba-87d460a2d4d7&page=queryresults
[0m22:20:49.637315 [info ] [Thread-1  ]: 9 of 15 PASS not_null_stg_users_email .......................................... [[32mPASS[0m in 1.85s]
[0m22:20:49.638609 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:20:49.639417 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:20:49.640255 [info ] [Thread-1  ]: 10 of 15 START test not_null_stg_users_user_id ................................. [RUN]
[0m22:20:49.641237 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_email.2723c62e0e, now test.digital_marketing.not_null_stg_users_user_id.980dfc1b77)
[0m22:20:49.641960 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:20:49.652780 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"
[0m22:20:49.654819 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:20:49.662954 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"
[0m22:20:49.664008 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:20:49.664529 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:20:50.815097 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:adf4536c-83a1-4054-a5bd-0defdb119108&page=queryresults
[0m22:20:51.425025 [info ] [Thread-1  ]: 10 of 15 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 1.78s]
[0m22:20:51.426392 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:20:51.427195 [debug] [Thread-1  ]: Began running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:20:51.428089 [info ] [Thread-1  ]: 11 of 15 START test relationships_stg_orders_user_id__user_id__ref_stg_users_ .. [RUN]
[0m22:20:51.429083 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_user_id.980dfc1b77, now test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737)
[0m22:20:51.429874 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:20:51.447647 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"
[0m22:20:51.448851 [debug] [Thread-1  ]: Began executing node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:20:51.455653 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"
[0m22:20:51.456569 [debug] [Thread-1  ]: On test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
    where user_id is not null
),

parent as (
    select user_id as to_field
    from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:20:51.457130 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:20:52.960083 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:efcec211-2fd0-4a79-b089-e6e09505173a&page=queryresults
[0m22:20:53.513797 [error] [Thread-1  ]: 11 of 15 FAIL 16395 relationships_stg_orders_user_id__user_id__ref_stg_users_ .. [[31mFAIL 16395[0m in 2.08s]
[0m22:20:53.515121 [debug] [Thread-1  ]: Finished running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:20:53.515925 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m22:20:53.516862 [info ] [Thread-1  ]: 12 of 15 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m22:20:53.517862 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737, now test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108)
[0m22:20:53.518591 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m22:20:53.532851 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"
[0m22:20:53.534762 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m22:20:53.541652 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"
[0m22:20:53.542845 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_item_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
  where order_item_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:20:53.543392 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:20:54.757998 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:0ccb55d4-8283-4243-87a9-35b61c6d0a34&page=queryresults
[0m22:20:55.362551 [info ] [Thread-1  ]: 12 of 15 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 1.84s]
[0m22:20:55.363859 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m22:20:55.364667 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m22:20:55.365527 [info ] [Thread-1  ]: 13 of 15 START test unique_stg_orders_order_id ................................. [RUN]
[0m22:20:55.366501 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108, now test.digital_marketing.unique_stg_orders_order_id.e3b841c71a)
[0m22:20:55.367269 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m22:20:55.381166 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"
[0m22:20:55.382409 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m22:20:55.389373 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"
[0m22:20:55.390368 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:20:55.391027 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:20:56.681915 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:3e851829-2918-4428-9da4-a8e3da663a05&page=queryresults
[0m22:20:57.183656 [info ] [Thread-1  ]: 13 of 15 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 1.82s]
[0m22:20:57.184948 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m22:20:57.185749 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m22:20:57.186610 [info ] [Thread-1  ]: 14 of 15 START test unique_stg_products_product_id ............................. [RUN]
[0m22:20:57.187587 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_orders_order_id.e3b841c71a, now test.digital_marketing.unique_stg_products_product_id.7d950a1467)
[0m22:20:57.188350 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m22:20:57.204537 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_products_product_id.7d950a1467"
[0m22:20:57.209553 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m22:20:57.229725 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_products_product_id.7d950a1467"
[0m22:20:57.230818 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:20:57.231254 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:20:58.203439 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:dd6dc1b6-c2b0-47df-9cd8-8c28cd01db20&page=queryresults
[0m22:20:58.787138 [info ] [Thread-1  ]: 14 of 15 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 1.60s]
[0m22:20:58.788493 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m22:20:58.789307 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:20:58.790160 [info ] [Thread-1  ]: 15 of 15 START test unique_stg_users_user_id ................................... [RUN]
[0m22:20:58.791113 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_products_product_id.7d950a1467, now test.digital_marketing.unique_stg_users_user_id.c2ff477e6b)
[0m22:20:58.791877 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:20:58.804145 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"
[0m22:20:58.806258 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:20:58.814797 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"
[0m22:20:58.815893 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:20:58.816493 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:21:00.105096 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:481721b2-9e58-4cad-819b-95b4da20f433&page=queryresults
[0m22:21:00.623463 [info ] [Thread-1  ]: 15 of 15 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 1.83s]
[0m22:21:00.624817 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:21:00.626637 [info ] [MainThread]: 
[0m22:21:00.636622 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m22:21:00.637559 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m22:21:00.638415 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m22:21:00.639152 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m22:21:00.682028 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m22:21:00.688345 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m22:21:00.698101 [debug] [MainThread]: Elementary: Handling test results.
[0m22:21:00.831929 [debug] [MainThread]: Elementary: Deleting temporary Elementary test tables: []
[0m22:21:00.842761 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m22:21:00.843156 [debug] [MainThread]: Elementary: Handled test results successfully.
[0m22:21:00.852387 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m22:21:00.853824 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m22:21:00.854154 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.21s]
[0m22:21:00.854406 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:21:00.920267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:21:00.920572 [debug] [MainThread]: Connection 'list_data-products-441119_dbt_dev_analytics' was properly closed.
[0m22:21:00.920771 [debug] [MainThread]: Connection 'test.digital_marketing.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m22:21:00.921025 [info ] [MainThread]: 
[0m22:21:00.921254 [info ] [MainThread]: Finished running 5 project hooks, 15 data tests in 0 hours 0 minutes and 30.43 seconds (30.43s).
[0m22:21:00.923046 [debug] [MainThread]: Command end result
[0m22:21:01.077039 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:21:01.078659 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:21:01.083748 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m22:21:01.084045 [info ] [MainThread]: 
[0m22:21:01.084330 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:21:01.084558 [info ] [MainThread]: 
[0m22:21:01.084819 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_stg_users_age__120__13 (models/staging/_staging_models.yml)[0m
[0m22:21:01.085077 [error] [MainThread]:   Got 870 results, configured to fail if != 0
[0m22:21:01.085280 [info ] [MainThread]: 
[0m22:21:01.085520 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/dbt_utils_accepted_range_stg_users_age__120__13.sql
[0m22:21:01.085732 [info ] [MainThread]: 
[0m22:21:01.085977 [error] [MainThread]: [31mFailure in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)[0m
[0m22:21:01.086221 [error] [MainThread]:   Got 16395 results, configured to fail if != 0
[0m22:21:01.086422 [info ] [MainThread]: 
[0m22:21:01.086660 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql
[0m22:21:01.086878 [info ] [MainThread]: 
[0m22:21:01.087104 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=20
[0m22:21:01.089661 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 33.432068, "process_in_blocks": "0", "process_kernel_time": 0.549513, "process_mem_max_rss": "378847232", "process_out_blocks": "0", "process_user_time": 6.018042}
[0m22:21:01.090240 [debug] [MainThread]: Command `dbt test` failed at 22:21:01.090150 after 33.43 seconds
[0m22:21:01.090575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103953df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153f1df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153f1deb0>]}
[0m22:21:01.090877 [debug] [MainThread]: Flushing usage events
[0m22:21:01.406265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:32.236127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d53dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104224190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104224460>]}


============================== 23:03:32.240013 | b486e555-239e-45e0-8fc4-b9b4a10980a1 ==============================
[0m23:03:32.240013 [info ] [MainThread]: Running with dbt=1.10.10
[0m23:03:32.240405 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --select tag:intermediate', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'cache_selected_only': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'profiles_dir': '/Users/azadsolanki/.dbt', 'warn_error': 'None', 'no_print': 'None', 'write_json': 'True', 'debug': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'quiet': 'False', 'static_parser': 'True', 'printer_width': '80', 'introspect': 'True', 'use_colors': 'True', 'target_path': 'None'}
[0m23:03:34.143704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b486e555-239e-45e0-8fc4-b9b4a10980a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1262548e0>]}
[0m23:03:34.181057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b486e555-239e-45e0-8fc4-b9b4a10980a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1262acf40>]}
[0m23:03:34.181463 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m23:03:34.376834 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m23:03:34.716448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:03:34.716782 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:03:34.722941 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.staging
- models.thelook_analytics.marts.core
- models.thelook_analytics.marts.finance
- models.thelook_analytics.intermediate
- models.thelook_analytics.reports
- seeds.thelook_analytics.customer_segments
- seeds.thelook_analytics.product_categories
- snapshots.thelook_analytics
[0m23:03:34.785317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b486e555-239e-45e0-8fc4-b9b4a10980a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12772c130>]}
[0m23:03:34.924933 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m23:03:34.926739 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m23:03:34.945777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b486e555-239e-45e0-8fc4-b9b4a10980a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1267103a0>]}
[0m23:03:34.946169 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 41 data tests, 6 sources, 1492 macros
[0m23:03:34.946420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b486e555-239e-45e0-8fc4-b9b4a10980a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127728370>]}
[0m23:03:34.947620 [info ] [MainThread]: 
[0m23:03:34.947866 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:03:34.948077 [info ] [MainThread]: 
[0m23:03:34.948410 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:03:34.951202 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m23:03:34.951447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:35.555384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now list_data-products-441119_snapshot)
[0m23:03:35.556368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:03:36.239045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_snapshot, now list_data-products-441119_dbt_dev_analytics)
[0m23:03:36.240678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:03:36.851509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b486e555-239e-45e0-8fc4-b9b4a10980a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126235490>]}
[0m23:03:36.875632 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 06:03:32 ===
[0m23:03:36.876328 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m23:03:36.880148 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m23:03:36.880854 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m23:03:36.887264 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m23:03:36.888588 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m23:03:36.889153 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m23:03:36.889635 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:03:37.566268 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:e110c6f8-4765-4952-9995-06f9a3cfefe3&page=queryresults
[0m23:03:38.051197 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.17s]
[0m23:03:38.101719 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m23:03:38.103236 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m23:03:38.103779 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.05s]
[0m23:03:38.104138 [info ] [MainThread]: 
[0m23:03:38.109987 [debug] [Thread-1  ]: Began running node model.digital_marketing.int_order_items_enriched
[0m23:03:38.110580 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt_dev_analytics.int_order_items_enriched ......... [RUN]
[0m23:03:38.111465 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.digital_marketing.int_order_items_enriched'
[0m23:03:38.111858 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.int_order_items_enriched
[0m23:03:38.118434 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.int_order_items_enriched"
[0m23:03:38.119223 [debug] [Thread-1  ]: Began executing node model.digital_marketing.int_order_items_enriched
[0m23:03:38.144902 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.int_order_items_enriched"
[0m23:03:38.145682 [debug] [Thread-1  ]: On model.digital_marketing.int_order_items_enriched: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.int_order_items_enriched"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`int_order_items_enriched`
  OPTIONS()
  as 

select
    oi.order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    oi.inventory_item_id,
    oi.quantity,
    oi.sale_price as unit_price,
    oi.line_total,
    oi.discount_amount,
    oi.is_returned,
    oi.is_shipped,
    oi.is_delivered,
    oi.order_item_date,
    
    -- Product enrichment
    p.product_name,
    p.category,
    p.category_group,
    p.brand,
    p.brand_tier,
    p.department,
    p.cost as product_cost,
    p.retail_price,
    p.margin_amount as product_margin,
    p.margin_percentage as product_margin_pct,
    p.margin_tier,
    p.price_category,
    
    -- Profitability calculations
    oi.sale_price - p.cost as item_gross_profit,
    case when oi.sale_price > 0 then
        round((oi.sale_price - p.cost) / oi.sale_price * 100, 2)
        else 0 end as item_gross_margin_pct,
    
    -- Price analysis
    oi.sale_price - p.retail_price as price_variance,
    case when p.retail_price > 0 then
        round((oi.sale_price - p.retail_price) / p.retail_price * 100, 2)
        else 0 end as price_variance_pct,
        
    case 
        when oi.sale_price > p.retail_price * 1.05 then 'Premium Pricing'
        when oi.sale_price < p.retail_price * 0.95 then 'Discount Pricing'
        else 'Standard Pricing'
    end as pricing_strategy,
    
    -- Order context
    o.order_date,
    o.order_status,
    o.order_time_of_day,
    o.order_day_name,
    o.is_weekend,
    o.customer_gender,
    o.delivery_days,
    o.is_complete as order_complete,
    
    -- User context
    u.age,
    u.age_group,
    u.generation,
    u.state,
    u.country,
    u.region,
    u.is_domestic,
    u.acquisition_channel,
    
    -- Return analysis
    case when oi.is_returned then oi.sale_price else 0 end as returned_value,
    case when oi.is_returned then oi.item_gross_profit else 0 end as returned_profit_impact

from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items` as oi
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_products` as p
    on oi.product_id = p.product_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_orders` as o
    on oi.order_id = o.order_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_users` as u
    on oi.user_id = u.user_id
where not oi.has_invalid_price
  and not oi.has_missing_product
  and not p.has_invalid_cost
  and not p.has_negative_margin
  and not o.has_missing_user;


[0m23:03:38.146055 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:03:38.911350 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:721a8ea1-4904-45ed-9568-ec1867898170&page=queryresults
[0m23:03:39.074926 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:721a8ea1-4904-45ed-9568-ec1867898170&page=queryresults
[0m23:03:39.140277 [debug] [Thread-1  ]: Database Error in model int_order_items_enriched (models/intermediate/int_order_items_enriched.sql)
  Name item_gross_profit not found inside oi at [77:38]
  compiled code at target/run/digital_marketing/models/intermediate/int_order_items_enriched.sql
[0m23:03:39.142199 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b486e555-239e-45e0-8fc4-b9b4a10980a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1328cc0d0>]}
[0m23:03:39.142802 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model dbt_dev_analytics.int_order_items_enriched  [[31mERROR[0m in 1.03s]
[0m23:03:39.143292 [debug] [Thread-1  ]: Finished running node model.digital_marketing.int_order_items_enriched
[0m23:03:39.143706 [debug] [Thread-4  ]: Marking all children of 'model.digital_marketing.int_order_items_enriched' to be skipped because of status 'error'.  Reason: Database Error in model int_order_items_enriched (models/intermediate/int_order_items_enriched.sql)
  Name item_gross_profit not found inside oi at [77:38]
  compiled code at target/run/digital_marketing/models/intermediate/int_order_items_enriched.sql.
[0m23:03:39.144271 [debug] [Thread-1  ]: Began running node model.digital_marketing.int_product_metrics
[0m23:03:39.144672 [info ] [Thread-1  ]: 2 of 3 SKIP relation dbt_dev_analytics.int_product_metrics ..................... [[33mSKIP[0m]
[0m23:03:39.145118 [debug] [Thread-1  ]: Finished running node model.digital_marketing.int_product_metrics
[0m23:03:39.145463 [debug] [Thread-1  ]: Began running node model.digital_marketing.int_user_order_history
[0m23:03:39.145828 [info ] [Thread-1  ]: 3 of 3 SKIP relation dbt_dev_analytics.int_user_order_history .................. [[33mSKIP[0m]
[0m23:03:39.146180 [debug] [Thread-1  ]: Finished running node model.digital_marketing.int_user_order_history
[0m23:03:39.146864 [info ] [MainThread]: 
[0m23:03:39.151576 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m23:03:39.151967 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m23:03:39.152385 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m23:03:39.152744 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m23:03:39.175781 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m23:03:39.186814 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m23:03:39.191229 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m23:03:39.202133 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m23:03:39.203834 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m23:03:39.204178 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.05s]
[0m23:03:39.204438 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:03:39.270792 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:39.271110 [debug] [MainThread]: Connection 'list_data-products-441119_dbt_dev_analytics' was properly closed.
[0m23:03:39.271310 [debug] [MainThread]: Connection 'model.digital_marketing.int_order_items_enriched' was properly closed.
[0m23:03:39.271576 [info ] [MainThread]: 
[0m23:03:39.271811 [info ] [MainThread]: Finished running 5 project hooks, 3 view models in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m23:03:39.272605 [debug] [MainThread]: Command end result
[0m23:03:39.334971 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m23:03:39.336333 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m23:03:39.340610 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m23:03:39.340848 [info ] [MainThread]: 
[0m23:03:39.341106 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:03:39.341331 [info ] [MainThread]: 
[0m23:03:39.341592 [error] [MainThread]: [31mFailure in model int_order_items_enriched (models/intermediate/int_order_items_enriched.sql)[0m
[0m23:03:39.341848 [error] [MainThread]:   Database Error in model int_order_items_enriched (models/intermediate/int_order_items_enriched.sql)
  Name item_gross_profit not found inside oi at [77:38]
  compiled code at target/run/digital_marketing/models/intermediate/int_order_items_enriched.sql
[0m23:03:39.342054 [info ] [MainThread]: 
[0m23:03:39.342292 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/intermediate/int_order_items_enriched.sql
[0m23:03:39.342575 [info ] [MainThread]: 
[0m23:03:39.342845 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=8
[0m23:03:39.345410 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.1583385, "process_in_blocks": "0", "process_kernel_time": 0.471074, "process_mem_max_rss": "378421248", "process_out_blocks": "0", "process_user_time": 3.692203}
[0m23:03:39.345776 [debug] [MainThread]: Command `dbt run` failed at 23:03:39.345724 after 7.16 seconds
[0m23:03:39.346036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d53dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1262acf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1277359a0>]}
[0m23:03:39.346290 [debug] [MainThread]: Flushing usage events
[0m23:03:39.735028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:07:52.486866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10321fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ef190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ef460>]}


============================== 23:07:52.490974 | 1d725c77-b862-42a5-8130-80c985d2dd96 ==============================
[0m23:07:52.490974 [info ] [MainThread]: Running with dbt=1.10.10
[0m23:07:52.491376 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_format': 'default', 'profiles_dir': '/Users/azadsolanki/.dbt', 'static_parser': 'True', 'introspect': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'no_print': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'target_path': 'None', 'warn_error': 'None', 'write_json': 'True', 'invocation_command': 'dbt run --select int_order_items_enriched', 'use_colors': 'True', 'debug': 'False'}
[0m23:07:54.383495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d725c77-b862-42a5-8130-80c985d2dd96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117cff4f0>]}
[0m23:07:54.420799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d725c77-b862-42a5-8130-80c985d2dd96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bb6970>]}
[0m23:07:54.421216 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m23:07:54.610830 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m23:07:54.949521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:07:54.950136 [debug] [MainThread]: Partial parsing: updated file: digital_marketing://models/intermediate/int_order_items_enriched.sql
[0m23:07:55.202004 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.marts.finance
- models.thelook_analytics.marts.core
- models.thelook_analytics.intermediate
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.reports
- models.thelook_analytics.staging
- seeds.thelook_analytics.customer_segments
- seeds.thelook_analytics.product_categories
- snapshots.thelook_analytics
[0m23:07:55.216587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d725c77-b862-42a5-8130-80c985d2dd96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d13130>]}
[0m23:07:55.357125 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m23:07:55.358908 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m23:07:55.377582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d725c77-b862-42a5-8130-80c985d2dd96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118275640>]}
[0m23:07:55.377986 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 41 data tests, 6 sources, 1492 macros
[0m23:07:55.378234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d725c77-b862-42a5-8130-80c985d2dd96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d0b5b0>]}
[0m23:07:55.379535 [info ] [MainThread]: 
[0m23:07:55.379789 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:07:55.380005 [info ] [MainThread]: 
[0m23:07:55.380332 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:07:55.385575 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_dbt_dev_analytics'
[0m23:07:55.385962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:55.951337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev_analytics, now list_data-products-441119_snapshot)
[0m23:07:55.953590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:07:56.526614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d725c77-b862-42a5-8130-80c985d2dd96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118109f70>]}
[0m23:07:56.550384 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 06:07:52 ===
[0m23:07:56.551029 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m23:07:56.554918 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m23:07:56.555598 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m23:07:56.563185 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m23:07:56.565222 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m23:07:56.565767 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m23:07:56.566250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:07:57.225293 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:b36a04fb-0059-446c-b5f2-c31dd8ae4104&page=queryresults
[0m23:07:57.661262 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.10s]
[0m23:07:57.709410 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m23:07:57.711469 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m23:07:57.711987 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.05s]
[0m23:07:57.712342 [info ] [MainThread]: 
[0m23:07:57.717409 [debug] [Thread-1  ]: Began running node model.digital_marketing.int_order_items_enriched
[0m23:07:57.718029 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_snapshot, now model.digital_marketing.int_order_items_enriched)
[0m23:07:57.718455 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.int_order_items_enriched
[0m23:07:57.725809 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.int_order_items_enriched"
[0m23:07:57.726684 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:07:57.797568 [debug] [Thread-1  ]: Finished running node model.digital_marketing.int_order_items_enriched
[0m23:07:57.798259 [info ] [MainThread]: 
[0m23:07:57.802006 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m23:07:57.802354 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m23:07:57.802705 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m23:07:57.803091 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.00s]
[0m23:07:57.823470 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m23:07:57.931414 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m23:07:57.933298 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m23:07:57.933642 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.13s]
[0m23:07:57.933891 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:07:57.999650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:57.999951 [debug] [MainThread]: Connection 'model.digital_marketing.int_order_items_enriched' was properly closed.
[0m23:07:58.000198 [info ] [MainThread]: 
[0m23:07:58.000429 [info ] [MainThread]: Finished running 5 project hooks in 0 hours 0 minutes and 2.62 seconds (2.62s).
[0m23:07:58.001123 [debug] [MainThread]: Command end result
[0m23:07:58.064313 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m23:07:58.065789 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m23:07:58.070380 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m23:07:58.070620 [info ] [MainThread]: 
[0m23:07:58.070884 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:07:58.071108 [info ] [MainThread]: 
[0m23:07:58.071357 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m23:07:58.073884 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.637398, "process_in_blocks": "0", "process_kernel_time": 0.47415, "process_mem_max_rss": "390479872", "process_out_blocks": "0", "process_user_time": 3.727636}
[0m23:07:58.074237 [debug] [MainThread]: Command `dbt run` succeeded at 23:07:58.074189 after 5.64 seconds
[0m23:07:58.074487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10321fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103107910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118109790>]}
[0m23:07:58.074737 [debug] [MainThread]: Flushing usage events
[0m23:07:58.414893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:08:08.701522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11142bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146c4970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146c4c40>]}


============================== 23:08:08.705274 | c84fa6b7-8520-4348-b8e2-ed7a03b9c090 ==============================
[0m23:08:08.705274 [info ] [MainThread]: Running with dbt=1.10.10
[0m23:08:08.705659 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'write_json': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run --select tag:intermediate', 'quiet': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'target_path': 'None', 'use_colors': 'True', 'version_check': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'log_format': 'default'}
[0m23:08:10.573761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c84fa6b7-8520-4348-b8e2-ed7a03b9c090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f7fdf0>]}
[0m23:08:10.612036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c84fa6b7-8520-4348-b8e2-ed7a03b9c090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f9c6d0>]}
[0m23:08:10.612535 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m23:08:10.808573 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m23:08:11.138889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:08:11.139215 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:08:11.145352 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.reports
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.marts.core
- models.thelook_analytics.marts.finance
- models.thelook_analytics.intermediate
- models.thelook_analytics.staging
- seeds.thelook_analytics.customer_segments
- seeds.thelook_analytics.product_categories
- snapshots.thelook_analytics
[0m23:08:11.207884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c84fa6b7-8520-4348-b8e2-ed7a03b9c090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14646b130>]}
[0m23:08:11.356045 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m23:08:11.358331 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m23:08:11.376435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c84fa6b7-8520-4348-b8e2-ed7a03b9c090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145d11640>]}
[0m23:08:11.376907 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 41 data tests, 6 sources, 1492 macros
[0m23:08:11.377187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c84fa6b7-8520-4348-b8e2-ed7a03b9c090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145cee070>]}
[0m23:08:11.378475 [info ] [MainThread]: 
[0m23:08:11.378730 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:08:11.378944 [info ] [MainThread]: 
[0m23:08:11.379294 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:08:11.382099 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m23:08:11.382380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:11.953076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now list_data-products-441119_dbt_dev_analytics)
[0m23:08:11.953670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:08:12.455375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev_analytics, now list_data-products-441119_snapshot)
[0m23:08:12.456242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:08:13.071001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c84fa6b7-8520-4348-b8e2-ed7a03b9c090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14640f100>]}
[0m23:08:13.096560 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 06:08:08 ===
[0m23:08:13.097292 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m23:08:13.101031 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m23:08:13.101710 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m23:08:13.108266 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m23:08:13.109346 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m23:08:13.109889 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m23:08:13.110358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:08:13.716544 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:fa45e681-2c62-4324-9d6a-b6549e950771&page=queryresults
[0m23:08:14.128739 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.03s]
[0m23:08:14.178028 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m23:08:14.179068 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m23:08:14.179604 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.05s]
[0m23:08:14.179962 [info ] [MainThread]: 
[0m23:08:14.185012 [debug] [Thread-1  ]: Began running node model.digital_marketing.int_order_items_enriched
[0m23:08:14.185867 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.digital_marketing.int_order_items_enriched'
[0m23:08:14.186295 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.int_order_items_enriched
[0m23:08:14.193344 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.int_order_items_enriched"
[0m23:08:14.194123 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:08:14.265892 [debug] [Thread-1  ]: Finished running node model.digital_marketing.int_order_items_enriched
[0m23:08:14.266475 [debug] [Thread-1  ]: Began running node model.digital_marketing.int_product_metrics
[0m23:08:14.266831 [info ] [Thread-1  ]: 1 of 2 START sql view model dbt_dev_analytics.int_product_metrics .............. [RUN]
[0m23:08:14.267175 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.int_order_items_enriched, now model.digital_marketing.int_product_metrics)
[0m23:08:14.267529 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.int_product_metrics
[0m23:08:14.291999 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.int_product_metrics"
[0m23:08:14.292602 [debug] [Thread-1  ]: Began executing node model.digital_marketing.int_product_metrics
[0m23:08:14.313118 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.int_product_metrics"
[0m23:08:14.313836 [debug] [Thread-1  ]: On model.digital_marketing.int_product_metrics: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.int_product_metrics"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`int_product_metrics`
  OPTIONS()
  as 

with  __dbt__cte__int_order_items_enriched as (


select
    oi.order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    oi.inventory_item_id,
    oi.quantity,
    oi.sale_price as unit_price,
    oi.line_total,
    oi.discount_amount,
    oi.is_returned,
    oi.is_shipped,
    oi.is_delivered,
    oi.order_item_date,
    
    -- Product enrichment
    p.product_name,
    p.category,
    p.category_group,
    p.brand,
    p.brand_tier,
    p.department,
    p.cost as product_cost,
    p.retail_price,
    p.margin_amount as product_margin,
    p.margin_percentage as product_margin_pct,
    p.margin_tier,
    p.price_category,
    
    -- Profitability calculations
    oi.sale_price - p.cost as item_gross_profit,
    case when oi.sale_price > 0 then
        round((oi.sale_price - p.cost) / oi.sale_price * 100, 2)
        else 0 end as item_gross_margin_pct,
    
    -- Price analysis
    oi.sale_price - p.retail_price as price_variance,
    case when p.retail_price > 0 then
        round((oi.sale_price - p.retail_price) / p.retail_price * 100, 2)
        else 0 end as price_variance_pct,
        
    case
        when oi.sale_price > p.retail_price * 1.05 then 'Premium Pricing'
        when oi.sale_price < p.retail_price * 0.95 then 'Discount Pricing'
        else 'Standard Pricing'
    end as pricing_strategy,
    
    -- Order context
    o.order_date,
    o.order_status,
    o.order_time_of_day,
    o.order_day_name,
    o.is_weekend,
    o.customer_gender,
    o.delivery_days,
    o.is_complete as order_complete,
    
    -- User context
    u.age,
    u.age_group,
    u.generation,
    u.state,
    u.country,
    u.region,
    u.is_domestic,
    u.acquisition_channel,
    
    -- Return analysis
    case when oi.is_returned then oi.sale_price else 0 end as returned_value,
    case when oi.is_returned then (oi.sale_price - p.cost) else 0 end as returned_profit_impact  -- Fixed this line

from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items` as oi
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_products` as p
    on oi.product_id = p.product_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_orders` as o
    on oi.order_id = o.order_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_users` as u
    on oi.user_id = u.user_id
where not oi.has_invalid_price
  and not oi.has_missing_product
  and not p.has_invalid_cost
  and not p.has_negative_margin
  and not o.has_missing_user
), product_sales as (
    select
        product_id,
        
        -- Sales volume
        count(*) as total_units_sold,
        count(distinct order_id) as total_orders,
        count(distinct user_id) as unique_customers,
        
        -- Revenue metrics
        sum(line_total) as total_revenue,
        sum(item_gross_profit) as total_gross_profit,
        avg(unit_price) as avg_selling_price,
        avg(item_gross_margin_pct) as avg_gross_margin_pct,
        
        -- Return analysis
        count(case when is_returned then 1 end) as units_returned,
        sum(returned_value) as total_returned_revenue,
        
        -- Timing
        min(order_date) as first_sale_date,
        max(order_date) as last_sale_date,
        count(distinct date(order_date)) as active_sales_days,
        
        -- Customer segments
        count(case when age_group = '25-34' then 1 end) as sales_to_millennials,
        count(case when age_group = '35-44' then 1 end) as sales_to_gen_x,
        count(case when is_domestic then 1 end) as domestic_sales,
        
        -- Geographic distribution
        count(distinct state) as states_sold_in,
        count(distinct region) as regions_sold_in,
        
        -- Seasonal patterns
        count(case when extract(quarter from order_date) = 1 then 1 end) as q1_sales,
        count(case when extract(quarter from order_date) = 2 then 1 end) as q2_sales,
        count(case when extract(quarter from order_date) = 3 then 1 end) as q3_sales,
        count(case when extract(quarter from order_date) = 4 then 1 end) as q4_sales,
        
        -- Recent performance (last 90 days)
        sum(case when date(order_date) >= date_sub(current_date(), interval 90 day) 
            then line_total else 0 end) as revenue_90d,
        count(case when date(order_date) >= date_sub(current_date(), interval 90 day) 
            then 1 end) as units_sold_90d

    from __dbt__cte__int_order_items_enriched
    where order_complete
    group by product_id
)

select
    *,
    
    -- Performance calculations
    case when total_units_sold > 0 then
        round(units_returned * 100.0 / total_units_sold, 2)
        else 0 end as return_rate,
        
    case when total_orders > 0 then
        round(total_units_sold * 1.0 / total_orders, 2)
        else 0 end as avg_units_per_order,
        
    case when unique_customers > 0 then
        round(total_revenue / unique_customers, 2)
        else 0 end as revenue_per_customer,
    
    -- Geographic reach
    states_sold_in + regions_sold_in as geographic_reach_score,
    
    -- Seasonality index (Q4 typically highest for retail)
    case when (q1_sales + q2_sales + q3_sales + q4_sales) > 0 then
        round(q4_sales * 4.0 / (q1_sales + q2_sales + q3_sales + q4_sales), 2)
        else 0 end as q4_seasonality_index,
    
    -- Performance status
    case 
        when revenue_90d > 5000 then 'Hot'
        when revenue_90d > 1000 then 'Warm'
        when revenue_90d > 100 then 'Cool'
        when revenue_90d > 0 then 'Cold'
        else 'No Recent Sales'
    end as recent_performance_status,
    
    -- Customer concentration
    case when total_orders > 0 then
        round(unique_customers * 100.0 / total_orders, 2)
        else 0 end as customer_diversity_pct

from product_sales;


[0m23:08:14.314282 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:08:15.072009 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:19e7ae4e-c0db-4c69-a831-6ba35501927d&page=queryresults
[0m23:08:15.499588 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c84fa6b7-8520-4348-b8e2-ed7a03b9c090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14754f490>]}
[0m23:08:15.500604 [info ] [Thread-1  ]: 1 of 2 OK created sql view model dbt_dev_analytics.int_product_metrics ......... [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m23:08:15.501434 [debug] [Thread-1  ]: Finished running node model.digital_marketing.int_product_metrics
[0m23:08:15.502009 [debug] [Thread-1  ]: Began running node model.digital_marketing.int_user_order_history
[0m23:08:15.502774 [info ] [Thread-1  ]: 2 of 2 START sql view model dbt_dev_analytics.int_user_order_history ........... [RUN]
[0m23:08:15.503432 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.int_product_metrics, now model.digital_marketing.int_user_order_history)
[0m23:08:15.503907 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.int_user_order_history
[0m23:08:15.544248 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.int_user_order_history"
[0m23:08:15.544930 [debug] [Thread-1  ]: Began executing node model.digital_marketing.int_user_order_history
[0m23:08:15.549519 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.int_user_order_history"
[0m23:08:15.550225 [debug] [Thread-1  ]: On model.digital_marketing.int_user_order_history: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.int_user_order_history"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`int_user_order_history`
  OPTIONS()
  as 

with  __dbt__cte__int_order_items_enriched as (


select
    oi.order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    oi.inventory_item_id,
    oi.quantity,
    oi.sale_price as unit_price,
    oi.line_total,
    oi.discount_amount,
    oi.is_returned,
    oi.is_shipped,
    oi.is_delivered,
    oi.order_item_date,
    
    -- Product enrichment
    p.product_name,
    p.category,
    p.category_group,
    p.brand,
    p.brand_tier,
    p.department,
    p.cost as product_cost,
    p.retail_price,
    p.margin_amount as product_margin,
    p.margin_percentage as product_margin_pct,
    p.margin_tier,
    p.price_category,
    
    -- Profitability calculations
    oi.sale_price - p.cost as item_gross_profit,
    case when oi.sale_price > 0 then
        round((oi.sale_price - p.cost) / oi.sale_price * 100, 2)
        else 0 end as item_gross_margin_pct,
    
    -- Price analysis
    oi.sale_price - p.retail_price as price_variance,
    case when p.retail_price > 0 then
        round((oi.sale_price - p.retail_price) / p.retail_price * 100, 2)
        else 0 end as price_variance_pct,
        
    case
        when oi.sale_price > p.retail_price * 1.05 then 'Premium Pricing'
        when oi.sale_price < p.retail_price * 0.95 then 'Discount Pricing'
        else 'Standard Pricing'
    end as pricing_strategy,
    
    -- Order context
    o.order_date,
    o.order_status,
    o.order_time_of_day,
    o.order_day_name,
    o.is_weekend,
    o.customer_gender,
    o.delivery_days,
    o.is_complete as order_complete,
    
    -- User context
    u.age,
    u.age_group,
    u.generation,
    u.state,
    u.country,
    u.region,
    u.is_domestic,
    u.acquisition_channel,
    
    -- Return analysis
    case when oi.is_returned then oi.sale_price else 0 end as returned_value,
    case when oi.is_returned then (oi.sale_price - p.cost) else 0 end as returned_profit_impact  -- Fixed this line

from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items` as oi
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_products` as p
    on oi.product_id = p.product_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_orders` as o
    on oi.order_id = o.order_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_users` as u
    on oi.user_id = u.user_id
where not oi.has_invalid_price
  and not oi.has_missing_product
  and not p.has_invalid_cost
  and not p.has_negative_margin
  and not o.has_missing_user
), order_aggregates as (
    select
        user_id,
        
        -- Order counts by status
        count(*) as total_orders,
        count(case when order_status = 'Complete' then 1 end) as completed_orders,
        count(case when order_status = 'Cancelled' then 1 end) as cancelled_orders,
        count(case when order_status = 'Returned' then 1 end) as returned_orders,
        count(case when is_returned then 1 end) as orders_with_returns,
        
        -- Financial metrics
        sum(line_total) as lifetime_value,
        sum(case when not is_returned then line_total else 0 end) as net_lifetime_value,
        sum(item_gross_profit) as lifetime_gross_profit,
        sum(returned_value) as total_returned_value,
        avg(line_total) as avg_item_value,
        
        -- Order characteristics
        avg(delivery_days) as avg_delivery_days,
        sum(case when delivery_days <= 3 then 1 else 0 end) as fast_deliveries,
        
        -- Product preferences
        count(distinct product_id) as unique_products_purchased,
        count(distinct category) as unique_categories_purchased,
        count(distinct brand) as unique_brands_purchased,
        count(distinct department) as unique_departments_purchased,
        
        -- Timing patterns
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        count(distinct date(order_date)) as unique_order_days,
        
        -- Channel and behavior
        count(case when is_weekend then 1 end) as weekend_orders,
        count(case when order_time_of_day = 'Evening' then 1 end) as evening_orders,
        
        -- Product tier preferences
        count(case when price_category = 'Luxury' then 1 end) as luxury_items,
        count(case when price_category = 'Premium' then 1 end) as premium_items,
        count(case when price_category = 'Budget' then 1 end) as budget_items,
        
        -- Brand preferences
        count(case when brand_tier = 'Premium' then 1 end) as premium_brand_items,
        
        -- Category preferences (top category)
        mode() within group (order by category_group) as preferred_category,
        mode() within group (order by brand) as preferred_brand

    from __dbt__cte__int_order_items_enriched
    where order_complete
    group by user_id
)

select
    *,
    
    -- Derived metrics
    date_diff(current_date(), date(last_order_date), day) as days_since_last_order,
    date_diff(last_order_date, first_order_date, day) as customer_tenure_days,
    
    -- Frequency calculations
    case when customer_tenure_days > 0 then
        round(total_orders * 365.0 / customer_tenure_days, 2)
        else 0 end as orders_per_year,
        
    case when customer_tenure_days > 30 then
        round(total_orders * 30.0 / customer_tenure_days, 2)
        else total_orders end as orders_per_month,
    
    -- Value calculations
    case when completed_orders > 0 then
        round(lifetime_value / completed_orders, 2)
        else 0 end as avg_order_value,
        
    case when lifetime_value > 0 then
        round(lifetime_gross_profit / lifetime_value * 100, 2)
        else 0 end as avg_margin_pct,
    
    -- Behavioral patterns
    case when total_orders > 0 then
        round(orders_with_returns * 100.0 / total_orders, 2)
        else 0 end as return_rate,
        
    case when total_orders > 0 then
        round(weekend_orders * 100.0 / total_orders, 2)
        else 0 end as weekend_order_pct,
        
    case when completed_orders > 0 then
        round(fast_deliveries * 100.0 / completed_orders, 2)
        else 0 end as fast_delivery_pct,
    
    -- Product diversity
    case when total_orders > 0 then
        round(unique_products_purchased * 1.0 / total_orders, 2)
        else 0 end as product_diversity_score,
    
    -- Premium propensity
    case when total_orders > 0 then
        round((luxury_items + premium_items) * 100.0 / total_orders, 2)
        else 0 end as premium_propensity_pct

from order_aggregates;


[0m23:08:15.550737 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:08:16.066378 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:c35165b2-bfe0-4e14-b761-83297bfb0e8a&page=queryresults
[0m23:08:16.068185 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:c35165b2-bfe0-4e14-b761-83297bfb0e8a&page=queryresults
[0m23:08:16.136162 [debug] [Thread-1  ]: Database Error in model int_user_order_history (models/intermediate/int_user_order_history.sql)
  Syntax error: Expected ")" but got keyword WITHIN at [140:16]
  compiled code at target/run/digital_marketing/models/intermediate/int_user_order_history.sql
[0m23:08:16.136816 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c84fa6b7-8520-4348-b8e2-ed7a03b9c090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147683ee0>]}
[0m23:08:16.137444 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model dbt_dev_analytics.int_user_order_history .. [[31mERROR[0m in 0.63s]
[0m23:08:16.137947 [debug] [Thread-1  ]: Finished running node model.digital_marketing.int_user_order_history
[0m23:08:16.138425 [debug] [Thread-4  ]: Marking all children of 'model.digital_marketing.int_user_order_history' to be skipped because of status 'error'.  Reason: Database Error in model int_user_order_history (models/intermediate/int_user_order_history.sql)
  Syntax error: Expected ")" but got keyword WITHIN at [140:16]
  compiled code at target/run/digital_marketing/models/intermediate/int_user_order_history.sql.
[0m23:08:16.139269 [info ] [MainThread]: 
[0m23:08:16.143883 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m23:08:16.144316 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m23:08:16.144801 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m23:08:16.145287 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m23:08:16.168035 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m23:08:16.179071 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m23:08:16.184258 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m23:08:16.195252 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m23:08:16.195914 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m23:08:16.196248 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.05s]
[0m23:08:16.196499 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:08:16.262459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:08:16.262766 [debug] [MainThread]: Connection 'list_data-products-441119_snapshot' was properly closed.
[0m23:08:16.262967 [debug] [MainThread]: Connection 'model.digital_marketing.int_user_order_history' was properly closed.
[0m23:08:16.263231 [info ] [MainThread]: 
[0m23:08:16.263461 [info ] [MainThread]: Finished running 5 project hooks, 2 view models in 0 hours 0 minutes and 4.88 seconds (4.88s).
[0m23:08:16.264299 [debug] [MainThread]: Command end result
[0m23:08:16.327537 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m23:08:16.328938 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m23:08:16.333588 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m23:08:16.333829 [info ] [MainThread]: 
[0m23:08:16.334083 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:08:16.334309 [info ] [MainThread]: 
[0m23:08:16.334573 [error] [MainThread]: [31mFailure in model int_user_order_history (models/intermediate/int_user_order_history.sql)[0m
[0m23:08:16.334835 [error] [MainThread]:   Database Error in model int_user_order_history (models/intermediate/int_user_order_history.sql)
  Syntax error: Expected ")" but got keyword WITHIN at [140:16]
  compiled code at target/run/digital_marketing/models/intermediate/int_user_order_history.sql
[0m23:08:16.335047 [info ] [MainThread]: 
[0m23:08:16.335290 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/intermediate/int_user_order_history.sql
[0m23:08:16.335507 [info ] [MainThread]: 
[0m23:08:16.335738 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m23:08:16.338252 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.6838264, "process_in_blocks": "0", "process_kernel_time": 0.451685, "process_mem_max_rss": "371130368", "process_out_blocks": "0", "process_user_time": 4.082694}
[0m23:08:16.338615 [debug] [MainThread]: Command `dbt run` failed at 23:08:16.338559 after 7.68 seconds
[0m23:08:16.338888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11142bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f7fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1458b6eb0>]}
[0m23:08:16.339151 [debug] [MainThread]: Flushing usage events
[0m23:08:16.635428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:16:45.246486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105723dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf32b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf3580>]}


============================== 00:16:45.250919 | 9cc4c285-a209-4dd2-b5bf-07241d3138f3 ==============================
[0m00:16:45.250919 [info ] [MainThread]: Running with dbt=1.10.10
[0m00:16:45.251311 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'write_json': 'True', 'no_print': 'None', 'profiles_dir': '/Users/azadsolanki/.dbt', 'empty': 'False', 'printer_width': '80', 'fail_fast': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'debug': 'False', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:intermediate', 'introspect': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs'}
[0m00:16:47.606225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cc4c285-a209-4dd2-b5bf-07241d3138f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1424962b0>]}
[0m00:16:47.644871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cc4c285-a209-4dd2-b5bf-07241d3138f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1425975b0>]}
[0m00:16:47.645368 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:16:47.843371 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m00:16:48.187949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:16:48.188619 [debug] [MainThread]: Partial parsing: updated file: digital_marketing://models/intermediate/int_user_order_history.sql
[0m00:16:48.442100 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.marts.core
- models.thelook_analytics.intermediate
- models.thelook_analytics.marts.finance
- models.thelook_analytics.reports
- models.thelook_analytics.staging
- seeds.thelook_analytics.customer_segments
- seeds.thelook_analytics.product_categories
- snapshots.thelook_analytics
[0m00:16:48.456970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cc4c285-a209-4dd2-b5bf-07241d3138f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143a96130>]}
[0m00:16:48.594983 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m00:16:48.596827 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m00:16:48.616098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cc4c285-a209-4dd2-b5bf-07241d3138f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143a84e50>]}
[0m00:16:48.616485 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 41 data tests, 6 sources, 1492 macros
[0m00:16:48.616732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cc4c285-a209-4dd2-b5bf-07241d3138f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143a8dca0>]}
[0m00:16:48.617923 [info ] [MainThread]: 
[0m00:16:48.618175 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:16:48.618384 [info ] [MainThread]: 
[0m00:16:48.618710 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:16:48.621433 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m00:16:48.621695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:49.246059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now list_data-products-441119_snapshot)
[0m00:16:49.247041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:49.928318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_snapshot, now list_data-products-441119_dbt_dev_analytics)
[0m00:16:49.930042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:50.437187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cc4c285-a209-4dd2-b5bf-07241d3138f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1431d42b0>]}
[0m00:16:50.456565 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 07:16:45 ===
[0m00:16:50.457210 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m00:16:50.461160 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m00:16:50.462004 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.02s]
[0m00:16:50.469537 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m00:16:50.470955 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m00:16:50.471548 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m00:16:50.472044 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:16:51.062148 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:73672161-4ac8-4b8a-9506-704c4031b638&page=queryresults
[0m00:16:51.557591 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.09s]
[0m00:16:51.601764 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m00:16:51.603807 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m00:16:51.604390 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.05s]
[0m00:16:51.604754 [info ] [MainThread]: 
[0m00:16:51.609852 [debug] [Thread-1  ]: Began running node model.digital_marketing.int_order_items_enriched
[0m00:16:51.610276 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev_analytics, now model.digital_marketing.int_order_items_enriched)
[0m00:16:51.610635 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.int_order_items_enriched
[0m00:16:51.617698 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.int_order_items_enriched"
[0m00:16:51.618604 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:16:51.689364 [debug] [Thread-1  ]: Finished running node model.digital_marketing.int_order_items_enriched
[0m00:16:51.689857 [debug] [Thread-1  ]: Began running node model.digital_marketing.int_product_metrics
[0m00:16:51.690203 [info ] [Thread-1  ]: 1 of 2 START sql view model dbt_dev_analytics.int_product_metrics .............. [RUN]
[0m00:16:51.690550 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.int_order_items_enriched, now model.digital_marketing.int_product_metrics)
[0m00:16:51.690835 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.int_product_metrics
[0m00:16:51.714904 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.int_product_metrics"
[0m00:16:51.715894 [debug] [Thread-1  ]: Began executing node model.digital_marketing.int_product_metrics
[0m00:16:51.826860 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.int_product_metrics"
[0m00:16:51.827701 [debug] [Thread-1  ]: On model.digital_marketing.int_product_metrics: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.int_product_metrics"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`int_product_metrics`
  OPTIONS()
  as 

with  __dbt__cte__int_order_items_enriched as (


select
    oi.order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    oi.inventory_item_id,
    oi.quantity,
    oi.sale_price as unit_price,
    oi.line_total,
    oi.discount_amount,
    oi.is_returned,
    oi.is_shipped,
    oi.is_delivered,
    oi.order_item_date,
    
    -- Product enrichment
    p.product_name,
    p.category,
    p.category_group,
    p.brand,
    p.brand_tier,
    p.department,
    p.cost as product_cost,
    p.retail_price,
    p.margin_amount as product_margin,
    p.margin_percentage as product_margin_pct,
    p.margin_tier,
    p.price_category,
    
    -- Profitability calculations
    oi.sale_price - p.cost as item_gross_profit,
    case when oi.sale_price > 0 then
        round((oi.sale_price - p.cost) / oi.sale_price * 100, 2)
        else 0 end as item_gross_margin_pct,
    
    -- Price analysis
    oi.sale_price - p.retail_price as price_variance,
    case when p.retail_price > 0 then
        round((oi.sale_price - p.retail_price) / p.retail_price * 100, 2)
        else 0 end as price_variance_pct,
        
    case
        when oi.sale_price > p.retail_price * 1.05 then 'Premium Pricing'
        when oi.sale_price < p.retail_price * 0.95 then 'Discount Pricing'
        else 'Standard Pricing'
    end as pricing_strategy,
    
    -- Order context
    o.order_date,
    o.order_status,
    o.order_time_of_day,
    o.order_day_name,
    o.is_weekend,
    o.customer_gender,
    o.delivery_days,
    o.is_complete as order_complete,
    
    -- User context
    u.age,
    u.age_group,
    u.generation,
    u.state,
    u.country,
    u.region,
    u.is_domestic,
    u.acquisition_channel,
    
    -- Return analysis
    case when oi.is_returned then oi.sale_price else 0 end as returned_value,
    case when oi.is_returned then (oi.sale_price - p.cost) else 0 end as returned_profit_impact  -- Fixed this line

from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items` as oi
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_products` as p
    on oi.product_id = p.product_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_orders` as o
    on oi.order_id = o.order_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_users` as u
    on oi.user_id = u.user_id
where not oi.has_invalid_price
  and not oi.has_missing_product
  and not p.has_invalid_cost
  and not p.has_negative_margin
  and not o.has_missing_user
), product_sales as (
    select
        product_id,
        
        -- Sales volume
        count(*) as total_units_sold,
        count(distinct order_id) as total_orders,
        count(distinct user_id) as unique_customers,
        
        -- Revenue metrics
        sum(line_total) as total_revenue,
        sum(item_gross_profit) as total_gross_profit,
        avg(unit_price) as avg_selling_price,
        avg(item_gross_margin_pct) as avg_gross_margin_pct,
        
        -- Return analysis
        count(case when is_returned then 1 end) as units_returned,
        sum(returned_value) as total_returned_revenue,
        
        -- Timing
        min(order_date) as first_sale_date,
        max(order_date) as last_sale_date,
        count(distinct date(order_date)) as active_sales_days,
        
        -- Customer segments
        count(case when age_group = '25-34' then 1 end) as sales_to_millennials,
        count(case when age_group = '35-44' then 1 end) as sales_to_gen_x,
        count(case when is_domestic then 1 end) as domestic_sales,
        
        -- Geographic distribution
        count(distinct state) as states_sold_in,
        count(distinct region) as regions_sold_in,
        
        -- Seasonal patterns
        count(case when extract(quarter from order_date) = 1 then 1 end) as q1_sales,
        count(case when extract(quarter from order_date) = 2 then 1 end) as q2_sales,
        count(case when extract(quarter from order_date) = 3 then 1 end) as q3_sales,
        count(case when extract(quarter from order_date) = 4 then 1 end) as q4_sales,
        
        -- Recent performance (last 90 days)
        sum(case when date(order_date) >= date_sub(current_date(), interval 90 day) 
            then line_total else 0 end) as revenue_90d,
        count(case when date(order_date) >= date_sub(current_date(), interval 90 day) 
            then 1 end) as units_sold_90d

    from __dbt__cte__int_order_items_enriched
    where order_complete
    group by product_id
)

select
    *,
    
    -- Performance calculations
    case when total_units_sold > 0 then
        round(units_returned * 100.0 / total_units_sold, 2)
        else 0 end as return_rate,
        
    case when total_orders > 0 then
        round(total_units_sold * 1.0 / total_orders, 2)
        else 0 end as avg_units_per_order,
        
    case when unique_customers > 0 then
        round(total_revenue / unique_customers, 2)
        else 0 end as revenue_per_customer,
    
    -- Geographic reach
    states_sold_in + regions_sold_in as geographic_reach_score,
    
    -- Seasonality index (Q4 typically highest for retail)
    case when (q1_sales + q2_sales + q3_sales + q4_sales) > 0 then
        round(q4_sales * 4.0 / (q1_sales + q2_sales + q3_sales + q4_sales), 2)
        else 0 end as q4_seasonality_index,
    
    -- Performance status
    case 
        when revenue_90d > 5000 then 'Hot'
        when revenue_90d > 1000 then 'Warm'
        when revenue_90d > 100 then 'Cool'
        when revenue_90d > 0 then 'Cold'
        else 'No Recent Sales'
    end as recent_performance_status,
    
    -- Customer concentration
    case when total_orders > 0 then
        round(unique_customers * 100.0 / total_orders, 2)
        else 0 end as customer_diversity_pct

from product_sales;


[0m00:16:51.828158 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:16:52.604415 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:1c9c30c2-3cf6-492f-a1c6-e0c5178a05bc&page=queryresults
[0m00:16:52.970426 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc4c285-a209-4dd2-b5bf-07241d3138f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cd10df0>]}
[0m00:16:52.971297 [info ] [Thread-1  ]: 1 of 2 OK created sql view model dbt_dev_analytics.int_product_metrics ......... [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m00:16:52.971991 [debug] [Thread-1  ]: Finished running node model.digital_marketing.int_product_metrics
[0m00:16:52.972477 [debug] [Thread-1  ]: Began running node model.digital_marketing.int_user_order_history
[0m00:16:52.973106 [info ] [Thread-1  ]: 2 of 2 START sql view model dbt_dev_analytics.int_user_order_history ........... [RUN]
[0m00:16:52.973694 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.int_product_metrics, now model.digital_marketing.int_user_order_history)
[0m00:16:52.974160 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.int_user_order_history
[0m00:16:53.014701 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.int_user_order_history"
[0m00:16:53.015393 [debug] [Thread-1  ]: Began executing node model.digital_marketing.int_user_order_history
[0m00:16:53.019370 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.int_user_order_history"
[0m00:16:53.020094 [debug] [Thread-1  ]: On model.digital_marketing.int_user_order_history: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.int_user_order_history"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`int_user_order_history`
  OPTIONS()
  as 

with  __dbt__cte__int_order_items_enriched as (


select
    oi.order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    oi.inventory_item_id,
    oi.quantity,
    oi.sale_price as unit_price,
    oi.line_total,
    oi.discount_amount,
    oi.is_returned,
    oi.is_shipped,
    oi.is_delivered,
    oi.order_item_date,
    
    -- Product enrichment
    p.product_name,
    p.category,
    p.category_group,
    p.brand,
    p.brand_tier,
    p.department,
    p.cost as product_cost,
    p.retail_price,
    p.margin_amount as product_margin,
    p.margin_percentage as product_margin_pct,
    p.margin_tier,
    p.price_category,
    
    -- Profitability calculations
    oi.sale_price - p.cost as item_gross_profit,
    case when oi.sale_price > 0 then
        round((oi.sale_price - p.cost) / oi.sale_price * 100, 2)
        else 0 end as item_gross_margin_pct,
    
    -- Price analysis
    oi.sale_price - p.retail_price as price_variance,
    case when p.retail_price > 0 then
        round((oi.sale_price - p.retail_price) / p.retail_price * 100, 2)
        else 0 end as price_variance_pct,
        
    case
        when oi.sale_price > p.retail_price * 1.05 then 'Premium Pricing'
        when oi.sale_price < p.retail_price * 0.95 then 'Discount Pricing'
        else 'Standard Pricing'
    end as pricing_strategy,
    
    -- Order context
    o.order_date,
    o.order_status,
    o.order_time_of_day,
    o.order_day_name,
    o.is_weekend,
    o.customer_gender,
    o.delivery_days,
    o.is_complete as order_complete,
    
    -- User context
    u.age,
    u.age_group,
    u.generation,
    u.state,
    u.country,
    u.region,
    u.is_domestic,
    u.acquisition_channel,
    
    -- Return analysis
    case when oi.is_returned then oi.sale_price else 0 end as returned_value,
    case when oi.is_returned then (oi.sale_price - p.cost) else 0 end as returned_profit_impact  -- Fixed this line

from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items` as oi
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_products` as p
    on oi.product_id = p.product_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_orders` as o
    on oi.order_id = o.order_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_users` as u
    on oi.user_id = u.user_id
where not oi.has_invalid_price
  and not oi.has_missing_product
  and not p.has_invalid_cost
  and not p.has_negative_margin
  and not o.has_missing_user
), order_aggregates as (
    select
        user_id,
        
        -- Order counts by status
        count(*) as total_orders,
        count(case when order_status = 'Complete' then 1 end) as completed_orders,
        count(case when order_status = 'Cancelled' then 1 end) as cancelled_orders,
        count(case when order_status = 'Returned' then 1 end) as returned_orders,
        count(case when is_returned then 1 end) as orders_with_returns,
        
        -- Financial metrics
        sum(line_total) as lifetime_value,
        sum(case when not is_returned then line_total else 0 end) as net_lifetime_value,
        sum(item_gross_profit) as lifetime_gross_profit,
        sum(returned_value) as total_returned_value,
        avg(line_total) as avg_item_value,
        
        -- Order characteristics
        avg(delivery_days) as avg_delivery_days,
        sum(case when delivery_days <= 3 then 1 else 0 end) as fast_deliveries,
        
        -- Product preferences
        count(distinct product_id) as unique_products_purchased,
        count(distinct category) as unique_categories_purchased,
        count(distinct brand) as unique_brands_purchased,
        count(distinct department) as unique_departments_purchased,
        
        -- Timing patterns
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        count(distinct date(order_date)) as unique_order_days,
        
        -- Channel and behavior
        count(case when is_weekend then 1 end) as weekend_orders,
        count(case when order_time_of_day = 'Evening' then 1 end) as evening_orders,
        
        -- Product tier preferences
        count(case when price_category = 'Luxury' then 1 end) as luxury_items,
        count(case when price_category = 'Premium' then 1 end) as premium_items,
        count(case when price_category = 'Budget' then 1 end) as budget_items,
        
        -- Brand preferences
        count(case when brand_tier = 'Premium' then 1 end) as premium_brand_items,
        
 
        -- Top category (most frequent)
        array_agg(category_group order by category_group limit 1)[offset(0)] as preferred_category,

        -- Top brand (most frequent)  
        array_agg(brand order by brand limit 1)[offset(0)] as preferred_brand


    from __dbt__cte__int_order_items_enriched
    where order_complete
    group by user_id
)

select
    *,
    
    -- Derived metrics
    date_diff(current_date(), date(last_order_date), day) as days_since_last_order,
    date_diff(last_order_date, first_order_date, day) as customer_tenure_days,
    
    -- Frequency calculations
    case when customer_tenure_days > 0 then
        round(total_orders * 365.0 / customer_tenure_days, 2)
        else 0 end as orders_per_year,
        
    case when customer_tenure_days > 30 then
        round(total_orders * 30.0 / customer_tenure_days, 2)
        else total_orders end as orders_per_month,
    
    -- Value calculations
    case when completed_orders > 0 then
        round(lifetime_value / completed_orders, 2)
        else 0 end as avg_order_value,
        
    case when lifetime_value > 0 then
        round(lifetime_gross_profit / lifetime_value * 100, 2)
        else 0 end as avg_margin_pct,
    
    -- Behavioral patterns
    case when total_orders > 0 then
        round(orders_with_returns * 100.0 / total_orders, 2)
        else 0 end as return_rate,
        
    case when total_orders > 0 then
        round(weekend_orders * 100.0 / total_orders, 2)
        else 0 end as weekend_order_pct,
        
    case when completed_orders > 0 then
        round(fast_deliveries * 100.0 / completed_orders, 2)
        else 0 end as fast_delivery_pct,
    
    -- Product diversity
    case when total_orders > 0 then
        round(unique_products_purchased * 1.0 / total_orders, 2)
        else 0 end as product_diversity_score,
    
    -- Premium propensity
    case when total_orders > 0 then
        round((luxury_items + premium_items) * 100.0 / total_orders, 2)
        else 0 end as premium_propensity_pct

from order_aggregates;


[0m00:16:53.020628 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:16:53.754555 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:9daf0eba-eabf-446a-8752-81e08fcca200&page=queryresults
[0m00:16:53.933264 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:9daf0eba-eabf-446a-8752-81e08fcca200&page=queryresults
[0m00:16:53.983194 [debug] [Thread-1  ]: Database Error in model int_user_order_history (models/intermediate/int_user_order_history.sql)
  Unrecognized name: customer_tenure_days at [160:15]
  compiled code at target/run/digital_marketing/models/intermediate/int_user_order_history.sql
[0m00:16:53.983716 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc4c285-a209-4dd2-b5bf-07241d3138f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143230f10>]}
[0m00:16:53.984210 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model dbt_dev_analytics.int_user_order_history .. [[31mERROR[0m in 1.01s]
[0m00:16:53.984638 [debug] [Thread-1  ]: Finished running node model.digital_marketing.int_user_order_history
[0m00:16:53.985000 [debug] [Thread-4  ]: Marking all children of 'model.digital_marketing.int_user_order_history' to be skipped because of status 'error'.  Reason: Database Error in model int_user_order_history (models/intermediate/int_user_order_history.sql)
  Unrecognized name: customer_tenure_days at [160:15]
  compiled code at target/run/digital_marketing/models/intermediate/int_user_order_history.sql.
[0m00:16:53.985684 [info ] [MainThread]: 
[0m00:16:53.989811 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m00:16:53.990321 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m00:16:53.990787 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m00:16:53.991155 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m00:16:54.013289 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m00:16:54.024271 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m00:16:54.028741 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m00:16:54.039675 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m00:16:54.041125 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m00:16:54.041471 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.05s]
[0m00:16:54.041725 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:16:54.107557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:54.107875 [debug] [MainThread]: Connection 'model.digital_marketing.int_user_order_history' was properly closed.
[0m00:16:54.108155 [info ] [MainThread]: 
[0m00:16:54.108397 [info ] [MainThread]: Finished running 5 project hooks, 2 view models in 0 hours 0 minutes and 5.49 seconds (5.49s).
[0m00:16:54.109251 [debug] [MainThread]: Command end result
[0m00:16:54.171253 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m00:16:54.172733 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m00:16:54.177120 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m00:16:54.177350 [info ] [MainThread]: 
[0m00:16:54.177604 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:16:54.177832 [info ] [MainThread]: 
[0m00:16:54.178091 [error] [MainThread]: [31mFailure in model int_user_order_history (models/intermediate/int_user_order_history.sql)[0m
[0m00:16:54.178341 [error] [MainThread]:   Database Error in model int_user_order_history (models/intermediate/int_user_order_history.sql)
  Unrecognized name: customer_tenure_days at [160:15]
  compiled code at target/run/digital_marketing/models/intermediate/int_user_order_history.sql
[0m00:16:54.178544 [info ] [MainThread]: 
[0m00:16:54.178794 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/intermediate/int_user_order_history.sql
[0m00:16:54.178998 [info ] [MainThread]: 
[0m00:16:54.179225 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m00:16:54.182325 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.991781, "process_in_blocks": "0", "process_kernel_time": 0.572774, "process_mem_max_rss": "393117696", "process_out_blocks": "0", "process_user_time": 4.297865}
[0m00:16:54.182700 [debug] [MainThread]: Command `dbt run` failed at 00:16:54.182648 after 8.99 seconds
[0m00:16:54.182961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105723dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142eb3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142eb3f70>]}
[0m00:16:54.183225 [debug] [MainThread]: Flushing usage events
[0m00:16:54.573776 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:04:18.687744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d3bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10420b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10420b4f0>]}


============================== 16:04:18.691770 | 8d5a32c4-9b57-492a-9907-964108bd302f ==============================
[0m16:04:18.691770 [info ] [MainThread]: Running with dbt=1.10.10
[0m16:04:18.692211 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'log_cache_events': 'False', 'quiet': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'version_check': 'True', 'invocation_command': 'dbt run --select tag:intermediate', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'no_print': 'None', 'target_path': 'None', 'empty': 'False', 'static_parser': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_colors': 'True', 'printer_width': '80', 'introspect': 'True'}
[0m16:04:21.085014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d5a32c4-9b57-492a-9907-964108bd302f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10424be50>]}
[0m16:04:21.124189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d5a32c4-9b57-492a-9907-964108bd302f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12629d3a0>]}
[0m16:04:21.124680 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:04:21.323515 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m16:04:21.673791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:04:21.674436 [debug] [MainThread]: Partial parsing: updated file: digital_marketing://models/intermediate/int_user_order_history.sql
[0m16:04:21.925139 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.intermediate
- models.thelook_analytics.staging
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.marts.core
- models.thelook_analytics.marts.finance
- models.thelook_analytics.reports
- seeds.thelook_analytics.customer_segments
- seeds.thelook_analytics.product_categories
- snapshots.thelook_analytics
[0m16:04:21.939958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d5a32c4-9b57-492a-9907-964108bd302f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127e95130>]}
[0m16:04:22.079588 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:04:22.081246 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:04:22.101547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d5a32c4-9b57-492a-9907-964108bd302f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1273a13d0>]}
[0m16:04:22.101945 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 41 data tests, 6 sources, 1492 macros
[0m16:04:22.102197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d5a32c4-9b57-492a-9907-964108bd302f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127e96250>]}
[0m16:04:22.103447 [info ] [MainThread]: 
[0m16:04:22.103701 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:04:22.103912 [info ] [MainThread]: 
[0m16:04:22.104250 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:04:22.107012 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m16:04:22.107258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:22.797305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now list_data-products-441119_snapshot)
[0m16:04:22.798292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:23.402537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_snapshot, now list_data-products-441119_dbt_dev_analytics)
[0m16:04:23.403708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:23.974021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d5a32c4-9b57-492a-9907-964108bd302f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10427e820>]}
[0m16:04:23.988915 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 23:04:18 ===
[0m16:04:23.989333 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m16:04:23.991467 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m16:04:23.992010 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.02s]
[0m16:04:23.997926 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m16:04:23.999064 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m16:04:23.999599 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m16:04:23.999926 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:04:24.766229 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:41ec0bbd-2028-4426-b69c-d3fdcd2ddd48&page=queryresults
[0m16:04:25.380336 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.39s]
[0m16:04:25.430226 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m16:04:25.432401 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m16:04:25.432952 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.05s]
[0m16:04:25.433320 [info ] [MainThread]: 
[0m16:04:25.438638 [debug] [Thread-1  ]: Began running node model.digital_marketing.int_order_items_enriched
[0m16:04:25.439324 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev_analytics, now model.digital_marketing.int_order_items_enriched)
[0m16:04:25.439726 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.int_order_items_enriched
[0m16:04:25.447069 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.int_order_items_enriched"
[0m16:04:25.447911 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:04:25.519343 [debug] [Thread-1  ]: Finished running node model.digital_marketing.int_order_items_enriched
[0m16:04:25.519878 [debug] [Thread-1  ]: Began running node model.digital_marketing.int_product_metrics
[0m16:04:25.520217 [info ] [Thread-1  ]: 1 of 2 START sql view model dbt_dev_analytics.int_product_metrics .............. [RUN]
[0m16:04:25.520570 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.int_order_items_enriched, now model.digital_marketing.int_product_metrics)
[0m16:04:25.520869 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.int_product_metrics
[0m16:04:25.544979 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.int_product_metrics"
[0m16:04:25.546040 [debug] [Thread-1  ]: Began executing node model.digital_marketing.int_product_metrics
[0m16:04:25.656336 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.int_product_metrics"
[0m16:04:25.657164 [debug] [Thread-1  ]: On model.digital_marketing.int_product_metrics: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.int_product_metrics"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`int_product_metrics`
  OPTIONS()
  as 

with  __dbt__cte__int_order_items_enriched as (


select
    oi.order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    oi.inventory_item_id,
    oi.quantity,
    oi.sale_price as unit_price,
    oi.line_total,
    oi.discount_amount,
    oi.is_returned,
    oi.is_shipped,
    oi.is_delivered,
    oi.order_item_date,
    
    -- Product enrichment
    p.product_name,
    p.category,
    p.category_group,
    p.brand,
    p.brand_tier,
    p.department,
    p.cost as product_cost,
    p.retail_price,
    p.margin_amount as product_margin,
    p.margin_percentage as product_margin_pct,
    p.margin_tier,
    p.price_category,
    
    -- Profitability calculations
    oi.sale_price - p.cost as item_gross_profit,
    case when oi.sale_price > 0 then
        round((oi.sale_price - p.cost) / oi.sale_price * 100, 2)
        else 0 end as item_gross_margin_pct,
    
    -- Price analysis
    oi.sale_price - p.retail_price as price_variance,
    case when p.retail_price > 0 then
        round((oi.sale_price - p.retail_price) / p.retail_price * 100, 2)
        else 0 end as price_variance_pct,
        
    case
        when oi.sale_price > p.retail_price * 1.05 then 'Premium Pricing'
        when oi.sale_price < p.retail_price * 0.95 then 'Discount Pricing'
        else 'Standard Pricing'
    end as pricing_strategy,
    
    -- Order context
    o.order_date,
    o.order_status,
    o.order_time_of_day,
    o.order_day_name,
    o.is_weekend,
    o.customer_gender,
    o.delivery_days,
    o.is_complete as order_complete,
    
    -- User context
    u.age,
    u.age_group,
    u.generation,
    u.state,
    u.country,
    u.region,
    u.is_domestic,
    u.acquisition_channel,
    
    -- Return analysis
    case when oi.is_returned then oi.sale_price else 0 end as returned_value,
    case when oi.is_returned then (oi.sale_price - p.cost) else 0 end as returned_profit_impact  -- Fixed this line

from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items` as oi
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_products` as p
    on oi.product_id = p.product_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_orders` as o
    on oi.order_id = o.order_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_users` as u
    on oi.user_id = u.user_id
where not oi.has_invalid_price
  and not oi.has_missing_product
  and not p.has_invalid_cost
  and not p.has_negative_margin
  and not o.has_missing_user
), product_sales as (
    select
        product_id,
        
        -- Sales volume
        count(*) as total_units_sold,
        count(distinct order_id) as total_orders,
        count(distinct user_id) as unique_customers,
        
        -- Revenue metrics
        sum(line_total) as total_revenue,
        sum(item_gross_profit) as total_gross_profit,
        avg(unit_price) as avg_selling_price,
        avg(item_gross_margin_pct) as avg_gross_margin_pct,
        
        -- Return analysis
        count(case when is_returned then 1 end) as units_returned,
        sum(returned_value) as total_returned_revenue,
        
        -- Timing
        min(order_date) as first_sale_date,
        max(order_date) as last_sale_date,
        count(distinct date(order_date)) as active_sales_days,
        
        -- Customer segments
        count(case when age_group = '25-34' then 1 end) as sales_to_millennials,
        count(case when age_group = '35-44' then 1 end) as sales_to_gen_x,
        count(case when is_domestic then 1 end) as domestic_sales,
        
        -- Geographic distribution
        count(distinct state) as states_sold_in,
        count(distinct region) as regions_sold_in,
        
        -- Seasonal patterns
        count(case when extract(quarter from order_date) = 1 then 1 end) as q1_sales,
        count(case when extract(quarter from order_date) = 2 then 1 end) as q2_sales,
        count(case when extract(quarter from order_date) = 3 then 1 end) as q3_sales,
        count(case when extract(quarter from order_date) = 4 then 1 end) as q4_sales,
        
        -- Recent performance (last 90 days)
        sum(case when date(order_date) >= date_sub(current_date(), interval 90 day) 
            then line_total else 0 end) as revenue_90d,
        count(case when date(order_date) >= date_sub(current_date(), interval 90 day) 
            then 1 end) as units_sold_90d

    from __dbt__cte__int_order_items_enriched
    where order_complete
    group by product_id
)

select
    *,
    
    -- Performance calculations
    case when total_units_sold > 0 then
        round(units_returned * 100.0 / total_units_sold, 2)
        else 0 end as return_rate,
        
    case when total_orders > 0 then
        round(total_units_sold * 1.0 / total_orders, 2)
        else 0 end as avg_units_per_order,
        
    case when unique_customers > 0 then
        round(total_revenue / unique_customers, 2)
        else 0 end as revenue_per_customer,
    
    -- Geographic reach
    states_sold_in + regions_sold_in as geographic_reach_score,
    
    -- Seasonality index (Q4 typically highest for retail)
    case when (q1_sales + q2_sales + q3_sales + q4_sales) > 0 then
        round(q4_sales * 4.0 / (q1_sales + q2_sales + q3_sales + q4_sales), 2)
        else 0 end as q4_seasonality_index,
    
    -- Performance status
    case 
        when revenue_90d > 5000 then 'Hot'
        when revenue_90d > 1000 then 'Warm'
        when revenue_90d > 100 then 'Cool'
        when revenue_90d > 0 then 'Cold'
        else 'No Recent Sales'
    end as recent_performance_status,
    
    -- Customer concentration
    case when total_orders > 0 then
        round(unique_customers * 100.0 / total_orders, 2)
        else 0 end as customer_diversity_pct

from product_sales;


[0m16:04:25.657620 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:04:26.606064 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:d16ddb67-ae12-4887-b8e4-a13e3b69f649&page=queryresults
[0m16:04:27.230745 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d5a32c4-9b57-492a-9907-964108bd302f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c32be0>]}
[0m16:04:27.231693 [info ] [Thread-1  ]: 1 of 2 OK created sql view model dbt_dev_analytics.int_product_metrics ......... [[32mCREATE VIEW (0 processed)[0m in 1.71s]
[0m16:04:27.232383 [debug] [Thread-1  ]: Finished running node model.digital_marketing.int_product_metrics
[0m16:04:27.232869 [debug] [Thread-1  ]: Began running node model.digital_marketing.int_user_order_history
[0m16:04:27.233499 [info ] [Thread-1  ]: 2 of 2 START sql view model dbt_dev_analytics.int_user_order_history ........... [RUN]
[0m16:04:27.234101 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.int_product_metrics, now model.digital_marketing.int_user_order_history)
[0m16:04:27.234576 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.int_user_order_history
[0m16:04:27.275751 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.int_user_order_history"
[0m16:04:27.276638 [debug] [Thread-1  ]: Began executing node model.digital_marketing.int_user_order_history
[0m16:04:27.280647 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.int_user_order_history"
[0m16:04:27.281610 [debug] [Thread-1  ]: On model.digital_marketing.int_user_order_history: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.int_user_order_history"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`int_user_order_history`
  OPTIONS()
  as 

with  __dbt__cte__int_order_items_enriched as (


select
    oi.order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    oi.inventory_item_id,
    oi.quantity,
    oi.sale_price as unit_price,
    oi.line_total,
    oi.discount_amount,
    oi.is_returned,
    oi.is_shipped,
    oi.is_delivered,
    oi.order_item_date,
    
    -- Product enrichment
    p.product_name,
    p.category,
    p.category_group,
    p.brand,
    p.brand_tier,
    p.department,
    p.cost as product_cost,
    p.retail_price,
    p.margin_amount as product_margin,
    p.margin_percentage as product_margin_pct,
    p.margin_tier,
    p.price_category,
    
    -- Profitability calculations
    oi.sale_price - p.cost as item_gross_profit,
    case when oi.sale_price > 0 then
        round((oi.sale_price - p.cost) / oi.sale_price * 100, 2)
        else 0 end as item_gross_margin_pct,
    
    -- Price analysis
    oi.sale_price - p.retail_price as price_variance,
    case when p.retail_price > 0 then
        round((oi.sale_price - p.retail_price) / p.retail_price * 100, 2)
        else 0 end as price_variance_pct,
        
    case
        when oi.sale_price > p.retail_price * 1.05 then 'Premium Pricing'
        when oi.sale_price < p.retail_price * 0.95 then 'Discount Pricing'
        else 'Standard Pricing'
    end as pricing_strategy,
    
    -- Order context
    o.order_date,
    o.order_status,
    o.order_time_of_day,
    o.order_day_name,
    o.is_weekend,
    o.customer_gender,
    o.delivery_days,
    o.is_complete as order_complete,
    
    -- User context
    u.age,
    u.age_group,
    u.generation,
    u.state,
    u.country,
    u.region,
    u.is_domestic,
    u.acquisition_channel,
    
    -- Return analysis
    case when oi.is_returned then oi.sale_price else 0 end as returned_value,
    case when oi.is_returned then (oi.sale_price - p.cost) else 0 end as returned_profit_impact  -- Fixed this line

from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items` as oi
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_products` as p
    on oi.product_id = p.product_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_orders` as o
    on oi.order_id = o.order_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_users` as u
    on oi.user_id = u.user_id
where not oi.has_invalid_price
  and not oi.has_missing_product
  and not p.has_invalid_cost
  and not p.has_negative_margin
  and not o.has_missing_user
), order_aggregates as (
    select
        user_id,
        
        -- Order counts by status
        count(*) as total_orders,
        count(case when order_status = 'Complete' then 1 end) as completed_orders,
        count(case when order_status = 'Cancelled' then 1 end) as cancelled_orders,
        count(case when order_status = 'Returned' then 1 end) as returned_orders,
        count(case when is_returned then 1 end) as orders_with_returns,
        
        -- Financial metrics
        sum(line_total) as lifetime_value,
        sum(case when not is_returned then line_total else 0 end) as net_lifetime_value,
        sum(item_gross_profit) as lifetime_gross_profit,
        sum(returned_value) as total_returned_value,
        avg(line_total) as avg_item_value,
        
        -- Order characteristics
        avg(delivery_days) as avg_delivery_days,
        sum(case when delivery_days <= 3 then 1 else 0 end) as fast_deliveries,
        
        -- Product preferences
        count(distinct product_id) as unique_products_purchased,
        count(distinct category) as unique_categories_purchased,
        count(distinct brand) as unique_brands_purchased,
        count(distinct department) as unique_departments_purchased,
        
        -- Timing patterns
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        count(distinct date(order_date)) as unique_order_days,
        
        -- Channel and behavior
        count(case when is_weekend then 1 end) as weekend_orders,
        count(case when order_time_of_day = 'Evening' then 1 end) as evening_orders,
        
        -- Product tier preferences
        count(case when price_category = 'Luxury' then 1 end) as luxury_items,
        count(case when price_category = 'Premium' then 1 end) as premium_items,
        count(case when price_category = 'Budget' then 1 end) as budget_items,
        
        -- Brand preferences
        count(case when brand_tier = 'Premium' then 1 end) as premium_brand_items,
        
 
        -- Top category (most frequent)
        array_agg(category_group order by category_group limit 1)[offset(0)] as preferred_category,

        -- Top brand (most frequent)  
        array_agg(brand order by brand limit 1)[offset(0)] as preferred_brand


    from __dbt__cte__int_order_items_enriched
    where order_complete
    group by user_id
)

select
    *,
    
    -- Derived metrics
    date_diff(current_date(), date(last_order_date), day) as days_since_last_order,
    date_diff(last_order_date, first_order_date, day) as customer_tenure_days,
  
   -- Frequency calculations
    case when date_diff(last_order_date, first_order_date, day) > 0 then
        round(total_orders * 365.0 / date_diff(last_order_date, first_order_date, day), 2)
        else 0 end as orders_per_year,
        
    case when date_diff(last_order_date, first_order_date, day) > 30 then
        round(total_orders * 30.0 / date_diff(last_order_date, first_order_date, day), 2)
        else total_orders end as orders_per_month,
    
    -- Value calculations
    case when completed_orders > 0 then
        round(lifetime_value / completed_orders, 2)
        else 0 end as avg_order_value,
        
    case when lifetime_value > 0 then
        round(lifetime_gross_profit / lifetime_value * 100, 2)
        else 0 end as avg_margin_pct,
    
    -- Behavioral patterns
    case when total_orders > 0 then
        round(orders_with_returns * 100.0 / total_orders, 2)
        else 0 end as return_rate,
        
    case when total_orders > 0 then
        round(weekend_orders * 100.0 / total_orders, 2)
        else 0 end as weekend_order_pct,
        
    case when completed_orders > 0 then
        round(fast_deliveries * 100.0 / completed_orders, 2)
        else 0 end as fast_delivery_pct,
    
    -- Product diversity
    case when total_orders > 0 then
        round(unique_products_purchased * 1.0 / total_orders, 2)
        else 0 end as product_diversity_score,
    
    -- Premium propensity
    case when total_orders > 0 then
        round((luxury_items + premium_items) * 100.0 / total_orders, 2)
        else 0 end as premium_propensity_pct

from order_aggregates;


[0m16:04:27.282152 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:04:28.147623 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:08e76d8c-2c28-45f5-b60c-4c6cfdd321d3&page=queryresults
[0m16:04:28.534975 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d5a32c4-9b57-492a-9907-964108bd302f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c32be0>]}
[0m16:04:28.535746 [info ] [Thread-1  ]: 2 of 2 OK created sql view model dbt_dev_analytics.int_user_order_history ...... [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m16:04:28.536351 [debug] [Thread-1  ]: Finished running node model.digital_marketing.int_user_order_history
[0m16:04:28.537216 [info ] [MainThread]: 
[0m16:04:28.542563 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m16:04:28.543170 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m16:04:28.543705 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m16:04:28.544169 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m16:04:28.569638 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m16:04:28.580870 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m16:04:28.585566 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m16:04:28.596900 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m16:04:28.598310 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m16:04:28.598634 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.05s]
[0m16:04:28.598883 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:04:28.664832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:28.665162 [debug] [MainThread]: Connection 'model.digital_marketing.int_user_order_history' was properly closed.
[0m16:04:28.665452 [info ] [MainThread]: 
[0m16:04:28.665693 [info ] [MainThread]: Finished running 5 project hooks, 2 view models in 0 hours 0 minutes and 6.56 seconds (6.56s).
[0m16:04:28.666630 [debug] [MainThread]: Command end result
[0m16:04:28.730192 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:04:28.731704 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:04:28.736123 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m16:04:28.736353 [info ] [MainThread]: 
[0m16:04:28.736619 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:04:28.736840 [info ] [MainThread]: 
[0m16:04:28.737070 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m16:04:28.748479 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.114918, "process_in_blocks": "0", "process_kernel_time": 0.562462, "process_mem_max_rss": "393641984", "process_out_blocks": "0", "process_user_time": 4.319474}
[0m16:04:28.748920 [debug] [MainThread]: Command `dbt run` succeeded at 16:04:28.748862 after 10.12 seconds
[0m16:04:28.749219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d3bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1273a10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1266ef850>]}
[0m16:04:28.749511 [debug] [MainThread]: Flushing usage events
[0m16:04:29.078631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:06:36.215722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ebe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085bc220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085bc4f0>]}


============================== 16:06:36.219642 | 5e214ed4-8ebd-44ca-bc59-d8acfab8e201 ==============================
[0m16:06:36.219642 [info ] [MainThread]: Running with dbt=1.10.10
[0m16:06:36.220032 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/azadsolanki/.dbt', 'target_path': 'None', 'no_print': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_format': 'default', 'printer_width': '80', 'write_json': 'True', 'use_colors': 'True', 'static_parser': 'True', 'warn_error': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select tag:marts', 'debug': 'False'}
[0m16:06:38.052797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e214ed4-8ebd-44ca-bc59-d8acfab8e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085477f0>]}
[0m16:06:38.089978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e214ed4-8ebd-44ca-bc59-d8acfab8e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797c700>]}
[0m16:06:38.090372 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:06:38.282938 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m16:06:38.627207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:06:38.627542 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:06:38.633661 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.intermediate
- models.thelook_analytics.marts.finance
- models.thelook_analytics.marts.core
- models.thelook_analytics.reports
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.staging
- seeds.thelook_analytics.customer_segments
- seeds.thelook_analytics.product_categories
- snapshots.thelook_analytics
[0m16:06:38.695768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e214ed4-8ebd-44ca-bc59-d8acfab8e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1433eb130>]}
[0m16:06:38.834781 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:06:38.836974 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:06:38.855805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e214ed4-8ebd-44ca-bc59-d8acfab8e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142c78340>]}
[0m16:06:38.856198 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 41 data tests, 6 sources, 1492 macros
[0m16:06:38.856448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e214ed4-8ebd-44ca-bc59-d8acfab8e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1433e7610>]}
[0m16:06:38.857650 [info ] [MainThread]: 
[0m16:06:38.857902 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:06:38.858113 [info ] [MainThread]: 
[0m16:06:38.858442 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:06:38.861239 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m16:06:38.861509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:39.471912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now list_data-products-441119_snapshot)
[0m16:06:39.472984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:40.044775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_snapshot, now list_data-products-441119_dbt_dev_analytics)
[0m16:06:40.046336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:40.573744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e214ed4-8ebd-44ca-bc59-d8acfab8e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142e26fd0>]}
[0m16:06:40.595440 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 23:06:36 ===
[0m16:06:40.596088 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m16:06:40.599925 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m16:06:40.600612 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m16:06:40.606953 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m16:06:40.608055 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m16:06:40.608590 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m16:06:40.609073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:06:41.270136 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:9e45a814-e2ee-41a0-8a3b-595990f05b77&page=queryresults
[0m16:06:41.983637 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.38s]
[0m16:06:42.033877 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m16:06:42.036049 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m16:06:42.036603 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.05s]
[0m16:06:42.036966 [info ] [MainThread]: 
[0m16:06:42.042652 [debug] [Thread-1  ]: Began running node model.digital_marketing.dim_users
[0m16:06:42.043258 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt_dev_analytics.dim_users ........................ [RUN]
[0m16:06:42.043900 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.digital_marketing.dim_users'
[0m16:06:42.044259 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.dim_users
[0m16:06:42.051220 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.dim_users"
[0m16:06:42.052027 [debug] [Thread-1  ]: Began executing node model.digital_marketing.dim_users
[0m16:06:42.077376 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.dim_users"
[0m16:06:42.078341 [debug] [Thread-1  ]: On model.digital_marketing.dim_users: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.dim_users"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`dim_users`
  OPTIONS()
  as 

select
    u.user_id,
    u.first_name,
    u.last_name,
    u.full_name,
    u.email,
    u.age,
    u.age_group,
    u.generation,
    u.gender,
    u.state,
    u.country,
    u.region,
    u.is_domestic,
    u.latitude,
    u.longitude,
    u.traffic_source,
    u.acquisition_channel,
    u.registration_date,
    
    -- Order history metrics
    coalesce(oh.total_orders, 0) as total_orders,
    coalesce(oh.completed_orders, 0) as completed_orders,
    coalesce(oh.cancelled_orders, 0) as cancelled_orders,
    coalesce(oh.lifetime_value, 0) as lifetime_value,
    coalesce(oh.net_lifetime_value, 0) as net_lifetime_value,
    coalesce(oh.lifetime_gross_profit, 0) as lifetime_gross_profit,
    coalesce(oh.avg_order_value, 0) as avg_order_value,
    coalesce(oh.avg_item_value, 0) as avg_item_value,
    
    -- Timing metrics
    oh.first_order_date,
    oh.last_order_date,
    coalesce(oh.days_since_last_order, 999999) as days_since_last_order,
    coalesce(oh.customer_tenure_days, 0) as customer_tenure_days,
    coalesce(oh.orders_per_month, 0) as orders_per_month,
    coalesce(oh.orders_per_year, 0) as orders_per_year,
    
    -- Product preferences
    coalesce(oh.unique_products_purchased, 0) as unique_products_purchased,
    coalesce(oh.unique_categories_purchased, 0) as unique_categories_purchased,
    coalesce(oh.unique_brands_purchased, 0) as unique_brands_purchased,
    oh.preferred_category,
    oh.preferred_brand,
    coalesce(oh.product_diversity_score, 0) as product_diversity_score,
    
    -- Behavioral patterns
    coalesce(oh.return_rate, 0) as return_rate,
    coalesce(oh.weekend_order_pct, 0) as weekend_order_pct,
    coalesce(oh.premium_propensity_pct, 0) as premium_propensity_pct,
    coalesce(oh.avg_delivery_days, 0) as avg_delivery_days,
    coalesce(oh.fast_delivery_pct, 0) as fast_delivery_pct,
    
    -- Customer segmentation
    case 
        when oh.lifetime_value >= 1000 then 'VIP'
        when oh.completed_orders >= 5 then 'Loyal'
        when oh.completed_orders >= 2 then 'Regular'
        when oh.completed_orders = 1 then 'New'
        else 'Prospect'
    end as value_segment,
    
    case 
        when oh.days_since_last_order <= 90 then 'Active'
        when oh.days_since_last_order <= 180 then 'At Risk'
        when oh.days_since_last_order <= 365 then 'Dormant'
        when oh.days_since_last_order < 999999 then 'Churned'
        else 'Prospect'
    end as activity_segment,
    
    case
        when oh.orders_per_month >= 2 then 'High Frequency'
        when oh.orders_per_month >= 0.5 then 'Medium Frequency'
        when oh.orders_per_month > 0 then 'Low Frequency'
        else 'One-time'
    end as frequency_segment,
    
    -- RFM Score Components
    case 
        when oh.days_since_last_order <= 30 then 5
        when oh.days_since_last_order <= 90 then 4
        when oh.days_since_last_order <= 180 then 3
        when oh.days_since_last_order <= 365 then 2
        else 1
    end as recency_score,
    
    case 
        when oh.completed_orders >= 10 then 5
        when oh.completed_orders >= 5 then 4
        when oh.completed_orders >= 3 then 3
        when oh.completed_orders >= 2 then 2
        else 1
    end as frequency_score,
    
    case 
        when oh.lifetime_value >= 1000 then 5
        when oh.lifetime_value >= 500 then 4
        when oh.lifetime_value >= 200 then 3
        when oh.lifetime_value >= 100 then 2
        else 1
    end as monetary_score,
    
    current_timestamp() as dbt_updated_at

from `data-products-441119`.`dbt_dev_analytics`.`stg_users` as u
left join `data-products-441119`.`dbt_dev_analytics`.`int_user_order_history` as oh
    on u.user_id = oh.user_id
where not u.has_invalid_email
  and not u.has_invalid_age;


[0m16:06:42.078771 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:06:43.214297 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:6a3c980e-6b75-445a-9700-28758e63ebbe&page=queryresults
[0m16:06:43.654536 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e214ed4-8ebd-44ca-bc59-d8acfab8e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085650a0>]}
[0m16:06:43.655075 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt_dev_analytics.dim_users ................... [[32mCREATE VIEW (0 processed)[0m in 1.61s]
[0m16:06:43.655506 [debug] [Thread-1  ]: Finished running node model.digital_marketing.dim_users
[0m16:06:43.655810 [debug] [Thread-1  ]: Began running node model.digital_marketing.fct_orders
[0m16:06:43.656143 [info ] [Thread-1  ]: 2 of 3 START sql incremental model dbt_dev_analytics.fct_orders ................ [RUN]
[0m16:06:43.656516 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.dim_users, now model.digital_marketing.fct_orders)
[0m16:06:43.656839 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.fct_orders
[0m16:06:43.670450 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.fct_orders"
[0m16:06:43.707063 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.fct_orders"
[0m16:06:43.707654 [debug] [Thread-1  ]: Began executing node model.digital_marketing.fct_orders
[0m16:06:43.753047 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.fct_orders"
[0m16:06:43.753909 [debug] [Thread-1  ]: On model.digital_marketing.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.fct_orders"} */

  
    

    create or replace table `data-products-441119`.`dbt_dev_analytics`.`fct_orders`
      
    partition by timestamp_trunc(order_date, day)
    cluster by user_id, order_status

    
    OPTIONS()
    as (
      

with  __dbt__cte__int_order_items_enriched as (


select
    oi.order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    oi.inventory_item_id,
    oi.quantity,
    oi.sale_price as unit_price,
    oi.line_total,
    oi.discount_amount,
    oi.is_returned,
    oi.is_shipped,
    oi.is_delivered,
    oi.order_item_date,
    
    -- Product enrichment
    p.product_name,
    p.category,
    p.category_group,
    p.brand,
    p.brand_tier,
    p.department,
    p.cost as product_cost,
    p.retail_price,
    p.margin_amount as product_margin,
    p.margin_percentage as product_margin_pct,
    p.margin_tier,
    p.price_category,
    
    -- Profitability calculations
    oi.sale_price - p.cost as item_gross_profit,
    case when oi.sale_price > 0 then
        round((oi.sale_price - p.cost) / oi.sale_price * 100, 2)
        else 0 end as item_gross_margin_pct,
    
    -- Price analysis
    oi.sale_price - p.retail_price as price_variance,
    case when p.retail_price > 0 then
        round((oi.sale_price - p.retail_price) / p.retail_price * 100, 2)
        else 0 end as price_variance_pct,
        
    case
        when oi.sale_price > p.retail_price * 1.05 then 'Premium Pricing'
        when oi.sale_price < p.retail_price * 0.95 then 'Discount Pricing'
        else 'Standard Pricing'
    end as pricing_strategy,
    
    -- Order context
    o.order_date,
    o.order_status,
    o.order_time_of_day,
    o.order_day_name,
    o.is_weekend,
    o.customer_gender,
    o.delivery_days,
    o.is_complete as order_complete,
    
    -- User context
    u.age,
    u.age_group,
    u.generation,
    u.state,
    u.country,
    u.region,
    u.is_domestic,
    u.acquisition_channel,
    
    -- Return analysis
    case when oi.is_returned then oi.sale_price else 0 end as returned_value,
    case when oi.is_returned then (oi.sale_price - p.cost) else 0 end as returned_profit_impact  -- Fixed this line

from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items` as oi
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_products` as p
    on oi.product_id = p.product_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_orders` as o
    on oi.order_id = o.order_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_users` as u
    on oi.user_id = u.user_id
where not oi.has_invalid_price
  and not oi.has_missing_product
  and not p.has_invalid_cost
  and not p.has_negative_margin
  and not o.has_missing_user
), order_calculations as (
    select
        o.order_id,
        o.user_id,
        o.order_date,
        o.order_status,
        o.customer_gender,
        o.order_time_of_day,
        o.order_day_name,
        o.order_hour,
        o.order_month,
        o.order_quarter,
        o.order_year,
        o.is_weekend,
        o.item_count,
        o.is_returned as order_has_returns,
        o.is_delivered,
        o.is_complete,
        o.delivery_days,
        
        -- Financial aggregations from order items
        sum(oi.line_total) as order_total,
        sum(oi.item_gross_profit) as total_gross_profit,
        avg(oi.item_gross_margin_pct) as avg_gross_margin_pct,
        sum(case when oi.is_returned then oi.line_total else 0 end) as returned_amount,
        sum(case when not oi.is_returned then oi.line_total else 0 end) as net_order_total,
        
        -- Product mix analysis
        count(distinct oi.product_id) as unique_products,
        count(distinct oi.category) as unique_categories,
        count(distinct oi.brand) as unique_brands,
        count(*) as total_line_items,
        
        -- Price analysis
        avg(oi.unit_price) as avg_item_price,
        max(oi.unit_price) as max_item_price,
        min(oi.unit_price) as min_item_price,
        stddev(oi.unit_price) as price_stddev,
        
        -- Category mix
        count(case when oi.category_group = 'Apparel' then 1 end) as apparel_items,
        count(case when oi.category_group = 'Footwear' then 1 end) as footwear_items,
        count(case when oi.category_group = 'Accessories' then 1 end) as accessories_items,
        
        -- Price tier mix
        count(case when oi.price_category = 'Luxury' then 1 end) as luxury_items,
        count(case when oi.price_category = 'Premium' then 1 end) as premium_items,
        count(case when oi.price_category = 'Budget' then 1 end) as budget_items,
        
        -- Customer demographics from enriched data
        max(oi.age) as customer_age,
        max(oi.age_group) as customer_age_group,
        max(oi.generation) as customer_generation,
        max(oi.state) as customer_state,
        max(oi.country) as customer_country,
        max(oi.region) as customer_region,
        max(oi.is_domestic) as is_domestic_customer,
        max(oi.acquisition_channel) as customer_acquisition_channel

    from `data-products-441119`.`dbt_dev_analytics`.`stg_orders` as o
    inner join __dbt__cte__int_order_items_enriched as oi
        on o.order_id = oi.order_id
    where not o.has_missing_user
      and not o.has_invalid_item_count
      and not o.is_future_order
    
    
    
    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16
),

customer_sequence as (
    select
        *,
        
        -- Customer order sequence analysis
        row_number() over (
            partition by user_id 
            order by order_date
        ) as customer_order_number,
        
        -- Running customer metrics
        sum(order_total) over (
            partition by user_id 
            order by order_date 
            rows unbounded preceding
        ) as customer_running_total,
        
        count(*) over (
            partition by user_id 
            order by order_date 
            rows unbounded preceding
        ) as customer_running_orders,
        
        -- Inter-order timing
        lag(order_date) over (
            partition by user_id 
            order by order_date
        ) as previous_order_date,
        
        date_diff(
            order_date,
            lag(order_date) over (partition by user_id order by order_date),
            day
        ) as days_since_previous_order,
        
        -- Order value progression
        lag(order_total) over (
            partition by user_id 
            order by order_date
        ) as previous_order_value,
        
        -- Customer segment at time of order
        case 
            when sum(order_total) over (
                partition by user_id 
                order by order_date 
                rows unbounded preceding
            ) >= 1000 then 'VIP'
            when count(*) over (
                partition by user_id 
                order by order_date 
                rows unbounded preceding
            ) >= 5 then 'Loyal'
            when count(*) over (
                partition by user_id 
                order by order_date 
                rows unbounded preceding
            ) >= 2 then 'Regular'
            else 'New'
        end as customer_segment_at_order

    from order_calculations
)

select
    *,
    
    -- Order characteristics
    case when customer_order_number = 1 then true else false end as is_first_order,
    case when customer_order_number <= 3 then true else false end as is_early_order,
    
    -- Order size categorization
    case 
        when order_total >= 200 then 'Large'
        when order_total >= 100 then 'Medium'
        when order_total >= 50 then 'Small'
        else 'Micro'
    end as order_size_category,
    
    -- Product diversity metrics
    safe_divide(unique_products, total_line_items) as product_diversity_ratio,
    safe_divide(unique_categories, total_line_items) as category_diversity_ratio,
    
    -- Return analysis
    safe_divide(returned_amount, order_total) as return_rate_by_value,
    case when returned_amount > 0 then true else false end as has_returns,
    
    -- Value progression
    case 
        when previous_order_value is null then 'First Order'
        when order_total > previous_order_value * 1.2 then 'Increasing Value'
        when order_total < previous_order_value * 0.8 then 'Decreasing Value'
        else 'Stable Value'
    end as value_trend,
    
    -- Repurchase timing
    case 
        when days_since_previous_order is null then 'First Order'
        when days_since_previous_order <= 30 then 'Quick Repeat'
        when days_since_previous_order <= 90 then 'Regular Repeat'
        when days_since_previous_order <= 180 then 'Slow Repeat'
        else 'Long Gap'
    end as repurchase_timing,
    
    -- Seasonal indicators
    case 
        when order_month in (11, 12) then 'Holiday Season'
        when order_month in (6, 7, 8) then 'Summer'
        when order_month in (3, 4, 5) then 'Spring'
        else 'Regular Season'
    end as seasonal_period,
    
    current_timestamp() as dbt_updated_at

from customer_sequence
    );
  
[0m16:06:43.754431 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:06:44.647202 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:edbac2b0-edc1-446f-947f-6cd1654230bb&page=queryresults
[0m16:06:44.851728 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:edbac2b0-edc1-446f-947f-6cd1654230bb&page=queryresults
[0m16:06:44.917887 [debug] [Thread-1  ]: Database Error in model fct_orders (models/marts/fct_orders.sql)
  SELECT list expression references o.delivery_days which is neither grouped nor aggregated at [120:9]
  compiled code at target/run/digital_marketing/models/marts/fct_orders.sql
[0m16:06:44.918476 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e214ed4-8ebd-44ca-bc59-d8acfab8e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1447a0490>]}
[0m16:06:44.919066 [error] [Thread-1  ]: 2 of 3 ERROR creating sql incremental model dbt_dev_analytics.fct_orders ....... [[31mERROR[0m in 1.26s]
[0m16:06:44.919545 [debug] [Thread-1  ]: Finished running node model.digital_marketing.fct_orders
[0m16:06:44.919957 [debug] [Thread-4  ]: Marking all children of 'model.digital_marketing.fct_orders' to be skipped because of status 'error'.  Reason: Database Error in model fct_orders (models/marts/fct_orders.sql)
  SELECT list expression references o.delivery_days which is neither grouped nor aggregated at [120:9]
  compiled code at target/run/digital_marketing/models/marts/fct_orders.sql.
[0m16:06:44.920519 [debug] [Thread-1  ]: Began running node model.digital_marketing.fct_daily_revenue
[0m16:06:44.920940 [info ] [Thread-1  ]: 3 of 3 SKIP relation dbt_dev_analytics.fct_daily_revenue ....................... [[33mSKIP[0m]
[0m16:06:44.921324 [debug] [Thread-1  ]: Finished running node model.digital_marketing.fct_daily_revenue
[0m16:06:44.922031 [info ] [MainThread]: 
[0m16:06:44.926814 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m16:06:44.927202 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m16:06:44.927620 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m16:06:44.927980 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m16:06:44.950822 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m16:06:44.961869 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m16:06:44.966509 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m16:06:44.978395 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m16:06:44.979178 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m16:06:44.979530 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.05s]
[0m16:06:44.979788 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:06:45.047699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:45.048029 [debug] [MainThread]: Connection 'list_data-products-441119_dbt_dev_analytics' was properly closed.
[0m16:06:45.048236 [debug] [MainThread]: Connection 'model.digital_marketing.fct_orders' was properly closed.
[0m16:06:45.048510 [info ] [MainThread]: 
[0m16:06:45.048750 [info ] [MainThread]: Finished running 2 incremental models, 5 project hooks, 1 view model in 0 hours 0 minutes and 6.19 seconds (6.19s).
[0m16:06:45.049599 [debug] [MainThread]: Command end result
[0m16:06:45.114024 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:06:45.115420 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:06:45.119753 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m16:06:45.119995 [info ] [MainThread]: 
[0m16:06:45.120258 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:06:45.120490 [info ] [MainThread]: 
[0m16:06:45.120746 [error] [MainThread]: [31mFailure in model fct_orders (models/marts/fct_orders.sql)[0m
[0m16:06:45.121000 [error] [MainThread]:   Database Error in model fct_orders (models/marts/fct_orders.sql)
  SELECT list expression references o.delivery_days which is neither grouped nor aggregated at [120:9]
  compiled code at target/run/digital_marketing/models/marts/fct_orders.sql
[0m16:06:45.121213 [info ] [MainThread]: 
[0m16:06:45.121452 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/marts/fct_orders.sql
[0m16:06:45.121663 [info ] [MainThread]: 
[0m16:06:45.121887 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=8
[0m16:06:45.124452 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.956493, "process_in_blocks": "0", "process_kernel_time": 0.462889, "process_mem_max_rss": "384368640", "process_out_blocks": "0", "process_user_time": 3.907919}
[0m16:06:45.124801 [debug] [MainThread]: Command `dbt run` failed at 16:06:45.124752 after 8.96 seconds
[0m16:06:45.125053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ebe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085477f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142847220>]}
[0m16:06:45.125304 [debug] [MainThread]: Flushing usage events
[0m16:06:45.508332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:09:30.389333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107093d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108558970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108558c40>]}


============================== 16:09:30.393375 | 33f6be8d-0f4e-4a9c-96ca-ea52998bfa26 ==============================
[0m16:09:30.393375 [info ] [MainThread]: Running with dbt=1.10.10
[0m16:09:30.393777 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'target_path': 'None', 'partial_parse': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'printer_width': '80', 'introspect': 'True', 'no_print': 'None', 'debug': 'False', 'invocation_command': 'dbt run --select tag:marts', 'version_check': 'True', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'log_cache_events': 'False'}
[0m16:09:32.292682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33f6be8d-0f4e-4a9c-96ca-ea52998bfa26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5c3b20>]}
[0m16:09:32.329875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33f6be8d-0f4e-4a9c-96ca-ea52998bfa26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ade20>]}
[0m16:09:32.330280 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:09:32.523575 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m16:09:32.875643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:09:32.876302 [debug] [MainThread]: Partial parsing: updated file: digital_marketing://models/marts/fct_orders.sql
[0m16:09:33.190812 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.reports
- models.thelook_analytics.marts.finance
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.marts.core
- models.thelook_analytics.staging
- models.thelook_analytics.intermediate
- seeds.thelook_analytics.product_categories
- seeds.thelook_analytics.customer_segments
- snapshots.thelook_analytics
[0m16:09:33.205822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33f6be8d-0f4e-4a9c-96ca-ea52998bfa26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11de11130>]}
[0m16:09:33.346254 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:09:33.349125 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:09:33.368033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33f6be8d-0f4e-4a9c-96ca-ea52998bfa26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da88a60>]}
[0m16:09:33.368468 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 41 data tests, 6 sources, 1492 macros
[0m16:09:33.368722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33f6be8d-0f4e-4a9c-96ca-ea52998bfa26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11de0d550>]}
[0m16:09:33.369975 [info ] [MainThread]: 
[0m16:09:33.370233 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:09:33.370450 [info ] [MainThread]: 
[0m16:09:33.370790 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:09:33.373609 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m16:09:33.373903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:34.128243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now list_data-products-441119_dbt_dev_analytics)
[0m16:09:34.128843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:34.649493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev_analytics, now list_data-products-441119_snapshot)
[0m16:09:34.650496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:35.352405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33f6be8d-0f4e-4a9c-96ca-ea52998bfa26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ce9f1c0>]}
[0m16:09:35.376572 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 23:09:30 ===
[0m16:09:35.377271 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m16:09:35.381067 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m16:09:35.381933 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m16:09:35.389640 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m16:09:35.390792 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m16:09:35.391358 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m16:09:35.391864 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:36.064869 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:f9923a37-5888-40ae-af7a-2e19213af49e&page=queryresults
[0m16:09:36.613365 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.23s]
[0m16:09:36.663198 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m16:09:36.664570 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m16:09:36.665120 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.05s]
[0m16:09:36.665480 [info ] [MainThread]: 
[0m16:09:36.670538 [debug] [Thread-1  ]: Began running node model.digital_marketing.dim_users
[0m16:09:36.671277 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt_dev_analytics.dim_users ........................ [RUN]
[0m16:09:36.672031 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.digital_marketing.dim_users'
[0m16:09:36.672531 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.dim_users
[0m16:09:36.680343 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.dim_users"
[0m16:09:36.681104 [debug] [Thread-1  ]: Began executing node model.digital_marketing.dim_users
[0m16:09:36.706009 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.dim_users"
[0m16:09:36.706898 [debug] [Thread-1  ]: On model.digital_marketing.dim_users: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.dim_users"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`dim_users`
  OPTIONS()
  as 

select
    u.user_id,
    u.first_name,
    u.last_name,
    u.full_name,
    u.email,
    u.age,
    u.age_group,
    u.generation,
    u.gender,
    u.state,
    u.country,
    u.region,
    u.is_domestic,
    u.latitude,
    u.longitude,
    u.traffic_source,
    u.acquisition_channel,
    u.registration_date,
    
    -- Order history metrics
    coalesce(oh.total_orders, 0) as total_orders,
    coalesce(oh.completed_orders, 0) as completed_orders,
    coalesce(oh.cancelled_orders, 0) as cancelled_orders,
    coalesce(oh.lifetime_value, 0) as lifetime_value,
    coalesce(oh.net_lifetime_value, 0) as net_lifetime_value,
    coalesce(oh.lifetime_gross_profit, 0) as lifetime_gross_profit,
    coalesce(oh.avg_order_value, 0) as avg_order_value,
    coalesce(oh.avg_item_value, 0) as avg_item_value,
    
    -- Timing metrics
    oh.first_order_date,
    oh.last_order_date,
    coalesce(oh.days_since_last_order, 999999) as days_since_last_order,
    coalesce(oh.customer_tenure_days, 0) as customer_tenure_days,
    coalesce(oh.orders_per_month, 0) as orders_per_month,
    coalesce(oh.orders_per_year, 0) as orders_per_year,
    
    -- Product preferences
    coalesce(oh.unique_products_purchased, 0) as unique_products_purchased,
    coalesce(oh.unique_categories_purchased, 0) as unique_categories_purchased,
    coalesce(oh.unique_brands_purchased, 0) as unique_brands_purchased,
    oh.preferred_category,
    oh.preferred_brand,
    coalesce(oh.product_diversity_score, 0) as product_diversity_score,
    
    -- Behavioral patterns
    coalesce(oh.return_rate, 0) as return_rate,
    coalesce(oh.weekend_order_pct, 0) as weekend_order_pct,
    coalesce(oh.premium_propensity_pct, 0) as premium_propensity_pct,
    coalesce(oh.avg_delivery_days, 0) as avg_delivery_days,
    coalesce(oh.fast_delivery_pct, 0) as fast_delivery_pct,
    
    -- Customer segmentation
    case 
        when oh.lifetime_value >= 1000 then 'VIP'
        when oh.completed_orders >= 5 then 'Loyal'
        when oh.completed_orders >= 2 then 'Regular'
        when oh.completed_orders = 1 then 'New'
        else 'Prospect'
    end as value_segment,
    
    case 
        when oh.days_since_last_order <= 90 then 'Active'
        when oh.days_since_last_order <= 180 then 'At Risk'
        when oh.days_since_last_order <= 365 then 'Dormant'
        when oh.days_since_last_order < 999999 then 'Churned'
        else 'Prospect'
    end as activity_segment,
    
    case
        when oh.orders_per_month >= 2 then 'High Frequency'
        when oh.orders_per_month >= 0.5 then 'Medium Frequency'
        when oh.orders_per_month > 0 then 'Low Frequency'
        else 'One-time'
    end as frequency_segment,
    
    -- RFM Score Components
    case 
        when oh.days_since_last_order <= 30 then 5
        when oh.days_since_last_order <= 90 then 4
        when oh.days_since_last_order <= 180 then 3
        when oh.days_since_last_order <= 365 then 2
        else 1
    end as recency_score,
    
    case 
        when oh.completed_orders >= 10 then 5
        when oh.completed_orders >= 5 then 4
        when oh.completed_orders >= 3 then 3
        when oh.completed_orders >= 2 then 2
        else 1
    end as frequency_score,
    
    case 
        when oh.lifetime_value >= 1000 then 5
        when oh.lifetime_value >= 500 then 4
        when oh.lifetime_value >= 200 then 3
        when oh.lifetime_value >= 100 then 2
        else 1
    end as monetary_score,
    
    current_timestamp() as dbt_updated_at

from `data-products-441119`.`dbt_dev_analytics`.`stg_users` as u
left join `data-products-441119`.`dbt_dev_analytics`.`int_user_order_history` as oh
    on u.user_id = oh.user_id
where not u.has_invalid_email
  and not u.has_invalid_age;


[0m16:09:36.707337 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:09:37.806851 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:460538b9-0b70-4a32-8879-58b45fb1988e&page=queryresults
[0m16:09:38.188620 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33f6be8d-0f4e-4a9c-96ca-ea52998bfa26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d72dc40>]}
[0m16:09:38.189593 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt_dev_analytics.dim_users ................... [[32mCREATE VIEW (0 processed)[0m in 1.51s]
[0m16:09:38.190375 [debug] [Thread-1  ]: Finished running node model.digital_marketing.dim_users
[0m16:09:38.190926 [debug] [Thread-1  ]: Began running node model.digital_marketing.fct_orders
[0m16:09:38.191590 [info ] [Thread-1  ]: 2 of 3 START sql incremental model dbt_dev_analytics.fct_orders ................ [RUN]
[0m16:09:38.192215 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.dim_users, now model.digital_marketing.fct_orders)
[0m16:09:38.192734 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.fct_orders
[0m16:09:38.210924 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.fct_orders"
[0m16:09:38.256277 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.fct_orders"
[0m16:09:38.256893 [debug] [Thread-1  ]: Began executing node model.digital_marketing.fct_orders
[0m16:09:38.302421 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.fct_orders"
[0m16:09:38.303272 [debug] [Thread-1  ]: On model.digital_marketing.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.fct_orders"} */

  
    

    create or replace table `data-products-441119`.`dbt_dev_analytics`.`fct_orders`
      
    partition by timestamp_trunc(order_date, day)
    cluster by user_id, order_status

    
    OPTIONS()
    as (
      

with  __dbt__cte__int_order_items_enriched as (


select
    oi.order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    oi.inventory_item_id,
    oi.quantity,
    oi.sale_price as unit_price,
    oi.line_total,
    oi.discount_amount,
    oi.is_returned,
    oi.is_shipped,
    oi.is_delivered,
    oi.order_item_date,
    
    -- Product enrichment
    p.product_name,
    p.category,
    p.category_group,
    p.brand,
    p.brand_tier,
    p.department,
    p.cost as product_cost,
    p.retail_price,
    p.margin_amount as product_margin,
    p.margin_percentage as product_margin_pct,
    p.margin_tier,
    p.price_category,
    
    -- Profitability calculations
    oi.sale_price - p.cost as item_gross_profit,
    case when oi.sale_price > 0 then
        round((oi.sale_price - p.cost) / oi.sale_price * 100, 2)
        else 0 end as item_gross_margin_pct,
    
    -- Price analysis
    oi.sale_price - p.retail_price as price_variance,
    case when p.retail_price > 0 then
        round((oi.sale_price - p.retail_price) / p.retail_price * 100, 2)
        else 0 end as price_variance_pct,
        
    case
        when oi.sale_price > p.retail_price * 1.05 then 'Premium Pricing'
        when oi.sale_price < p.retail_price * 0.95 then 'Discount Pricing'
        else 'Standard Pricing'
    end as pricing_strategy,
    
    -- Order context
    o.order_date,
    o.order_status,
    o.order_time_of_day,
    o.order_day_name,
    o.is_weekend,
    o.customer_gender,
    o.delivery_days,
    o.is_complete as order_complete,
    
    -- User context
    u.age,
    u.age_group,
    u.generation,
    u.state,
    u.country,
    u.region,
    u.is_domestic,
    u.acquisition_channel,
    
    -- Return analysis
    case when oi.is_returned then oi.sale_price else 0 end as returned_value,
    case when oi.is_returned then (oi.sale_price - p.cost) else 0 end as returned_profit_impact  -- Fixed this line

from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items` as oi
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_products` as p
    on oi.product_id = p.product_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_orders` as o
    on oi.order_id = o.order_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_users` as u
    on oi.user_id = u.user_id
where not oi.has_invalid_price
  and not oi.has_missing_product
  and not p.has_invalid_cost
  and not p.has_negative_margin
  and not o.has_missing_user
), order_calculations as (
    select
        o.order_id,
        o.user_id,
        o.order_date,
        o.order_status,
        o.customer_gender,
        o.order_time_of_day,
        o.order_day_name,
        o.order_hour,
        o.order_month,
        o.order_quarter,
        o.order_year,
        o.is_weekend,
        o.item_count,
        o.is_returned as order_has_returns,
        o.is_delivered,
        o.is_complete,
       max(o.delivery_days) as delivery_days,
        
        -- Financial aggregations from order items
        sum(oi.line_total) as order_total,
        sum(oi.item_gross_profit) as total_gross_profit,
        avg(oi.item_gross_margin_pct) as avg_gross_margin_pct,
        sum(case when oi.is_returned then oi.line_total else 0 end) as returned_amount,
        sum(case when not oi.is_returned then oi.line_total else 0 end) as net_order_total,
        
        -- Product mix analysis
        count(distinct oi.product_id) as unique_products,
        count(distinct oi.category) as unique_categories,
        count(distinct oi.brand) as unique_brands,
        count(*) as total_line_items,
        
        -- Price analysis
        avg(oi.unit_price) as avg_item_price,
        max(oi.unit_price) as max_item_price,
        min(oi.unit_price) as min_item_price,
        stddev(oi.unit_price) as price_stddev,
        
        -- Category mix
        count(case when oi.category_group = 'Apparel' then 1 end) as apparel_items,
        count(case when oi.category_group = 'Footwear' then 1 end) as footwear_items,
        count(case when oi.category_group = 'Accessories' then 1 end) as accessories_items,
        
        -- Price tier mix
        count(case when oi.price_category = 'Luxury' then 1 end) as luxury_items,
        count(case when oi.price_category = 'Premium' then 1 end) as premium_items,
        count(case when oi.price_category = 'Budget' then 1 end) as budget_items,
        
        -- Customer demographics from enriched data
        max(oi.age) as customer_age,
        max(oi.age_group) as customer_age_group,
        max(oi.generation) as customer_generation,
        max(oi.state) as customer_state,
        max(oi.country) as customer_country,
        max(oi.region) as customer_region,
        max(oi.is_domestic) as is_domestic_customer,
        max(oi.acquisition_channel) as customer_acquisition_channel

    from `data-products-441119`.`dbt_dev_analytics`.`stg_orders` as o
    inner join __dbt__cte__int_order_items_enriched as oi
        on o.order_id = oi.order_id
    where not o.has_missing_user
      and not o.has_invalid_item_count
      and not o.is_future_order
    
    
    
    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16
),

customer_sequence as (
    select
        *,
        
        -- Customer order sequence analysis
        row_number() over (
            partition by user_id 
            order by order_date
        ) as customer_order_number,
        
        -- Running customer metrics
        sum(order_total) over (
            partition by user_id 
            order by order_date 
            rows unbounded preceding
        ) as customer_running_total,
        
        count(*) over (
            partition by user_id 
            order by order_date 
            rows unbounded preceding
        ) as customer_running_orders,
        
        -- Inter-order timing
        lag(order_date) over (
            partition by user_id 
            order by order_date
        ) as previous_order_date,
        
        date_diff(
            order_date,
            lag(order_date) over (partition by user_id order by order_date),
            day
        ) as days_since_previous_order,
        
        -- Order value progression
        lag(order_total) over (
            partition by user_id 
            order by order_date
        ) as previous_order_value,
        
        -- Customer segment at time of order
        case 
            when sum(order_total) over (
                partition by user_id 
                order by order_date 
                rows unbounded preceding
            ) >= 1000 then 'VIP'
            when count(*) over (
                partition by user_id 
                order by order_date 
                rows unbounded preceding
            ) >= 5 then 'Loyal'
            when count(*) over (
                partition by user_id 
                order by order_date 
                rows unbounded preceding
            ) >= 2 then 'Regular'
            else 'New'
        end as customer_segment_at_order

    from order_calculations
)

select
    *,
    
    -- Order characteristics
    case when customer_order_number = 1 then true else false end as is_first_order,
    case when customer_order_number <= 3 then true else false end as is_early_order,
    
    -- Order size categorization
    case 
        when order_total >= 200 then 'Large'
        when order_total >= 100 then 'Medium'
        when order_total >= 50 then 'Small'
        else 'Micro'
    end as order_size_category,
    
    -- Product diversity metrics
    safe_divide(unique_products, total_line_items) as product_diversity_ratio,
    safe_divide(unique_categories, total_line_items) as category_diversity_ratio,
    
    -- Return analysis
    safe_divide(returned_amount, order_total) as return_rate_by_value,
    case when returned_amount > 0 then true else false end as has_returns,
    
    -- Value progression
    case 
        when previous_order_value is null then 'First Order'
        when order_total > previous_order_value * 1.2 then 'Increasing Value'
        when order_total < previous_order_value * 0.8 then 'Decreasing Value'
        else 'Stable Value'
    end as value_trend,
    
    -- Repurchase timing
    case 
        when days_since_previous_order is null then 'First Order'
        when days_since_previous_order <= 30 then 'Quick Repeat'
        when days_since_previous_order <= 90 then 'Regular Repeat'
        when days_since_previous_order <= 180 then 'Slow Repeat'
        else 'Long Gap'
    end as repurchase_timing,
    
    -- Seasonal indicators
    case 
        when order_month in (11, 12) then 'Holiday Season'
        when order_month in (6, 7, 8) then 'Summer'
        when order_month in (3, 4, 5) then 'Spring'
        else 'Regular Season'
    end as seasonal_period,
    
    current_timestamp() as dbt_updated_at

from customer_sequence
    );
  
[0m16:09:38.303814 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:09:39.249140 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:5da7e0c4-7a3b-46fa-98fb-62af19b8a875&page=queryresults
[0m16:09:50.047979 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33f6be8d-0f4e-4a9c-96ca-ea52998bfa26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7f070>]}
[0m16:09:50.048930 [info ] [Thread-1  ]: 2 of 3 OK created sql incremental model dbt_dev_analytics.fct_orders ........... [[32mCREATE TABLE (24.7k rows, 19.3 MiB processed)[0m in 11.86s]
[0m16:09:50.049366 [debug] [Thread-1  ]: Finished running node model.digital_marketing.fct_orders
[0m16:09:50.049867 [debug] [Thread-1  ]: Began running node model.digital_marketing.fct_daily_revenue
[0m16:09:50.050225 [info ] [Thread-1  ]: 3 of 3 START sql incremental model dbt_dev_analytics.fct_daily_revenue ......... [RUN]
[0m16:09:50.050579 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.fct_orders, now model.digital_marketing.fct_daily_revenue)
[0m16:09:50.050842 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.fct_daily_revenue
[0m16:09:50.060027 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.fct_daily_revenue"
[0m16:09:50.061590 [debug] [Thread-1  ]: Began executing node model.digital_marketing.fct_daily_revenue
[0m16:09:50.069901 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:09:50.179048 [debug] [Thread-1  ]: Compilation Error in model fct_daily_revenue (models/marts/fct_daily_revenue.sql)
  Invalid incremental strategy provided: delete+insert
      Expected one of: 'merge', 'insert_overwrite', 'microbatch'
  
  > in macro dbt_bigquery_validate_get_incremental_strategy (macros/materializations/incremental.sql)
  > called by macro materialization_incremental_bigquery (macros/materializations/incremental.sql)
  > called by model fct_daily_revenue (models/marts/fct_daily_revenue.sql)
[0m16:09:50.179523 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33f6be8d-0f4e-4a9c-96ca-ea52998bfa26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7f070>]}
[0m16:09:50.179975 [error] [Thread-1  ]: 3 of 3 ERROR creating sql incremental model dbt_dev_analytics.fct_daily_revenue  [[31mERROR[0m in 0.13s]
[0m16:09:50.180370 [debug] [Thread-1  ]: Finished running node model.digital_marketing.fct_daily_revenue
[0m16:09:50.180709 [debug] [Thread-4  ]: Marking all children of 'model.digital_marketing.fct_daily_revenue' to be skipped because of status 'error'.  Reason: Compilation Error in model fct_daily_revenue (models/marts/fct_daily_revenue.sql)
  Invalid incremental strategy provided: delete+insert
      Expected one of: 'merge', 'insert_overwrite', 'microbatch'
  
  > in macro dbt_bigquery_validate_get_incremental_strategy (macros/materializations/incremental.sql)
  > called by macro materialization_incremental_bigquery (macros/materializations/incremental.sql)
  > called by model fct_daily_revenue (models/marts/fct_daily_revenue.sql).
[0m16:09:50.181346 [info ] [MainThread]: 
[0m16:09:50.185542 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m16:09:50.185944 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m16:09:50.186381 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m16:09:50.186707 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m16:09:50.206526 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m16:09:50.217377 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m16:09:50.221930 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m16:09:50.233051 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m16:09:50.234529 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m16:09:50.234861 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.05s]
[0m16:09:50.235107 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:50.301144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:50.301467 [debug] [MainThread]: Connection 'list_data-products-441119_snapshot' was properly closed.
[0m16:09:50.301672 [debug] [MainThread]: Connection 'model.digital_marketing.fct_daily_revenue' was properly closed.
[0m16:09:50.301950 [info ] [MainThread]: 
[0m16:09:50.302184 [info ] [MainThread]: Finished running 2 incremental models, 5 project hooks, 1 view model in 0 hours 0 minutes and 16.93 seconds (16.93s).
[0m16:09:50.303115 [debug] [MainThread]: Command end result
[0m16:09:50.367269 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:09:50.368713 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:09:50.373255 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m16:09:50.373521 [info ] [MainThread]: 
[0m16:09:50.373788 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:09:50.374077 [info ] [MainThread]: 
[0m16:09:50.374360 [error] [MainThread]: [31mFailure in model fct_daily_revenue (models/marts/fct_daily_revenue.sql)[0m
[0m16:09:50.374637 [error] [MainThread]:   Compilation Error in model fct_daily_revenue (models/marts/fct_daily_revenue.sql)
  Invalid incremental strategy provided: delete+insert
      Expected one of: 'merge', 'insert_overwrite', 'microbatch'
  
  > in macro dbt_bigquery_validate_get_incremental_strategy (macros/materializations/incremental.sql)
  > called by macro materialization_incremental_bigquery (macros/materializations/incremental.sql)
  > called by model fct_daily_revenue (models/marts/fct_daily_revenue.sql)
[0m16:09:50.374863 [info ] [MainThread]: 
[0m16:09:50.375107 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/marts/fct_daily_revenue.sql
[0m16:09:50.375323 [info ] [MainThread]: 
[0m16:09:50.375551 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m16:09:50.378062 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 20.039833, "process_in_blocks": "0", "process_kernel_time": 0.479822, "process_mem_max_rss": "395935744", "process_out_blocks": "0", "process_user_time": 4.375398}
[0m16:09:50.378410 [debug] [MainThread]: Command `dbt run` failed at 16:09:50.378364 after 20.04 seconds
[0m16:09:50.378672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107093d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5c3b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c985700>]}
[0m16:09:50.378934 [debug] [MainThread]: Flushing usage events
[0m16:09:50.702433 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:11:05.740307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108500220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085004f0>]}


============================== 16:11:05.744299 | 8f829272-5a46-4910-a4f2-c3a4084fe5bd ==============================
[0m16:11:05.744299 [info ] [MainThread]: Running with dbt=1.10.10
[0m16:11:05.744673 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_format': 'default', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'quiet': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'log_cache_events': 'False', 'write_json': 'True', 'target_path': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'empty': 'False', 'introspect': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'invocation_command': 'dbt run --select tag:marts', 'version_check': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'static_parser': 'True'}
[0m16:11:07.697046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f829272-5a46-4910-a4f2-c3a4084fe5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c1340>]}
[0m16:11:07.735881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f829272-5a46-4910-a4f2-c3a4084fe5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188e7070>]}
[0m16:11:07.736392 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:11:07.929829 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m16:11:08.281342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:11:08.281959 [debug] [MainThread]: Partial parsing: updated file: digital_marketing://models/marts/fct_daily_revenue.sql
[0m16:11:08.495691 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.reports
- models.thelook_analytics.intermediate
- models.thelook_analytics.marts.finance
- models.thelook_analytics.staging
- models.thelook_analytics.marts.core
- models.thelook_analytics.marts.marketing
- seeds.thelook_analytics.customer_segments
- seeds.thelook_analytics.product_categories
- snapshots.thelook_analytics
[0m16:11:08.510088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f829272-5a46-4910-a4f2-c3a4084fe5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c953130>]}
[0m16:11:08.653612 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:11:08.655617 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:11:08.675334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f829272-5a46-4910-a4f2-c3a4084fe5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c946be0>]}
[0m16:11:08.675766 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 41 data tests, 6 sources, 1492 macros
[0m16:11:08.676020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f829272-5a46-4910-a4f2-c3a4084fe5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c952dc0>]}
[0m16:11:08.677298 [info ] [MainThread]: 
[0m16:11:08.677602 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:11:08.677857 [info ] [MainThread]: 
[0m16:11:08.678201 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:11:08.681125 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119'
[0m16:11:08.681497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:09.247781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119, now list_data-products-441119_snapshot)
[0m16:11:09.248766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:09.913169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_snapshot, now list_data-products-441119_dbt_dev_analytics)
[0m16:11:09.913835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:10.590165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f829272-5a46-4910-a4f2-c3a4084fe5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb85cd0>]}
[0m16:11:10.609736 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 23:11:05 ===
[0m16:11:10.610420 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m16:11:10.614383 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m16:11:10.615181 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.02s]
[0m16:11:10.621241 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m16:11:10.622382 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m16:11:10.622992 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m16:11:10.623487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:11.402218 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:16cc4bdd-e625-42f3-914c-1ab84e96be99&page=queryresults
[0m16:11:11.901754 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.28s]
[0m16:11:11.951399 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m16:11:11.952830 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m16:11:11.953354 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.05s]
[0m16:11:11.953705 [info ] [MainThread]: 
[0m16:11:11.958933 [debug] [Thread-1  ]: Began running node model.digital_marketing.dim_users
[0m16:11:11.959605 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt_dev_analytics.dim_users ........................ [RUN]
[0m16:11:11.960254 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.digital_marketing.dim_users'
[0m16:11:11.960616 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.dim_users
[0m16:11:11.967111 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.dim_users"
[0m16:11:11.968005 [debug] [Thread-1  ]: Began executing node model.digital_marketing.dim_users
[0m16:11:11.994187 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.dim_users"
[0m16:11:11.995092 [debug] [Thread-1  ]: On model.digital_marketing.dim_users: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.dim_users"} */


  create or replace view `data-products-441119`.`dbt_dev_analytics`.`dim_users`
  OPTIONS()
  as 

select
    u.user_id,
    u.first_name,
    u.last_name,
    u.full_name,
    u.email,
    u.age,
    u.age_group,
    u.generation,
    u.gender,
    u.state,
    u.country,
    u.region,
    u.is_domestic,
    u.latitude,
    u.longitude,
    u.traffic_source,
    u.acquisition_channel,
    u.registration_date,
    
    -- Order history metrics
    coalesce(oh.total_orders, 0) as total_orders,
    coalesce(oh.completed_orders, 0) as completed_orders,
    coalesce(oh.cancelled_orders, 0) as cancelled_orders,
    coalesce(oh.lifetime_value, 0) as lifetime_value,
    coalesce(oh.net_lifetime_value, 0) as net_lifetime_value,
    coalesce(oh.lifetime_gross_profit, 0) as lifetime_gross_profit,
    coalesce(oh.avg_order_value, 0) as avg_order_value,
    coalesce(oh.avg_item_value, 0) as avg_item_value,
    
    -- Timing metrics
    oh.first_order_date,
    oh.last_order_date,
    coalesce(oh.days_since_last_order, 999999) as days_since_last_order,
    coalesce(oh.customer_tenure_days, 0) as customer_tenure_days,
    coalesce(oh.orders_per_month, 0) as orders_per_month,
    coalesce(oh.orders_per_year, 0) as orders_per_year,
    
    -- Product preferences
    coalesce(oh.unique_products_purchased, 0) as unique_products_purchased,
    coalesce(oh.unique_categories_purchased, 0) as unique_categories_purchased,
    coalesce(oh.unique_brands_purchased, 0) as unique_brands_purchased,
    oh.preferred_category,
    oh.preferred_brand,
    coalesce(oh.product_diversity_score, 0) as product_diversity_score,
    
    -- Behavioral patterns
    coalesce(oh.return_rate, 0) as return_rate,
    coalesce(oh.weekend_order_pct, 0) as weekend_order_pct,
    coalesce(oh.premium_propensity_pct, 0) as premium_propensity_pct,
    coalesce(oh.avg_delivery_days, 0) as avg_delivery_days,
    coalesce(oh.fast_delivery_pct, 0) as fast_delivery_pct,
    
    -- Customer segmentation
    case 
        when oh.lifetime_value >= 1000 then 'VIP'
        when oh.completed_orders >= 5 then 'Loyal'
        when oh.completed_orders >= 2 then 'Regular'
        when oh.completed_orders = 1 then 'New'
        else 'Prospect'
    end as value_segment,
    
    case 
        when oh.days_since_last_order <= 90 then 'Active'
        when oh.days_since_last_order <= 180 then 'At Risk'
        when oh.days_since_last_order <= 365 then 'Dormant'
        when oh.days_since_last_order < 999999 then 'Churned'
        else 'Prospect'
    end as activity_segment,
    
    case
        when oh.orders_per_month >= 2 then 'High Frequency'
        when oh.orders_per_month >= 0.5 then 'Medium Frequency'
        when oh.orders_per_month > 0 then 'Low Frequency'
        else 'One-time'
    end as frequency_segment,
    
    -- RFM Score Components
    case 
        when oh.days_since_last_order <= 30 then 5
        when oh.days_since_last_order <= 90 then 4
        when oh.days_since_last_order <= 180 then 3
        when oh.days_since_last_order <= 365 then 2
        else 1
    end as recency_score,
    
    case 
        when oh.completed_orders >= 10 then 5
        when oh.completed_orders >= 5 then 4
        when oh.completed_orders >= 3 then 3
        when oh.completed_orders >= 2 then 2
        else 1
    end as frequency_score,
    
    case 
        when oh.lifetime_value >= 1000 then 5
        when oh.lifetime_value >= 500 then 4
        when oh.lifetime_value >= 200 then 3
        when oh.lifetime_value >= 100 then 2
        else 1
    end as monetary_score,
    
    current_timestamp() as dbt_updated_at

from `data-products-441119`.`dbt_dev_analytics`.`stg_users` as u
left join `data-products-441119`.`dbt_dev_analytics`.`int_user_order_history` as oh
    on u.user_id = oh.user_id
where not u.has_invalid_email
  and not u.has_invalid_age;


[0m16:11:11.995503 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:11:12.937248 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:b2825d73-002a-40c7-8a66-1d565262df14&page=queryresults
[0m16:11:13.342974 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f829272-5a46-4910-a4f2-c3a4084fe5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd78280>]}
[0m16:11:13.343914 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt_dev_analytics.dim_users ................... [[32mCREATE VIEW (0 processed)[0m in 1.38s]
[0m16:11:13.344621 [debug] [Thread-1  ]: Finished running node model.digital_marketing.dim_users
[0m16:11:13.345108 [debug] [Thread-1  ]: Began running node model.digital_marketing.fct_orders
[0m16:11:13.345736 [info ] [Thread-1  ]: 2 of 3 START sql incremental model dbt_dev_analytics.fct_orders ................ [RUN]
[0m16:11:13.346338 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.dim_users, now model.digital_marketing.fct_orders)
[0m16:11:13.346803 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.fct_orders
[0m16:11:13.365655 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.fct_orders"
[0m16:11:13.410125 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.fct_orders"
[0m16:11:13.410730 [debug] [Thread-1  ]: Began executing node model.digital_marketing.fct_orders
[0m16:11:13.456021 [debug] [Thread-1  ]: On model.digital_marketing.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.fct_orders"} */

  
    

    create or replace table `data-products-441119`.`dbt_dev_analytics`.`fct_orders__dbt_tmp`
      
    partition by timestamp_trunc(order_date, day)
    cluster by user_id, order_status

    
    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

with  __dbt__cte__int_order_items_enriched as (


select
    oi.order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    oi.inventory_item_id,
    oi.quantity,
    oi.sale_price as unit_price,
    oi.line_total,
    oi.discount_amount,
    oi.is_returned,
    oi.is_shipped,
    oi.is_delivered,
    oi.order_item_date,
    
    -- Product enrichment
    p.product_name,
    p.category,
    p.category_group,
    p.brand,
    p.brand_tier,
    p.department,
    p.cost as product_cost,
    p.retail_price,
    p.margin_amount as product_margin,
    p.margin_percentage as product_margin_pct,
    p.margin_tier,
    p.price_category,
    
    -- Profitability calculations
    oi.sale_price - p.cost as item_gross_profit,
    case when oi.sale_price > 0 then
        round((oi.sale_price - p.cost) / oi.sale_price * 100, 2)
        else 0 end as item_gross_margin_pct,
    
    -- Price analysis
    oi.sale_price - p.retail_price as price_variance,
    case when p.retail_price > 0 then
        round((oi.sale_price - p.retail_price) / p.retail_price * 100, 2)
        else 0 end as price_variance_pct,
        
    case
        when oi.sale_price > p.retail_price * 1.05 then 'Premium Pricing'
        when oi.sale_price < p.retail_price * 0.95 then 'Discount Pricing'
        else 'Standard Pricing'
    end as pricing_strategy,
    
    -- Order context
    o.order_date,
    o.order_status,
    o.order_time_of_day,
    o.order_day_name,
    o.is_weekend,
    o.customer_gender,
    o.delivery_days,
    o.is_complete as order_complete,
    
    -- User context
    u.age,
    u.age_group,
    u.generation,
    u.state,
    u.country,
    u.region,
    u.is_domestic,
    u.acquisition_channel,
    
    -- Return analysis
    case when oi.is_returned then oi.sale_price else 0 end as returned_value,
    case when oi.is_returned then (oi.sale_price - p.cost) else 0 end as returned_profit_impact  -- Fixed this line

from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items` as oi
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_products` as p
    on oi.product_id = p.product_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_orders` as o
    on oi.order_id = o.order_id
inner join `data-products-441119`.`dbt_dev_analytics`.`stg_users` as u
    on oi.user_id = u.user_id
where not oi.has_invalid_price
  and not oi.has_missing_product
  and not p.has_invalid_cost
  and not p.has_negative_margin
  and not o.has_missing_user
), order_calculations as (
    select
        o.order_id,
        o.user_id,
        o.order_date,
        o.order_status,
        o.customer_gender,
        o.order_time_of_day,
        o.order_day_name,
        o.order_hour,
        o.order_month,
        o.order_quarter,
        o.order_year,
        o.is_weekend,
        o.item_count,
        o.is_returned as order_has_returns,
        o.is_delivered,
        o.is_complete,
       max(o.delivery_days) as delivery_days,
        
        -- Financial aggregations from order items
        sum(oi.line_total) as order_total,
        sum(oi.item_gross_profit) as total_gross_profit,
        avg(oi.item_gross_margin_pct) as avg_gross_margin_pct,
        sum(case when oi.is_returned then oi.line_total else 0 end) as returned_amount,
        sum(case when not oi.is_returned then oi.line_total else 0 end) as net_order_total,
        
        -- Product mix analysis
        count(distinct oi.product_id) as unique_products,
        count(distinct oi.category) as unique_categories,
        count(distinct oi.brand) as unique_brands,
        count(*) as total_line_items,
        
        -- Price analysis
        avg(oi.unit_price) as avg_item_price,
        max(oi.unit_price) as max_item_price,
        min(oi.unit_price) as min_item_price,
        stddev(oi.unit_price) as price_stddev,
        
        -- Category mix
        count(case when oi.category_group = 'Apparel' then 1 end) as apparel_items,
        count(case when oi.category_group = 'Footwear' then 1 end) as footwear_items,
        count(case when oi.category_group = 'Accessories' then 1 end) as accessories_items,
        
        -- Price tier mix
        count(case when oi.price_category = 'Luxury' then 1 end) as luxury_items,
        count(case when oi.price_category = 'Premium' then 1 end) as premium_items,
        count(case when oi.price_category = 'Budget' then 1 end) as budget_items,
        
        -- Customer demographics from enriched data
        max(oi.age) as customer_age,
        max(oi.age_group) as customer_age_group,
        max(oi.generation) as customer_generation,
        max(oi.state) as customer_state,
        max(oi.country) as customer_country,
        max(oi.region) as customer_region,
        max(oi.is_domestic) as is_domestic_customer,
        max(oi.acquisition_channel) as customer_acquisition_channel

    from `data-products-441119`.`dbt_dev_analytics`.`stg_orders` as o
    inner join __dbt__cte__int_order_items_enriched as oi
        on o.order_id = oi.order_id
    where not o.has_missing_user
      and not o.has_invalid_item_count
      and not o.is_future_order
    
    
        -- Incremental processing with lookback for late-arriving data
        and o.order_date >= (
            select date_sub(max(order_date), interval 3 day)
            from `data-products-441119`.`dbt_dev_analytics`.`fct_orders`
        )
    
    
    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16
),

customer_sequence as (
    select
        *,
        
        -- Customer order sequence analysis
        row_number() over (
            partition by user_id 
            order by order_date
        ) as customer_order_number,
        
        -- Running customer metrics
        sum(order_total) over (
            partition by user_id 
            order by order_date 
            rows unbounded preceding
        ) as customer_running_total,
        
        count(*) over (
            partition by user_id 
            order by order_date 
            rows unbounded preceding
        ) as customer_running_orders,
        
        -- Inter-order timing
        lag(order_date) over (
            partition by user_id 
            order by order_date
        ) as previous_order_date,
        
        date_diff(
            order_date,
            lag(order_date) over (partition by user_id order by order_date),
            day
        ) as days_since_previous_order,
        
        -- Order value progression
        lag(order_total) over (
            partition by user_id 
            order by order_date
        ) as previous_order_value,
        
        -- Customer segment at time of order
        case 
            when sum(order_total) over (
                partition by user_id 
                order by order_date 
                rows unbounded preceding
            ) >= 1000 then 'VIP'
            when count(*) over (
                partition by user_id 
                order by order_date 
                rows unbounded preceding
            ) >= 5 then 'Loyal'
            when count(*) over (
                partition by user_id 
                order by order_date 
                rows unbounded preceding
            ) >= 2 then 'Regular'
            else 'New'
        end as customer_segment_at_order

    from order_calculations
)

select
    *,
    
    -- Order characteristics
    case when customer_order_number = 1 then true else false end as is_first_order,
    case when customer_order_number <= 3 then true else false end as is_early_order,
    
    -- Order size categorization
    case 
        when order_total >= 200 then 'Large'
        when order_total >= 100 then 'Medium'
        when order_total >= 50 then 'Small'
        else 'Micro'
    end as order_size_category,
    
    -- Product diversity metrics
    safe_divide(unique_products, total_line_items) as product_diversity_ratio,
    safe_divide(unique_categories, total_line_items) as category_diversity_ratio,
    
    -- Return analysis
    safe_divide(returned_amount, order_total) as return_rate_by_value,
    case when returned_amount > 0 then true else false end as has_returns,
    
    -- Value progression
    case 
        when previous_order_value is null then 'First Order'
        when order_total > previous_order_value * 1.2 then 'Increasing Value'
        when order_total < previous_order_value * 0.8 then 'Decreasing Value'
        else 'Stable Value'
    end as value_trend,
    
    -- Repurchase timing
    case 
        when days_since_previous_order is null then 'First Order'
        when days_since_previous_order <= 30 then 'Quick Repeat'
        when days_since_previous_order <= 90 then 'Regular Repeat'
        when days_since_previous_order <= 180 then 'Slow Repeat'
        else 'Long Gap'
    end as repurchase_timing,
    
    -- Seasonal indicators
    case 
        when order_month in (11, 12) then 'Holiday Season'
        when order_month in (6, 7, 8) then 'Summer'
        when order_month in (3, 4, 5) then 'Spring'
        else 'Regular Season'
    end as seasonal_period,
    
    current_timestamp() as dbt_updated_at

from customer_sequence
    );
  
[0m16:11:13.456637 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:11:14.344844 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:1ba02ec5-14b1-46c3-b5c3-aeb8b188c912&page=queryresults
[0m16:11:19.573755 [debug] [Thread-1  ]: 
    In `data-products-441119`.`dbt_dev_analytics`.`fct_orders`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:11:19.607575 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.fct_orders"
[0m16:11:19.609309 [debug] [Thread-1  ]: On model.digital_marketing.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.fct_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `data-products-441119`.`dbt_dev_analytics`.`fct_orders` as DBT_INTERNAL_DEST
        using (
        select
        * from `data-products-441119`.`dbt_dev_analytics`.`fct_orders__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        `order_id` = DBT_INTERNAL_SOURCE.`order_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`order_date` = DBT_INTERNAL_SOURCE.`order_date`,`order_status` = DBT_INTERNAL_SOURCE.`order_status`,`customer_gender` = DBT_INTERNAL_SOURCE.`customer_gender`,`order_time_of_day` = DBT_INTERNAL_SOURCE.`order_time_of_day`,`order_day_name` = DBT_INTERNAL_SOURCE.`order_day_name`,`order_hour` = DBT_INTERNAL_SOURCE.`order_hour`,`order_month` = DBT_INTERNAL_SOURCE.`order_month`,`order_quarter` = DBT_INTERNAL_SOURCE.`order_quarter`,`order_year` = DBT_INTERNAL_SOURCE.`order_year`,`is_weekend` = DBT_INTERNAL_SOURCE.`is_weekend`,`item_count` = DBT_INTERNAL_SOURCE.`item_count`,`order_has_returns` = DBT_INTERNAL_SOURCE.`order_has_returns`,`is_delivered` = DBT_INTERNAL_SOURCE.`is_delivered`,`is_complete` = DBT_INTERNAL_SOURCE.`is_complete`,`delivery_days` = DBT_INTERNAL_SOURCE.`delivery_days`,`order_total` = DBT_INTERNAL_SOURCE.`order_total`,`total_gross_profit` = DBT_INTERNAL_SOURCE.`total_gross_profit`,`avg_gross_margin_pct` = DBT_INTERNAL_SOURCE.`avg_gross_margin_pct`,`returned_amount` = DBT_INTERNAL_SOURCE.`returned_amount`,`net_order_total` = DBT_INTERNAL_SOURCE.`net_order_total`,`unique_products` = DBT_INTERNAL_SOURCE.`unique_products`,`unique_categories` = DBT_INTERNAL_SOURCE.`unique_categories`,`unique_brands` = DBT_INTERNAL_SOURCE.`unique_brands`,`total_line_items` = DBT_INTERNAL_SOURCE.`total_line_items`,`avg_item_price` = DBT_INTERNAL_SOURCE.`avg_item_price`,`max_item_price` = DBT_INTERNAL_SOURCE.`max_item_price`,`min_item_price` = DBT_INTERNAL_SOURCE.`min_item_price`,`price_stddev` = DBT_INTERNAL_SOURCE.`price_stddev`,`apparel_items` = DBT_INTERNAL_SOURCE.`apparel_items`,`footwear_items` = DBT_INTERNAL_SOURCE.`footwear_items`,`accessories_items` = DBT_INTERNAL_SOURCE.`accessories_items`,`luxury_items` = DBT_INTERNAL_SOURCE.`luxury_items`,`premium_items` = DBT_INTERNAL_SOURCE.`premium_items`,`budget_items` = DBT_INTERNAL_SOURCE.`budget_items`,`customer_age` = DBT_INTERNAL_SOURCE.`customer_age`,`customer_age_group` = DBT_INTERNAL_SOURCE.`customer_age_group`,`customer_generation` = DBT_INTERNAL_SOURCE.`customer_generation`,`customer_state` = DBT_INTERNAL_SOURCE.`customer_state`,`customer_country` = DBT_INTERNAL_SOURCE.`customer_country`,`customer_region` = DBT_INTERNAL_SOURCE.`customer_region`,`is_domestic_customer` = DBT_INTERNAL_SOURCE.`is_domestic_customer`,`customer_acquisition_channel` = DBT_INTERNAL_SOURCE.`customer_acquisition_channel`,`customer_order_number` = DBT_INTERNAL_SOURCE.`customer_order_number`,`customer_running_total` = DBT_INTERNAL_SOURCE.`customer_running_total`,`customer_running_orders` = DBT_INTERNAL_SOURCE.`customer_running_orders`,`previous_order_date` = DBT_INTERNAL_SOURCE.`previous_order_date`,`days_since_previous_order` = DBT_INTERNAL_SOURCE.`days_since_previous_order`,`previous_order_value` = DBT_INTERNAL_SOURCE.`previous_order_value`,`customer_segment_at_order` = DBT_INTERNAL_SOURCE.`customer_segment_at_order`,`is_first_order` = DBT_INTERNAL_SOURCE.`is_first_order`,`is_early_order` = DBT_INTERNAL_SOURCE.`is_early_order`,`order_size_category` = DBT_INTERNAL_SOURCE.`order_size_category`,`product_diversity_ratio` = DBT_INTERNAL_SOURCE.`product_diversity_ratio`,`category_diversity_ratio` = DBT_INTERNAL_SOURCE.`category_diversity_ratio`,`return_rate_by_value` = DBT_INTERNAL_SOURCE.`return_rate_by_value`,`has_returns` = DBT_INTERNAL_SOURCE.`has_returns`,`value_trend` = DBT_INTERNAL_SOURCE.`value_trend`,`repurchase_timing` = DBT_INTERNAL_SOURCE.`repurchase_timing`,`seasonal_period` = DBT_INTERNAL_SOURCE.`seasonal_period`,`dbt_updated_at` = DBT_INTERNAL_SOURCE.`dbt_updated_at`
    

    when not matched then insert
        (`order_id`, `user_id`, `order_date`, `order_status`, `customer_gender`, `order_time_of_day`, `order_day_name`, `order_hour`, `order_month`, `order_quarter`, `order_year`, `is_weekend`, `item_count`, `order_has_returns`, `is_delivered`, `is_complete`, `delivery_days`, `order_total`, `total_gross_profit`, `avg_gross_margin_pct`, `returned_amount`, `net_order_total`, `unique_products`, `unique_categories`, `unique_brands`, `total_line_items`, `avg_item_price`, `max_item_price`, `min_item_price`, `price_stddev`, `apparel_items`, `footwear_items`, `accessories_items`, `luxury_items`, `premium_items`, `budget_items`, `customer_age`, `customer_age_group`, `customer_generation`, `customer_state`, `customer_country`, `customer_region`, `is_domestic_customer`, `customer_acquisition_channel`, `customer_order_number`, `customer_running_total`, `customer_running_orders`, `previous_order_date`, `days_since_previous_order`, `previous_order_value`, `customer_segment_at_order`, `is_first_order`, `is_early_order`, `order_size_category`, `product_diversity_ratio`, `category_diversity_ratio`, `return_rate_by_value`, `has_returns`, `value_trend`, `repurchase_timing`, `seasonal_period`, `dbt_updated_at`)
    values
        (`order_id`, `user_id`, `order_date`, `order_status`, `customer_gender`, `order_time_of_day`, `order_day_name`, `order_hour`, `order_month`, `order_quarter`, `order_year`, `is_weekend`, `item_count`, `order_has_returns`, `is_delivered`, `is_complete`, `delivery_days`, `order_total`, `total_gross_profit`, `avg_gross_margin_pct`, `returned_amount`, `net_order_total`, `unique_products`, `unique_categories`, `unique_brands`, `total_line_items`, `avg_item_price`, `max_item_price`, `min_item_price`, `price_stddev`, `apparel_items`, `footwear_items`, `accessories_items`, `luxury_items`, `premium_items`, `budget_items`, `customer_age`, `customer_age_group`, `customer_generation`, `customer_state`, `customer_country`, `customer_region`, `is_domestic_customer`, `customer_acquisition_channel`, `customer_order_number`, `customer_running_total`, `customer_running_orders`, `previous_order_date`, `days_since_previous_order`, `previous_order_value`, `customer_segment_at_order`, `is_first_order`, `is_early_order`, `order_size_category`, `product_diversity_ratio`, `category_diversity_ratio`, `return_rate_by_value`, `has_returns`, `value_trend`, `repurchase_timing`, `seasonal_period`, `dbt_updated_at`)


    
[0m16:11:20.089044 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:ec86c4f0-cb5a-4966-ba7e-a2a3d10f54a2&page=queryresults
[0m16:11:24.209046 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f829272-5a46-4910-a4f2-c3a4084fe5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f26be0>]}
[0m16:11:24.210491 [info ] [Thread-1  ]: 2 of 3 OK created sql incremental model dbt_dev_analytics.fct_orders ........... [[32mMERGE (242.0 rows, 439.9 KiB processed)[0m in 10.86s]
[0m16:11:24.211631 [debug] [Thread-1  ]: Finished running node model.digital_marketing.fct_orders
[0m16:11:24.212950 [debug] [Thread-1  ]: Began running node model.digital_marketing.fct_daily_revenue
[0m16:11:24.214026 [info ] [Thread-1  ]: 3 of 3 START sql incremental model dbt_dev_analytics.fct_daily_revenue ......... [RUN]
[0m16:11:24.214895 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.fct_orders, now model.digital_marketing.fct_daily_revenue)
[0m16:11:24.215638 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.fct_daily_revenue
[0m16:11:24.229996 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.fct_daily_revenue"
[0m16:11:24.231315 [debug] [Thread-1  ]: Began executing node model.digital_marketing.fct_daily_revenue
[0m16:11:24.239659 [debug] [Thread-1  ]: Writing runtime sql for node "model.digital_marketing.fct_daily_revenue"
[0m16:11:24.240959 [debug] [Thread-1  ]: On model.digital_marketing.fct_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.digital_marketing.fct_daily_revenue"} */

  
    

    create or replace table `data-products-441119`.`dbt_dev_analytics`.`fct_daily_revenue`
      
    partition by revenue_date
    

    
    OPTIONS()
    as (
      

with daily_aggregates as (
    select
        date(order_date) as revenue_date,
        
        -- Revenue metrics
        sum(order_total) as total_revenue,
        sum(net_order_total) as net_revenue,
        sum(returned_amount) as total_returns,
        sum(total_gross_profit) as total_gross_profit,
        avg(order_total) as avg_order_value,
        
        -- Volume metrics
        count(*) as total_orders,
        count(distinct user_id) as unique_customers,
        sum(total_line_items) as total_items_sold,
        sum(unique_products) as total_unique_products_sold,
        
        -- Customer acquisition
        count(case when is_first_order then 1 end) as new_customers,
        count(case when not is_first_order then 1 end) as returning_customers,
        count(case when customer_order_number <= 3 then 1 end) as early_orders,
        
        -- Order characteristics
        count(case when order_size_category = 'Large' then 1 end) as large_orders,
        count(case when order_size_category = 'Medium' then 1 end) as medium_orders,
        count(case when order_size_category = 'Small' then 1 end) as small_orders,
        
        -- Geographic distribution
        count(case when is_domestic_customer then 1 end) as domestic_orders,
        count(case when not is_domestic_customer then 1 end) as international_orders,
        count(distinct customer_state) as states_with_orders,
        count(distinct customer_country) as countries_with_orders,
        
        -- Customer segments
        count(case when customer_segment_at_order = 'VIP' then 1 end) as vip_orders,
        count(case when customer_segment_at_order = 'Loyal' then 1 end) as loyal_orders,
        count(case when customer_segment_at_order = 'Regular' then 1 end) as regular_orders,
        count(case when customer_segment_at_order = 'New' then 1 end) as new_customer_orders,
        
        -- Product categories
        sum(apparel_items) as apparel_items_sold,
        sum(footwear_items) as footwear_items_sold,
        sum(accessories_items) as accessories_items_sold,
        
        -- Price tiers
        sum(luxury_items) as luxury_items_sold,
        sum(premium_items) as premium_items_sold,
        sum(budget_items) as budget_items_sold,
        
        -- Timing patterns
        count(case when is_weekend then 1 end) as weekend_orders,
        count(case when order_time_of_day = 'Evening' then 1 end) as evening_orders,
        count(case when order_time_of_day = 'Morning' then 1 end) as morning_orders,
        
        -- Order status breakdown
        count(case when order_status = 'Complete' then 1 end) as completed_orders,
        count(case when order_status = 'Cancelled' then 1 end) as cancelled_orders,
        count(case when order_has_returns then 1 end) as orders_with_returns,
        
        -- Delivery performance
        avg(delivery_days) as avg_delivery_days,
        count(case when delivery_days <= 3 then 1 end) as fast_deliveries,
        count(case when delivery_days > 7 then 1 end) as slow_deliveries

    from `data-products-441119`.`dbt_dev_analytics`.`fct_orders`
    where order_status in ('Complete', 'Shipped', 'Processing')
    
    
    
    group by 1
)

select
    *,
    
    -- Calculated ratios and percentages
    safe_divide(total_gross_profit, total_revenue) as gross_margin_rate,
    safe_divide(returning_customers, unique_customers) as returning_customer_rate,
    safe_divide(new_customers, unique_customers) as new_customer_rate,
    safe_divide(cancelled_orders, total_orders) as cancellation_rate,
    safe_divide(total_returns, total_revenue) as return_rate,
    safe_divide(international_orders, total_orders) as international_order_rate,
    safe_divide(weekend_orders, total_orders) as weekend_order_rate,
    safe_divide(fast_deliveries, completed_orders) as fast_delivery_rate,
    
    -- Customer acquisition metrics
    safe_divide(total_revenue, new_customers) as revenue_per_new_customer,
    safe_divide(new_customer_orders, new_customers) as orders_per_new_customer,
    
    -- Product mix percentages
    safe_divide(luxury_items_sold, total_items_sold) as luxury_item_mix,
    safe_divide(apparel_items_sold, total_items_sold) as apparel_item_mix,
    
    -- Year-over-year comparisons
    lag(total_revenue, 365) over (order by revenue_date) as revenue_ly,
    safe_divide(
        total_revenue - lag(total_revenue, 365) over (order by revenue_date),
        lag(total_revenue, 365) over (order by revenue_date)
    ) as revenue_yoy_growth,
    
    lag(unique_customers, 365) over (order by revenue_date) as customers_ly,
    safe_divide(
        unique_customers - lag(unique_customers, 365) over (order by revenue_date),
        lag(unique_customers, 365) over (order by revenue_date)
    ) as customer_growth_yoy,
    
    -- Moving averages for trend analysis
    avg(total_revenue) over (
        order by revenue_date 
        rows between 6 preceding and current row
    ) as revenue_7day_avg,
    
    avg(total_revenue) over (
        order by revenue_date 
        rows between 29 preceding and current row
    ) as revenue_30day_avg,
    
    avg(unique_customers) over (
        order by revenue_date 
        rows between 6 preceding and current row
    ) as customers_7day_avg,
    
    -- Performance indicators
    case 
        when total_revenue > avg(total_revenue) over (
            order by revenue_date 
            rows between 29 preceding and current row
        ) * 1.2 then 'High Performance'
        when total_revenue < avg(total_revenue) over (
            order by revenue_date 
            rows between 29 preceding and current row
        ) * 0.8 then 'Low Performance'
        else 'Normal Performance'
    end as daily_performance_status,
    
    current_timestamp() as dbt_updated_at

from daily_aggregates
    );
  
[0m16:11:24.241797 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:11:25.123717 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:b13d5686-1f51-46d3-8de0-eb3d872c311d&page=queryresults
[0m16:11:36.020322 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f829272-5a46-4910-a4f2-c3a4084fe5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f26be0>]}
[0m16:11:36.022640 [info ] [Thread-1  ]: 3 of 3 OK created sql incremental model dbt_dev_analytics.fct_daily_revenue .... [[32mCREATE TABLE (403.0 rows, 4.3 MiB processed)[0m in 11.81s]
[0m16:11:36.023780 [debug] [Thread-1  ]: Finished running node model.digital_marketing.fct_daily_revenue
[0m16:11:36.025490 [info ] [MainThread]: 
[0m16:11:36.036121 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m16:11:36.036902 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m16:11:36.037738 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m16:11:36.038472 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m16:11:36.073209 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m16:11:36.086974 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m16:11:36.092507 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m16:11:36.105057 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m16:11:36.106514 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m16:11:36.106877 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.07s]
[0m16:11:36.107148 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:11:36.173757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:36.174082 [debug] [MainThread]: Connection 'list_data-products-441119_dbt_dev_analytics' was properly closed.
[0m16:11:36.174289 [debug] [MainThread]: Connection 'model.digital_marketing.fct_daily_revenue' was properly closed.
[0m16:11:36.174563 [info ] [MainThread]: 
[0m16:11:36.174800 [info ] [MainThread]: Finished running 2 incremental models, 5 project hooks, 1 view model in 0 hours 0 minutes and 27.50 seconds (27.50s).
[0m16:11:36.175722 [debug] [MainThread]: Command end result
[0m16:11:36.329837 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:11:36.331577 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:11:36.335939 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m16:11:36.336175 [info ] [MainThread]: 
[0m16:11:36.336439 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:36.336662 [info ] [MainThread]: 
[0m16:11:36.336897 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m16:11:36.339373 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 30.64636, "process_in_blocks": "0", "process_kernel_time": 0.496477, "process_mem_max_rss": "393641984", "process_out_blocks": "0", "process_user_time": 4.580041}
[0m16:11:36.339715 [debug] [MainThread]: Command `dbt run` succeeded at 16:11:36.339666 after 30.65 seconds
[0m16:11:36.339965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730a070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c946be0>]}
[0m16:11:36.340213 [debug] [MainThread]: Flushing usage events
[0m16:11:36.702684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:12:27.021346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073abd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11927a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11927a460>]}


============================== 16:12:27.025225 | 145cafdf-a0c6-4e46-ac38-f089bbe323e7 ==============================
[0m16:12:27.025225 [info ] [MainThread]: Running with dbt=1.10.10
[0m16:12:27.025606 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'fail_fast': 'False', 'partial_parse': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'invocation_command': 'dbt test', 'version_check': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'no_print': 'None', 'debug': 'False', 'introspect': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_colors': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'static_parser': 'True'}
[0m16:12:28.926210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '145cafdf-a0c6-4e46-ac38-f089bbe323e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141b14e50>]}
[0m16:12:28.966537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '145cafdf-a0c6-4e46-ac38-f089bbe323e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010c1280>]}
[0m16:12:28.967028 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:12:29.169192 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m16:12:29.535196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:12:29.535575 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:12:29.542246 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.reports
- models.thelook_analytics.marts.core
- models.thelook_analytics.intermediate
- models.thelook_analytics.marts.finance
- models.thelook_analytics.staging
- seeds.thelook_analytics.customer_segments
- seeds.thelook_analytics.product_categories
- snapshots.thelook_analytics
[0m16:12:29.615710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '145cafdf-a0c6-4e46-ac38-f089bbe323e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142f28130>]}
[0m16:12:29.763318 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:12:29.765719 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:12:29.792525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '145cafdf-a0c6-4e46-ac38-f089bbe323e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143238b50>]}
[0m16:12:29.792956 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 41 data tests, 6 sources, 1492 macros
[0m16:12:29.793205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '145cafdf-a0c6-4e46-ac38-f089bbe323e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141c7d100>]}
[0m16:12:29.795870 [info ] [MainThread]: 
[0m16:12:29.796125 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:12:29.796343 [info ] [MainThread]: 
[0m16:12:29.796683 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:12:29.802375 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_dbt_dev_analytics'
[0m16:12:29.803112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:30.359595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev_analytics, now list_data-products-441119_snapshot)
[0m16:12:30.362964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:12:31.070927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '145cafdf-a0c6-4e46-ac38-f089bbe323e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143238490>]}
[0m16:12:31.087253 [info ] [MainThread]: === DBT Run Started at: 2025-09-10 23:12:27 ===
[0m16:12:31.087722 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m16:12:31.091041 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m16:12:31.091531 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.02s]
[0m16:12:31.096886 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m16:12:31.098409 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m16:12:31.100140 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m16:12:31.100715 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:12:31.786468 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:375d58c0-1786-4ac1-8f24-39e5196bab79&page=queryresults
[0m16:12:32.249762 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.16s]
[0m16:12:32.599449 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m16:12:32.602489 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m16:12:32.603453 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.35s]
[0m16:12:32.604104 [info ] [MainThread]: 
[0m16:12:32.615346 [debug] [Thread-1  ]: Began running node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m16:12:32.616156 [info ] [Thread-1  ]: 1 of 41 START test dbt_utils_accepted_range_stg_order_items_sale_price__10000__0  [RUN]
[0m16:12:32.617038 [debug] [Thread-1  ]: Acquiring new bigquery connection 'test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde'
[0m16:12:32.617653 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m16:12:32.634367 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde"
[0m16:12:32.635947 [debug] [Thread-1  ]: Began executing node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m16:12:32.662652 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde"
[0m16:12:32.663584 [debug] [Thread-1  ]: On test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sale_price >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sale_price <= 10000
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m16:12:32.664016 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:12:33.524821 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:fb0e877d-2dfc-4ace-8992-2b7e90a3ecaa&page=queryresults
[0m16:12:34.094203 [info ] [Thread-1  ]: 1 of 41 PASS dbt_utils_accepted_range_stg_order_items_sale_price__10000__0 ..... [[32mPASS[0m in 1.48s]
[0m16:12:34.095126 [debug] [Thread-1  ]: Finished running node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m16:12:34.095573 [debug] [Thread-1  ]: Began running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m16:12:34.096060 [info ] [Thread-1  ]: 2 of 41 START test dbt_utils_accepted_range_stg_users_age__120__13 ............. [RUN]
[0m16:12:34.096597 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde, now test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2)
[0m16:12:34.097017 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m16:12:34.108341 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"
[0m16:12:34.109316 [debug] [Thread-1  ]: Began executing node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m16:12:34.116172 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"
[0m16:12:34.117077 [debug] [Thread-1  ]: On test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not age >= 13
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not age <= 120
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m16:12:34.117611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:12:34.958820 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:28885854-cda2-48c4-a941-aaabd99d7a8e&page=queryresults
[0m16:12:35.573652 [error] [Thread-1  ]: 2 of 41 FAIL 870 dbt_utils_accepted_range_stg_users_age__120__13 ............... [[31mFAIL 870[0m in 1.48s]
[0m16:12:35.575018 [debug] [Thread-1  ]: Finished running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m16:12:35.575825 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_dim_products_product_id.c8aba288d1
[0m16:12:35.576724 [info ] [Thread-1  ]: 3 of 41 START test not_null_dim_products_product_id ............................ [RUN]
[0m16:12:35.577726 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2, now test.digital_marketing.not_null_dim_products_product_id.c8aba288d1)
[0m16:12:35.578509 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_dim_products_product_id.c8aba288d1
[0m16:12:35.596441 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_dim_products_product_id.c8aba288d1"
[0m16:12:35.597942 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_dim_products_product_id.c8aba288d1
[0m16:12:35.604745 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_dim_products_product_id.c8aba288d1"
[0m16:12:35.605790 [debug] [Thread-1  ]: On test.digital_marketing.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `data-products-441119`.`dbt_dev_analytics`.`dim_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:12:35.606303 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:12:36.292011 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:219d8ad8-b679-4d67-93bb-a20f867dcb32&page=queryresults
[0m16:12:36.293652 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:219d8ad8-b679-4d67-93bb-a20f867dcb32&page=queryresults
[0m16:12:36.352184 [debug] [Thread-1  ]: Database Error in test not_null_dim_products_product_id (models/marts/_core_models.yml)
  Not found: Table data-products-441119:dbt_dev_analytics.dim_products was not found in location US
  compiled code at target/run/digital_marketing/models/marts/_core_models.yml/not_null_dim_products_product_id.sql
[0m16:12:36.352796 [error] [Thread-1  ]: 3 of 41 ERROR not_null_dim_products_product_id ................................. [[31mERROR[0m in 0.78s]
[0m16:12:36.353331 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_dim_products_product_id.c8aba288d1
[0m16:12:36.353725 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_dim_products_product_name.991aec73f3
[0m16:12:36.354199 [debug] [Thread-4  ]: Marking all children of 'test.digital_marketing.not_null_dim_products_product_id.c8aba288d1' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_products_product_id (models/marts/_core_models.yml)
  Not found: Table data-products-441119:dbt_dev_analytics.dim_products was not found in location US
  compiled code at target/run/digital_marketing/models/marts/_core_models.yml/not_null_dim_products_product_id.sql.
[0m16:12:36.354593 [info ] [Thread-1  ]: 4 of 41 START test not_null_dim_products_product_name .......................... [RUN]
[0m16:12:36.355165 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_dim_products_product_id.c8aba288d1, now test.digital_marketing.not_null_dim_products_product_name.991aec73f3)
[0m16:12:36.355518 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_dim_products_product_name.991aec73f3
[0m16:12:36.361513 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_dim_products_product_name.991aec73f3"
[0m16:12:36.362215 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_dim_products_product_name.991aec73f3
[0m16:12:36.367561 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_dim_products_product_name.991aec73f3"
[0m16:12:36.368293 [debug] [Thread-1  ]: On test.digital_marketing.not_null_dim_products_product_name.991aec73f3: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_dim_products_product_name.991aec73f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from `data-products-441119`.`dbt_dev_analytics`.`dim_products`
where product_name is null



  
  
      
    ) dbt_internal_test
[0m16:12:36.368650 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:12:37.008269 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:baba333a-1cf0-4dab-9e01-25237a89b695&page=queryresults
[0m16:12:37.010791 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:baba333a-1cf0-4dab-9e01-25237a89b695&page=queryresults
[0m16:12:37.038757 [debug] [Thread-1  ]: Database Error in test not_null_dim_products_product_name (models/marts/_core_models.yml)
  Not found: Table data-products-441119:dbt_dev_analytics.dim_products was not found in location US
  compiled code at target/run/digital_marketing/models/marts/_core_models.yml/not_null_dim_products_product_name.sql
[0m16:12:37.039765 [error] [Thread-1  ]: 4 of 41 ERROR not_null_dim_products_product_name ............................... [[31mERROR[0m in 0.68s]
[0m16:12:37.040535 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_dim_products_product_name.991aec73f3
[0m16:12:37.041092 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8
[0m16:12:37.041754 [debug] [Thread-4  ]: Marking all children of 'test.digital_marketing.not_null_dim_products_product_name.991aec73f3' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_products_product_name (models/marts/_core_models.yml)
  Not found: Table data-products-441119:dbt_dev_analytics.dim_products was not found in location US
  compiled code at target/run/digital_marketing/models/marts/_core_models.yml/not_null_dim_products_product_name.sql.
[0m16:12:37.042324 [info ] [Thread-1  ]: 5 of 41 START test not_null_dim_users_lifetime_value ........................... [RUN]
[0m16:12:37.043133 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_dim_products_product_name.991aec73f3, now test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8)
[0m16:12:37.043674 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8
[0m16:12:37.052412 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8"
[0m16:12:37.053338 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8
[0m16:12:37.059594 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8"
[0m16:12:37.060323 [debug] [Thread-1  ]: On test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lifetime_value
from `data-products-441119`.`dbt_dev_analytics`.`dim_users`
where lifetime_value is null



  
  
      
    ) dbt_internal_test
[0m16:12:37.060777 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:12:39.310260 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:71e0d34b-9902-403f-9c13-62dd405050bf&page=queryresults
[0m16:12:40.100516 [info ] [Thread-1  ]: 5 of 41 PASS not_null_dim_users_lifetime_value ................................. [[32mPASS[0m in 3.06s]
[0m16:12:40.102023 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8
[0m16:12:40.102822 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_dim_users_user_id.e754bb5812
[0m16:12:40.103700 [info ] [Thread-1  ]: 6 of 41 START test not_null_dim_users_user_id .................................. [RUN]
[0m16:12:40.104688 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8, now test.digital_marketing.not_null_dim_users_user_id.e754bb5812)
[0m16:12:40.105461 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_dim_users_user_id.e754bb5812
[0m16:12:40.117667 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_dim_users_user_id.e754bb5812"
[0m16:12:40.119118 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_dim_users_user_id.e754bb5812
[0m16:12:40.127503 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_dim_users_user_id.e754bb5812"
[0m16:12:40.128452 [debug] [Thread-1  ]: On test.digital_marketing.not_null_dim_users_user_id.e754bb5812: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_dim_users_user_id.e754bb5812"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `data-products-441119`.`dbt_dev_analytics`.`dim_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:12:40.129063 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:12:42.359947 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:99873679-9043-46c8-8b2c-4692a715d0df&page=queryresults
[0m16:12:43.217332 [info ] [Thread-1  ]: 6 of 41 PASS not_null_dim_users_user_id ........................................ [[32mPASS[0m in 3.11s]
[0m16:12:43.217901 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_dim_users_user_id.e754bb5812
[0m16:12:43.218203 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0
[0m16:12:43.218464 [info ] [Thread-1  ]: 7 of 41 START test not_null_fct_orders_order_id ................................ [RUN]
[0m16:12:43.218801 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_dim_users_user_id.e754bb5812, now test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0)
[0m16:12:43.219055 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0
[0m16:12:43.223818 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0"
[0m16:12:43.224800 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0
[0m16:12:43.228617 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0"
[0m16:12:43.229334 [debug] [Thread-1  ]: On test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `data-products-441119`.`dbt_dev_analytics`.`fct_orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:12:43.229646 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:12:44.757317 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:4eee05b8-45d8-401a-b08f-58430df6dd0d&page=queryresults
[0m16:12:45.363379 [info ] [Thread-1  ]: 7 of 41 PASS not_null_fct_orders_order_id ...................................... [[32mPASS[0m in 2.14s]
[0m16:12:45.365550 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0
[0m16:12:45.366388 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7
[0m16:12:45.367283 [info ] [Thread-1  ]: 8 of 41 START test not_null_fct_orders_user_id ................................. [RUN]
[0m16:12:45.368299 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0, now test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7)
[0m16:12:45.369084 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7
[0m16:12:45.382425 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7"
[0m16:12:45.383775 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7
[0m16:12:45.390883 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7"
[0m16:12:45.392166 [debug] [Thread-1  ]: On test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `data-products-441119`.`dbt_dev_analytics`.`fct_orders`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:12:45.392778 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:12:46.712428 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:4d62583b-1537-4794-ad40-9abfa3130798&page=queryresults
[0m16:12:47.338276 [info ] [Thread-1  ]: 8 of 41 PASS not_null_fct_orders_user_id ....................................... [[32mPASS[0m in 1.97s]
[0m16:12:47.339017 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7
[0m16:12:47.339414 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:12:47.339811 [info ] [Thread-1  ]: 9 of 41 START test not_null_stg_order_items_order_item_id ...................... [RUN]
[0m16:12:47.340271 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7, now test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m16:12:47.340596 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:12:47.346827 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m16:12:47.348346 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:12:47.352487 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m16:12:47.353401 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m16:12:47.353739 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:12:48.191253 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:90dc27c3-8cbd-417b-9ae3-7c93523d254f&page=queryresults
[0m16:12:48.794725 [info ] [Thread-1  ]: 9 of 41 PASS not_null_stg_order_items_order_item_id ............................ [[32mPASS[0m in 1.45s]
[0m16:12:48.795852 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:12:48.796591 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m16:12:48.797465 [info ] [Thread-1  ]: 10 of 41 START test not_null_stg_order_items_sale_price ........................ [RUN]
[0m16:12:48.798470 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0)
[0m16:12:48.799122 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m16:12:48.810556 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"
[0m16:12:48.811888 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m16:12:48.818567 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"
[0m16:12:48.819501 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sale_price
from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
where sale_price is null



  
  
      
    ) dbt_internal_test
[0m16:12:48.819818 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:12:49.665825 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:68e2cf1b-8f68-49f4-9e6e-0874c517e94a&page=queryresults
[0m16:12:50.208907 [info ] [Thread-1  ]: 10 of 41 PASS not_null_stg_order_items_sale_price .............................. [[32mPASS[0m in 1.41s]
[0m16:12:50.209537 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m16:12:50.209851 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m16:12:50.210194 [info ] [Thread-1  ]: 11 of 41 START test not_null_stg_orders_order_date ............................. [RUN]
[0m16:12:50.210593 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0, now test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb)
[0m16:12:50.210863 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m16:12:50.215895 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"
[0m16:12:50.217507 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m16:12:50.222073 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"
[0m16:12:50.222786 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
where order_date is null



  
  
      
    ) dbt_internal_test
[0m16:12:50.223113 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:12:51.703252 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:29f395d4-ea53-4a60-82f7-75f1b04e8d8b&page=queryresults
[0m16:12:52.238139 [info ] [Thread-1  ]: 11 of 41 PASS not_null_stg_orders_order_date ................................... [[32mPASS[0m in 2.03s]
[0m16:12:52.239450 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m16:12:52.240255 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m16:12:52.241144 [info ] [Thread-1  ]: 12 of 41 START test not_null_stg_orders_order_id ............................... [RUN]
[0m16:12:52.242148 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb, now test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64)
[0m16:12:52.242938 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m16:12:52.254599 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:12:52.256622 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m16:12:52.263968 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:12:52.265054 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:12:52.265638 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:12:53.387901 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:0da713ab-d712-4833-bb4d-e1400f70e8fb&page=queryresults
[0m16:12:53.986358 [info ] [Thread-1  ]: 12 of 41 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 1.74s]
[0m16:12:53.987719 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m16:12:53.988516 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m16:12:53.989371 [info ] [Thread-1  ]: 13 of 41 START test not_null_stg_orders_user_id ................................ [RUN]
[0m16:12:53.990347 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64, now test.digital_marketing.not_null_stg_orders_user_id.7d129d0209)
[0m16:12:53.991120 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m16:12:54.004456 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"
[0m16:12:54.006656 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m16:12:54.013825 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"
[0m16:12:54.015075 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_orders_user_id.7d129d0209: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:12:54.015706 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:12:55.159780 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:687e264d-4b9b-4091-87fd-748932106708&page=queryresults
[0m16:12:55.702869 [info ] [Thread-1  ]: 13 of 41 PASS not_null_stg_orders_user_id ...................................... [[32mPASS[0m in 1.71s]
[0m16:12:55.704189 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m16:12:55.704989 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m16:12:55.705869 [info ] [Thread-1  ]: 14 of 41 START test not_null_stg_products_product_id ........................... [RUN]
[0m16:12:55.706856 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_user_id.7d129d0209, now test.digital_marketing.not_null_stg_products_product_id.6373b0acf3)
[0m16:12:55.707627 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m16:12:55.720463 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"
[0m16:12:55.721767 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m16:12:55.728938 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"
[0m16:12:55.730069 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:12:55.730668 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:12:56.671681 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:16250ab0-df8f-44d6-b233-b6754c751c6a&page=queryresults
[0m16:12:57.247683 [info ] [Thread-1  ]: 14 of 41 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 1.54s]
[0m16:12:57.249079 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m16:12:57.249877 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m16:12:57.250766 [info ] [Thread-1  ]: 15 of 41 START test not_null_stg_users_email ................................... [RUN]
[0m16:12:57.251757 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_products_product_id.6373b0acf3, now test.digital_marketing.not_null_stg_users_email.2723c62e0e)
[0m16:12:57.252541 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m16:12:57.264898 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_email.2723c62e0e"
[0m16:12:57.266158 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m16:12:57.274113 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_email.2723c62e0e"
[0m16:12:57.275014 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_email.2723c62e0e: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_email.2723c62e0e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where email is null



  
  
      
    ) dbt_internal_test
[0m16:12:57.275594 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:12:58.101521 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:bba877a5-e9c7-4c75-8de6-e660ec0dcb87&page=queryresults
[0m16:12:58.664779 [info ] [Thread-1  ]: 15 of 41 PASS not_null_stg_users_email ......................................... [[32mPASS[0m in 1.41s]
[0m16:12:58.665719 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m16:12:58.666050 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m16:12:58.666372 [info ] [Thread-1  ]: 16 of 41 START test not_null_stg_users_user_id ................................. [RUN]
[0m16:12:58.666730 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_email.2723c62e0e, now test.digital_marketing.not_null_stg_users_user_id.980dfc1b77)
[0m16:12:58.666994 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m16:12:58.671676 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"
[0m16:12:58.673045 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m16:12:58.677903 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"
[0m16:12:58.678625 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:12:58.678965 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:12:59.635898 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:829c907e-b69e-4eb2-9028-060d22082330&page=queryresults
[0m16:13:00.179687 [info ] [Thread-1  ]: 16 of 41 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 1.51s]
[0m16:13:00.181059 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m16:13:00.181906 [debug] [Thread-1  ]: Began running node test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b
[0m16:13:00.182795 [info ] [Thread-1  ]: 17 of 41 START test relationships_fct_orders_user_id__user_id__ref_dim_users_ .. [RUN]
[0m16:13:00.183869 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_user_id.980dfc1b77, now test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b)
[0m16:13:00.184656 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b
[0m16:13:00.202753 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b"
[0m16:13:00.203911 [debug] [Thread-1  ]: Began executing node test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b
[0m16:13:00.210877 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b"
[0m16:13:00.211704 [debug] [Thread-1  ]: On test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from `data-products-441119`.`dbt_dev_analytics`.`fct_orders`
    where user_id is not null
),

parent as (
    select user_id as to_field
    from `data-products-441119`.`dbt_dev_analytics`.`dim_users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:13:00.212259 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:02.809564 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:50bfb892-273b-42b4-b9ae-8524cddbcc58&page=queryresults
[0m16:13:03.917728 [error] [Thread-1  ]: 17 of 41 FAIL 409 relationships_fct_orders_user_id__user_id__ref_dim_users_ .... [[31mFAIL 409[0m in 3.73s]
[0m16:13:03.918270 [debug] [Thread-1  ]: Finished running node test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b
[0m16:13:03.918566 [debug] [Thread-1  ]: Began running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m16:13:03.918833 [info ] [Thread-1  ]: 18 of 41 START test relationships_stg_orders_user_id__user_id__ref_stg_users_ .. [RUN]
[0m16:13:03.919185 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b, now test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737)
[0m16:13:03.919466 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m16:13:03.924435 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"
[0m16:13:03.924989 [debug] [Thread-1  ]: Began executing node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m16:13:03.929051 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"
[0m16:13:03.930206 [debug] [Thread-1  ]: On test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
    where user_id is not null
),

parent as (
    select user_id as to_field
    from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:13:03.930527 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:05.475435 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:7ab0cce0-45db-4044-837d-fe2c0010cd4e&page=queryresults
[0m16:13:06.302956 [error] [Thread-1  ]: 18 of 41 FAIL 16395 relationships_stg_orders_user_id__user_id__ref_stg_users_ .. [[31mFAIL 16395[0m in 2.38s]
[0m16:13:06.304359 [debug] [Thread-1  ]: Finished running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m16:13:06.305169 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265
[0m16:13:06.306043 [info ] [Thread-1  ]: 19 of 41 START test source_not_null_thelook_ecommerce_order_items_id ........... [RUN]
[0m16:13:06.307027 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737, now test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265)
[0m16:13:06.307815 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265
[0m16:13:06.320755 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265"
[0m16:13:06.322336 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265
[0m16:13:06.329589 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265"
[0m16:13:06.330796 [debug] [Thread-1  ]: On test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `bigquery-public-data`.`thelook_ecommerce`.`order_items`
where id is null



  
  
      
    ) dbt_internal_test
[0m16:13:06.331384 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:07.245296 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:e9006d8d-9bde-4223-8d41-e89de3e8c182&page=queryresults
[0m16:13:07.781685 [info ] [Thread-1  ]: 19 of 41 PASS source_not_null_thelook_ecommerce_order_items_id ................. [[32mPASS[0m in 1.47s]
[0m16:13:07.783011 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265
[0m16:13:07.783820 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50
[0m16:13:07.784673 [info ] [Thread-1  ]: 20 of 41 START test source_not_null_thelook_ecommerce_order_items_order_id ..... [RUN]
[0m16:13:07.785621 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265, now test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50)
[0m16:13:07.786483 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50
[0m16:13:07.799324 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50"
[0m16:13:07.800610 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50
[0m16:13:07.808098 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50"
[0m16:13:07.809210 [debug] [Thread-1  ]: On test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `bigquery-public-data`.`thelook_ecommerce`.`order_items`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:13:07.809800 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:08.650496 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:0820fa62-d937-4c97-92b3-2ce767b36277&page=queryresults
[0m16:13:09.231194 [info ] [Thread-1  ]: 20 of 41 PASS source_not_null_thelook_ecommerce_order_items_order_id ........... [[32mPASS[0m in 1.45s]
[0m16:13:09.232556 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50
[0m16:13:09.233360 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8
[0m16:13:09.234239 [info ] [Thread-1  ]: 21 of 41 START test source_not_null_thelook_ecommerce_orders_order_id .......... [RUN]
[0m16:13:09.235215 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50, now test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8)
[0m16:13:09.236002 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8
[0m16:13:09.247806 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8"
[0m16:13:09.249124 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8
[0m16:13:09.357940 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8"
[0m16:13:09.358614 [debug] [Thread-1  ]: On test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `bigquery-public-data`.`thelook_ecommerce`.`orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:13:09.358908 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:10.186752 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:e5c2b8a4-4c7e-42c9-a34c-743870bc537a&page=queryresults
[0m16:13:10.726510 [info ] [Thread-1  ]: 21 of 41 PASS source_not_null_thelook_ecommerce_orders_order_id ................ [[32mPASS[0m in 1.49s]
[0m16:13:10.727784 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8
[0m16:13:10.728583 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41
[0m16:13:10.729445 [info ] [Thread-1  ]: 22 of 41 START test source_not_null_thelook_ecommerce_orders_user_id ........... [RUN]
[0m16:13:10.730405 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8, now test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41)
[0m16:13:10.731197 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41
[0m16:13:10.742981 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41"
[0m16:13:10.744213 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41
[0m16:13:10.750909 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41"
[0m16:13:10.751814 [debug] [Thread-1  ]: On test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `bigquery-public-data`.`thelook_ecommerce`.`orders`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:13:10.752397 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:11.614923 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:ca1379a8-afa0-459a-b28b-0d23ffd6989e&page=queryresults
[0m16:13:12.232768 [info ] [Thread-1  ]: 22 of 41 PASS source_not_null_thelook_ecommerce_orders_user_id ................. [[32mPASS[0m in 1.50s]
[0m16:13:12.234035 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41
[0m16:13:12.234853 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8
[0m16:13:12.235720 [info ] [Thread-1  ]: 23 of 41 START test source_not_null_thelook_ecommerce_products_id .............. [RUN]
[0m16:13:12.236689 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41, now test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8)
[0m16:13:12.237473 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8
[0m16:13:12.248916 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8"
[0m16:13:12.250205 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8
[0m16:13:12.257272 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8"
[0m16:13:12.258202 [debug] [Thread-1  ]: On test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `bigquery-public-data`.`thelook_ecommerce`.`products`
where id is null



  
  
      
    ) dbt_internal_test
[0m16:13:12.258804 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:13.157803 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:309dce7c-3248-43d0-ac31-d7607d7806e3&page=queryresults
[0m16:13:13.771676 [info ] [Thread-1  ]: 23 of 41 PASS source_not_null_thelook_ecommerce_products_id .................... [[32mPASS[0m in 1.53s]
[0m16:13:13.772956 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8
[0m16:13:13.773756 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1
[0m16:13:13.774614 [info ] [Thread-1  ]: 24 of 41 START test source_not_null_thelook_ecommerce_users_created_at ......... [RUN]
[0m16:13:13.775568 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8, now test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1)
[0m16:13:13.776344 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1
[0m16:13:13.790073 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1"
[0m16:13:13.791391 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1
[0m16:13:13.798846 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1"
[0m16:13:13.800023 [debug] [Thread-1  ]: On test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select created_at
from `bigquery-public-data`.`thelook_ecommerce`.`users`
where created_at is null



  
  
      
    ) dbt_internal_test
[0m16:13:13.800595 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:14.795163 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:3c222a2f-6efa-4e21-bdab-5bfce254ebf7&page=queryresults
[0m16:13:15.372053 [info ] [Thread-1  ]: 24 of 41 PASS source_not_null_thelook_ecommerce_users_created_at ............... [[32mPASS[0m in 1.60s]
[0m16:13:15.373417 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1
[0m16:13:15.374235 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53
[0m16:13:15.375104 [info ] [Thread-1  ]: 25 of 41 START test source_not_null_thelook_ecommerce_users_email .............. [RUN]
[0m16:13:15.376074 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1, now test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53)
[0m16:13:15.376855 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53
[0m16:13:15.390316 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53"
[0m16:13:15.391548 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53
[0m16:13:15.398626 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53"
[0m16:13:15.399854 [debug] [Thread-1  ]: On test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from `bigquery-public-data`.`thelook_ecommerce`.`users`
where email is null



  
  
      
    ) dbt_internal_test
[0m16:13:15.400489 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:16.229131 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:fca44a1c-b95d-42df-8650-a5e2aa16b33a&page=queryresults
[0m16:13:16.841183 [info ] [Thread-1  ]: 25 of 41 PASS source_not_null_thelook_ecommerce_users_email .................... [[32mPASS[0m in 1.46s]
[0m16:13:16.842703 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53
[0m16:13:16.843513 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588
[0m16:13:16.844419 [info ] [Thread-1  ]: 26 of 41 START test source_not_null_thelook_ecommerce_users_id ................. [RUN]
[0m16:13:16.845407 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53, now test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588)
[0m16:13:16.846199 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588
[0m16:13:16.857766 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588"
[0m16:13:16.859086 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588
[0m16:13:16.867925 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588"
[0m16:13:16.869195 [debug] [Thread-1  ]: On test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `bigquery-public-data`.`thelook_ecommerce`.`users`
where id is null



  
  
      
    ) dbt_internal_test
[0m16:13:16.869816 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:17.768741 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:20b85d85-cb0a-452e-9ed1-5138b72b870e&page=queryresults
[0m16:13:18.326090 [info ] [Thread-1  ]: 26 of 41 PASS source_not_null_thelook_ecommerce_users_id ....................... [[32mPASS[0m in 1.48s]
[0m16:13:18.327382 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588
[0m16:13:18.328200 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c
[0m16:13:18.329118 [info ] [Thread-1  ]: 27 of 41 START test source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_  [RUN]
[0m16:13:18.330090 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588, now test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c)
[0m16:13:18.330885 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c
[0m16:13:18.344810 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c"
[0m16:13:18.346176 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c
[0m16:13:18.354583 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c"
[0m16:13:18.355725 [debug] [Thread-1  ]: On test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from `bigquery-public-data`.`thelook_ecommerce`.`order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `bigquery-public-data`.`thelook_ecommerce`.`orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:13:18.356348 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:19.292219 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:34940016-d504-43c8-b909-3a946338eba7&page=queryresults
[0m16:13:19.800349 [info ] [Thread-1  ]: 27 of 41 PASS source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_  [[32mPASS[0m in 1.47s]
[0m16:13:19.801874 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c
[0m16:13:19.802575 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d
[0m16:13:19.803315 [info ] [Thread-1  ]: 28 of 41 START test source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_  [RUN]
[0m16:13:19.804129 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c, now test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d)
[0m16:13:19.804792 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d
[0m16:13:19.816884 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d"
[0m16:13:19.818070 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d
[0m16:13:19.824034 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d"
[0m16:13:19.824870 [debug] [Thread-1  ]: On test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from `bigquery-public-data`.`thelook_ecommerce`.`orders`
    where user_id is not null
),

parent as (
    select id as to_field
    from `bigquery-public-data`.`thelook_ecommerce`.`users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:13:19.825401 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:20.837908 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:0c729edc-83d8-4a29-9dd5-99360b396a11&page=queryresults
[0m16:13:21.470862 [info ] [Thread-1  ]: 28 of 41 PASS source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_  [[32mPASS[0m in 1.67s]
[0m16:13:21.472229 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d
[0m16:13:21.473056 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c
[0m16:13:21.473919 [info ] [Thread-1  ]: 29 of 41 START test source_unique_thelook_ecommerce_order_items_id ............. [RUN]
[0m16:13:21.474885 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d, now test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c)
[0m16:13:21.475654 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c
[0m16:13:21.492821 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c"
[0m16:13:21.493980 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c
[0m16:13:21.500809 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c"
[0m16:13:21.501679 [debug] [Thread-1  ]: On test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `bigquery-public-data`.`thelook_ecommerce`.`order_items`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:13:21.502217 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:22.576002 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:bd8559ca-7f0c-49c9-a60b-388e43a1fbee&page=queryresults
[0m16:13:23.163186 [info ] [Thread-1  ]: 29 of 41 PASS source_unique_thelook_ecommerce_order_items_id ................... [[32mPASS[0m in 1.69s]
[0m16:13:23.164481 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c
[0m16:13:23.165299 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268
[0m16:13:23.166156 [info ] [Thread-1  ]: 30 of 41 START test source_unique_thelook_ecommerce_orders_order_id ............ [RUN]
[0m16:13:23.167119 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c, now test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268)
[0m16:13:23.167889 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268
[0m16:13:23.181146 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268"
[0m16:13:23.182398 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268
[0m16:13:23.189952 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268"
[0m16:13:23.191198 [debug] [Thread-1  ]: On test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `bigquery-public-data`.`thelook_ecommerce`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:13:23.191820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:24.215336 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:9b53da82-e4df-4388-9813-17cc7054988a&page=queryresults
[0m16:13:24.737642 [info ] [Thread-1  ]: 30 of 41 PASS source_unique_thelook_ecommerce_orders_order_id .................. [[32mPASS[0m in 1.57s]
[0m16:13:24.738390 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268
[0m16:13:24.738831 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd
[0m16:13:24.739300 [info ] [Thread-1  ]: 31 of 41 START test source_unique_thelook_ecommerce_products_id ................ [RUN]
[0m16:13:24.739824 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268, now test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd)
[0m16:13:24.740243 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd
[0m16:13:24.747614 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd"
[0m16:13:24.748465 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd
[0m16:13:24.754106 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd"
[0m16:13:24.754773 [debug] [Thread-1  ]: On test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `bigquery-public-data`.`thelook_ecommerce`.`products`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:13:24.755179 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:25.771456 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:79a8bcd4-f52c-4006-83cb-be2ba32e536f&page=queryresults
[0m16:13:26.319023 [info ] [Thread-1  ]: 31 of 41 PASS source_unique_thelook_ecommerce_products_id ...................... [[32mPASS[0m in 1.58s]
[0m16:13:26.320305 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd
[0m16:13:26.321112 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d
[0m16:13:26.321954 [info ] [Thread-1  ]: 32 of 41 START test source_unique_thelook_ecommerce_users_email ................ [RUN]
[0m16:13:26.322908 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd, now test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d)
[0m16:13:26.323682 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d
[0m16:13:26.335501 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d"
[0m16:13:26.336913 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d
[0m16:13:26.345221 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d"
[0m16:13:26.346351 [debug] [Thread-1  ]: On test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select email as unique_field
  from `bigquery-public-data`.`thelook_ecommerce`.`users`
  where email is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:13:26.346958 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:27.417196 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:2d36c9a9-04f9-4ddb-a61f-d43743e23127&page=queryresults
[0m16:13:27.943683 [error] [Thread-1  ]: 32 of 41 FAIL 10540 source_unique_thelook_ecommerce_users_email ................ [[31mFAIL 10540[0m in 1.62s]
[0m16:13:27.945012 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d
[0m16:13:27.945820 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6
[0m16:13:27.946683 [info ] [Thread-1  ]: 33 of 41 START test source_unique_thelook_ecommerce_users_id ................... [RUN]
[0m16:13:27.947617 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d, now test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6)
[0m16:13:27.948380 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6
[0m16:13:27.960158 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6"
[0m16:13:27.961496 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6
[0m16:13:27.968353 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6"
[0m16:13:27.969298 [debug] [Thread-1  ]: On test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `bigquery-public-data`.`thelook_ecommerce`.`users`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:13:27.969916 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:28.911111 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:c3276f92-8c55-435c-bc1a-022c8476f9e2&page=queryresults
[0m16:13:29.462907 [info ] [Thread-1  ]: 33 of 41 PASS source_unique_thelook_ecommerce_users_id ......................... [[32mPASS[0m in 1.51s]
[0m16:13:29.464363 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6
[0m16:13:29.465212 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_dim_products_product_id.ef7b2a9985
[0m16:13:29.466129 [info ] [Thread-1  ]: 34 of 41 START test unique_dim_products_product_id ............................. [RUN]
[0m16:13:29.467128 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6, now test.digital_marketing.unique_dim_products_product_id.ef7b2a9985)
[0m16:13:29.467922 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_dim_products_product_id.ef7b2a9985
[0m16:13:29.479821 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_dim_products_product_id.ef7b2a9985"
[0m16:13:29.481909 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_dim_products_product_id.ef7b2a9985
[0m16:13:29.488736 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_dim_products_product_id.ef7b2a9985"
[0m16:13:29.489689 [debug] [Thread-1  ]: On test.digital_marketing.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`dim_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:13:29.490271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:30.064015 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:363408f5-3397-4847-81ce-60d939345ce6&page=queryresults
[0m16:13:30.066203 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:363408f5-3397-4847-81ce-60d939345ce6&page=queryresults
[0m16:13:30.096083 [debug] [Thread-1  ]: Database Error in test unique_dim_products_product_id (models/marts/_core_models.yml)
  Not found: Table data-products-441119:dbt_dev_analytics.dim_products was not found in location US
  compiled code at target/run/digital_marketing/models/marts/_core_models.yml/unique_dim_products_product_id.sql
[0m16:13:30.097022 [error] [Thread-1  ]: 34 of 41 ERROR unique_dim_products_product_id .................................. [[31mERROR[0m in 0.63s]
[0m16:13:30.097795 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_dim_products_product_id.ef7b2a9985
[0m16:13:30.098341 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_dim_users_email.53417c09f1
[0m16:13:30.099039 [debug] [Thread-4  ]: Marking all children of 'test.digital_marketing.unique_dim_products_product_id.ef7b2a9985' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_products_product_id (models/marts/_core_models.yml)
  Not found: Table data-products-441119:dbt_dev_analytics.dim_products was not found in location US
  compiled code at target/run/digital_marketing/models/marts/_core_models.yml/unique_dim_products_product_id.sql.
[0m16:13:30.099598 [info ] [Thread-1  ]: 35 of 41 START test unique_dim_users_email ..................................... [RUN]
[0m16:13:30.100404 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_dim_products_product_id.ef7b2a9985, now test.digital_marketing.unique_dim_users_email.53417c09f1)
[0m16:13:30.100932 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_dim_users_email.53417c09f1
[0m16:13:30.110596 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_dim_users_email.53417c09f1"
[0m16:13:30.111558 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_dim_users_email.53417c09f1
[0m16:13:30.116925 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_dim_users_email.53417c09f1"
[0m16:13:30.117638 [debug] [Thread-1  ]: On test.digital_marketing.unique_dim_users_email.53417c09f1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_dim_users_email.53417c09f1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select email as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`dim_users`
  where email is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:13:30.118090 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:32.408440 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:04cc5d2d-f8d9-4151-9302-e75660c47b68&page=queryresults
[0m16:13:33.172008 [error] [Thread-1  ]: 35 of 41 FAIL 3573 unique_dim_users_email ...................................... [[31mFAIL 3573[0m in 3.07s]
[0m16:13:33.173295 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_dim_users_email.53417c09f1
[0m16:13:33.174085 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9
[0m16:13:33.174926 [info ] [Thread-1  ]: 36 of 41 START test unique_dim_users_user_id ................................... [RUN]
[0m16:13:33.175880 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_dim_users_email.53417c09f1, now test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9)
[0m16:13:33.176634 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9
[0m16:13:33.189611 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9"
[0m16:13:33.190898 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9
[0m16:13:33.198325 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9"
[0m16:13:33.199432 [debug] [Thread-1  ]: On test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`dim_users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:13:33.200039 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:35.275583 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:03bc49a9-9613-4a78-845d-60df3d55510a&page=queryresults
[0m16:13:36.109362 [info ] [Thread-1  ]: 36 of 41 PASS unique_dim_users_user_id ......................................... [[32mPASS[0m in 2.93s]
[0m16:13:36.110721 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9
[0m16:13:36.111534 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5
[0m16:13:36.112399 [info ] [Thread-1  ]: 37 of 41 START test unique_fct_orders_order_id ................................. [RUN]
[0m16:13:36.113368 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9, now test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5)
[0m16:13:36.114132 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5
[0m16:13:36.126001 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5"
[0m16:13:36.127411 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5
[0m16:13:36.136353 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5"
[0m16:13:36.137513 [debug] [Thread-1  ]: On test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`fct_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:13:36.138125 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:37.631081 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:e40b82cb-18b6-4132-b1a5-4f7d76e05120&page=queryresults
[0m16:13:38.159813 [info ] [Thread-1  ]: 37 of 41 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 2.05s]
[0m16:13:38.161155 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5
[0m16:13:38.161977 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m16:13:38.162851 [info ] [Thread-1  ]: 38 of 41 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m16:13:38.163821 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5, now test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108)
[0m16:13:38.164593 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m16:13:38.176245 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"
[0m16:13:38.178300 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m16:13:38.186954 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"
[0m16:13:38.188298 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_item_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
  where order_item_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:13:38.188892 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:39.007773 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:be382a5f-4ddd-4a3c-bd6c-93c4835bb26a&page=queryresults
[0m16:13:39.531065 [info ] [Thread-1  ]: 38 of 41 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 1.37s]
[0m16:13:39.532420 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m16:13:39.533218 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m16:13:39.534080 [info ] [Thread-1  ]: 39 of 41 START test unique_stg_orders_order_id ................................. [RUN]
[0m16:13:39.535038 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108, now test.digital_marketing.unique_stg_orders_order_id.e3b841c71a)
[0m16:13:39.535811 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m16:13:39.547515 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"
[0m16:13:39.549795 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m16:13:39.556762 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"
[0m16:13:39.557670 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:13:39.558267 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:40.805319 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:704cee74-66ff-4041-b135-e0df018b70fa&page=queryresults
[0m16:13:41.326540 [info ] [Thread-1  ]: 39 of 41 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 1.79s]
[0m16:13:41.327898 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m16:13:41.328706 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m16:13:41.329564 [info ] [Thread-1  ]: 40 of 41 START test unique_stg_products_product_id ............................. [RUN]
[0m16:13:41.330512 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_orders_order_id.e3b841c71a, now test.digital_marketing.unique_stg_products_product_id.7d950a1467)
[0m16:13:41.331274 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m16:13:41.344239 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_products_product_id.7d950a1467"
[0m16:13:41.345487 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m16:13:41.352512 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_products_product_id.7d950a1467"
[0m16:13:41.353851 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:13:41.354484 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:42.238765 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:9101a9fb-edc5-449d-a235-7733b2c087c6&page=queryresults
[0m16:13:42.711713 [info ] [Thread-1  ]: 40 of 41 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 1.38s]
[0m16:13:42.713033 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m16:13:42.713831 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m16:13:42.714692 [info ] [Thread-1  ]: 41 of 41 START test unique_stg_users_user_id ................................... [RUN]
[0m16:13:42.715658 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_products_product_id.7d950a1467, now test.digital_marketing.unique_stg_users_user_id.c2ff477e6b)
[0m16:13:42.716418 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m16:13:42.729076 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"
[0m16:13:42.731478 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m16:13:42.738575 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"
[0m16:13:42.739950 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:13:42.740572 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:43.587434 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:bec36cb1-102e-43a9-be3e-0a2427c9b354&page=queryresults
[0m16:13:44.156803 [info ] [Thread-1  ]: 41 of 41 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 1.44s]
[0m16:13:44.158351 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m16:13:44.160237 [info ] [MainThread]: 
[0m16:13:44.170668 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m16:13:44.171496 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m16:13:44.172334 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m16:13:44.173068 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m16:13:44.218225 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m16:13:44.225337 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m16:13:44.235148 [debug] [MainThread]: Elementary: Handling test results.
[0m16:13:44.422173 [debug] [MainThread]: Elementary: Deleting temporary Elementary test tables: []
[0m16:13:44.432905 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m16:13:44.433256 [debug] [MainThread]: Elementary: Handled test results successfully.
[0m16:13:44.442337 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m16:13:44.443702 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m16:13:44.444043 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.27s]
[0m16:13:44.444299 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:13:44.510196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:44.510494 [debug] [MainThread]: Connection 'list_data-products-441119_snapshot' was properly closed.
[0m16:13:44.510694 [debug] [MainThread]: Connection 'test.digital_marketing.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m16:13:44.510977 [info ] [MainThread]: 
[0m16:13:44.511209 [info ] [MainThread]: Finished running 5 project hooks, 41 data tests in 0 hours 1 minutes and 14.71 seconds (74.71s).
[0m16:13:44.514869 [debug] [MainThread]: Command end result
[0m16:13:44.577814 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m16:13:44.579811 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m16:13:44.585491 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m16:13:44.585764 [info ] [MainThread]: 
[0m16:13:44.586036 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m16:13:44.586265 [info ] [MainThread]: 
[0m16:13:44.586532 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_stg_users_age__120__13 (models/staging/_staging_models.yml)[0m
[0m16:13:44.586785 [error] [MainThread]:   Got 870 results, configured to fail if != 0
[0m16:13:44.586992 [info ] [MainThread]: 
[0m16:13:44.587233 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/dbt_utils_accepted_range_stg_users_age__120__13.sql
[0m16:13:44.587446 [info ] [MainThread]: 
[0m16:13:44.587690 [error] [MainThread]: [31mFailure in test not_null_dim_products_product_id (models/marts/_core_models.yml)[0m
[0m16:13:44.587938 [error] [MainThread]:   Database Error in test not_null_dim_products_product_id (models/marts/_core_models.yml)
  Not found: Table data-products-441119:dbt_dev_analytics.dim_products was not found in location US
  compiled code at target/run/digital_marketing/models/marts/_core_models.yml/not_null_dim_products_product_id.sql
[0m16:13:44.588151 [info ] [MainThread]: 
[0m16:13:44.588383 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/marts/_core_models.yml/not_null_dim_products_product_id.sql
[0m16:13:44.588590 [info ] [MainThread]: 
[0m16:13:44.588830 [error] [MainThread]: [31mFailure in test not_null_dim_products_product_name (models/marts/_core_models.yml)[0m
[0m16:13:44.589080 [error] [MainThread]:   Database Error in test not_null_dim_products_product_name (models/marts/_core_models.yml)
  Not found: Table data-products-441119:dbt_dev_analytics.dim_products was not found in location US
  compiled code at target/run/digital_marketing/models/marts/_core_models.yml/not_null_dim_products_product_name.sql
[0m16:13:44.589286 [info ] [MainThread]: 
[0m16:13:44.589518 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/marts/_core_models.yml/not_null_dim_products_product_name.sql
[0m16:13:44.589727 [info ] [MainThread]: 
[0m16:13:44.589967 [error] [MainThread]: [31mFailure in test relationships_fct_orders_user_id__user_id__ref_dim_users_ (models/marts/_core_models.yml)[0m
[0m16:13:44.590207 [error] [MainThread]:   Got 409 results, configured to fail if != 0
[0m16:13:44.590405 [info ] [MainThread]: 
[0m16:13:44.590848 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/marts/_core_models.yml/relationships_fct_orders_user_id__user_id__ref_dim_users_.sql
[0m16:13:44.591098 [info ] [MainThread]: 
[0m16:13:44.591367 [error] [MainThread]: [31mFailure in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)[0m
[0m16:13:44.591627 [error] [MainThread]:   Got 16395 results, configured to fail if != 0
[0m16:13:44.591836 [info ] [MainThread]: 
[0m16:13:44.592147 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql
[0m16:13:44.592416 [info ] [MainThread]: 
[0m16:13:44.592675 [error] [MainThread]: [31mFailure in test source_unique_thelook_ecommerce_users_email (models/staging/_sources.yml)[0m
[0m16:13:44.592939 [error] [MainThread]:   Got 10540 results, configured to fail if != 0
[0m16:13:44.593171 [info ] [MainThread]: 
[0m16:13:44.593413 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_sources.yml/source_unique_thelook_ecommerce_users_email.sql
[0m16:13:44.593694 [info ] [MainThread]: 
[0m16:13:44.593989 [error] [MainThread]: [31mFailure in test unique_dim_products_product_id (models/marts/_core_models.yml)[0m
[0m16:13:44.594263 [error] [MainThread]:   Database Error in test unique_dim_products_product_id (models/marts/_core_models.yml)
  Not found: Table data-products-441119:dbt_dev_analytics.dim_products was not found in location US
  compiled code at target/run/digital_marketing/models/marts/_core_models.yml/unique_dim_products_product_id.sql
[0m16:13:44.594492 [info ] [MainThread]: 
[0m16:13:44.594734 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/marts/_core_models.yml/unique_dim_products_product_id.sql
[0m16:13:44.594948 [info ] [MainThread]: 
[0m16:13:44.595191 [error] [MainThread]: [31mFailure in test unique_dim_users_email (models/marts/_core_models.yml)[0m
[0m16:13:44.595526 [error] [MainThread]:   Got 3573 results, configured to fail if != 0
[0m16:13:44.595787 [info ] [MainThread]: 
[0m16:13:44.596049 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/marts/_core_models.yml/unique_dim_users_email.sql
[0m16:13:44.596315 [info ] [MainThread]: 
[0m16:13:44.596552 [info ] [MainThread]: Done. PASS=38 WARN=0 ERROR=8 SKIP=0 NO-OP=0 TOTAL=46
[0m16:13:44.599613 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 77.627, "process_in_blocks": "0", "process_kernel_time": 0.749446, "process_mem_max_rss": "370049024", "process_out_blocks": "0", "process_user_time": 10.665435}
[0m16:13:44.599979 [debug] [MainThread]: Command `dbt test` failed at 16:13:44.599930 after 77.63 seconds
[0m16:13:44.600243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073abd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14319c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14323d730>]}
[0m16:13:44.600500 [debug] [MainThread]: Flushing usage events
[0m16:13:44.919241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:35:58.159302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037efd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cbe310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cbe5e0>]}


============================== 17:35:58.163358 | 8aa37d8c-5e8f-4d22-8f08-d6fe671ad612 ==============================
[0m17:35:58.163358 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:35:58.163761 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'printer_width': '80', 'target_path': 'None', 'version_check': 'True', 'partial_parse': 'True', 'log_format': 'default', 'debug': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/azadsolanki/.dbt', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt docs generate'}
[0m17:36:00.108030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8aa37d8c-5e8f-4d22-8f08-d6fe671ad612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118334550>]}
[0m17:36:00.146203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8aa37d8c-5e8f-4d22-8f08-d6fe671ad612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118344250>]}
[0m17:36:00.146688 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:36:00.342401 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m17:36:00.691748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:36:00.692073 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:36:00.698303 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.reports
- models.thelook_analytics.staging
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.intermediate
- models.thelook_analytics.marts.core
- models.thelook_analytics.marts.finance
- seeds.thelook_analytics.product_categories
- seeds.thelook_analytics.customer_segments
- snapshots.thelook_analytics
[0m17:36:00.760632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8aa37d8c-5e8f-4d22-8f08-d6fe671ad612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e27130>]}
[0m17:36:00.781479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8aa37d8c-5e8f-4d22-8f08-d6fe671ad612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a31130>]}
[0m17:36:00.781885 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 41 data tests, 6 sources, 1492 macros
[0m17:36:00.782137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8aa37d8c-5e8f-4d22-8f08-d6fe671ad612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a311c0>]}
[0m17:36:00.785316 [info ] [MainThread]: 
[0m17:36:00.785579 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:36:00.785798 [info ] [MainThread]: 
[0m17:36:00.786125 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:36:00.791379 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_dbt_dev_analytics'
[0m17:36:00.791759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:01.438812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev_analytics, now list_data-products-441119_snapshot)
[0m17:36:01.442046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:36:02.376333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8aa37d8c-5e8f-4d22-8f08-d6fe671ad612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a314c0>]}
[0m17:36:02.376950 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:36:02.463624 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_events
[0m17:36:02.464064 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_snapshot, now model.digital_marketing.stg_events)
[0m17:36:02.464336 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_events
[0m17:36:02.474362 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_events"
[0m17:36:02.475211 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_events
[0m17:36:02.475534 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:02.543536 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_events
[0m17:36:02.544305 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_order_items
[0m17:36:02.544865 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_events, now model.digital_marketing.stg_order_items)
[0m17:36:02.545156 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_order_items
[0m17:36:02.550485 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_order_items"
[0m17:36:02.552372 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_order_items
[0m17:36:02.552649 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:02.620239 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_order_items
[0m17:36:02.620581 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_orders
[0m17:36:02.620854 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_order_items, now model.digital_marketing.stg_orders)
[0m17:36:02.621097 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_orders
[0m17:36:02.626444 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_orders"
[0m17:36:02.627439 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_orders
[0m17:36:02.627825 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:02.696387 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_orders
[0m17:36:02.696747 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_products
[0m17:36:02.697020 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_orders, now model.digital_marketing.stg_products)
[0m17:36:02.697288 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_products
[0m17:36:02.701397 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_products"
[0m17:36:02.702083 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_products
[0m17:36:02.702389 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:02.770337 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_products
[0m17:36:02.770690 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_users
[0m17:36:02.770965 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_products, now model.digital_marketing.stg_users)
[0m17:36:02.771245 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_users
[0m17:36:02.776735 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_users"
[0m17:36:02.777788 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_users
[0m17:36:02.778112 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:02.845101 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_users
[0m17:36:02.845449 [debug] [Thread-1  ]: Began running node model.elementary.data_monitoring_metrics
[0m17:36:02.845720 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_users, now model.elementary.data_monitoring_metrics)
[0m17:36:02.845967 [debug] [Thread-1  ]: Began compiling node model.elementary.data_monitoring_metrics
[0m17:36:02.881744 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.data_monitoring_metrics"
[0m17:36:02.882542 [debug] [Thread-1  ]: Began executing node model.elementary.data_monitoring_metrics
[0m17:36:02.882841 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:02.948314 [debug] [Thread-1  ]: Finished running node model.elementary.data_monitoring_metrics
[0m17:36:02.948644 [debug] [Thread-1  ]: Began running node model.elementary.dbt_columns
[0m17:36:02.948914 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.data_monitoring_metrics, now model.elementary.dbt_columns)
[0m17:36:02.949156 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_columns
[0m17:36:02.958578 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_columns"
[0m17:36:02.959181 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_columns
[0m17:36:02.959456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:03.026389 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_columns
[0m17:36:03.026728 [debug] [Thread-1  ]: Began running node model.elementary.dbt_exposures
[0m17:36:03.027001 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_columns, now model.elementary.dbt_exposures)
[0m17:36:03.027245 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_exposures
[0m17:36:03.036575 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_exposures"
[0m17:36:03.037123 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_exposures
[0m17:36:03.037388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:03.103990 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_exposures
[0m17:36:03.104331 [debug] [Thread-1  ]: Began running node model.elementary.dbt_invocations
[0m17:36:03.104601 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_exposures, now model.elementary.dbt_invocations)
[0m17:36:03.104848 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_invocations
[0m17:36:03.119146 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_invocations"
[0m17:36:03.119739 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_invocations
[0m17:36:03.120016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:03.186977 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_invocations
[0m17:36:03.187333 [debug] [Thread-1  ]: Began running node model.elementary.dbt_metrics
[0m17:36:03.187619 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_invocations, now model.elementary.dbt_metrics)
[0m17:36:03.187877 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_metrics
[0m17:36:03.197674 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_metrics"
[0m17:36:03.198216 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_metrics
[0m17:36:03.198538 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:03.264737 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_metrics
[0m17:36:03.265052 [debug] [Thread-1  ]: Began running node model.elementary.dbt_models
[0m17:36:03.265402 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_metrics, now model.elementary.dbt_models)
[0m17:36:03.265733 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_models
[0m17:36:03.275684 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_models"
[0m17:36:03.276213 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_models
[0m17:36:03.276481 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:03.341929 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_models
[0m17:36:03.342252 [debug] [Thread-1  ]: Began running node model.elementary.dbt_run_results
[0m17:36:03.342517 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_models, now model.elementary.dbt_run_results)
[0m17:36:03.342768 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_run_results
[0m17:36:03.354900 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_run_results"
[0m17:36:03.355441 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_run_results
[0m17:36:03.355713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:03.420823 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_run_results
[0m17:36:03.421095 [debug] [Thread-1  ]: Began running node model.elementary.dbt_seeds
[0m17:36:03.421348 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_run_results, now model.elementary.dbt_seeds)
[0m17:36:03.421587 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_seeds
[0m17:36:03.430131 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_seeds"
[0m17:36:03.430611 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_seeds
[0m17:36:03.430873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:03.513712 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_seeds
[0m17:36:03.514140 [debug] [Thread-1  ]: Began running node model.elementary.dbt_snapshots
[0m17:36:03.514453 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_seeds, now model.elementary.dbt_snapshots)
[0m17:36:03.514712 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_snapshots
[0m17:36:03.522091 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_snapshots"
[0m17:36:03.522635 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_snapshots
[0m17:36:03.522922 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:03.589882 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_snapshots
[0m17:36:03.590237 [debug] [Thread-1  ]: Began running node model.elementary.dbt_source_freshness_results
[0m17:36:03.590511 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_snapshots, now model.elementary.dbt_source_freshness_results)
[0m17:36:03.590762 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_source_freshness_results
[0m17:36:03.599277 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_source_freshness_results"
[0m17:36:03.599955 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_source_freshness_results
[0m17:36:03.600258 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:03.666207 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_source_freshness_results
[0m17:36:03.666558 [debug] [Thread-1  ]: Began running node model.elementary.dbt_sources
[0m17:36:03.666835 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_source_freshness_results, now model.elementary.dbt_sources)
[0m17:36:03.667081 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_sources
[0m17:36:03.677160 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_sources"
[0m17:36:03.677714 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_sources
[0m17:36:03.677991 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:03.743405 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_sources
[0m17:36:03.743706 [debug] [Thread-1  ]: Began running node model.elementary.dbt_tests
[0m17:36:03.743972 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_sources, now model.elementary.dbt_tests)
[0m17:36:03.744213 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_tests
[0m17:36:03.754950 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_tests"
[0m17:36:03.755459 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_tests
[0m17:36:03.755722 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:03.820880 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_tests
[0m17:36:03.821165 [debug] [Thread-1  ]: Began running node model.elementary.elementary_test_results
[0m17:36:03.821421 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_tests, now model.elementary.elementary_test_results)
[0m17:36:03.821665 [debug] [Thread-1  ]: Began compiling node model.elementary.elementary_test_results
[0m17:36:03.832074 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.elementary_test_results"
[0m17:36:03.832593 [debug] [Thread-1  ]: Began executing node model.elementary.elementary_test_results
[0m17:36:03.832860 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:03.897996 [debug] [Thread-1  ]: Finished running node model.elementary.elementary_test_results
[0m17:36:03.898266 [debug] [Thread-1  ]: Began running node model.elementary.metadata
[0m17:36:03.898524 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.elementary_test_results, now model.elementary.metadata)
[0m17:36:03.898759 [debug] [Thread-1  ]: Began compiling node model.elementary.metadata
[0m17:36:03.904329 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.metadata"
[0m17:36:03.904898 [debug] [Thread-1  ]: Began executing node model.elementary.metadata
[0m17:36:03.905174 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:03.970469 [debug] [Thread-1  ]: Finished running node model.elementary.metadata
[0m17:36:03.970777 [debug] [Thread-1  ]: Began running node model.elementary.schema_columns_snapshot
[0m17:36:03.971038 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.metadata, now model.elementary.schema_columns_snapshot)
[0m17:36:03.971282 [debug] [Thread-1  ]: Began compiling node model.elementary.schema_columns_snapshot
[0m17:36:03.978052 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.schema_columns_snapshot"
[0m17:36:03.978673 [debug] [Thread-1  ]: Began executing node model.elementary.schema_columns_snapshot
[0m17:36:03.978939 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:04.044061 [debug] [Thread-1  ]: Finished running node model.elementary.schema_columns_snapshot
[0m17:36:04.044337 [debug] [Thread-1  ]: Began running node operation.digital_marketing.digital_marketing-on-run-end-0
[0m17:36:04.044591 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.schema_columns_snapshot, now operation.digital_marketing.digital_marketing-on-run-end-0)
[0m17:36:04.044829 [debug] [Thread-1  ]: Began compiling node operation.digital_marketing.digital_marketing-on-run-end-0
[0m17:36:04.048774 [info ] [Thread-1  ]: === DBT Run Completed Successfully ===
[0m17:36:04.049104 [debug] [Thread-1  ]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m17:36:04.049353 [debug] [Thread-1  ]: Began executing node operation.digital_marketing.digital_marketing-on-run-end-0
[0m17:36:04.049597 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:04.115936 [debug] [Thread-1  ]: Finished running node operation.digital_marketing.digital_marketing-on-run-end-0
[0m17:36:04.116309 [debug] [Thread-1  ]: Began running node operation.digital_marketing.digital_marketing-on-run-start-0
[0m17:36:04.116662 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly operation.digital_marketing.digital_marketing-on-run-end-0, now operation.digital_marketing.digital_marketing-on-run-start-0)
[0m17:36:04.116946 [debug] [Thread-1  ]: Began compiling node operation.digital_marketing.digital_marketing-on-run-start-0
[0m17:36:04.121085 [info ] [Thread-1  ]: === DBT Run Started at: 2025-09-11 00:35:58 ===
[0m17:36:04.121446 [debug] [Thread-1  ]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m17:36:04.121711 [debug] [Thread-1  ]: Began executing node operation.digital_marketing.digital_marketing-on-run-start-0
[0m17:36:04.121962 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:04.188146 [debug] [Thread-1  ]: Finished running node operation.digital_marketing.digital_marketing-on-run-start-0
[0m17:36:04.188488 [debug] [Thread-1  ]: Began running node operation.digital_marketing.digital_marketing-on-run-start-1
[0m17:36:04.188758 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly operation.digital_marketing.digital_marketing-on-run-start-0, now operation.digital_marketing.digital_marketing-on-run-start-1)
[0m17:36:04.189004 [debug] [Thread-1  ]: Began compiling node operation.digital_marketing.digital_marketing-on-run-start-1
[0m17:36:04.192544 [debug] [Thread-1  ]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m17:36:04.193204 [debug] [Thread-1  ]: Began executing node operation.digital_marketing.digital_marketing-on-run-start-1
[0m17:36:04.193451 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:04.258928 [debug] [Thread-1  ]: Finished running node operation.digital_marketing.digital_marketing-on-run-start-1
[0m17:36:04.259230 [debug] [Thread-1  ]: Began running node operation.elementary.elementary-on-run-end-0
[0m17:36:04.259487 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly operation.digital_marketing.digital_marketing-on-run-start-1, now operation.elementary.elementary-on-run-end-0)
[0m17:36:04.259726 [debug] [Thread-1  ]: Began compiling node operation.elementary.elementary-on-run-end-0
[0m17:36:04.267648 [debug] [Thread-1  ]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m17:36:04.268131 [debug] [Thread-1  ]: Began executing node operation.elementary.elementary-on-run-end-0
[0m17:36:04.268388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:04.333646 [debug] [Thread-1  ]: Finished running node operation.elementary.elementary-on-run-end-0
[0m17:36:04.333912 [debug] [Thread-1  ]: Began running node operation.elementary.elementary-on-run-start-0
[0m17:36:04.334164 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly operation.elementary.elementary-on-run-end-0, now operation.elementary.elementary-on-run-start-0)
[0m17:36:04.334402 [debug] [Thread-1  ]: Began compiling node operation.elementary.elementary-on-run-start-0
[0m17:36:04.344326 [debug] [Thread-1  ]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m17:36:04.344847 [debug] [Thread-1  ]: Began executing node operation.elementary.elementary-on-run-start-0
[0m17:36:04.345112 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:04.410223 [debug] [Thread-1  ]: Finished running node operation.elementary.elementary-on-run-start-0
[0m17:36:04.410494 [debug] [Thread-1  ]: Began running node seed.digital_marketing.customer_segments
[0m17:36:04.410751 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly operation.elementary.elementary-on-run-start-0, now seed.digital_marketing.customer_segments)
[0m17:36:04.410992 [debug] [Thread-1  ]: Began compiling node seed.digital_marketing.customer_segments
[0m17:36:04.414653 [debug] [Thread-1  ]: Began executing node seed.digital_marketing.customer_segments
[0m17:36:04.414920 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:04.493304 [debug] [Thread-1  ]: Finished running node seed.digital_marketing.customer_segments
[0m17:36:04.493691 [debug] [Thread-1  ]: Began running node seed.digital_marketing.product_categories
[0m17:36:04.494084 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.digital_marketing.customer_segments, now seed.digital_marketing.product_categories)
[0m17:36:04.494436 [debug] [Thread-1  ]: Began compiling node seed.digital_marketing.product_categories
[0m17:36:04.498128 [debug] [Thread-1  ]: Began executing node seed.digital_marketing.product_categories
[0m17:36:04.498495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:04.567274 [debug] [Thread-1  ]: Finished running node seed.digital_marketing.product_categories
[0m17:36:04.567634 [debug] [Thread-1  ]: Began running node snapshot.digital_marketing.snap_products
[0m17:36:04.567905 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.digital_marketing.product_categories, now snapshot.digital_marketing.snap_products)
[0m17:36:04.568150 [debug] [Thread-1  ]: Began compiling node snapshot.digital_marketing.snap_products
[0m17:36:04.572893 [debug] [Thread-1  ]: Began executing node snapshot.digital_marketing.snap_products
[0m17:36:04.573188 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:04.639849 [debug] [Thread-1  ]: Finished running node snapshot.digital_marketing.snap_products
[0m17:36:04.640194 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265
[0m17:36:04.640474 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.digital_marketing.snap_products, now test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265)
[0m17:36:04.640769 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265
[0m17:36:04.649841 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265"
[0m17:36:04.650985 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265
[0m17:36:04.651261 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:04.717067 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265
[0m17:36:04.717422 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50
[0m17:36:04.717697 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265, now test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50)
[0m17:36:04.717944 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50
[0m17:36:04.722350 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50"
[0m17:36:04.722863 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50
[0m17:36:04.723135 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:04.788236 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50
[0m17:36:04.788516 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8
[0m17:36:04.788772 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50, now test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8)
[0m17:36:04.789011 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8
[0m17:36:04.793900 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8"
[0m17:36:04.794447 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8
[0m17:36:04.794736 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:04.859732 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8
[0m17:36:04.860018 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41
[0m17:36:04.860282 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8, now test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41)
[0m17:36:04.860527 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41
[0m17:36:04.864751 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41"
[0m17:36:04.865608 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41
[0m17:36:04.865869 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:04.930802 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41
[0m17:36:04.931068 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8
[0m17:36:04.931324 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41, now test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8)
[0m17:36:04.931570 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8
[0m17:36:04.936232 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8"
[0m17:36:04.936712 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8
[0m17:36:04.936981 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:05.002025 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8
[0m17:36:05.002314 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1
[0m17:36:05.002575 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8, now test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1)
[0m17:36:05.002817 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1
[0m17:36:05.007086 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1"
[0m17:36:05.007554 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1
[0m17:36:05.007807 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:05.072751 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1
[0m17:36:05.073013 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53
[0m17:36:05.073265 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1, now test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53)
[0m17:36:05.073502 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53
[0m17:36:05.077673 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53"
[0m17:36:05.078117 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53
[0m17:36:05.078368 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:05.144190 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53
[0m17:36:05.144493 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588
[0m17:36:05.144759 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53, now test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588)
[0m17:36:05.145001 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588
[0m17:36:05.149146 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588"
[0m17:36:05.150391 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588
[0m17:36:05.150649 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:05.215740 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588
[0m17:36:05.216017 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c
[0m17:36:05.216281 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588, now test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c)
[0m17:36:05.216533 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c
[0m17:36:05.223283 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c"
[0m17:36:05.223756 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c
[0m17:36:05.224020 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:05.290323 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c
[0m17:36:05.290679 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d
[0m17:36:05.290973 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c, now test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d)
[0m17:36:05.291230 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d
[0m17:36:05.297483 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d"
[0m17:36:05.298139 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d
[0m17:36:05.298436 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:05.366394 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d
[0m17:36:05.366746 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c
[0m17:36:05.367030 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d, now test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c)
[0m17:36:05.367280 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c
[0m17:36:05.372977 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c"
[0m17:36:05.374219 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c
[0m17:36:05.374510 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:05.440761 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c
[0m17:36:05.441106 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268
[0m17:36:05.441389 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c, now test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268)
[0m17:36:05.441634 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268
[0m17:36:05.446428 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268"
[0m17:36:05.446960 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268
[0m17:36:05.447223 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:05.512443 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268
[0m17:36:05.512711 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd
[0m17:36:05.512965 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268, now test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd)
[0m17:36:05.513202 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd
[0m17:36:05.517489 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd"
[0m17:36:05.518014 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd
[0m17:36:05.518278 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:05.583264 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd
[0m17:36:05.583534 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d
[0m17:36:05.583790 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd, now test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d)
[0m17:36:05.584028 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d
[0m17:36:05.588244 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d"
[0m17:36:05.589746 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d
[0m17:36:05.590006 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:05.655123 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d
[0m17:36:05.655421 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6
[0m17:36:05.655685 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d, now test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6)
[0m17:36:05.655931 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6
[0m17:36:05.660738 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6"
[0m17:36:05.661978 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6
[0m17:36:05.662257 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:05.727423 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6
[0m17:36:05.727693 [debug] [Thread-1  ]: Began running node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m17:36:05.727951 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6, now test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde)
[0m17:36:05.728189 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m17:36:05.734987 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde"
[0m17:36:05.735946 [debug] [Thread-1  ]: Began executing node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m17:36:05.736202 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:05.802345 [debug] [Thread-1  ]: Finished running node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m17:36:05.802715 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m17:36:05.803077 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde, now test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m17:36:05.803336 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m17:36:05.808236 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m17:36:05.809007 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m17:36:05.809276 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:05.874733 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m17:36:05.875035 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m17:36:05.875303 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0)
[0m17:36:05.875546 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m17:36:05.879775 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"
[0m17:36:05.880929 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m17:36:05.881184 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:05.951085 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m17:36:05.951508 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m17:36:05.951831 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0, now test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108)
[0m17:36:05.952089 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m17:36:05.956432 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"
[0m17:36:05.957147 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m17:36:05.957425 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:06.025422 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m17:36:06.025790 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m17:36:06.026181 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108, now test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb)
[0m17:36:06.026462 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m17:36:06.031826 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"
[0m17:36:06.032504 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m17:36:06.032820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:06.104329 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m17:36:06.104719 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m17:36:06.105017 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb, now test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64)
[0m17:36:06.105298 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m17:36:06.111515 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:36:06.112237 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m17:36:06.112557 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:06.182889 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m17:36:06.183266 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m17:36:06.183659 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64, now test.digital_marketing.not_null_stg_orders_user_id.7d129d0209)
[0m17:36:06.183969 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m17:36:06.189289 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"
[0m17:36:06.190706 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m17:36:06.191004 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:06.257247 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m17:36:06.257578 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m17:36:06.257849 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_user_id.7d129d0209, now test.digital_marketing.unique_stg_orders_order_id.e3b841c71a)
[0m17:36:06.258232 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m17:36:06.262607 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"
[0m17:36:06.263426 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m17:36:06.263695 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:06.329827 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m17:36:06.330172 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m17:36:06.330450 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_orders_order_id.e3b841c71a, now test.digital_marketing.not_null_stg_products_product_id.6373b0acf3)
[0m17:36:06.330698 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m17:36:06.335137 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"
[0m17:36:06.335827 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m17:36:06.336108 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:06.402435 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m17:36:06.402826 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m17:36:06.403184 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_products_product_id.6373b0acf3, now test.digital_marketing.unique_stg_products_product_id.7d950a1467)
[0m17:36:06.403483 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m17:36:06.408556 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_products_product_id.7d950a1467"
[0m17:36:06.409109 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m17:36:06.409373 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:06.476109 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m17:36:06.476490 [debug] [Thread-1  ]: Began running node model.digital_marketing.int_order_items_enriched
[0m17:36:06.476791 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_products_product_id.7d950a1467, now model.digital_marketing.int_order_items_enriched)
[0m17:36:06.477043 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.int_order_items_enriched
[0m17:36:06.482113 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.int_order_items_enriched"
[0m17:36:06.482915 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:06.548446 [debug] [Thread-1  ]: Finished running node model.digital_marketing.int_order_items_enriched
[0m17:36:06.548767 [debug] [Thread-1  ]: Began running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m17:36:06.549032 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.int_order_items_enriched, now test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2)
[0m17:36:06.549279 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m17:36:06.647834 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"
[0m17:36:06.649069 [debug] [Thread-1  ]: Began executing node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m17:36:06.649348 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:06.715169 [debug] [Thread-1  ]: Finished running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m17:36:06.715485 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m17:36:06.715840 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2, now test.digital_marketing.not_null_stg_users_email.2723c62e0e)
[0m17:36:06.716126 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m17:36:06.720440 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_email.2723c62e0e"
[0m17:36:06.720954 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m17:36:06.721221 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:06.787376 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m17:36:06.787711 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m17:36:06.787986 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_email.2723c62e0e, now test.digital_marketing.not_null_stg_users_user_id.980dfc1b77)
[0m17:36:06.788226 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m17:36:06.792544 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"
[0m17:36:06.793300 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m17:36:06.793612 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:06.863496 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m17:36:06.863865 [debug] [Thread-1  ]: Began running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m17:36:06.864209 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_user_id.980dfc1b77, now test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737)
[0m17:36:06.864506 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m17:36:06.871195 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"
[0m17:36:06.871795 [debug] [Thread-1  ]: Began executing node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m17:36:06.872171 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:06.942685 [debug] [Thread-1  ]: Finished running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m17:36:06.943045 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m17:36:06.943373 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737, now test.digital_marketing.unique_stg_users_user_id.c2ff477e6b)
[0m17:36:06.943723 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m17:36:06.948642 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"
[0m17:36:06.950092 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m17:36:06.950396 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:07.018093 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m17:36:07.018439 [debug] [Thread-1  ]: Began running node model.elementary.metrics_anomaly_score
[0m17:36:07.018709 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_users_user_id.c2ff477e6b, now model.elementary.metrics_anomaly_score)
[0m17:36:07.018961 [debug] [Thread-1  ]: Began compiling node model.elementary.metrics_anomaly_score
[0m17:36:07.035889 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.metrics_anomaly_score"
[0m17:36:07.036542 [debug] [Thread-1  ]: Began executing node model.elementary.metrics_anomaly_score
[0m17:36:07.036818 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:07.103470 [debug] [Thread-1  ]: Finished running node model.elementary.metrics_anomaly_score
[0m17:36:07.103817 [debug] [Thread-1  ]: Began running node model.elementary.monitors_runs
[0m17:36:07.104084 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.metrics_anomaly_score, now model.elementary.monitors_runs)
[0m17:36:07.104326 [debug] [Thread-1  ]: Began compiling node model.elementary.monitors_runs
[0m17:36:07.108627 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.monitors_runs"
[0m17:36:07.109137 [debug] [Thread-1  ]: Began executing node model.elementary.monitors_runs
[0m17:36:07.109392 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:07.175437 [debug] [Thread-1  ]: Finished running node model.elementary.monitors_runs
[0m17:36:07.175775 [debug] [Thread-1  ]: Began running node model.elementary.job_run_results
[0m17:36:07.176091 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.monitors_runs, now model.elementary.job_run_results)
[0m17:36:07.176337 [debug] [Thread-1  ]: Began compiling node model.elementary.job_run_results
[0m17:36:07.183927 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.job_run_results"
[0m17:36:07.184532 [debug] [Thread-1  ]: Began executing node model.elementary.job_run_results
[0m17:36:07.184810 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:07.250091 [debug] [Thread-1  ]: Finished running node model.elementary.job_run_results
[0m17:36:07.250374 [debug] [Thread-1  ]: Began running node model.elementary.model_run_results
[0m17:36:07.250629 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.job_run_results, now model.elementary.model_run_results)
[0m17:36:07.250869 [debug] [Thread-1  ]: Began compiling node model.elementary.model_run_results
[0m17:36:07.256801 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.model_run_results"
[0m17:36:07.257303 [debug] [Thread-1  ]: Began executing node model.elementary.model_run_results
[0m17:36:07.257562 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:07.322729 [debug] [Thread-1  ]: Finished running node model.elementary.model_run_results
[0m17:36:07.322999 [debug] [Thread-1  ]: Began running node model.elementary.snapshot_run_results
[0m17:36:07.323247 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.model_run_results, now model.elementary.snapshot_run_results)
[0m17:36:07.323486 [debug] [Thread-1  ]: Began compiling node model.elementary.snapshot_run_results
[0m17:36:07.327567 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.snapshot_run_results"
[0m17:36:07.328045 [debug] [Thread-1  ]: Began executing node model.elementary.snapshot_run_results
[0m17:36:07.328299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:07.393530 [debug] [Thread-1  ]: Finished running node model.elementary.snapshot_run_results
[0m17:36:07.393829 [debug] [Thread-1  ]: Began running node model.elementary.alerts_dbt_source_freshness
[0m17:36:07.394086 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.snapshot_run_results, now model.elementary.alerts_dbt_source_freshness)
[0m17:36:07.394325 [debug] [Thread-1  ]: Began compiling node model.elementary.alerts_dbt_source_freshness
[0m17:36:07.400071 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.alerts_dbt_source_freshness"
[0m17:36:07.400653 [debug] [Thread-1  ]: Began executing node model.elementary.alerts_dbt_source_freshness
[0m17:36:07.400911 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:07.465975 [debug] [Thread-1  ]: Finished running node model.elementary.alerts_dbt_source_freshness
[0m17:36:07.466240 [debug] [Thread-1  ]: Began running node model.elementary.information_schema_columns
[0m17:36:07.466492 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.alerts_dbt_source_freshness, now model.elementary.information_schema_columns)
[0m17:36:07.466736 [debug] [Thread-1  ]: Began compiling node model.elementary.information_schema_columns
[0m17:36:07.481486 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:08.375060 [debug] [Thread-1  ]: On model.elementary.information_schema_columns: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.elementary.information_schema_columns"} */

    
    begin
      select 1
      from `bigquery-public-data`.`thelook_ecommerce`.INFORMATION_SCHEMA.COLUMNS
      limit 1;
    exception when error then
      select 0;
    end
  
  
[0m17:36:08.622120 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:0f0afd7e-adf2-4a4b-a5e4-af10c89f3b9d&page=queryresults
[0m17:36:09.677506 [debug] [Thread-1  ]: On model.elementary.information_schema_columns: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.elementary.information_schema_columns"} */

    
    begin
      select 1
      from `data-products-441119`.`dbt_dev_analytics`.INFORMATION_SCHEMA.COLUMNS
      limit 1;
    exception when error then
      select 0;
    end
  
  
[0m17:36:10.053544 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:d87873a7-4d55-40d4-83e6-567e38d1a289&page=queryresults
[0m17:36:11.248961 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.information_schema_columns"
[0m17:36:11.250484 [debug] [Thread-1  ]: Began executing node model.elementary.information_schema_columns
[0m17:36:11.257331 [debug] [Thread-1  ]: Finished running node model.elementary.information_schema_columns
[0m17:36:11.258075 [debug] [Thread-1  ]: Began running node model.elementary.dbt_artifacts_hashes
[0m17:36:11.258864 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.information_schema_columns, now model.elementary.dbt_artifacts_hashes)
[0m17:36:11.259661 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_artifacts_hashes
[0m17:36:11.271728 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_artifacts_hashes"
[0m17:36:11.272871 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_artifacts_hashes
[0m17:36:11.273449 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:11.357795 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_artifacts_hashes
[0m17:36:11.358160 [debug] [Thread-1  ]: Began running node model.elementary.alerts_anomaly_detection
[0m17:36:11.358445 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_artifacts_hashes, now model.elementary.alerts_anomaly_detection)
[0m17:36:11.358711 [debug] [Thread-1  ]: Began compiling node model.elementary.alerts_anomaly_detection
[0m17:36:11.364556 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.alerts_anomaly_detection"
[0m17:36:11.365109 [debug] [Thread-1  ]: Began executing node model.elementary.alerts_anomaly_detection
[0m17:36:11.365382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:11.430989 [debug] [Thread-1  ]: Finished running node model.elementary.alerts_anomaly_detection
[0m17:36:11.431312 [debug] [Thread-1  ]: Began running node model.elementary.alerts_dbt_tests
[0m17:36:11.431579 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.alerts_anomaly_detection, now model.elementary.alerts_dbt_tests)
[0m17:36:11.431820 [debug] [Thread-1  ]: Began compiling node model.elementary.alerts_dbt_tests
[0m17:36:11.437111 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.alerts_dbt_tests"
[0m17:36:11.437707 [debug] [Thread-1  ]: Began executing node model.elementary.alerts_dbt_tests
[0m17:36:11.437982 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:11.503662 [debug] [Thread-1  ]: Finished running node model.elementary.alerts_dbt_tests
[0m17:36:11.504004 [debug] [Thread-1  ]: Began running node model.elementary.alerts_schema_changes
[0m17:36:11.504274 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.alerts_dbt_tests, now model.elementary.alerts_schema_changes)
[0m17:36:11.504525 [debug] [Thread-1  ]: Began compiling node model.elementary.alerts_schema_changes
[0m17:36:11.510387 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.alerts_schema_changes"
[0m17:36:11.510995 [debug] [Thread-1  ]: Began executing node model.elementary.alerts_schema_changes
[0m17:36:11.511277 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:11.579402 [debug] [Thread-1  ]: Finished running node model.elementary.alerts_schema_changes
[0m17:36:11.579759 [debug] [Thread-1  ]: Began running node model.elementary.test_result_rows
[0m17:36:11.580028 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.alerts_schema_changes, now model.elementary.test_result_rows)
[0m17:36:11.580274 [debug] [Thread-1  ]: Began compiling node model.elementary.test_result_rows
[0m17:36:11.586261 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.test_result_rows"
[0m17:36:11.586802 [debug] [Thread-1  ]: Began executing node model.elementary.test_result_rows
[0m17:36:11.587066 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:11.652268 [debug] [Thread-1  ]: Finished running node model.elementary.test_result_rows
[0m17:36:11.652534 [debug] [Thread-1  ]: Began running node model.digital_marketing.fct_orders
[0m17:36:11.652783 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.test_result_rows, now model.digital_marketing.fct_orders)
[0m17:36:11.653017 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.fct_orders
[0m17:36:11.698615 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.fct_orders"
[0m17:36:11.700314 [debug] [Thread-1  ]: Began executing node model.digital_marketing.fct_orders
[0m17:36:11.700607 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:11.765865 [debug] [Thread-1  ]: Finished running node model.digital_marketing.fct_orders
[0m17:36:11.766137 [debug] [Thread-1  ]: Began running node model.digital_marketing.int_product_metrics
[0m17:36:11.766392 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.fct_orders, now model.digital_marketing.int_product_metrics)
[0m17:36:11.766629 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.int_product_metrics
[0m17:36:11.790598 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.int_product_metrics"
[0m17:36:11.792054 [debug] [Thread-1  ]: Began executing node model.digital_marketing.int_product_metrics
[0m17:36:11.792326 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:11.857575 [debug] [Thread-1  ]: Finished running node model.digital_marketing.int_product_metrics
[0m17:36:11.857882 [debug] [Thread-1  ]: Began running node model.digital_marketing.int_user_order_history
[0m17:36:11.858146 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.int_product_metrics, now model.digital_marketing.int_user_order_history)
[0m17:36:11.858388 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.int_user_order_history
[0m17:36:11.886035 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.int_user_order_history"
[0m17:36:11.887263 [debug] [Thread-1  ]: Began executing node model.digital_marketing.int_user_order_history
[0m17:36:11.887525 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:11.952623 [debug] [Thread-1  ]: Finished running node model.digital_marketing.int_user_order_history
[0m17:36:11.952917 [debug] [Thread-1  ]: Began running node model.elementary.anomaly_threshold_sensitivity
[0m17:36:11.953172 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.int_user_order_history, now model.elementary.anomaly_threshold_sensitivity)
[0m17:36:11.953410 [debug] [Thread-1  ]: Began compiling node model.elementary.anomaly_threshold_sensitivity
[0m17:36:11.960985 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.anomaly_threshold_sensitivity"
[0m17:36:11.961559 [debug] [Thread-1  ]: Began executing node model.elementary.anomaly_threshold_sensitivity
[0m17:36:11.961840 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:12.027214 [debug] [Thread-1  ]: Finished running node model.elementary.anomaly_threshold_sensitivity
[0m17:36:12.027527 [debug] [Thread-1  ]: Began running node model.elementary.alerts_dbt_models
[0m17:36:12.027797 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.anomaly_threshold_sensitivity, now model.elementary.alerts_dbt_models)
[0m17:36:12.028039 [debug] [Thread-1  ]: Began compiling node model.elementary.alerts_dbt_models
[0m17:36:12.033393 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.alerts_dbt_models"
[0m17:36:12.033933 [debug] [Thread-1  ]: Began executing node model.elementary.alerts_dbt_models
[0m17:36:12.034201 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:12.099567 [debug] [Thread-1  ]: Finished running node model.elementary.alerts_dbt_models
[0m17:36:12.099837 [debug] [Thread-1  ]: Began running node model.elementary.enriched_columns
[0m17:36:12.100096 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.alerts_dbt_models, now model.elementary.enriched_columns)
[0m17:36:12.100335 [debug] [Thread-1  ]: Began compiling node model.elementary.enriched_columns
[0m17:36:12.105118 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.enriched_columns"
[0m17:36:12.105606 [debug] [Thread-1  ]: Began executing node model.elementary.enriched_columns
[0m17:36:12.105873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:12.171177 [debug] [Thread-1  ]: Finished running node model.elementary.enriched_columns
[0m17:36:12.171457 [debug] [Thread-1  ]: Began running node model.digital_marketing.fct_daily_revenue
[0m17:36:12.171713 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.enriched_columns, now model.digital_marketing.fct_daily_revenue)
[0m17:36:12.171949 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.fct_daily_revenue
[0m17:36:12.176910 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.fct_daily_revenue"
[0m17:36:12.177806 [debug] [Thread-1  ]: Began executing node model.digital_marketing.fct_daily_revenue
[0m17:36:12.178084 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:12.243251 [debug] [Thread-1  ]: Finished running node model.digital_marketing.fct_daily_revenue
[0m17:36:12.243543 [debug] [Thread-1  ]: Began running node model.digital_marketing.rpt_customer_cohorts
[0m17:36:12.243806 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.fct_daily_revenue, now model.digital_marketing.rpt_customer_cohorts)
[0m17:36:12.244045 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.rpt_customer_cohorts
[0m17:36:12.248092 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.rpt_customer_cohorts"
[0m17:36:12.248620 [debug] [Thread-1  ]: Began executing node model.digital_marketing.rpt_customer_cohorts
[0m17:36:12.248875 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:12.313979 [debug] [Thread-1  ]: Finished running node model.digital_marketing.rpt_customer_cohorts
[0m17:36:12.314247 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0
[0m17:36:12.314502 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.rpt_customer_cohorts, now test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0)
[0m17:36:12.314737 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0
[0m17:36:12.319642 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0"
[0m17:36:12.320384 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0
[0m17:36:12.320658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:12.385736 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0
[0m17:36:12.386004 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7
[0m17:36:12.386339 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0, now test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7)
[0m17:36:12.386580 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7
[0m17:36:12.390735 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7"
[0m17:36:12.391192 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7
[0m17:36:12.391445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:12.456461 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7
[0m17:36:12.456730 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5
[0m17:36:12.456980 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7, now test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5)
[0m17:36:12.457217 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5
[0m17:36:12.461780 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5"
[0m17:36:12.462450 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5
[0m17:36:12.462717 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:12.528230 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5
[0m17:36:12.528554 [debug] [Thread-1  ]: Began running node model.digital_marketing.dim_products
[0m17:36:12.528820 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5, now model.digital_marketing.dim_products)
[0m17:36:12.529058 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.dim_products
[0m17:36:12.533088 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.dim_products"
[0m17:36:12.533579 [debug] [Thread-1  ]: Began executing node model.digital_marketing.dim_products
[0m17:36:12.533834 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:12.599707 [debug] [Thread-1  ]: Finished running node model.digital_marketing.dim_products
[0m17:36:12.600055 [debug] [Thread-1  ]: Began running node model.digital_marketing.dim_users
[0m17:36:12.600316 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.dim_products, now model.digital_marketing.dim_users)
[0m17:36:12.600560 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.dim_users
[0m17:36:12.605198 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.dim_users"
[0m17:36:12.605761 [debug] [Thread-1  ]: Began executing node model.digital_marketing.dim_users
[0m17:36:12.606022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:12.671898 [debug] [Thread-1  ]: Finished running node model.digital_marketing.dim_users
[0m17:36:12.672223 [debug] [Thread-1  ]: Began running node model.digital_marketing.rpt_product_performance
[0m17:36:12.672498 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.dim_users, now model.digital_marketing.rpt_product_performance)
[0m17:36:12.672743 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.rpt_product_performance
[0m17:36:12.677475 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.rpt_product_performance"
[0m17:36:12.678083 [debug] [Thread-1  ]: Began executing node model.digital_marketing.rpt_product_performance
[0m17:36:12.678383 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:12.744375 [debug] [Thread-1  ]: Finished running node model.digital_marketing.rpt_product_performance
[0m17:36:12.744708 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_dim_products_product_id.c8aba288d1
[0m17:36:12.744975 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.rpt_product_performance, now test.digital_marketing.not_null_dim_products_product_id.c8aba288d1)
[0m17:36:12.745224 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_dim_products_product_id.c8aba288d1
[0m17:36:12.749718 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_dim_products_product_id.c8aba288d1"
[0m17:36:12.751048 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_dim_products_product_id.c8aba288d1
[0m17:36:12.751322 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:12.816885 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_dim_products_product_id.c8aba288d1
[0m17:36:12.817194 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_dim_products_product_name.991aec73f3
[0m17:36:12.817459 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_dim_products_product_id.c8aba288d1, now test.digital_marketing.not_null_dim_products_product_name.991aec73f3)
[0m17:36:12.817697 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_dim_products_product_name.991aec73f3
[0m17:36:12.822475 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_dim_products_product_name.991aec73f3"
[0m17:36:12.823005 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_dim_products_product_name.991aec73f3
[0m17:36:12.823292 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:12.888938 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_dim_products_product_name.991aec73f3
[0m17:36:12.889255 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_dim_products_product_id.ef7b2a9985
[0m17:36:12.889530 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_dim_products_product_name.991aec73f3, now test.digital_marketing.unique_dim_products_product_id.ef7b2a9985)
[0m17:36:12.889804 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_dim_products_product_id.ef7b2a9985
[0m17:36:12.894191 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_dim_products_product_id.ef7b2a9985"
[0m17:36:12.894751 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_dim_products_product_id.ef7b2a9985
[0m17:36:12.895029 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:12.960877 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_dim_products_product_id.ef7b2a9985
[0m17:36:12.961219 [debug] [Thread-1  ]: Began running node model.digital_marketing.rpt_executive_dashboard
[0m17:36:12.961486 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_dim_products_product_id.ef7b2a9985, now model.digital_marketing.rpt_executive_dashboard)
[0m17:36:12.961731 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.rpt_executive_dashboard
[0m17:36:12.966230 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.rpt_executive_dashboard"
[0m17:36:12.966949 [debug] [Thread-1  ]: Began executing node model.digital_marketing.rpt_executive_dashboard
[0m17:36:12.967233 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:13.032948 [debug] [Thread-1  ]: Finished running node model.digital_marketing.rpt_executive_dashboard
[0m17:36:13.033264 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8
[0m17:36:13.033527 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.rpt_executive_dashboard, now test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8)
[0m17:36:13.033765 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8
[0m17:36:13.038762 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8"
[0m17:36:13.039345 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8
[0m17:36:13.039601 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:13.105079 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8
[0m17:36:13.105379 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_dim_users_user_id.e754bb5812
[0m17:36:13.105640 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8, now test.digital_marketing.not_null_dim_users_user_id.e754bb5812)
[0m17:36:13.105878 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_dim_users_user_id.e754bb5812
[0m17:36:13.110707 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_dim_users_user_id.e754bb5812"
[0m17:36:13.111207 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_dim_users_user_id.e754bb5812
[0m17:36:13.111467 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:13.176564 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_dim_users_user_id.e754bb5812
[0m17:36:13.176829 [debug] [Thread-1  ]: Began running node test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b
[0m17:36:13.177083 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_dim_users_user_id.e754bb5812, now test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b)
[0m17:36:13.177319 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b
[0m17:36:13.182469 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b"
[0m17:36:13.183171 [debug] [Thread-1  ]: Began executing node test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b
[0m17:36:13.183442 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:13.248675 [debug] [Thread-1  ]: Finished running node test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b
[0m17:36:13.248955 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_dim_users_email.53417c09f1
[0m17:36:13.249211 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b, now test.digital_marketing.unique_dim_users_email.53417c09f1)
[0m17:36:13.249449 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_dim_users_email.53417c09f1
[0m17:36:13.253751 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_dim_users_email.53417c09f1"
[0m17:36:13.254228 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_dim_users_email.53417c09f1
[0m17:36:13.254481 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:13.319583 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_dim_users_email.53417c09f1
[0m17:36:13.319858 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9
[0m17:36:13.320117 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_dim_users_email.53417c09f1, now test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9)
[0m17:36:13.320352 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9
[0m17:36:13.324437 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9"
[0m17:36:13.324887 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9
[0m17:36:13.325136 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:36:13.390238 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9
[0m17:36:13.390829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:13.391075 [debug] [MainThread]: Connection 'test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9' was properly closed.
[0m17:36:13.397215 [debug] [MainThread]: Command end result
[0m17:36:13.538136 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:36:13.539737 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:36:13.547524 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m17:36:13.549664 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m17:36:13.549913 [info ] [MainThread]: Building catalog
[0m17:36:13.557647 [debug] [ThreadPool]: Acquiring new bigquery connection 'data-products-441119.information_schema'
[0m17:36:13.568924 [debug] [ThreadPool]: On data-products-441119.information_schema: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "data-products-441119.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `data-products-441119`.`dbt_dev_analytics`.__TABLES__ tables
    left join `data-products-441119`.`dbt_dev_analytics`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `data-products-441119`.`dbt_dev_analytics`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_seeds')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_columns')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('elementary_test_results')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('job_run_results')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('alerts_anomaly_detection')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dim_users')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('metrics_anomaly_score')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('int_product_metrics')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_run_results')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('alerts_schema_changes')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('alerts_dbt_tests')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('schema_columns_snapshot')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('stg_products')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_source_freshness_results')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('int_user_order_history')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('customer_segments')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('rpt_product_performance')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('alerts_dbt_source_freshness')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('metadata')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('stg_events')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('monitors_runs')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('data_monitoring_metrics')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_models')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('stg_orders')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_invocations')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('stg_users')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('product_categories')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('alerts_dbt_models')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('anomaly_threshold_sensitivity')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('fct_orders')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('rpt_customer_cohorts')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('stg_order_items')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_tests')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dim_products')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('fct_daily_revenue')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_sources')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_metrics')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_artifacts_hashes')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('test_result_rows')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_exposures')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_snapshots')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('enriched_columns')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('rpt_executive_dashboard')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('model_run_results')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('information_schema_columns')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('snapshot_run_results')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `data-products-441119`.`dbt_dev_analytics`.INFORMATION_SCHEMA.COLUMNS columns
    join `data-products-441119`.`dbt_dev_analytics`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m17:36:13.569711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:14.393956 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:02efde4b-d040-4e67-9760-7f01a1514fad&page=queryresults
[0m17:36:16.379618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly data-products-441119.information_schema, now bigquery-public-data.information_schema)
[0m17:36:16.384713 [debug] [ThreadPool]: On bigquery-public-data.information_schema: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "bigquery-public-data.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `bigquery-public-data`.`thelook_ecommerce`.__TABLES__ tables
    left join `bigquery-public-data`.`thelook_ecommerce`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `bigquery-public-data`.`thelook_ecommerce`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('thelook_ecommerce')
                            and upper(table_name) = upper('events')
                            ) or (
                                upper(table_schema) = upper('thelook_ecommerce')
                            and upper(table_name) = upper('orders')
                            ) or (
                                upper(table_schema) = upper('thelook_ecommerce')
                            and upper(table_name) = upper('products')
                            ) or (
                                upper(table_schema) = upper('thelook_ecommerce')
                            and upper(table_name) = upper('order_items')
                            ) or (
                                upper(table_schema) = upper('thelook_ecommerce')
                            and upper(table_name) = upper('inventory_items')
                            ) or (
                                upper(table_schema) = upper('thelook_ecommerce')
                            and upper(table_name) = upper('users')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `bigquery-public-data`.`thelook_ecommerce`.INFORMATION_SCHEMA.COLUMNS columns
    join `bigquery-public-data`.`thelook_ecommerce`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m17:36:16.385404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:36:17.091243 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:3e64af20-16ed-42ce-b8a2-a4d57dadce97&page=queryresults
[0m17:36:19.644842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly bigquery-public-data.information_schema, now data-products-441119.information_schema)
[0m17:36:19.649739 [debug] [ThreadPool]: On data-products-441119.information_schema: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "data-products-441119.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `data-products-441119`.`snapshot`.__TABLES__ tables
    left join `data-products-441119`.`snapshot`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `data-products-441119`.`snapshot`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('snapshot')
                            and upper(table_name) = upper('snap_products')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `data-products-441119`.`snapshot`.INFORMATION_SCHEMA.COLUMNS columns
    join `data-products-441119`.`snapshot`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m17:36:19.650476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:36:20.242934 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:bf967a17-008f-42fd-b929-9546f41edb6c&page=queryresults
[0m17:36:20.244262 [error] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:bf967a17-008f-42fd-b929-9546f41edb6c&page=queryresults
[0m17:36:20.245252 [debug] [ThreadPool]: BigQuery adapter: Unhandled error while running:
macro get_catalog_relations
[0m17:36:20.245888 [debug] [ThreadPool]: BigQuery adapter: Database Error
  Not found: Dataset data-products-441119:snapshot was not found in location US
[0m17:36:20.252145 [warn ] [MainThread]: Encountered an error while generating catalog: Database Error
  Not found: Dataset data-products-441119:snapshot was not found in location US
[0m17:36:20.351405 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:36:20.434892 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/catalog.json
[0m17:36:20.499028 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m17:36:20.501509 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m17:36:20.501790 [error] [MainThread]: dbt encountered 1 failure while writing the catalog
[0m17:36:20.502030 [info ] [MainThread]: Catalog written to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/catalog.json
[0m17:36:20.505716 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 22.40651, "process_in_blocks": "0", "process_kernel_time": 0.56385, "process_mem_max_rss": "375865344", "process_out_blocks": "0", "process_user_time": 11.10737}
[0m17:36:20.506180 [debug] [MainThread]: Command `dbt docs generate` failed at 17:36:20.506124 after 22.41 seconds
[0m17:36:20.506418 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:36:20.506630 [debug] [MainThread]: Connection 'data-products-441119.information_schema' was properly closed.
[0m17:36:20.506859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037efd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e66580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a31880>]}
[0m17:36:20.507241 [debug] [MainThread]: Flushing usage events
[0m17:36:20.919063 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:24:21.291030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105853d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d22190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d22460>]}


============================== 22:24:21.294636 | 334268e8-9e05-46f5-a418-dea14730f444 ==============================
[0m22:24:21.294636 [info ] [MainThread]: Running with dbt=1.10.10
[0m22:24:21.295018 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'version_check': 'True', 'printer_width': '80', 'write_json': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'cache_selected_only': 'False', 'quiet': 'False'}
[0m22:24:23.760978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '334268e8-9e05-46f5-a418-dea14730f444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a334130>]}
[0m22:24:23.799091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '334268e8-9e05-46f5-a418-dea14730f444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ddc70>]}
[0m22:24:23.799560 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:24:24.002502 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m22:24:24.361438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:24:24.361761 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:24:24.368225 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.marts.core
- models.thelook_analytics.staging
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.intermediate
- models.thelook_analytics.marts.finance
- models.thelook_analytics.reports
- seeds.thelook_analytics.product_categories
- seeds.thelook_analytics.customer_segments
- snapshots.thelook_analytics
[0m22:24:24.433827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '334268e8-9e05-46f5-a418-dea14730f444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae28130>]}
[0m22:24:24.576517 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:24:24.579070 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:24:24.603797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '334268e8-9e05-46f5-a418-dea14730f444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae0edf0>]}
[0m22:24:24.604232 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 41 data tests, 6 sources, 1492 macros
[0m22:24:24.604481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '334268e8-9e05-46f5-a418-dea14730f444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a4e21f0>]}
[0m22:24:24.607112 [info ] [MainThread]: 
[0m22:24:24.607377 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:24:24.607593 [info ] [MainThread]: 
[0m22:24:24.607927 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:24:24.613427 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_dbt_dev_analytics'
[0m22:24:24.614182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:25.273522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev_analytics, now list_data-products-441119_snapshot)
[0m22:24:25.276830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:25.965251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '334268e8-9e05-46f5-a418-dea14730f444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae0ebe0>]}
[0m22:24:25.989721 [info ] [MainThread]: === DBT Run Started at: 2025-09-16 05:24:21 ===
[0m22:24:25.990520 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m22:24:25.994228 [info ] [MainThread]: 1 of 3 START hook: digital_marketing.on-run-start.0 ............................ [RUN]
[0m22:24:25.995123 [info ] [MainThread]: 1 of 3 OK hook: digital_marketing.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m22:24:26.001822 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m22:24:26.003619 [info ] [MainThread]: 2 of 3 START hook: digital_marketing.on-run-start.1 ............................ [RUN]
[0m22:24:26.004309 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "master"} */
select 1
[0m22:24:26.004856 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:24:26.881766 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:7f358de9-9334-44d3-8de3-4451ac76bcfa&page=queryresults
[0m22:24:27.368110 [info ] [MainThread]: 2 of 3 OK hook: digital_marketing.on-run-start.1 ............................... [[32mOK[0m in 1.37s]
[0m22:24:27.771475 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m22:24:27.774520 [info ] [MainThread]: 3 of 3 START hook: elementary.on-run-start.2 ................................... [RUN]
[0m22:24:27.775486 [info ] [MainThread]: 3 of 3 OK hook: elementary.on-run-start.2 ...................................... [[32mOK[0m in 0.41s]
[0m22:24:27.776160 [info ] [MainThread]: 
[0m22:24:27.787783 [debug] [Thread-1  ]: Began running node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m22:24:27.788717 [info ] [Thread-1  ]: 1 of 41 START test dbt_utils_accepted_range_stg_order_items_sale_price__10000__0  [RUN]
[0m22:24:27.789717 [debug] [Thread-1  ]: Acquiring new bigquery connection 'test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde'
[0m22:24:27.790348 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m22:24:27.809775 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde"
[0m22:24:27.811187 [debug] [Thread-1  ]: Began executing node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m22:24:27.837070 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde"
[0m22:24:27.838209 [debug] [Thread-1  ]: On test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sale_price >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sale_price <= 10000
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m22:24:27.838646 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:24:29.256997 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:a90f6d53-3b40-4ca6-905c-a843339ebb56&page=queryresults
[0m22:24:29.916809 [info ] [Thread-1  ]: 1 of 41 PASS dbt_utils_accepted_range_stg_order_items_sale_price__10000__0 ..... [[32mPASS[0m in 2.13s]
[0m22:24:29.918091 [debug] [Thread-1  ]: Finished running node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m22:24:29.918913 [debug] [Thread-1  ]: Began running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:24:29.919803 [info ] [Thread-1  ]: 2 of 41 START test dbt_utils_accepted_range_stg_users_age__120__13 ............. [RUN]
[0m22:24:29.920623 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde, now test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2)
[0m22:24:29.921272 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:24:29.933784 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"
[0m22:24:29.935015 [debug] [Thread-1  ]: Began executing node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:24:29.941896 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"
[0m22:24:29.943098 [debug] [Thread-1  ]: On test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not age >= 13
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not age <= 120
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m22:24:29.943647 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:31.258351 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:58f85c67-baa4-4ab9-8e27-75b5da526016&page=queryresults
[0m22:24:31.834702 [error] [Thread-1  ]: 2 of 41 FAIL 820 dbt_utils_accepted_range_stg_users_age__120__13 ............... [[31mFAIL 820[0m in 1.91s]
[0m22:24:31.836083 [debug] [Thread-1  ]: Finished running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:24:31.836880 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_dim_products_product_id.c8aba288d1
[0m22:24:31.837751 [info ] [Thread-1  ]: 3 of 41 START test not_null_dim_products_product_id ............................ [RUN]
[0m22:24:31.838723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2, now test.digital_marketing.not_null_dim_products_product_id.c8aba288d1)
[0m22:24:31.839493 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_dim_products_product_id.c8aba288d1
[0m22:24:31.856071 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_dim_products_product_id.c8aba288d1"
[0m22:24:31.858482 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_dim_products_product_id.c8aba288d1
[0m22:24:31.865214 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_dim_products_product_id.c8aba288d1"
[0m22:24:31.866545 [debug] [Thread-1  ]: On test.digital_marketing.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `data-products-441119`.`dbt_dev_analytics`.`dim_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m22:24:31.867071 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:32.722364 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:3f0b380a-fa52-4dfa-9f62-975b57f1c300&page=queryresults
[0m22:24:32.724726 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:3f0b380a-fa52-4dfa-9f62-975b57f1c300&page=queryresults
[0m22:24:32.787742 [debug] [Thread-1  ]: Database Error in test not_null_dim_products_product_id (models/marts/_core_models.yml)
  Not found: Table data-products-441119:dbt_dev_analytics.dim_products was not found in location US
  compiled code at target/run/digital_marketing/models/marts/_core_models.yml/not_null_dim_products_product_id.sql
[0m22:24:32.788320 [error] [Thread-1  ]: 3 of 41 ERROR not_null_dim_products_product_id ................................. [[31mERROR[0m in 0.95s]
[0m22:24:32.788808 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_dim_products_product_id.c8aba288d1
[0m22:24:32.789158 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_dim_products_product_name.991aec73f3
[0m22:24:32.789600 [debug] [Thread-4  ]: Marking all children of 'test.digital_marketing.not_null_dim_products_product_id.c8aba288d1' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_products_product_id (models/marts/_core_models.yml)
  Not found: Table data-products-441119:dbt_dev_analytics.dim_products was not found in location US
  compiled code at target/run/digital_marketing/models/marts/_core_models.yml/not_null_dim_products_product_id.sql.
[0m22:24:32.789959 [info ] [Thread-1  ]: 4 of 41 START test not_null_dim_products_product_name .......................... [RUN]
[0m22:24:32.790481 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_dim_products_product_id.c8aba288d1, now test.digital_marketing.not_null_dim_products_product_name.991aec73f3)
[0m22:24:32.790806 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_dim_products_product_name.991aec73f3
[0m22:24:32.797580 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_dim_products_product_name.991aec73f3"
[0m22:24:32.798318 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_dim_products_product_name.991aec73f3
[0m22:24:32.802283 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_dim_products_product_name.991aec73f3"
[0m22:24:32.803004 [debug] [Thread-1  ]: On test.digital_marketing.not_null_dim_products_product_name.991aec73f3: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_dim_products_product_name.991aec73f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from `data-products-441119`.`dbt_dev_analytics`.`dim_products`
where product_name is null



  
  
      
    ) dbt_internal_test
[0m22:24:32.803365 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:33.467840 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:531ac7ea-b707-48de-a263-e61013606f2d&page=queryresults
[0m22:24:33.470829 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:531ac7ea-b707-48de-a263-e61013606f2d&page=queryresults
[0m22:24:33.501980 [debug] [Thread-1  ]: Database Error in test not_null_dim_products_product_name (models/marts/_core_models.yml)
  Not found: Table data-products-441119:dbt_dev_analytics.dim_products was not found in location US
  compiled code at target/run/digital_marketing/models/marts/_core_models.yml/not_null_dim_products_product_name.sql
[0m22:24:33.502889 [error] [Thread-1  ]: 4 of 41 ERROR not_null_dim_products_product_name ............................... [[31mERROR[0m in 0.71s]
[0m22:24:33.503669 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_dim_products_product_name.991aec73f3
[0m22:24:33.504225 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8
[0m22:24:33.504907 [debug] [Thread-4  ]: Marking all children of 'test.digital_marketing.not_null_dim_products_product_name.991aec73f3' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_products_product_name (models/marts/_core_models.yml)
  Not found: Table data-products-441119:dbt_dev_analytics.dim_products was not found in location US
  compiled code at target/run/digital_marketing/models/marts/_core_models.yml/not_null_dim_products_product_name.sql.
[0m22:24:33.505485 [info ] [Thread-1  ]: 5 of 41 START test not_null_dim_users_lifetime_value ........................... [RUN]
[0m22:24:33.506304 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_dim_products_product_name.991aec73f3, now test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8)
[0m22:24:33.506839 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8
[0m22:24:33.515637 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8"
[0m22:24:33.516557 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8
[0m22:24:33.523291 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8"
[0m22:24:33.524004 [debug] [Thread-1  ]: On test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lifetime_value
from `data-products-441119`.`dbt_dev_analytics`.`dim_users`
where lifetime_value is null



  
  
      
    ) dbt_internal_test
[0m22:24:33.524459 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:35.670463 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:0d4faaf6-b07b-4331-be9e-fada67430656&page=queryresults
[0m22:24:36.405914 [info ] [Thread-1  ]: 5 of 41 PASS not_null_dim_users_lifetime_value ................................. [[32mPASS[0m in 2.90s]
[0m22:24:36.406734 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8
[0m22:24:36.407201 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_dim_users_user_id.e754bb5812
[0m22:24:36.407668 [info ] [Thread-1  ]: 6 of 41 START test not_null_dim_users_user_id .................................. [RUN]
[0m22:24:36.408185 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8, now test.digital_marketing.not_null_dim_users_user_id.e754bb5812)
[0m22:24:36.408600 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_dim_users_user_id.e754bb5812
[0m22:24:36.416192 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_dim_users_user_id.e754bb5812"
[0m22:24:36.417095 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_dim_users_user_id.e754bb5812
[0m22:24:36.422921 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_dim_users_user_id.e754bb5812"
[0m22:24:36.423989 [debug] [Thread-1  ]: On test.digital_marketing.not_null_dim_users_user_id.e754bb5812: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_dim_users_user_id.e754bb5812"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `data-products-441119`.`dbt_dev_analytics`.`dim_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:24:36.424409 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:38.580913 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:8fb570ad-ad88-43b1-8789-1d43aa817e02&page=queryresults
[0m22:24:39.143763 [info ] [Thread-1  ]: 6 of 41 PASS not_null_dim_users_user_id ........................................ [[32mPASS[0m in 2.73s]
[0m22:24:39.145773 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_dim_users_user_id.e754bb5812
[0m22:24:39.146643 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0
[0m22:24:39.147604 [info ] [Thread-1  ]: 7 of 41 START test not_null_fct_orders_order_id ................................ [RUN]
[0m22:24:39.148634 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_dim_users_user_id.e754bb5812, now test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0)
[0m22:24:39.149415 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0
[0m22:24:39.161138 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0"
[0m22:24:39.162557 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0
[0m22:24:39.169920 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0"
[0m22:24:39.171306 [debug] [Thread-1  ]: On test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `data-products-441119`.`dbt_dev_analytics`.`fct_orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m22:24:39.171911 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:40.606570 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:00ef6e5e-543b-4f9d-9fc8-4f9069ef98a9&page=queryresults
[0m22:24:41.190457 [info ] [Thread-1  ]: 7 of 41 PASS not_null_fct_orders_order_id ...................................... [[32mPASS[0m in 2.04s]
[0m22:24:41.191072 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0
[0m22:24:41.191436 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7
[0m22:24:41.191714 [info ] [Thread-1  ]: 8 of 41 START test not_null_fct_orders_user_id ................................. [RUN]
[0m22:24:41.192274 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0, now test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7)
[0m22:24:41.192703 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7
[0m22:24:41.203799 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7"
[0m22:24:41.205165 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7
[0m22:24:41.212085 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7"
[0m22:24:41.213028 [debug] [Thread-1  ]: On test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `data-products-441119`.`dbt_dev_analytics`.`fct_orders`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:24:41.213467 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:42.314195 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:d723df7b-331d-4df9-a24b-175bb76ace38&page=queryresults
[0m22:24:42.840631 [info ] [Thread-1  ]: 8 of 41 PASS not_null_fct_orders_user_id ....................................... [[32mPASS[0m in 1.65s]
[0m22:24:42.841493 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7
[0m22:24:42.843017 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m22:24:42.844008 [info ] [Thread-1  ]: 9 of 41 START test not_null_stg_order_items_order_item_id ...................... [RUN]
[0m22:24:42.844837 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7, now test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m22:24:42.845520 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m22:24:42.856218 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m22:24:42.857155 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m22:24:42.862058 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m22:24:42.862927 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m22:24:42.863575 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:43.961424 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:9d066d27-68ca-42b4-aec4-4e968714e264&page=queryresults
[0m22:24:44.550641 [info ] [Thread-1  ]: 9 of 41 PASS not_null_stg_order_items_order_item_id ............................ [[32mPASS[0m in 1.71s]
[0m22:24:44.551320 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m22:24:44.551692 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m22:24:44.551978 [info ] [Thread-1  ]: 10 of 41 START test not_null_stg_order_items_sale_price ........................ [RUN]
[0m22:24:44.552346 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0)
[0m22:24:44.552633 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m22:24:44.561076 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"
[0m22:24:44.562096 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m22:24:44.567159 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"
[0m22:24:44.567890 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sale_price
from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
where sale_price is null



  
  
      
    ) dbt_internal_test
[0m22:24:44.568250 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:46.033096 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:c29d2d1a-d091-4e7f-8f09-53fa8903e916&page=queryresults
[0m22:24:46.607193 [info ] [Thread-1  ]: 10 of 41 PASS not_null_stg_order_items_sale_price .............................. [[32mPASS[0m in 2.05s]
[0m22:24:46.608521 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m22:24:46.609346 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m22:24:46.610232 [info ] [Thread-1  ]: 11 of 41 START test not_null_stg_orders_order_date ............................. [RUN]
[0m22:24:46.611242 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0, now test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb)
[0m22:24:46.612067 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m22:24:46.623660 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"
[0m22:24:46.624894 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m22:24:46.633206 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"
[0m22:24:46.634148 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
where order_date is null



  
  
      
    ) dbt_internal_test
[0m22:24:46.634751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:47.773236 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:b19aed9d-b0b2-4747-ac38-13d109f290eb&page=queryresults
[0m22:24:48.310585 [info ] [Thread-1  ]: 11 of 41 PASS not_null_stg_orders_order_date ................................... [[32mPASS[0m in 1.70s]
[0m22:24:48.311771 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m22:24:48.313352 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m22:24:48.314100 [info ] [Thread-1  ]: 12 of 41 START test not_null_stg_orders_order_id ............................... [RUN]
[0m22:24:48.315570 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb, now test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64)
[0m22:24:48.316607 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m22:24:48.327861 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"
[0m22:24:48.329076 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m22:24:48.336783 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"
[0m22:24:48.337708 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m22:24:48.338471 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:49.531787 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:17f4db24-ff8f-4a50-b3ca-d6953a20dec9&page=queryresults
[0m22:24:50.094208 [info ] [Thread-1  ]: 12 of 41 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 1.78s]
[0m22:24:50.094958 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m22:24:50.095373 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m22:24:50.095861 [info ] [Thread-1  ]: 13 of 41 START test not_null_stg_orders_user_id ................................ [RUN]
[0m22:24:50.096263 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64, now test.digital_marketing.not_null_stg_orders_user_id.7d129d0209)
[0m22:24:50.096571 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m22:24:50.108471 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"
[0m22:24:50.109576 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m22:24:50.113615 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"
[0m22:24:50.114355 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_orders_user_id.7d129d0209: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:24:50.114727 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:51.149139 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:40549eee-a325-4954-b99e-ee6c73129f5f&page=queryresults
[0m22:24:51.738912 [info ] [Thread-1  ]: 13 of 41 PASS not_null_stg_orders_user_id ...................................... [[32mPASS[0m in 1.64s]
[0m22:24:51.739888 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m22:24:51.740241 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m22:24:51.740578 [info ] [Thread-1  ]: 14 of 41 START test not_null_stg_products_product_id ........................... [RUN]
[0m22:24:51.740958 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_user_id.7d129d0209, now test.digital_marketing.not_null_stg_products_product_id.6373b0acf3)
[0m22:24:51.741240 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m22:24:51.750132 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"
[0m22:24:51.751748 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m22:24:51.756979 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"
[0m22:24:51.758118 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m22:24:51.759113 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:52.641515 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:5ca4d8b0-61dc-45ff-9402-24ca7ab482e7&page=queryresults
[0m22:24:53.165805 [info ] [Thread-1  ]: 14 of 41 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 1.42s]
[0m22:24:53.167206 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m22:24:53.168111 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:24:53.169088 [info ] [Thread-1  ]: 15 of 41 START test not_null_stg_users_email ................................... [RUN]
[0m22:24:53.170109 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_products_product_id.6373b0acf3, now test.digital_marketing.not_null_stg_users_email.2723c62e0e)
[0m22:24:53.170933 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:24:53.183536 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_email.2723c62e0e"
[0m22:24:53.184761 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:24:53.193712 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_email.2723c62e0e"
[0m22:24:53.196058 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_email.2723c62e0e: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_email.2723c62e0e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where email is null



  
  
      
    ) dbt_internal_test
[0m22:24:53.197059 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:54.823895 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:df95dda1-e60d-4cbb-ab41-9a6300e19031&page=queryresults
[0m22:24:55.418380 [info ] [Thread-1  ]: 15 of 41 PASS not_null_stg_users_email ......................................... [[32mPASS[0m in 2.25s]
[0m22:24:55.419521 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:24:55.420250 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:24:55.421091 [info ] [Thread-1  ]: 16 of 41 START test not_null_stg_users_user_id ................................. [RUN]
[0m22:24:55.422013 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_email.2723c62e0e, now test.digital_marketing.not_null_stg_users_user_id.980dfc1b77)
[0m22:24:55.422641 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:24:55.435215 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"
[0m22:24:55.436660 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:24:55.445829 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"
[0m22:24:55.447091 [debug] [Thread-1  ]: On test.digital_marketing.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:24:55.447619 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:56.683448 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:4bc9eee3-c678-409e-ae28-13e948d08c61&page=queryresults
[0m22:24:57.486438 [info ] [Thread-1  ]: 16 of 41 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 2.06s]
[0m22:24:57.488060 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:24:57.488936 [debug] [Thread-1  ]: Began running node test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b
[0m22:24:57.489859 [info ] [Thread-1  ]: 17 of 41 START test relationships_fct_orders_user_id__user_id__ref_dim_users_ .. [RUN]
[0m22:24:57.490895 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_user_id.980dfc1b77, now test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b)
[0m22:24:57.491707 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b
[0m22:24:57.513695 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b"
[0m22:24:57.515149 [debug] [Thread-1  ]: Began executing node test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b
[0m22:24:57.523186 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b"
[0m22:24:57.524263 [debug] [Thread-1  ]: On test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from `data-products-441119`.`dbt_dev_analytics`.`fct_orders`
    where user_id is not null
),

parent as (
    select user_id as to_field
    from `data-products-441119`.`dbt_dev_analytics`.`dim_users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:24:57.524824 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:00.059722 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:e31e8e98-165c-4aef-971b-e6e34961720c&page=queryresults
[0m22:25:01.207588 [error] [Thread-1  ]: 17 of 41 FAIL 12479 relationships_fct_orders_user_id__user_id__ref_dim_users_ .. [[31mFAIL 12479[0m in 3.72s]
[0m22:25:01.208294 [debug] [Thread-1  ]: Finished running node test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b
[0m22:25:01.208716 [debug] [Thread-1  ]: Began running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:25:01.209049 [info ] [Thread-1  ]: 18 of 41 START test relationships_stg_orders_user_id__user_id__ref_stg_users_ .. [RUN]
[0m22:25:01.209651 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b, now test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737)
[0m22:25:01.209968 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:25:01.218417 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"
[0m22:25:01.220184 [debug] [Thread-1  ]: Began executing node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:25:01.224941 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"
[0m22:25:01.225668 [debug] [Thread-1  ]: On test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
    where user_id is not null
),

parent as (
    select user_id as to_field
    from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:25:01.226057 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:02.852744 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:a8e4decd-1e8d-4d2f-ab9f-450452cbb715&page=queryresults
[0m22:25:03.406435 [error] [Thread-1  ]: 18 of 41 FAIL 16406 relationships_stg_orders_user_id__user_id__ref_stg_users_ .. [[31mFAIL 16406[0m in 2.20s]
[0m22:25:03.407741 [debug] [Thread-1  ]: Finished running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:25:03.408595 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265
[0m22:25:03.409498 [info ] [Thread-1  ]: 19 of 41 START test source_not_null_thelook_ecommerce_order_items_id ........... [RUN]
[0m22:25:03.410521 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737, now test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265)
[0m22:25:03.411304 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265
[0m22:25:03.425273 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265"
[0m22:25:03.427670 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265
[0m22:25:03.435648 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265"
[0m22:25:03.437062 [debug] [Thread-1  ]: On test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `bigquery-public-data`.`thelook_ecommerce`.`order_items`
where id is null



  
  
      
    ) dbt_internal_test
[0m22:25:03.437713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:04.396529 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:80d31f87-7583-4600-add3-fcb5d4e32f82&page=queryresults
[0m22:25:05.001856 [info ] [Thread-1  ]: 19 of 41 PASS source_not_null_thelook_ecommerce_order_items_id ................. [[32mPASS[0m in 1.59s]
[0m22:25:05.002588 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265
[0m22:25:05.003020 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50
[0m22:25:05.003440 [info ] [Thread-1  ]: 20 of 41 START test source_not_null_thelook_ecommerce_order_items_order_id ..... [RUN]
[0m22:25:05.003850 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265, now test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50)
[0m22:25:05.004184 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50
[0m22:25:05.013399 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50"
[0m22:25:05.014398 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50
[0m22:25:05.018901 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50"
[0m22:25:05.019789 [debug] [Thread-1  ]: On test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `bigquery-public-data`.`thelook_ecommerce`.`order_items`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m22:25:05.020196 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:05.837434 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:a5687cca-e577-4dfb-8ab0-7c6c5bd75102&page=queryresults
[0m22:25:06.431180 [info ] [Thread-1  ]: 20 of 41 PASS source_not_null_thelook_ecommerce_order_items_order_id ........... [[32mPASS[0m in 1.43s]
[0m22:25:06.431889 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50
[0m22:25:06.432302 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8
[0m22:25:06.432738 [info ] [Thread-1  ]: 21 of 41 START test source_not_null_thelook_ecommerce_orders_order_id .......... [RUN]
[0m22:25:06.433219 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50, now test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8)
[0m22:25:06.433608 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8
[0m22:25:06.443019 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8"
[0m22:25:06.444447 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8
[0m22:25:06.451035 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8"
[0m22:25:06.452248 [debug] [Thread-1  ]: On test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `bigquery-public-data`.`thelook_ecommerce`.`orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m22:25:06.452744 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:07.453972 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:527c9edb-a5fc-4890-8731-bfde19af8d6b&page=queryresults
[0m22:25:08.058207 [info ] [Thread-1  ]: 21 of 41 PASS source_not_null_thelook_ecommerce_orders_order_id ................ [[32mPASS[0m in 1.62s]
[0m22:25:08.059592 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8
[0m22:25:08.060422 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41
[0m22:25:08.061306 [info ] [Thread-1  ]: 22 of 41 START test source_not_null_thelook_ecommerce_orders_user_id ........... [RUN]
[0m22:25:08.062290 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8, now test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41)
[0m22:25:08.063058 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41
[0m22:25:08.074991 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41"
[0m22:25:08.076290 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41
[0m22:25:08.291307 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41"
[0m22:25:08.292013 [debug] [Thread-1  ]: On test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `bigquery-public-data`.`thelook_ecommerce`.`orders`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:25:08.292331 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:09.279603 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:2c59c719-f4d9-47eb-958a-d0147ef50b52&page=queryresults
[0m22:25:09.818473 [info ] [Thread-1  ]: 22 of 41 PASS source_not_null_thelook_ecommerce_orders_user_id ................. [[32mPASS[0m in 1.76s]
[0m22:25:09.819953 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41
[0m22:25:09.820841 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8
[0m22:25:09.821851 [info ] [Thread-1  ]: 23 of 41 START test source_not_null_thelook_ecommerce_products_id .............. [RUN]
[0m22:25:09.822891 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41, now test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8)
[0m22:25:09.823701 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8
[0m22:25:09.837440 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8"
[0m22:25:09.838656 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8
[0m22:25:09.846847 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8"
[0m22:25:09.848062 [debug] [Thread-1  ]: On test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `bigquery-public-data`.`thelook_ecommerce`.`products`
where id is null



  
  
      
    ) dbt_internal_test
[0m22:25:09.848699 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:10.807969 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:b76c6f76-919f-497b-9e96-d3b8be47562a&page=queryresults
[0m22:25:11.380720 [info ] [Thread-1  ]: 23 of 41 PASS source_not_null_thelook_ecommerce_products_id .................... [[32mPASS[0m in 1.56s]
[0m22:25:11.381388 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8
[0m22:25:11.381741 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1
[0m22:25:11.382106 [info ] [Thread-1  ]: 24 of 41 START test source_not_null_thelook_ecommerce_users_created_at ......... [RUN]
[0m22:25:11.382521 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8, now test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1)
[0m22:25:11.382811 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1
[0m22:25:11.390360 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1"
[0m22:25:11.391836 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1
[0m22:25:11.395470 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1"
[0m22:25:11.396053 [debug] [Thread-1  ]: On test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select created_at
from `bigquery-public-data`.`thelook_ecommerce`.`users`
where created_at is null



  
  
      
    ) dbt_internal_test
[0m22:25:11.396351 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:12.327903 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:a1321e37-5f5a-4511-98d9-0a1de655639a&page=queryresults
[0m22:25:12.913215 [info ] [Thread-1  ]: 24 of 41 PASS source_not_null_thelook_ecommerce_users_created_at ............... [[32mPASS[0m in 1.53s]
[0m22:25:12.913762 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1
[0m22:25:12.914061 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53
[0m22:25:12.914321 [info ] [Thread-1  ]: 25 of 41 START test source_not_null_thelook_ecommerce_users_email .............. [RUN]
[0m22:25:12.914619 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1, now test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53)
[0m22:25:12.914871 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53
[0m22:25:12.922654 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53"
[0m22:25:12.923829 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53
[0m22:25:12.927766 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53"
[0m22:25:12.928442 [debug] [Thread-1  ]: On test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from `bigquery-public-data`.`thelook_ecommerce`.`users`
where email is null



  
  
      
    ) dbt_internal_test
[0m22:25:12.928760 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:13.858802 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:48dd882e-1bb7-400b-96d2-a1b73c2c7214&page=queryresults
[0m22:25:14.446579 [info ] [Thread-1  ]: 25 of 41 PASS source_not_null_thelook_ecommerce_users_email .................... [[32mPASS[0m in 1.53s]
[0m22:25:14.447910 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53
[0m22:25:14.448702 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588
[0m22:25:14.449375 [info ] [Thread-1  ]: 26 of 41 START test source_not_null_thelook_ecommerce_users_id ................. [RUN]
[0m22:25:14.450117 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53, now test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588)
[0m22:25:14.450612 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588
[0m22:25:14.461396 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588"
[0m22:25:14.462568 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588
[0m22:25:14.470180 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588"
[0m22:25:14.471503 [debug] [Thread-1  ]: On test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `bigquery-public-data`.`thelook_ecommerce`.`users`
where id is null



  
  
      
    ) dbt_internal_test
[0m22:25:14.472113 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:15.527070 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:495ce830-9b95-4e9d-a301-ce609415f729&page=queryresults
[0m22:25:16.094704 [info ] [Thread-1  ]: 26 of 41 PASS source_not_null_thelook_ecommerce_users_id ....................... [[32mPASS[0m in 1.64s]
[0m22:25:16.096069 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588
[0m22:25:16.097061 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c
[0m22:25:16.098032 [info ] [Thread-1  ]: 27 of 41 START test source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_  [RUN]
[0m22:25:16.099049 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588, now test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c)
[0m22:25:16.099857 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c
[0m22:25:16.113623 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c"
[0m22:25:16.114742 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c
[0m22:25:16.123776 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c"
[0m22:25:16.124915 [debug] [Thread-1  ]: On test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from `bigquery-public-data`.`thelook_ecommerce`.`order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `bigquery-public-data`.`thelook_ecommerce`.`orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:25:16.125486 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:17.469767 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:828084a3-f326-4a5e-951b-33aa7457565b&page=queryresults
[0m22:25:18.005886 [info ] [Thread-1  ]: 27 of 41 PASS source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_  [[32mPASS[0m in 1.91s]
[0m22:25:18.007211 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c
[0m22:25:18.008043 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d
[0m22:25:18.008957 [info ] [Thread-1  ]: 28 of 41 START test source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_  [RUN]
[0m22:25:18.009990 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c, now test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d)
[0m22:25:18.010809 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d
[0m22:25:18.025537 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d"
[0m22:25:18.026637 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d
[0m22:25:18.033619 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d"
[0m22:25:18.034617 [debug] [Thread-1  ]: On test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from `bigquery-public-data`.`thelook_ecommerce`.`orders`
    where user_id is not null
),

parent as (
    select id as to_field
    from `bigquery-public-data`.`thelook_ecommerce`.`users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:25:18.035168 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:19.080925 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:58f2fe80-9a44-41d4-b378-481dcded20ca&page=queryresults
[0m22:25:19.606593 [info ] [Thread-1  ]: 28 of 41 PASS source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_  [[32mPASS[0m in 1.60s]
[0m22:25:19.607969 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d
[0m22:25:19.608783 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c
[0m22:25:19.609658 [info ] [Thread-1  ]: 29 of 41 START test source_unique_thelook_ecommerce_order_items_id ............. [RUN]
[0m22:25:19.610656 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d, now test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c)
[0m22:25:19.611457 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c
[0m22:25:19.627072 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c"
[0m22:25:19.628242 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c
[0m22:25:19.635447 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c"
[0m22:25:19.636643 [debug] [Thread-1  ]: On test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `bigquery-public-data`.`thelook_ecommerce`.`order_items`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:25:19.637257 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:20.643754 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:6a5367b6-2b0d-49e3-ac61-da52d52198c3&page=queryresults
[0m22:25:21.184122 [info ] [Thread-1  ]: 29 of 41 PASS source_unique_thelook_ecommerce_order_items_id ................... [[32mPASS[0m in 1.57s]
[0m22:25:21.188530 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c
[0m22:25:21.190508 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268
[0m22:25:21.197654 [info ] [Thread-1  ]: 30 of 41 START test source_unique_thelook_ecommerce_orders_order_id ............ [RUN]
[0m22:25:21.201083 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c, now test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268)
[0m22:25:21.204347 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268
[0m22:25:21.230466 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268"
[0m22:25:21.231435 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268
[0m22:25:21.239595 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268"
[0m22:25:21.242428 [debug] [Thread-1  ]: On test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `bigquery-public-data`.`thelook_ecommerce`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:25:21.244007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:22.245529 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:fd551f5a-0481-470f-97d1-fb79e517ac04&page=queryresults
[0m22:25:22.803937 [info ] [Thread-1  ]: 30 of 41 PASS source_unique_thelook_ecommerce_orders_order_id .................. [[32mPASS[0m in 1.60s]
[0m22:25:22.804691 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268
[0m22:25:22.805040 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd
[0m22:25:22.805327 [info ] [Thread-1  ]: 31 of 41 START test source_unique_thelook_ecommerce_products_id ................ [RUN]
[0m22:25:22.805739 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268, now test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd)
[0m22:25:22.806035 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd
[0m22:25:22.812016 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd"
[0m22:25:22.812612 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd
[0m22:25:22.815951 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd"
[0m22:25:22.816634 [debug] [Thread-1  ]: On test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `bigquery-public-data`.`thelook_ecommerce`.`products`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:25:22.817071 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:23.713096 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:5f70548a-46bd-4d7a-8e67-90e90b419747&page=queryresults
[0m22:25:24.174296 [info ] [Thread-1  ]: 31 of 41 PASS source_unique_thelook_ecommerce_products_id ...................... [[32mPASS[0m in 1.37s]
[0m22:25:24.175445 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd
[0m22:25:24.175875 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d
[0m22:25:24.176322 [info ] [Thread-1  ]: 32 of 41 START test source_unique_thelook_ecommerce_users_email ................ [RUN]
[0m22:25:24.177112 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd, now test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d)
[0m22:25:24.177550 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d
[0m22:25:24.188230 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d"
[0m22:25:24.189445 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d
[0m22:25:24.198141 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d"
[0m22:25:24.200011 [debug] [Thread-1  ]: On test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select email as unique_field
  from `bigquery-public-data`.`thelook_ecommerce`.`users`
  where email is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:25:24.200870 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:25.341369 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:6ad050db-7fb5-4d7c-bca6-5da69617301a&page=queryresults
[0m22:25:25.908127 [error] [Thread-1  ]: 32 of 41 FAIL 10644 source_unique_thelook_ecommerce_users_email ................ [[31mFAIL 10644[0m in 1.73s]
[0m22:25:25.909397 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d
[0m22:25:25.909957 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6
[0m22:25:25.910501 [info ] [Thread-1  ]: 33 of 41 START test source_unique_thelook_ecommerce_users_id ................... [RUN]
[0m22:25:25.911094 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d, now test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6)
[0m22:25:25.911533 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6
[0m22:25:25.919516 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6"
[0m22:25:25.920338 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6
[0m22:25:25.926010 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6"
[0m22:25:25.926912 [debug] [Thread-1  ]: On test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `bigquery-public-data`.`thelook_ecommerce`.`users`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:25:25.927356 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:26.930351 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:992856d3-4b9b-4ef9-a26a-4d9d164bd9fa&page=queryresults
[0m22:25:27.496282 [info ] [Thread-1  ]: 33 of 41 PASS source_unique_thelook_ecommerce_users_id ......................... [[32mPASS[0m in 1.58s]
[0m22:25:27.497396 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6
[0m22:25:27.497767 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_dim_products_product_id.ef7b2a9985
[0m22:25:27.498196 [info ] [Thread-1  ]: 34 of 41 START test unique_dim_products_product_id ............................. [RUN]
[0m22:25:27.498682 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6, now test.digital_marketing.unique_dim_products_product_id.ef7b2a9985)
[0m22:25:27.499052 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_dim_products_product_id.ef7b2a9985
[0m22:25:27.506138 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_dim_products_product_id.ef7b2a9985"
[0m22:25:27.506981 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_dim_products_product_id.ef7b2a9985
[0m22:25:27.511146 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_dim_products_product_id.ef7b2a9985"
[0m22:25:27.511824 [debug] [Thread-1  ]: On test.digital_marketing.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`dim_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:25:27.512178 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:28.060671 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:717b2530-3d20-48a5-a738-46465e7e8ad8&page=queryresults
[0m22:25:28.062532 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:717b2530-3d20-48a5-a738-46465e7e8ad8&page=queryresults
[0m22:25:28.129061 [debug] [Thread-1  ]: Database Error in test unique_dim_products_product_id (models/marts/_core_models.yml)
  Not found: Table data-products-441119:dbt_dev_analytics.dim_products was not found in location US
  compiled code at target/run/digital_marketing/models/marts/_core_models.yml/unique_dim_products_product_id.sql
[0m22:25:28.129778 [error] [Thread-1  ]: 34 of 41 ERROR unique_dim_products_product_id .................................. [[31mERROR[0m in 0.63s]
[0m22:25:28.130384 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_dim_products_product_id.ef7b2a9985
[0m22:25:28.130756 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_dim_users_email.53417c09f1
[0m22:25:28.131229 [debug] [Thread-4  ]: Marking all children of 'test.digital_marketing.unique_dim_products_product_id.ef7b2a9985' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_products_product_id (models/marts/_core_models.yml)
  Not found: Table data-products-441119:dbt_dev_analytics.dim_products was not found in location US
  compiled code at target/run/digital_marketing/models/marts/_core_models.yml/unique_dim_products_product_id.sql.
[0m22:25:28.131548 [info ] [Thread-1  ]: 35 of 41 START test unique_dim_users_email ..................................... [RUN]
[0m22:25:28.132324 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_dim_products_product_id.ef7b2a9985, now test.digital_marketing.unique_dim_users_email.53417c09f1)
[0m22:25:28.132987 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_dim_users_email.53417c09f1
[0m22:25:28.140735 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_dim_users_email.53417c09f1"
[0m22:25:28.141438 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_dim_users_email.53417c09f1
[0m22:25:28.145686 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_dim_users_email.53417c09f1"
[0m22:25:28.146219 [debug] [Thread-1  ]: On test.digital_marketing.unique_dim_users_email.53417c09f1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_dim_users_email.53417c09f1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select email as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`dim_users`
  where email is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:25:28.146572 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:30.243343 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:07e0fcaa-ba11-49ff-bdbf-eda4c6b44fb7&page=queryresults
[0m22:25:31.006413 [error] [Thread-1  ]: 35 of 41 FAIL 3603 unique_dim_users_email ...................................... [[31mFAIL 3603[0m in 2.87s]
[0m22:25:31.007224 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_dim_users_email.53417c09f1
[0m22:25:31.007658 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9
[0m22:25:31.007949 [info ] [Thread-1  ]: 36 of 41 START test unique_dim_users_user_id ................................... [RUN]
[0m22:25:31.008377 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_dim_users_email.53417c09f1, now test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9)
[0m22:25:31.008720 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9
[0m22:25:31.015087 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9"
[0m22:25:31.015765 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9
[0m22:25:31.020400 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9"
[0m22:25:31.021092 [debug] [Thread-1  ]: On test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`dim_users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:25:31.021431 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:33.029588 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:2c5141c9-4298-4a90-a240-a363ec76742a&page=queryresults
[0m22:25:33.716380 [info ] [Thread-1  ]: 36 of 41 PASS unique_dim_users_user_id ......................................... [[32mPASS[0m in 2.71s]
[0m22:25:33.717005 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9
[0m22:25:33.717342 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5
[0m22:25:33.717674 [info ] [Thread-1  ]: 37 of 41 START test unique_fct_orders_order_id ................................. [RUN]
[0m22:25:33.718020 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9, now test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5)
[0m22:25:33.718286 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5
[0m22:25:33.724950 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5"
[0m22:25:33.725942 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5
[0m22:25:33.730553 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5"
[0m22:25:33.731295 [debug] [Thread-1  ]: On test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`fct_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:25:33.731626 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:35.081770 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:64503c6e-9aba-4967-9f01-0925f6ed6acc&page=queryresults
[0m22:25:35.572733 [info ] [Thread-1  ]: 37 of 41 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 1.85s]
[0m22:25:35.573448 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5
[0m22:25:35.573823 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m22:25:35.574186 [info ] [Thread-1  ]: 38 of 41 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m22:25:35.574604 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5, now test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108)
[0m22:25:35.574878 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m22:25:35.579322 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"
[0m22:25:35.581467 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m22:25:35.585891 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"
[0m22:25:35.587111 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_item_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_order_items`
  where order_item_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:25:35.587453 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:36.880503 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:f8a6d099-abac-4f62-a7fd-2fd3d0944c55&page=queryresults
[0m22:25:37.437289 [info ] [Thread-1  ]: 38 of 41 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 1.86s]
[0m22:25:37.437989 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m22:25:37.438309 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m22:25:37.438582 [info ] [Thread-1  ]: 39 of 41 START test unique_stg_orders_order_id ................................. [RUN]
[0m22:25:37.439044 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108, now test.digital_marketing.unique_stg_orders_order_id.e3b841c71a)
[0m22:25:37.439318 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m22:25:37.444616 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"
[0m22:25:37.445580 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m22:25:37.449295 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"
[0m22:25:37.449918 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:25:37.450217 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:38.519015 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:07dfb54e-133c-4064-b63f-bdb8aaea9371&page=queryresults
[0m22:25:39.056973 [info ] [Thread-1  ]: 39 of 41 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 1.62s]
[0m22:25:39.057914 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m22:25:39.058476 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m22:25:39.059746 [info ] [Thread-1  ]: 40 of 41 START test unique_stg_products_product_id ............................. [RUN]
[0m22:25:39.060614 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_orders_order_id.e3b841c71a, now test.digital_marketing.unique_stg_products_product_id.7d950a1467)
[0m22:25:39.061030 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m22:25:39.076477 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_products_product_id.7d950a1467"
[0m22:25:39.077537 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m22:25:39.083555 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_products_product_id.7d950a1467"
[0m22:25:39.085126 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:25:39.085928 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:40.061260 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:799b4a94-3226-4335-a3b1-88b65fb782c2&page=queryresults
[0m22:25:40.584598 [info ] [Thread-1  ]: 40 of 41 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 1.52s]
[0m22:25:40.585174 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m22:25:40.585507 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:25:40.585778 [info ] [Thread-1  ]: 41 of 41 START test unique_stg_users_user_id ................................... [RUN]
[0m22:25:40.586214 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_products_product_id.7d950a1467, now test.digital_marketing.unique_stg_users_user_id.c2ff477e6b)
[0m22:25:40.586532 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:25:40.593004 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"
[0m22:25:40.594492 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:25:40.598680 [debug] [Thread-1  ]: Writing runtime sql for node "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"
[0m22:25:40.599547 [debug] [Thread-1  ]: On test.digital_marketing.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `data-products-441119`.`dbt_dev_analytics`.`stg_users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:25:40.599875 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:41.655385 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:da9fde60-c289-4ac1-8577-b75d19ab4a3a&page=queryresults
[0m22:25:42.181406 [info ] [Thread-1  ]: 41 of 41 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 1.60s]
[0m22:25:42.181957 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:25:42.183654 [info ] [MainThread]: 
[0m22:25:42.191784 [info ] [MainThread]: === DBT Run Completed Successfully ===
[0m22:25:42.192215 [debug] [MainThread]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m22:25:42.192855 [info ] [MainThread]: 1 of 2 START hook: digital_marketing.on-run-end.0 .............................. [RUN]
[0m22:25:42.193707 [info ] [MainThread]: 1 of 2 OK hook: digital_marketing.on-run-end.0 ................................. [[32mOK[0m in 0.01s]
[0m22:25:42.235510 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m22:25:42.241703 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m22:25:42.250547 [debug] [MainThread]: Elementary: Handling test results.
[0m22:25:42.461077 [debug] [MainThread]: Elementary: Deleting temporary Elementary test tables: []
[0m22:25:42.473495 [warn ] [MainThread]: Couldn't find Elementary's models in `data-products-441119.dbt_dev_analytics`. Please run `dbt run -s elementary --target dev`.
[0m22:25:42.473991 [debug] [MainThread]: Elementary: Handled test results successfully.
[0m22:25:42.484949 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m22:25:42.486449 [info ] [MainThread]: 2 of 2 START hook: elementary.on-run-end.1 ..................................... [RUN]
[0m22:25:42.486841 [info ] [MainThread]: 2 of 2 OK hook: elementary.on-run-end.1 ........................................ [[32mOK[0m in 0.29s]
[0m22:25:42.487120 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:25:42.557487 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:25:42.557824 [debug] [MainThread]: Connection 'list_data-products-441119_snapshot' was properly closed.
[0m22:25:42.558040 [debug] [MainThread]: Connection 'test.digital_marketing.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m22:25:42.558334 [info ] [MainThread]: 
[0m22:25:42.558576 [info ] [MainThread]: Finished running 5 project hooks, 41 data tests in 0 hours 1 minutes and 17.95 seconds (77.95s).
[0m22:25:42.562963 [debug] [MainThread]: Command end result
[0m22:25:42.633250 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:25:42.636031 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:25:42.643088 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m22:25:42.643468 [info ] [MainThread]: 
[0m22:25:42.643808 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m22:25:42.644055 [info ] [MainThread]: 
[0m22:25:42.644345 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_stg_users_age__120__13 (models/staging/_staging_models.yml)[0m
[0m22:25:42.644605 [error] [MainThread]:   Got 820 results, configured to fail if != 0
[0m22:25:42.644839 [info ] [MainThread]: 
[0m22:25:42.645165 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/dbt_utils_accepted_range_stg_users_age__120__13.sql
[0m22:25:42.645419 [info ] [MainThread]: 
[0m22:25:42.645680 [error] [MainThread]: [31mFailure in test not_null_dim_products_product_id (models/marts/_core_models.yml)[0m
[0m22:25:42.645938 [error] [MainThread]:   Database Error in test not_null_dim_products_product_id (models/marts/_core_models.yml)
  Not found: Table data-products-441119:dbt_dev_analytics.dim_products was not found in location US
  compiled code at target/run/digital_marketing/models/marts/_core_models.yml/not_null_dim_products_product_id.sql
[0m22:25:42.646170 [info ] [MainThread]: 
[0m22:25:42.646411 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/marts/_core_models.yml/not_null_dim_products_product_id.sql
[0m22:25:42.646627 [info ] [MainThread]: 
[0m22:25:42.646874 [error] [MainThread]: [31mFailure in test not_null_dim_products_product_name (models/marts/_core_models.yml)[0m
[0m22:25:42.647124 [error] [MainThread]:   Database Error in test not_null_dim_products_product_name (models/marts/_core_models.yml)
  Not found: Table data-products-441119:dbt_dev_analytics.dim_products was not found in location US
  compiled code at target/run/digital_marketing/models/marts/_core_models.yml/not_null_dim_products_product_name.sql
[0m22:25:42.647335 [info ] [MainThread]: 
[0m22:25:42.647575 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/marts/_core_models.yml/not_null_dim_products_product_name.sql
[0m22:25:42.647785 [info ] [MainThread]: 
[0m22:25:42.648072 [error] [MainThread]: [31mFailure in test relationships_fct_orders_user_id__user_id__ref_dim_users_ (models/marts/_core_models.yml)[0m
[0m22:25:42.648588 [error] [MainThread]:   Got 12479 results, configured to fail if != 0
[0m22:25:42.648854 [info ] [MainThread]: 
[0m22:25:42.649172 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/marts/_core_models.yml/relationships_fct_orders_user_id__user_id__ref_dim_users_.sql
[0m22:25:42.649431 [info ] [MainThread]: 
[0m22:25:42.649988 [error] [MainThread]: [31mFailure in test relationships_stg_orders_user_id__user_id__ref_stg_users_ (models/staging/_staging_models.yml)[0m
[0m22:25:42.650694 [error] [MainThread]:   Got 16406 results, configured to fail if != 0
[0m22:25:42.650940 [info ] [MainThread]: 
[0m22:25:42.651297 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_staging_models.yml/relationships_stg_orders_user_id__user_id__ref_stg_users_.sql
[0m22:25:42.651626 [info ] [MainThread]: 
[0m22:25:42.651930 [error] [MainThread]: [31mFailure in test source_unique_thelook_ecommerce_users_email (models/staging/_sources.yml)[0m
[0m22:25:42.652198 [error] [MainThread]:   Got 10644 results, configured to fail if != 0
[0m22:25:42.652529 [info ] [MainThread]: 
[0m22:25:42.652851 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/staging/_sources.yml/source_unique_thelook_ecommerce_users_email.sql
[0m22:25:42.653097 [info ] [MainThread]: 
[0m22:25:42.653745 [error] [MainThread]: [31mFailure in test unique_dim_products_product_id (models/marts/_core_models.yml)[0m
[0m22:25:42.654388 [error] [MainThread]:   Database Error in test unique_dim_products_product_id (models/marts/_core_models.yml)
  Not found: Table data-products-441119:dbt_dev_analytics.dim_products was not found in location US
  compiled code at target/run/digital_marketing/models/marts/_core_models.yml/unique_dim_products_product_id.sql
[0m22:25:42.654722 [info ] [MainThread]: 
[0m22:25:42.655126 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/marts/_core_models.yml/unique_dim_products_product_id.sql
[0m22:25:42.655487 [info ] [MainThread]: 
[0m22:25:42.655743 [error] [MainThread]: [31mFailure in test unique_dim_users_email (models/marts/_core_models.yml)[0m
[0m22:25:42.655987 [error] [MainThread]:   Got 3603 results, configured to fail if != 0
[0m22:25:42.656189 [info ] [MainThread]: 
[0m22:25:42.656635 [info ] [MainThread]:   compiled code at target/compiled/digital_marketing/models/marts/_core_models.yml/unique_dim_users_email.sql
[0m22:25:42.656980 [info ] [MainThread]: 
[0m22:25:42.657544 [info ] [MainThread]: Done. PASS=38 WARN=0 ERROR=8 SKIP=0 NO-OP=0 TOTAL=46
[0m22:25:42.680652 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 81.44214, "process_in_blocks": "0", "process_kernel_time": 1.062368, "process_mem_max_rss": "372146176", "process_out_blocks": "0", "process_user_time": 9.82313}
[0m22:25:42.681290 [debug] [MainThread]: Command `dbt test` failed at 22:25:42.681218 after 81.44 seconds
[0m22:25:42.681664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105853d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af75df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af75af0>]}
[0m22:25:42.682030 [debug] [MainThread]: Flushing usage events
[0m22:25:42.991865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:35:58.144262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bc3d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109092190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109092460>]}


============================== 22:35:58.148907 | be40b47c-bf1c-4567-a9be-b9541ce2514c ==============================
[0m22:35:58.148907 [info ] [MainThread]: Running with dbt=1.10.10
[0m22:35:58.149375 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'printer_width': '80', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'quiet': 'False', 'invocation_command': 'dbt docs generate', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'debug': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_format': 'default', 'profiles_dir': '/Users/azadsolanki/.dbt'}
[0m22:36:00.380022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be40b47c-bf1c-4567-a9be-b9541ce2514c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c6f9b20>]}
[0m22:36:00.421709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be40b47c-bf1c-4567-a9be-b9541ce2514c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c6c6490>]}
[0m22:36:00.422277 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:36:00.640660 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m22:36:01.028503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:36:01.028938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:36:01.035647 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.thelook_analytics.marts.finance
- models.thelook_analytics.marts.marketing
- models.thelook_analytics.reports
- models.thelook_analytics.marts.core
- models.thelook_analytics.intermediate
- models.thelook_analytics.staging
- seeds.thelook_analytics.customer_segments
- seeds.thelook_analytics.product_categories
- snapshots.thelook_analytics
[0m22:36:01.110546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be40b47c-bf1c-4567-a9be-b9541ce2514c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d1e7130>]}
[0m22:36:01.133059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be40b47c-bf1c-4567-a9be-b9541ce2514c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cde6190>]}
[0m22:36:01.133576 [info ] [MainThread]: Found 45 models, 1 snapshot, 2 seeds, 5 operations, 41 data tests, 6 sources, 1492 macros
[0m22:36:01.133847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be40b47c-bf1c-4567-a9be-b9541ce2514c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cde6220>]}
[0m22:36:01.137617 [info ] [MainThread]: 
[0m22:36:01.137997 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:36:01.138223 [info ] [MainThread]: 
[0m22:36:01.138745 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:36:01.147868 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-products-441119_snapshot'
[0m22:36:01.148503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:01.778401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-products-441119_snapshot, now list_data-products-441119_dbt_dev_analytics)
[0m22:36:01.779308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:36:02.282589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be40b47c-bf1c-4567-a9be-b9541ce2514c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d226220>]}
[0m22:36:02.283064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:36:02.357036 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_events
[0m22:36:02.357437 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_data-products-441119_dbt_dev_analytics, now model.digital_marketing.stg_events)
[0m22:36:02.357693 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_events
[0m22:36:02.370516 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_events"
[0m22:36:02.371685 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_events
[0m22:36:02.372076 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:02.442640 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_events
[0m22:36:02.443055 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_order_items
[0m22:36:02.443420 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_events, now model.digital_marketing.stg_order_items)
[0m22:36:02.443783 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_order_items
[0m22:36:02.449458 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_order_items"
[0m22:36:02.450375 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_order_items
[0m22:36:02.450674 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:02.519476 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_order_items
[0m22:36:02.519834 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_orders
[0m22:36:02.520127 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_order_items, now model.digital_marketing.stg_orders)
[0m22:36:02.520388 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_orders
[0m22:36:02.526058 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_orders"
[0m22:36:02.526676 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_orders
[0m22:36:02.526938 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:02.596165 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_orders
[0m22:36:02.596545 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_products
[0m22:36:02.596837 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_orders, now model.digital_marketing.stg_products)
[0m22:36:02.597082 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_products
[0m22:36:02.601085 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_products"
[0m22:36:02.601630 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_products
[0m22:36:02.601912 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:02.670410 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_products
[0m22:36:02.670818 [debug] [Thread-1  ]: Began running node model.digital_marketing.stg_users
[0m22:36:02.671211 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_products, now model.digital_marketing.stg_users)
[0m22:36:02.671536 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.stg_users
[0m22:36:02.676801 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.stg_users"
[0m22:36:02.677457 [debug] [Thread-1  ]: Began executing node model.digital_marketing.stg_users
[0m22:36:02.677737 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:02.747146 [debug] [Thread-1  ]: Finished running node model.digital_marketing.stg_users
[0m22:36:02.747521 [debug] [Thread-1  ]: Began running node model.elementary.data_monitoring_metrics
[0m22:36:02.747800 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.stg_users, now model.elementary.data_monitoring_metrics)
[0m22:36:02.748050 [debug] [Thread-1  ]: Began compiling node model.elementary.data_monitoring_metrics
[0m22:36:02.786680 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.data_monitoring_metrics"
[0m22:36:02.790182 [debug] [Thread-1  ]: Began executing node model.elementary.data_monitoring_metrics
[0m22:36:02.790588 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:02.859376 [debug] [Thread-1  ]: Finished running node model.elementary.data_monitoring_metrics
[0m22:36:02.859740 [debug] [Thread-1  ]: Began running node model.elementary.dbt_columns
[0m22:36:02.860026 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.data_monitoring_metrics, now model.elementary.dbt_columns)
[0m22:36:02.860283 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_columns
[0m22:36:02.871178 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_columns"
[0m22:36:02.872052 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_columns
[0m22:36:02.872473 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:02.941409 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_columns
[0m22:36:02.941777 [debug] [Thread-1  ]: Began running node model.elementary.dbt_exposures
[0m22:36:02.942069 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_columns, now model.elementary.dbt_exposures)
[0m22:36:02.942412 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_exposures
[0m22:36:02.952532 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_exposures"
[0m22:36:02.953163 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_exposures
[0m22:36:02.953467 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:03.022167 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_exposures
[0m22:36:03.022599 [debug] [Thread-1  ]: Began running node model.elementary.dbt_invocations
[0m22:36:03.022913 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_exposures, now model.elementary.dbt_invocations)
[0m22:36:03.023182 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_invocations
[0m22:36:03.037318 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_invocations"
[0m22:36:03.038088 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_invocations
[0m22:36:03.038429 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:03.108284 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_invocations
[0m22:36:03.108629 [debug] [Thread-1  ]: Began running node model.elementary.dbt_metrics
[0m22:36:03.108898 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_invocations, now model.elementary.dbt_metrics)
[0m22:36:03.109148 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_metrics
[0m22:36:03.119470 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_metrics"
[0m22:36:03.120164 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_metrics
[0m22:36:03.120491 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:03.189973 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_metrics
[0m22:36:03.190370 [debug] [Thread-1  ]: Began running node model.elementary.dbt_models
[0m22:36:03.190807 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_metrics, now model.elementary.dbt_models)
[0m22:36:03.191128 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_models
[0m22:36:03.202712 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_models"
[0m22:36:03.203452 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_models
[0m22:36:03.203782 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:03.272438 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_models
[0m22:36:03.272823 [debug] [Thread-1  ]: Began running node model.elementary.dbt_run_results
[0m22:36:03.273119 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_models, now model.elementary.dbt_run_results)
[0m22:36:03.273401 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_run_results
[0m22:36:03.286993 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_run_results"
[0m22:36:03.287670 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_run_results
[0m22:36:03.287976 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:03.356442 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_run_results
[0m22:36:03.356799 [debug] [Thread-1  ]: Began running node model.elementary.dbt_seeds
[0m22:36:03.357082 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_run_results, now model.elementary.dbt_seeds)
[0m22:36:03.357336 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_seeds
[0m22:36:03.366924 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_seeds"
[0m22:36:03.367769 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_seeds
[0m22:36:03.368062 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:03.437059 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_seeds
[0m22:36:03.437462 [debug] [Thread-1  ]: Began running node model.elementary.dbt_snapshots
[0m22:36:03.437863 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_seeds, now model.elementary.dbt_snapshots)
[0m22:36:03.438192 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_snapshots
[0m22:36:03.445796 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_snapshots"
[0m22:36:03.446501 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_snapshots
[0m22:36:03.446808 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:03.515598 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_snapshots
[0m22:36:03.515965 [debug] [Thread-1  ]: Began running node model.elementary.dbt_source_freshness_results
[0m22:36:03.516308 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_snapshots, now model.elementary.dbt_source_freshness_results)
[0m22:36:03.516625 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_source_freshness_results
[0m22:36:03.525892 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_source_freshness_results"
[0m22:36:03.526482 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_source_freshness_results
[0m22:36:03.526761 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:03.594792 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_source_freshness_results
[0m22:36:03.595454 [debug] [Thread-1  ]: Began running node model.elementary.dbt_sources
[0m22:36:03.595731 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_source_freshness_results, now model.elementary.dbt_sources)
[0m22:36:03.595985 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_sources
[0m22:36:03.606754 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_sources"
[0m22:36:03.607404 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_sources
[0m22:36:03.607691 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:03.675878 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_sources
[0m22:36:03.676242 [debug] [Thread-1  ]: Began running node model.elementary.dbt_tests
[0m22:36:03.676527 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_sources, now model.elementary.dbt_tests)
[0m22:36:03.676780 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_tests
[0m22:36:03.688484 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_tests"
[0m22:36:03.689242 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_tests
[0m22:36:03.689577 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:03.759154 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_tests
[0m22:36:03.759590 [debug] [Thread-1  ]: Began running node model.elementary.elementary_test_results
[0m22:36:03.759938 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_tests, now model.elementary.elementary_test_results)
[0m22:36:03.760352 [debug] [Thread-1  ]: Began compiling node model.elementary.elementary_test_results
[0m22:36:03.772825 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.elementary_test_results"
[0m22:36:03.773511 [debug] [Thread-1  ]: Began executing node model.elementary.elementary_test_results
[0m22:36:03.773832 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:03.859459 [debug] [Thread-1  ]: Finished running node model.elementary.elementary_test_results
[0m22:36:03.859908 [debug] [Thread-1  ]: Began running node model.elementary.metadata
[0m22:36:03.860360 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.elementary_test_results, now model.elementary.metadata)
[0m22:36:03.860642 [debug] [Thread-1  ]: Began compiling node model.elementary.metadata
[0m22:36:03.866862 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.metadata"
[0m22:36:03.867551 [debug] [Thread-1  ]: Began executing node model.elementary.metadata
[0m22:36:03.867847 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:03.936273 [debug] [Thread-1  ]: Finished running node model.elementary.metadata
[0m22:36:03.936625 [debug] [Thread-1  ]: Began running node model.elementary.schema_columns_snapshot
[0m22:36:03.936897 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.metadata, now model.elementary.schema_columns_snapshot)
[0m22:36:03.937152 [debug] [Thread-1  ]: Began compiling node model.elementary.schema_columns_snapshot
[0m22:36:03.944674 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.schema_columns_snapshot"
[0m22:36:03.945539 [debug] [Thread-1  ]: Began executing node model.elementary.schema_columns_snapshot
[0m22:36:03.945842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:04.014122 [debug] [Thread-1  ]: Finished running node model.elementary.schema_columns_snapshot
[0m22:36:04.014524 [debug] [Thread-1  ]: Began running node operation.digital_marketing.digital_marketing-on-run-end-0
[0m22:36:04.014824 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.schema_columns_snapshot, now operation.digital_marketing.digital_marketing-on-run-end-0)
[0m22:36:04.015083 [debug] [Thread-1  ]: Began compiling node operation.digital_marketing.digital_marketing-on-run-end-0
[0m22:36:04.019463 [info ] [Thread-1  ]: === DBT Run Completed Successfully ===
[0m22:36:04.019913 [debug] [Thread-1  ]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-end-0"
[0m22:36:04.020214 [debug] [Thread-1  ]: Began executing node operation.digital_marketing.digital_marketing-on-run-end-0
[0m22:36:04.020498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:04.091026 [debug] [Thread-1  ]: Finished running node operation.digital_marketing.digital_marketing-on-run-end-0
[0m22:36:04.091439 [debug] [Thread-1  ]: Began running node operation.digital_marketing.digital_marketing-on-run-start-0
[0m22:36:04.091812 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly operation.digital_marketing.digital_marketing-on-run-end-0, now operation.digital_marketing.digital_marketing-on-run-start-0)
[0m22:36:04.092135 [debug] [Thread-1  ]: Began compiling node operation.digital_marketing.digital_marketing-on-run-start-0
[0m22:36:04.096341 [info ] [Thread-1  ]: === DBT Run Started at: 2025-09-16 05:35:58 ===
[0m22:36:04.096762 [debug] [Thread-1  ]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-0"
[0m22:36:04.097046 [debug] [Thread-1  ]: Began executing node operation.digital_marketing.digital_marketing-on-run-start-0
[0m22:36:04.097338 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:04.166669 [debug] [Thread-1  ]: Finished running node operation.digital_marketing.digital_marketing-on-run-start-0
[0m22:36:04.167017 [debug] [Thread-1  ]: Began running node operation.digital_marketing.digital_marketing-on-run-start-1
[0m22:36:04.167287 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly operation.digital_marketing.digital_marketing-on-run-start-0, now operation.digital_marketing.digital_marketing-on-run-start-1)
[0m22:36:04.167533 [debug] [Thread-1  ]: Began compiling node operation.digital_marketing.digital_marketing-on-run-start-1
[0m22:36:04.171178 [debug] [Thread-1  ]: Writing injected SQL for node "operation.digital_marketing.digital_marketing-on-run-start-1"
[0m22:36:04.171880 [debug] [Thread-1  ]: Began executing node operation.digital_marketing.digital_marketing-on-run-start-1
[0m22:36:04.172212 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:04.243625 [debug] [Thread-1  ]: Finished running node operation.digital_marketing.digital_marketing-on-run-start-1
[0m22:36:04.244073 [debug] [Thread-1  ]: Began running node operation.elementary.elementary-on-run-end-0
[0m22:36:04.244484 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly operation.digital_marketing.digital_marketing-on-run-start-1, now operation.elementary.elementary-on-run-end-0)
[0m22:36:04.244798 [debug] [Thread-1  ]: Began compiling node operation.elementary.elementary-on-run-end-0
[0m22:36:04.254251 [debug] [Thread-1  ]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m22:36:04.254944 [debug] [Thread-1  ]: Began executing node operation.elementary.elementary-on-run-end-0
[0m22:36:04.255253 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:04.326961 [debug] [Thread-1  ]: Finished running node operation.elementary.elementary-on-run-end-0
[0m22:36:04.327305 [debug] [Thread-1  ]: Began running node operation.elementary.elementary-on-run-start-0
[0m22:36:04.327572 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly operation.elementary.elementary-on-run-end-0, now operation.elementary.elementary-on-run-start-0)
[0m22:36:04.327820 [debug] [Thread-1  ]: Began compiling node operation.elementary.elementary-on-run-start-0
[0m22:36:04.338626 [debug] [Thread-1  ]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m22:36:04.339354 [debug] [Thread-1  ]: Began executing node operation.elementary.elementary-on-run-start-0
[0m22:36:04.339674 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:04.407132 [debug] [Thread-1  ]: Finished running node operation.elementary.elementary-on-run-start-0
[0m22:36:04.407495 [debug] [Thread-1  ]: Began running node seed.digital_marketing.customer_segments
[0m22:36:04.407770 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly operation.elementary.elementary-on-run-start-0, now seed.digital_marketing.customer_segments)
[0m22:36:04.408027 [debug] [Thread-1  ]: Began compiling node seed.digital_marketing.customer_segments
[0m22:36:04.412053 [debug] [Thread-1  ]: Began executing node seed.digital_marketing.customer_segments
[0m22:36:04.412514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:04.491837 [debug] [Thread-1  ]: Finished running node seed.digital_marketing.customer_segments
[0m22:36:04.492396 [debug] [Thread-1  ]: Began running node seed.digital_marketing.product_categories
[0m22:36:04.492799 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.digital_marketing.customer_segments, now seed.digital_marketing.product_categories)
[0m22:36:04.493081 [debug] [Thread-1  ]: Began compiling node seed.digital_marketing.product_categories
[0m22:36:04.497358 [debug] [Thread-1  ]: Began executing node seed.digital_marketing.product_categories
[0m22:36:04.497991 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:04.570158 [debug] [Thread-1  ]: Finished running node seed.digital_marketing.product_categories
[0m22:36:04.570566 [debug] [Thread-1  ]: Began running node snapshot.digital_marketing.snap_products
[0m22:36:04.570857 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.digital_marketing.product_categories, now snapshot.digital_marketing.snap_products)
[0m22:36:04.571122 [debug] [Thread-1  ]: Began compiling node snapshot.digital_marketing.snap_products
[0m22:36:04.576409 [debug] [Thread-1  ]: Began executing node snapshot.digital_marketing.snap_products
[0m22:36:04.576884 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:04.645571 [debug] [Thread-1  ]: Finished running node snapshot.digital_marketing.snap_products
[0m22:36:04.646009 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265
[0m22:36:04.646315 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.digital_marketing.snap_products, now test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265)
[0m22:36:04.646579 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265
[0m22:36:04.656947 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265"
[0m22:36:04.658512 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265
[0m22:36:04.658828 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:04.727544 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265
[0m22:36:04.727920 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50
[0m22:36:04.728215 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_order_items_id.33dbceb265, now test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50)
[0m22:36:04.728474 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50
[0m22:36:04.733415 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50"
[0m22:36:04.734556 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50
[0m22:36:04.734899 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:04.804078 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50
[0m22:36:04.804449 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8
[0m22:36:04.804753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_order_items_order_id.d9aa42db50, now test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8)
[0m22:36:04.805014 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8
[0m22:36:04.810803 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8"
[0m22:36:04.811432 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8
[0m22:36:04.811729 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:04.881285 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8
[0m22:36:04.881670 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41
[0m22:36:04.882048 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_orders_order_id.5dd0719ef8, now test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41)
[0m22:36:04.882375 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41
[0m22:36:04.887164 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41"
[0m22:36:04.887792 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41
[0m22:36:04.888098 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:04.956549 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41
[0m22:36:04.956953 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8
[0m22:36:04.957276 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_orders_user_id.1fdf909a41, now test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8)
[0m22:36:04.957651 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8
[0m22:36:04.962844 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8"
[0m22:36:04.963481 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8
[0m22:36:04.963783 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:05.032064 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8
[0m22:36:05.032460 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1
[0m22:36:05.032764 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_products_id.202ee8cae8, now test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1)
[0m22:36:05.033022 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1
[0m22:36:05.037674 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1"
[0m22:36:05.038534 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1
[0m22:36:05.038818 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:05.106936 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1
[0m22:36:05.107321 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53
[0m22:36:05.107773 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_users_created_at.e4c994f9f1, now test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53)
[0m22:36:05.108086 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53
[0m22:36:05.112852 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53"
[0m22:36:05.113486 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53
[0m22:36:05.113775 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:05.182682 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53
[0m22:36:05.183052 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588
[0m22:36:05.183334 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_users_email.ca40db6f53, now test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588)
[0m22:36:05.183597 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588
[0m22:36:05.187829 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588"
[0m22:36:05.188395 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588
[0m22:36:05.188678 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:05.256681 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588
[0m22:36:05.257063 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c
[0m22:36:05.257486 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_not_null_thelook_ecommerce_users_id.df3e400588, now test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c)
[0m22:36:05.257765 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c
[0m22:36:05.265283 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c"
[0m22:36:05.266272 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c
[0m22:36:05.266560 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:05.336914 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c
[0m22:36:05.337384 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d
[0m22:36:05.337822 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_relationships_thelook_ecommerce_order_items_order_id__order_id__source_thelook_ecommerce_orders_.7c2d14368c, now test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d)
[0m22:36:05.338173 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d
[0m22:36:05.345296 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d"
[0m22:36:05.346033 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d
[0m22:36:05.346342 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:05.416249 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d
[0m22:36:05.416600 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c
[0m22:36:05.416925 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_relationships_thelook_ecommerce_orders_user_id__id__source_thelook_ecommerce_users_.d3da47e53d, now test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c)
[0m22:36:05.417186 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c
[0m22:36:05.423407 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c"
[0m22:36:05.424171 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c
[0m22:36:05.424491 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:05.493380 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c
[0m22:36:05.493789 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268
[0m22:36:05.494175 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_order_items_id.5f6147e80c, now test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268)
[0m22:36:05.494505 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268
[0m22:36:05.500230 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268"
[0m22:36:05.501209 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268
[0m22:36:05.501540 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:05.570598 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268
[0m22:36:05.570974 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd
[0m22:36:05.571258 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_orders_order_id.6d3cb72268, now test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd)
[0m22:36:05.571511 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd
[0m22:36:05.576412 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd"
[0m22:36:05.577789 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd
[0m22:36:05.578085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:05.645936 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd
[0m22:36:05.646324 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d
[0m22:36:05.646629 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_products_id.2107922dcd, now test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d)
[0m22:36:05.646900 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d
[0m22:36:05.651531 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d"
[0m22:36:05.652188 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d
[0m22:36:05.652498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:05.720928 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d
[0m22:36:05.721301 [debug] [Thread-1  ]: Began running node test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6
[0m22:36:05.721591 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_users_email.add6d40b4d, now test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6)
[0m22:36:05.721848 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6
[0m22:36:05.727278 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6"
[0m22:36:05.728782 [debug] [Thread-1  ]: Began executing node test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6
[0m22:36:05.729151 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:05.798181 [debug] [Thread-1  ]: Finished running node test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6
[0m22:36:05.798550 [debug] [Thread-1  ]: Began running node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m22:36:05.798841 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.source_unique_thelook_ecommerce_users_id.c8a19c10d6, now test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde)
[0m22:36:05.799098 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m22:36:05.806738 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde"
[0m22:36:05.810404 [debug] [Thread-1  ]: Began executing node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m22:36:05.810770 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:05.878659 [debug] [Thread-1  ]: Finished running node test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde
[0m22:36:05.879030 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m22:36:05.879329 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.dbt_utils_accepted_range_stg_order_items_sale_price__10000__0.d8a3358cde, now test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m22:36:05.879586 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m22:36:05.884715 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m22:36:05.886641 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m22:36:05.886979 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:05.955809 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m22:36:05.956182 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m22:36:05.956561 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0)
[0m22:36:05.956903 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m22:36:05.961620 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0"
[0m22:36:05.962246 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m22:36:05.962521 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:06.030781 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0
[0m22:36:06.031164 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m22:36:06.031462 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_order_items_sale_price.5a455c32d0, now test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108)
[0m22:36:06.031724 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m22:36:06.036325 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108"
[0m22:36:06.037180 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m22:36:06.037499 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:06.105844 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108
[0m22:36:06.106306 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m22:36:06.106684 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_order_items_order_item_id.90e333a108, now test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb)
[0m22:36:06.106992 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m22:36:06.112345 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb"
[0m22:36:06.112979 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m22:36:06.113244 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:06.182403 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb
[0m22:36:06.182794 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m22:36:06.183092 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_order_date.2177a3e8bb, now test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64)
[0m22:36:06.183355 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m22:36:06.187982 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64"
[0m22:36:06.188601 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m22:36:06.188891 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:06.258046 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64
[0m22:36:06.258494 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m22:36:06.258949 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_order_id.81cfe2fe64, now test.digital_marketing.not_null_stg_orders_user_id.7d129d0209)
[0m22:36:06.259266 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m22:36:06.264187 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_orders_user_id.7d129d0209"
[0m22:36:06.264987 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m22:36:06.265259 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:06.333507 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_orders_user_id.7d129d0209
[0m22:36:06.333841 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m22:36:06.334109 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_orders_user_id.7d129d0209, now test.digital_marketing.unique_stg_orders_order_id.e3b841c71a)
[0m22:36:06.334472 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m22:36:06.338888 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_orders_order_id.e3b841c71a"
[0m22:36:06.339865 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m22:36:06.340262 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:06.414722 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_orders_order_id.e3b841c71a
[0m22:36:06.415497 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m22:36:06.416014 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_orders_order_id.e3b841c71a, now test.digital_marketing.not_null_stg_products_product_id.6373b0acf3)
[0m22:36:06.416393 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m22:36:06.421732 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_products_product_id.6373b0acf3"
[0m22:36:06.422686 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m22:36:06.423169 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:06.502446 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_products_product_id.6373b0acf3
[0m22:36:06.503158 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m22:36:06.503701 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_products_product_id.6373b0acf3, now test.digital_marketing.unique_stg_products_product_id.7d950a1467)
[0m22:36:06.504016 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m22:36:06.704067 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_products_product_id.7d950a1467"
[0m22:36:06.704862 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m22:36:06.705233 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:06.775424 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_products_product_id.7d950a1467
[0m22:36:06.775773 [debug] [Thread-1  ]: Began running node model.digital_marketing.int_order_items_enriched
[0m22:36:06.776140 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_products_product_id.7d950a1467, now model.digital_marketing.int_order_items_enriched)
[0m22:36:06.776389 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.int_order_items_enriched
[0m22:36:06.780781 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.int_order_items_enriched"
[0m22:36:06.781939 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:06.850124 [debug] [Thread-1  ]: Finished running node model.digital_marketing.int_order_items_enriched
[0m22:36:06.850520 [debug] [Thread-1  ]: Began running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:36:06.850828 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.int_order_items_enriched, now test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2)
[0m22:36:06.851089 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:36:06.856416 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2"
[0m22:36:06.858179 [debug] [Thread-1  ]: Began executing node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:36:06.858587 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:06.927022 [debug] [Thread-1  ]: Finished running node test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2
[0m22:36:06.927392 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:36:06.927744 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.dbt_utils_accepted_range_stg_users_age__120__13.aab23c6be2, now test.digital_marketing.not_null_stg_users_email.2723c62e0e)
[0m22:36:06.928014 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:36:06.932408 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_email.2723c62e0e"
[0m22:36:06.933137 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:36:06.933430 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:07.001625 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_email.2723c62e0e
[0m22:36:07.001990 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:36:07.002275 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_email.2723c62e0e, now test.digital_marketing.not_null_stg_users_user_id.980dfc1b77)
[0m22:36:07.002528 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:36:07.007365 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_stg_users_user_id.980dfc1b77"
[0m22:36:07.008112 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:36:07.008448 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:07.076723 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_stg_users_user_id.980dfc1b77
[0m22:36:07.077115 [debug] [Thread-1  ]: Began running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:36:07.077430 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_stg_users_user_id.980dfc1b77, now test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737)
[0m22:36:07.077691 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:36:07.083774 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737"
[0m22:36:07.085202 [debug] [Thread-1  ]: Began executing node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:36:07.085510 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:07.153710 [debug] [Thread-1  ]: Finished running node test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737
[0m22:36:07.154153 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:36:07.154564 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.relationships_stg_orders_user_id__user_id__ref_stg_users_.42a5ade737, now test.digital_marketing.unique_stg_users_user_id.c2ff477e6b)
[0m22:36:07.154908 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:36:07.159969 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_stg_users_user_id.c2ff477e6b"
[0m22:36:07.160698 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:36:07.161021 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:07.231739 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_stg_users_user_id.c2ff477e6b
[0m22:36:07.232101 [debug] [Thread-1  ]: Began running node model.elementary.metrics_anomaly_score
[0m22:36:07.232461 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_stg_users_user_id.c2ff477e6b, now model.elementary.metrics_anomaly_score)
[0m22:36:07.232767 [debug] [Thread-1  ]: Began compiling node model.elementary.metrics_anomaly_score
[0m22:36:07.251111 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.metrics_anomaly_score"
[0m22:36:07.251920 [debug] [Thread-1  ]: Began executing node model.elementary.metrics_anomaly_score
[0m22:36:07.252231 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:07.320424 [debug] [Thread-1  ]: Finished running node model.elementary.metrics_anomaly_score
[0m22:36:07.320786 [debug] [Thread-1  ]: Began running node model.elementary.monitors_runs
[0m22:36:07.321074 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.metrics_anomaly_score, now model.elementary.monitors_runs)
[0m22:36:07.321337 [debug] [Thread-1  ]: Began compiling node model.elementary.monitors_runs
[0m22:36:07.325724 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.monitors_runs"
[0m22:36:07.326679 [debug] [Thread-1  ]: Began executing node model.elementary.monitors_runs
[0m22:36:07.327010 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:07.395214 [debug] [Thread-1  ]: Finished running node model.elementary.monitors_runs
[0m22:36:07.395589 [debug] [Thread-1  ]: Began running node model.elementary.job_run_results
[0m22:36:07.395957 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.monitors_runs, now model.elementary.job_run_results)
[0m22:36:07.396279 [debug] [Thread-1  ]: Began compiling node model.elementary.job_run_results
[0m22:36:07.404090 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.job_run_results"
[0m22:36:07.405572 [debug] [Thread-1  ]: Began executing node model.elementary.job_run_results
[0m22:36:07.405932 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:07.474720 [debug] [Thread-1  ]: Finished running node model.elementary.job_run_results
[0m22:36:07.475103 [debug] [Thread-1  ]: Began running node model.elementary.model_run_results
[0m22:36:07.475479 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.job_run_results, now model.elementary.model_run_results)
[0m22:36:07.475788 [debug] [Thread-1  ]: Began compiling node model.elementary.model_run_results
[0m22:36:07.482755 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.model_run_results"
[0m22:36:07.483546 [debug] [Thread-1  ]: Began executing node model.elementary.model_run_results
[0m22:36:07.483839 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:07.553819 [debug] [Thread-1  ]: Finished running node model.elementary.model_run_results
[0m22:36:07.554226 [debug] [Thread-1  ]: Began running node model.elementary.snapshot_run_results
[0m22:36:07.554612 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.model_run_results, now model.elementary.snapshot_run_results)
[0m22:36:07.554941 [debug] [Thread-1  ]: Began compiling node model.elementary.snapshot_run_results
[0m22:36:07.559756 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.snapshot_run_results"
[0m22:36:07.560787 [debug] [Thread-1  ]: Began executing node model.elementary.snapshot_run_results
[0m22:36:07.561077 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:07.635611 [debug] [Thread-1  ]: Finished running node model.elementary.snapshot_run_results
[0m22:36:07.636062 [debug] [Thread-1  ]: Began running node model.elementary.alerts_dbt_source_freshness
[0m22:36:07.636477 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.snapshot_run_results, now model.elementary.alerts_dbt_source_freshness)
[0m22:36:07.636896 [debug] [Thread-1  ]: Began compiling node model.elementary.alerts_dbt_source_freshness
[0m22:36:07.644024 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.alerts_dbt_source_freshness"
[0m22:36:07.644766 [debug] [Thread-1  ]: Began executing node model.elementary.alerts_dbt_source_freshness
[0m22:36:07.645089 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:07.714083 [debug] [Thread-1  ]: Finished running node model.elementary.alerts_dbt_source_freshness
[0m22:36:07.714437 [debug] [Thread-1  ]: Began running node model.elementary.information_schema_columns
[0m22:36:07.714710 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.alerts_dbt_source_freshness, now model.elementary.information_schema_columns)
[0m22:36:07.714958 [debug] [Thread-1  ]: Began compiling node model.elementary.information_schema_columns
[0m22:36:07.730349 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:08.960145 [debug] [Thread-1  ]: On model.elementary.information_schema_columns: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.elementary.information_schema_columns"} */

    
    begin
      select 1
      from `bigquery-public-data`.`thelook_ecommerce`.INFORMATION_SCHEMA.COLUMNS
      limit 1;
    exception when error then
      select 0;
    end
  
  
[0m22:36:09.177113 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:f975d9c0-5d20-4b5d-a566-e91ad3663ecb&page=queryresults
[0m22:36:10.475973 [debug] [Thread-1  ]: On model.elementary.information_schema_columns: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "node_id": "model.elementary.information_schema_columns"} */

    
    begin
      select 1
      from `data-products-441119`.`dbt_dev_analytics`.INFORMATION_SCHEMA.COLUMNS
      limit 1;
    exception when error then
      select 0;
    end
  
  
[0m22:36:10.659678 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:a6188935-1bc9-41aa-a11c-3329e10e88a8&page=queryresults
[0m22:36:11.921479 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.information_schema_columns"
[0m22:36:11.922995 [debug] [Thread-1  ]: Began executing node model.elementary.information_schema_columns
[0m22:36:11.936649 [debug] [Thread-1  ]: Finished running node model.elementary.information_schema_columns
[0m22:36:11.937245 [debug] [Thread-1  ]: Began running node model.elementary.dbt_artifacts_hashes
[0m22:36:11.938009 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.information_schema_columns, now model.elementary.dbt_artifacts_hashes)
[0m22:36:11.938729 [debug] [Thread-1  ]: Began compiling node model.elementary.dbt_artifacts_hashes
[0m22:36:11.950628 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.dbt_artifacts_hashes"
[0m22:36:11.951545 [debug] [Thread-1  ]: Began executing node model.elementary.dbt_artifacts_hashes
[0m22:36:11.952046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:12.040891 [debug] [Thread-1  ]: Finished running node model.elementary.dbt_artifacts_hashes
[0m22:36:12.041322 [debug] [Thread-1  ]: Began running node model.elementary.alerts_anomaly_detection
[0m22:36:12.041633 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.dbt_artifacts_hashes, now model.elementary.alerts_anomaly_detection)
[0m22:36:12.041901 [debug] [Thread-1  ]: Began compiling node model.elementary.alerts_anomaly_detection
[0m22:36:12.048217 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.alerts_anomaly_detection"
[0m22:36:12.048799 [debug] [Thread-1  ]: Began executing node model.elementary.alerts_anomaly_detection
[0m22:36:12.049070 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:12.116006 [debug] [Thread-1  ]: Finished running node model.elementary.alerts_anomaly_detection
[0m22:36:12.116387 [debug] [Thread-1  ]: Began running node model.elementary.alerts_dbt_tests
[0m22:36:12.116689 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.alerts_anomaly_detection, now model.elementary.alerts_dbt_tests)
[0m22:36:12.116943 [debug] [Thread-1  ]: Began compiling node model.elementary.alerts_dbt_tests
[0m22:36:12.122171 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.alerts_dbt_tests"
[0m22:36:12.122705 [debug] [Thread-1  ]: Began executing node model.elementary.alerts_dbt_tests
[0m22:36:12.122975 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:12.197630 [debug] [Thread-1  ]: Finished running node model.elementary.alerts_dbt_tests
[0m22:36:12.198462 [debug] [Thread-1  ]: Began running node model.elementary.alerts_schema_changes
[0m22:36:12.199036 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.alerts_dbt_tests, now model.elementary.alerts_schema_changes)
[0m22:36:12.199396 [debug] [Thread-1  ]: Began compiling node model.elementary.alerts_schema_changes
[0m22:36:12.206214 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.alerts_schema_changes"
[0m22:36:12.206974 [debug] [Thread-1  ]: Began executing node model.elementary.alerts_schema_changes
[0m22:36:12.207289 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:12.281946 [debug] [Thread-1  ]: Finished running node model.elementary.alerts_schema_changes
[0m22:36:12.282353 [debug] [Thread-1  ]: Began running node model.elementary.test_result_rows
[0m22:36:12.282705 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.alerts_schema_changes, now model.elementary.test_result_rows)
[0m22:36:12.283017 [debug] [Thread-1  ]: Began compiling node model.elementary.test_result_rows
[0m22:36:12.290315 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.test_result_rows"
[0m22:36:12.291120 [debug] [Thread-1  ]: Began executing node model.elementary.test_result_rows
[0m22:36:12.291456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:12.368902 [debug] [Thread-1  ]: Finished running node model.elementary.test_result_rows
[0m22:36:12.369300 [debug] [Thread-1  ]: Began running node model.digital_marketing.fct_orders
[0m22:36:12.369600 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.test_result_rows, now model.digital_marketing.fct_orders)
[0m22:36:12.369858 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.fct_orders
[0m22:36:12.418415 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.fct_orders"
[0m22:36:12.419539 [debug] [Thread-1  ]: Began executing node model.digital_marketing.fct_orders
[0m22:36:12.419858 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:12.490821 [debug] [Thread-1  ]: Finished running node model.digital_marketing.fct_orders
[0m22:36:12.491197 [debug] [Thread-1  ]: Began running node model.digital_marketing.int_product_metrics
[0m22:36:12.491471 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.fct_orders, now model.digital_marketing.int_product_metrics)
[0m22:36:12.491713 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.int_product_metrics
[0m22:36:12.518562 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.int_product_metrics"
[0m22:36:12.520139 [debug] [Thread-1  ]: Began executing node model.digital_marketing.int_product_metrics
[0m22:36:12.520494 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:12.593833 [debug] [Thread-1  ]: Finished running node model.digital_marketing.int_product_metrics
[0m22:36:12.594212 [debug] [Thread-1  ]: Began running node model.digital_marketing.int_user_order_history
[0m22:36:12.594615 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.int_product_metrics, now model.digital_marketing.int_user_order_history)
[0m22:36:12.595018 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.int_user_order_history
[0m22:36:12.623420 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.int_user_order_history"
[0m22:36:12.624862 [debug] [Thread-1  ]: Began executing node model.digital_marketing.int_user_order_history
[0m22:36:12.625166 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:12.692462 [debug] [Thread-1  ]: Finished running node model.digital_marketing.int_user_order_history
[0m22:36:12.692817 [debug] [Thread-1  ]: Began running node model.elementary.anomaly_threshold_sensitivity
[0m22:36:12.693087 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.int_user_order_history, now model.elementary.anomaly_threshold_sensitivity)
[0m22:36:12.693332 [debug] [Thread-1  ]: Began compiling node model.elementary.anomaly_threshold_sensitivity
[0m22:36:12.701363 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.anomaly_threshold_sensitivity"
[0m22:36:12.702065 [debug] [Thread-1  ]: Began executing node model.elementary.anomaly_threshold_sensitivity
[0m22:36:12.702375 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:12.770473 [debug] [Thread-1  ]: Finished running node model.elementary.anomaly_threshold_sensitivity
[0m22:36:12.770829 [debug] [Thread-1  ]: Began running node model.elementary.alerts_dbt_models
[0m22:36:12.771105 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.anomaly_threshold_sensitivity, now model.elementary.alerts_dbt_models)
[0m22:36:12.771359 [debug] [Thread-1  ]: Began compiling node model.elementary.alerts_dbt_models
[0m22:36:12.776768 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.alerts_dbt_models"
[0m22:36:12.778269 [debug] [Thread-1  ]: Began executing node model.elementary.alerts_dbt_models
[0m22:36:12.778681 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:12.848567 [debug] [Thread-1  ]: Finished running node model.elementary.alerts_dbt_models
[0m22:36:12.848929 [debug] [Thread-1  ]: Began running node model.elementary.enriched_columns
[0m22:36:12.849202 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.alerts_dbt_models, now model.elementary.enriched_columns)
[0m22:36:12.849460 [debug] [Thread-1  ]: Began compiling node model.elementary.enriched_columns
[0m22:36:12.854185 [debug] [Thread-1  ]: Writing injected SQL for node "model.elementary.enriched_columns"
[0m22:36:12.854702 [debug] [Thread-1  ]: Began executing node model.elementary.enriched_columns
[0m22:36:12.854961 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:12.922901 [debug] [Thread-1  ]: Finished running node model.elementary.enriched_columns
[0m22:36:12.923247 [debug] [Thread-1  ]: Began running node model.digital_marketing.fct_daily_revenue
[0m22:36:12.923514 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.elementary.enriched_columns, now model.digital_marketing.fct_daily_revenue)
[0m22:36:12.923756 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.fct_daily_revenue
[0m22:36:12.928962 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.fct_daily_revenue"
[0m22:36:12.930539 [debug] [Thread-1  ]: Began executing node model.digital_marketing.fct_daily_revenue
[0m22:36:12.930927 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:12.997841 [debug] [Thread-1  ]: Finished running node model.digital_marketing.fct_daily_revenue
[0m22:36:12.998189 [debug] [Thread-1  ]: Began running node model.digital_marketing.rpt_customer_cohorts
[0m22:36:12.998457 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.fct_daily_revenue, now model.digital_marketing.rpt_customer_cohorts)
[0m22:36:12.998702 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.rpt_customer_cohorts
[0m22:36:13.002752 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.rpt_customer_cohorts"
[0m22:36:13.003255 [debug] [Thread-1  ]: Began executing node model.digital_marketing.rpt_customer_cohorts
[0m22:36:13.003513 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:13.070370 [debug] [Thread-1  ]: Finished running node model.digital_marketing.rpt_customer_cohorts
[0m22:36:13.070731 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0
[0m22:36:13.070998 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.rpt_customer_cohorts, now test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0)
[0m22:36:13.071237 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0
[0m22:36:13.076343 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0"
[0m22:36:13.077201 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0
[0m22:36:13.077495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:13.144344 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0
[0m22:36:13.146501 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7
[0m22:36:13.146925 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_fct_orders_order_id.4e687af8d0, now test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7)
[0m22:36:13.147225 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7
[0m22:36:13.151597 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7"
[0m22:36:13.152159 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7
[0m22:36:13.152422 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:13.219512 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7
[0m22:36:13.219867 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5
[0m22:36:13.220133 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_fct_orders_user_id.14852ec2f7, now test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5)
[0m22:36:13.220507 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5
[0m22:36:13.225340 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5"
[0m22:36:13.226090 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5
[0m22:36:13.226382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:13.292622 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5
[0m22:36:13.292965 [debug] [Thread-1  ]: Began running node model.digital_marketing.dim_products
[0m22:36:13.293236 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_fct_orders_order_id.523ddb6ce5, now model.digital_marketing.dim_products)
[0m22:36:13.293479 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.dim_products
[0m22:36:13.297566 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.dim_products"
[0m22:36:13.298167 [debug] [Thread-1  ]: Began executing node model.digital_marketing.dim_products
[0m22:36:13.298440 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:13.364035 [debug] [Thread-1  ]: Finished running node model.digital_marketing.dim_products
[0m22:36:13.364350 [debug] [Thread-1  ]: Began running node model.digital_marketing.dim_users
[0m22:36:13.364605 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.dim_products, now model.digital_marketing.dim_users)
[0m22:36:13.364839 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.dim_users
[0m22:36:13.369373 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.dim_users"
[0m22:36:13.370063 [debug] [Thread-1  ]: Began executing node model.digital_marketing.dim_users
[0m22:36:13.370366 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:13.437466 [debug] [Thread-1  ]: Finished running node model.digital_marketing.dim_users
[0m22:36:13.437782 [debug] [Thread-1  ]: Began running node model.digital_marketing.rpt_product_performance
[0m22:36:13.438042 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.dim_users, now model.digital_marketing.rpt_product_performance)
[0m22:36:13.438281 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.rpt_product_performance
[0m22:36:13.442921 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.rpt_product_performance"
[0m22:36:13.443489 [debug] [Thread-1  ]: Began executing node model.digital_marketing.rpt_product_performance
[0m22:36:13.443777 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:13.512513 [debug] [Thread-1  ]: Finished running node model.digital_marketing.rpt_product_performance
[0m22:36:13.512922 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_dim_products_product_id.c8aba288d1
[0m22:36:13.513223 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.rpt_product_performance, now test.digital_marketing.not_null_dim_products_product_id.c8aba288d1)
[0m22:36:13.513665 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_dim_products_product_id.c8aba288d1
[0m22:36:13.519735 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_dim_products_product_id.c8aba288d1"
[0m22:36:13.520346 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_dim_products_product_id.c8aba288d1
[0m22:36:13.520622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:13.586262 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_dim_products_product_id.c8aba288d1
[0m22:36:13.586573 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_dim_products_product_name.991aec73f3
[0m22:36:13.586832 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_dim_products_product_id.c8aba288d1, now test.digital_marketing.not_null_dim_products_product_name.991aec73f3)
[0m22:36:13.587068 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_dim_products_product_name.991aec73f3
[0m22:36:13.592009 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_dim_products_product_name.991aec73f3"
[0m22:36:13.592677 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_dim_products_product_name.991aec73f3
[0m22:36:13.592992 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:13.659105 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_dim_products_product_name.991aec73f3
[0m22:36:13.659440 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_dim_products_product_id.ef7b2a9985
[0m22:36:13.659701 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_dim_products_product_name.991aec73f3, now test.digital_marketing.unique_dim_products_product_id.ef7b2a9985)
[0m22:36:13.660068 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_dim_products_product_id.ef7b2a9985
[0m22:36:13.664434 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_dim_products_product_id.ef7b2a9985"
[0m22:36:13.665010 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_dim_products_product_id.ef7b2a9985
[0m22:36:13.665283 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:13.731133 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_dim_products_product_id.ef7b2a9985
[0m22:36:13.731479 [debug] [Thread-1  ]: Began running node model.digital_marketing.rpt_executive_dashboard
[0m22:36:13.731744 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_dim_products_product_id.ef7b2a9985, now model.digital_marketing.rpt_executive_dashboard)
[0m22:36:13.731986 [debug] [Thread-1  ]: Began compiling node model.digital_marketing.rpt_executive_dashboard
[0m22:36:13.736389 [debug] [Thread-1  ]: Writing injected SQL for node "model.digital_marketing.rpt_executive_dashboard"
[0m22:36:13.736875 [debug] [Thread-1  ]: Began executing node model.digital_marketing.rpt_executive_dashboard
[0m22:36:13.737131 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:13.801996 [debug] [Thread-1  ]: Finished running node model.digital_marketing.rpt_executive_dashboard
[0m22:36:13.802256 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8
[0m22:36:13.802506 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.digital_marketing.rpt_executive_dashboard, now test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8)
[0m22:36:13.802737 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8
[0m22:36:13.807584 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8"
[0m22:36:13.808162 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8
[0m22:36:13.808447 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:13.873958 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8
[0m22:36:13.874283 [debug] [Thread-1  ]: Began running node test.digital_marketing.not_null_dim_users_user_id.e754bb5812
[0m22:36:13.874544 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_dim_users_lifetime_value.fe5133cef8, now test.digital_marketing.not_null_dim_users_user_id.e754bb5812)
[0m22:36:13.874806 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.not_null_dim_users_user_id.e754bb5812
[0m22:36:13.879114 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.not_null_dim_users_user_id.e754bb5812"
[0m22:36:13.879605 [debug] [Thread-1  ]: Began executing node test.digital_marketing.not_null_dim_users_user_id.e754bb5812
[0m22:36:13.879862 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:13.945309 [debug] [Thread-1  ]: Finished running node test.digital_marketing.not_null_dim_users_user_id.e754bb5812
[0m22:36:13.945685 [debug] [Thread-1  ]: Began running node test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b
[0m22:36:13.945979 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.not_null_dim_users_user_id.e754bb5812, now test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b)
[0m22:36:13.946237 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b
[0m22:36:13.951505 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b"
[0m22:36:13.952227 [debug] [Thread-1  ]: Began executing node test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b
[0m22:36:13.952492 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:14.017653 [debug] [Thread-1  ]: Finished running node test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b
[0m22:36:14.017934 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_dim_users_email.53417c09f1
[0m22:36:14.018192 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.relationships_fct_orders_user_id__user_id__ref_dim_users_.dd44ed847b, now test.digital_marketing.unique_dim_users_email.53417c09f1)
[0m22:36:14.018424 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_dim_users_email.53417c09f1
[0m22:36:14.022582 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_dim_users_email.53417c09f1"
[0m22:36:14.023011 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_dim_users_email.53417c09f1
[0m22:36:14.023262 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:14.088808 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_dim_users_email.53417c09f1
[0m22:36:14.089145 [debug] [Thread-1  ]: Began running node test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9
[0m22:36:14.089412 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.digital_marketing.unique_dim_users_email.53417c09f1, now test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9)
[0m22:36:14.089651 [debug] [Thread-1  ]: Began compiling node test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9
[0m22:36:14.093918 [debug] [Thread-1  ]: Writing injected SQL for node "test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9"
[0m22:36:14.094402 [debug] [Thread-1  ]: Began executing node test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9
[0m22:36:14.094654 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:36:14.161282 [debug] [Thread-1  ]: Finished running node test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9
[0m22:36:14.162095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:36:14.162336 [debug] [MainThread]: Connection 'test.digital_marketing.unique_dim_users_user_id.bcdc17b9f9' was properly closed.
[0m22:36:14.168750 [debug] [MainThread]: Command end result
[0m22:36:14.317979 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:36:14.320266 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:36:14.328606 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/run_results.json
[0m22:36:14.331130 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m22:36:14.331435 [info ] [MainThread]: Building catalog
[0m22:36:14.339851 [debug] [ThreadPool]: Acquiring new bigquery connection 'data-products-441119.information_schema'
[0m22:36:14.353391 [debug] [ThreadPool]: On data-products-441119.information_schema: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "data-products-441119.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `data-products-441119`.`dbt_dev_analytics`.__TABLES__ tables
    left join `data-products-441119`.`dbt_dev_analytics`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `data-products-441119`.`dbt_dev_analytics`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('alerts_schema_changes')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('stg_order_items')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('elementary_test_results')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('fct_daily_revenue')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dim_users')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('data_monitoring_metrics')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('int_user_order_history')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('rpt_customer_cohorts')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('alerts_dbt_tests')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('metrics_anomaly_score')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_invocations')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('test_result_rows')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_seeds')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('alerts_dbt_models')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('information_schema_columns')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_run_results')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('snapshot_run_results')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('metadata')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('anomaly_threshold_sensitivity')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('stg_users')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('monitors_runs')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_metrics')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_snapshots')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_columns')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_models')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('enriched_columns')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('stg_products')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dim_products')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_artifacts_hashes')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('product_categories')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_tests')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('job_run_results')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('customer_segments')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('alerts_anomaly_detection')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_exposures')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('rpt_executive_dashboard')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('schema_columns_snapshot')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('stg_orders')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('alerts_dbt_source_freshness')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('fct_orders')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('rpt_product_performance')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_sources')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('int_product_metrics')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('dbt_source_freshness_results')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('model_run_results')
                            ) or (
                                upper(table_schema) = upper('dbt_dev_analytics')
                            and upper(table_name) = upper('stg_events')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `data-products-441119`.`dbt_dev_analytics`.INFORMATION_SCHEMA.COLUMNS columns
    join `data-products-441119`.`dbt_dev_analytics`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m22:36:14.354253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:15.194879 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:42a24115-7e83-4964-8c9b-8ca7917b3e9b&page=queryresults
[0m22:36:17.415128 [debug] [ThreadPool]: On data-products-441119.information_schema: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "data-products-441119.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `data-products-441119`.`snapshot`.__TABLES__ tables
    left join `data-products-441119`.`snapshot`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `data-products-441119`.`snapshot`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('snapshot')
                            and upper(table_name) = upper('snap_products')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `data-products-441119`.`snapshot`.INFORMATION_SCHEMA.COLUMNS columns
    join `data-products-441119`.`snapshot`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m22:36:17.416117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:36:18.062023 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:5195bffe-abff-454d-a892-e2b572edde67&page=queryresults
[0m22:36:18.063875 [error] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:5195bffe-abff-454d-a892-e2b572edde67&page=queryresults
[0m22:36:18.065149 [debug] [ThreadPool]: BigQuery adapter: Unhandled error while running:
macro get_catalog_relations
[0m22:36:18.065770 [debug] [ThreadPool]: BigQuery adapter: Database Error
  Not found: Dataset data-products-441119:snapshot was not found in location US
[0m22:36:18.070688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly data-products-441119.information_schema, now bigquery-public-data.information_schema)
[0m22:36:18.071094 [warn ] [MainThread]: Encountered an error while generating catalog: Database Error
  Not found: Dataset data-products-441119:snapshot was not found in location US
[0m22:36:18.076520 [debug] [ThreadPool]: On bigquery-public-data.information_schema: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "thelook_analytics", "target_name": "dev", "connection_name": "bigquery-public-data.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `bigquery-public-data`.`thelook_ecommerce`.__TABLES__ tables
    left join `bigquery-public-data`.`thelook_ecommerce`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `bigquery-public-data`.`thelook_ecommerce`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('thelook_ecommerce')
                            and upper(table_name) = upper('inventory_items')
                            ) or (
                                upper(table_schema) = upper('thelook_ecommerce')
                            and upper(table_name) = upper('orders')
                            ) or (
                                upper(table_schema) = upper('thelook_ecommerce')
                            and upper(table_name) = upper('order_items')
                            ) or (
                                upper(table_schema) = upper('thelook_ecommerce')
                            and upper(table_name) = upper('products')
                            ) or (
                                upper(table_schema) = upper('thelook_ecommerce')
                            and upper(table_name) = upper('users')
                            ) or (
                                upper(table_schema) = upper('thelook_ecommerce')
                            and upper(table_name) = upper('events')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `bigquery-public-data`.`thelook_ecommerce`.INFORMATION_SCHEMA.COLUMNS columns
    join `bigquery-public-data`.`thelook_ecommerce`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m22:36:18.077656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:36:18.647929 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-products-441119&j=bq:US:e698b8da-f1ce-42c2-b201-caaa3a882bfb&page=queryresults
[0m22:36:20.614455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:36:20.698151 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/catalog.json
[0m22:36:20.924443 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/manifest.json
[0m22:36:20.926521 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/semantic_manifest.json
[0m22:36:20.926763 [error] [MainThread]: dbt encountered 1 failure while writing the catalog
[0m22:36:20.927000 [info ] [MainThread]: Catalog written to /Users/azadsolanki/dev/data-engineering/analytics-engineering/target/catalog.json
[0m22:36:20.930743 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 22.845564, "process_in_blocks": "0", "process_kernel_time": 0.77853, "process_mem_max_rss": "361693184", "process_out_blocks": "0", "process_user_time": 11.819438}
[0m22:36:20.931220 [debug] [MainThread]: Command `dbt docs generate` failed at 22:36:20.931144 after 22.85 seconds
[0m22:36:20.931540 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:36:20.931752 [debug] [MainThread]: Connection 'bigquery-public-data.information_schema' was properly closed.
[0m22:36:20.931984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bc3d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dda0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ddbe7f0>]}
[0m22:36:20.932308 [debug] [MainThread]: Flushing usage events
[0m22:36:21.274388 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:39:18.998963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105adbe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa9430>]}


============================== 22:39:19.003036 | e6ec358d-cd3b-4dba-94c5-d5b8a6b39683 ==============================
[0m22:39:19.003036 [info ] [MainThread]: Running with dbt=1.10.10
[0m22:39:19.003432 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_path': '/Users/azadsolanki/dev/data-engineering/analytics-engineering/logs', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt docs serve', 'indirect_selection': 'eager', 'version_check': 'True', 'quiet': 'False', 'warn_error': 'None', 'printer_width': '80', 'no_print': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'profiles_dir': '/Users/azadsolanki/.dbt', 'debug': 'False', 'log_format': 'default', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True'}
[0m22:39:21.127052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6ec358d-cd3b-4dba-94c5-d5b8a6b39683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14357ce80>]}
[0m22:39:21.167729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6ec358d-cd3b-4dba-94c5-d5b8a6b39683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14358d0d0>]}
[0m22:39:58.887534 [error] [MainThread]: Encountered an error:

[0m22:39:58.993924 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/azadsolanki/dev/data-engineering/airflow-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/azadsolanki/dev/data-engineering/airflow-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/azadsolanki/dev/data-engineering/airflow-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/azadsolanki/dev/data-engineering/airflow-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/azadsolanki/dev/data-engineering/airflow-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/azadsolanki/dev/data-engineering/airflow-env/lib/python3.9/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/Users/azadsolanki/dev/data-engineering/airflow-env/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m22:39:58.998499 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 40.053814, "process_in_blocks": "0", "process_kernel_time": 0.43103, "process_mem_max_rss": "342261760", "process_out_blocks": "0", "process_user_time": 2.395804}
[0m22:39:59.000003 [debug] [MainThread]: Command `dbt docs serve` failed at 22:39:58.999805 after 40.06 seconds
[0m22:39:59.000934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105adbe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1437d5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1437d5970>]}
[0m22:39:59.001474 [debug] [MainThread]: Flushing usage events
[0m22:39:59.336346 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:30:09.282660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe7dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a9b50>]}


============================== 20:30:09.287022 | 77df4739-6e1c-433f-962c-b5b06790e07a ==============================
[0m20:30:09.287022 [info ] [MainThread]: Running with dbt=1.10.10
[0m20:30:09.287449 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'profiles_dir': '/Users/azadsolanki/.dbt', 'printer_width': '80', 'invocation_command': 'dbt clean', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/azadsolanki/dev/data-engineering/retail-analytics-framework/logs', 'fail_fast': 'False', 'version_check': 'True', 'introspect': 'True', 'log_format': 'default', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'warn_error': 'None'}
[0m20:30:09.388922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77df4739-6e1c-433f-962c-b5b06790e07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105901ca0>]}
[0m20:30:09.510858 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.28151062, "process_in_blocks": "0", "process_kernel_time": 0.241559, "process_mem_max_rss": "99598336", "process_out_blocks": "0", "process_user_time": 0.926536}
[0m20:30:09.511310 [debug] [MainThread]: Command `dbt clean` succeeded at 20:30:09.511245 after 0.28 seconds
[0m20:30:09.511577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe7dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105901ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a32b80>]}
[0m20:30:09.511843 [debug] [MainThread]: Flushing usage events
[0m20:30:09.846011 [debug] [MainThread]: An error was encountered while trying to flush usage events
